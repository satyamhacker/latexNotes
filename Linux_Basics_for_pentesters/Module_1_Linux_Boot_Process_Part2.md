# **Module 1: Linux ki Buniyaad aur Boot Process (Part 2)**

## **Topic 3: Runlevels & Systemd Targets**

### **1. Topic ka Naam / Ek Line Mein Summary** ðŸš€
**Runlevels & Systemd Targets:** Linux system ke alag-alag "modes" - jaise aapka phone Silent, Vibrate, ya Ring mode mein hota hai.

### **2. Ye Kya Hai? (What is it?)**
Runlevels aur Systemd Targets Linux system ki alag-alag states hain jo decide karti hain ki boot ke baad kaun si services chalegi aur system ka behavior kaisa hoga.

**Analogy:** Sochiye aapki car mein gears hain - Parking (0), First gear (1), Second gear (2), etc. Har gear mein car ka behavior alag hota hai. Waise hi Linux mein runlevels/targets hain. Runlevel 0 mein system shutdown hota hai, Runlevel 5 mein full GUI ke saath chalta hai.

### **3. Kyun Zaroori Hai? (Why is it important?)**
**Pentester ke liye:**
- Single-user mode (Runlevel 1) mein password bypass attacks
- Service enumeration - kaun si services kis runlevel mein chalti hain
- Persistence - malicious services ko specific runlevel mein add karna
- System behavior ko samajhna

**VPS Admin ke liye:**
- Server ko GUI ke bina chalana (resources bachane ke liye)
- Maintenance mode mein jaana (single-user)
- Boot behavior customize karna
- Services ko control karna

### **4. Ise Kab Use Karna Chahiye? (When to use it?)**
- Server ko headless (bina GUI) mode mein run karna ho
- System recovery ya maintenance karna ho
- Specific services ko enable/disable karna ho
- Boot behavior change karni ho
- Pentesting mein privilege escalation ke liye

### **5. Agar Ye Pata Nahi Hoga Toh Kya Hoga? (If not known then what?)** ðŸ˜Ÿ
Aap system ko efficiently configure nahi kar payenge. VPS par unnecessary GUI services chalti rahegi (RAM waste). Pentesting mein single-user mode ka fayda nahi utha payenge. System troubleshooting mein dikkat hogi.

### **6. Ye Kaise Kaam Karta Hai? / Syntax aur Options**

**Traditional Runlevels (SysVinit):**
- **Runlevel 0:** Shutdown/Halt
- **Runlevel 1:** Single-user mode (root only, no network)
- **Runlevel 2:** Multi-user mode (no networking)
- **Runlevel 3:** Multi-user mode with networking (no GUI)
- **Runlevel 4:** Undefined (custom use)
- **Runlevel 5:** Multi-user with GUI (X11)
- **Runlevel 6:** Reboot

**Modern Systemd Targets:**
- `poweroff.target` â†’ Runlevel 0
- `rescue.target` â†’ Runlevel 1
- `multi-user.target` â†’ Runlevel 3
- `graphical.target` â†’ Runlevel 5
- `reboot.target` â†’ Runlevel 6

**Important Commands:**
```bash
# Current runlevel dekhna (old systems)
runlevel

# Current target dekhna (systemd)
systemctl get-default

# Target change karna
sudo systemctl set-default multi-user.target

# Temporarily target change karna (reboot tak)
sudo systemctl isolate rescue.target
```

### **7. Command Example (Poori Explanation ke Saath)**

**Scenario:** Server ko GUI se console mode mein switch karna hai (resources bachane ke liye)

```bash
sudo systemctl set-default multi-user.target
```

| Command Part | Matlab |
|--------------|--------|
| `sudo` | Root privileges ke saath |
| `systemctl` | systemd control command |
| `set-default` | Default boot target set karo |
| `multi-user.target` | Console mode (no GUI) |

**Expected Output:** 
```
Removed /etc/systemd/system/default.target.
Created symlink /etc/systemd/system/default.target â†’ /lib/systemd/system/multi-user.target.
```

**Runlevel change karna (old method):**
```bash
sudo init 3
```

| Command Part | Matlab |
|--------------|--------|
| `init` | Runlevel change command |
| `3` | Multi-user with networking (no GUI) |

**Expected Output:** GUI band ho jayega, console login screen aayega.

### **8. Beginners ki Aam Galtiyan (Common Mistakes)**
- `init 0` accidentally chala dena (system shutdown ho jayega)
- `init 6` aur `reboot` mein fark na samajhna (dono same hain)
- Runlevel aur systemd target ko mix karna (purane aur naye systems mein alag hain)
- Single-user mode mein network expect karna (network nahi hota)
- Default target change karne ke baad reboot na karna

### **9. Best Practices / Pro Tips**
- **CRITICAL Fix:** Production server par kabhi directly `init 0` ya `init 6` na chalayein, pehle confirm karein
- VPS servers ko hamesha `multi-user.target` (no GUI) par run karein - RAM aur CPU bachega
- **Stealth Tip:** Pentesting mein GRUB se `systemd.unit=rescue.target` boot parameter add karke single-user mode mein ja sakte hain
- `systemctl list-units --type=target` se saare available targets dekh sakte hain
- Emergency mode ke liye: `systemd.unit=emergency.target`

### **10. Asli Duniya ka Scenario (Real-World Scenario)**
Ek company ka web server GUI ke saath chal raha tha aur RAM usage 80% tha. Admin ne `systemctl set-default multi-user.target` set kiya aur reboot kiya. GUI services band ho gayi aur RAM usage 40% par aa gaya. Server ki performance double ho gayi kyunki unnecessary desktop environment nahi chal rahi thi. Ek pentester ne physical access mein GRUB edit karke `single` parameter add kiya aur bina password ke root shell le liya.

### **11. Checklist / Chota Recap (TL;DR)**
- Runlevel 0 = Shutdown, 1 = Single-user, 3 = Multi-user no GUI, 5 = GUI, 6 = Reboot
- Systemd targets modern replacement hain runlevels ka
- `systemctl get-default` se current target check karein
- `systemctl set-default multi-user.target` se GUI disable karein
- `init 1` ya `systemctl isolate rescue.target` se single-user mode

### **12. Aksar Puche Jaane Wale Sawaal (FAQs)**

**Q1: Runlevel aur Systemd Target mein kya fark hai?**
A: Runlevels purana SysVinit system hai (0-6 numbers), Systemd Targets modern replacement hain (descriptive names). Functionality same hai.

**Q2: Single-user mode mein kya hota hai?**
A: Sirf root user login kar sakta hai, networking disabled hoti hai, minimal services chalti hain. Ye recovery/maintenance ke liye use hota hai.

**Q3: GUI disable karne se kitna RAM bachega?**
A: Typically 500MB-1GB RAM bach sakta hai, depending on desktop environment (GNOME zyada, XFCE kam).

**Q4: Kya runlevel change permanent hota hai?**
A: `init` command temporary hai (reboot tak), `systemctl set-default` permanent hai.

**Q5: Emergency mode aur Rescue mode mein kya fark hai?**
A: Rescue mode mein zyada services chalti hain, Emergency mode mein bilkul minimal (sirf root filesystem mount hota hai).

### **13. Practice ke liye Task**
1. `systemctl get-default` se current target check karein
2. `systemctl list-units --type=target --all` se saare targets dekhein
3. `who -r` se current runlevel check karein
4. Test system par `sudo systemctl isolate multi-user.target` try karein (GUI band ho jayega)
5. `Ctrl+Alt+F1` se console switch karein, `Ctrl+Alt+F7` se wapas GUI

**Expected Output:**
- Default target: `graphical.target` (desktop) ya `multi-user.target` (server)
- 10-15 different targets ki list
- Current runlevel: `N 5` (N = previous, 5 = current)

### **14. Extra / Advanced Jaankari (Optional)**
- **Custom Targets:** Aap apne khud ke targets bana sakte hain `/etc/systemd/system/` mein
- **Target Dependencies:** `systemctl list-dependencies graphical.target` se dekh sakte hain ki ek target ko kya-kya chahiye
- **Runlevel Scripts:** Old systems mein `/etc/rc.d/rc3.d/` jaise directories mein startup scripts hote the
- **Systemd Units:** Targets actually unit files hain jo `.target` extension ke saath hote hain

### **15. Aakhri Choti Summary (5 lines)**
- Runlevels/Targets system ki different states hain (shutdown, single-user, multi-user, GUI)
- Modern systems systemd targets use karti hain, purani systems runlevels
- VPS servers ko `multi-user.target` par run karna chahiye (no GUI = better performance)
- Single-user mode (Runlevel 1) password bypass ke liye use hota hai pentesting mein
- `systemctl get-default` aur `systemctl set-default` main commands hain

> **Ye Zaroor Yaad Rakhein**
> 1. Runlevel 1 = Single-user mode (recovery/pentesting)
> 2. Runlevel 3 = Multi-user no GUI (ideal for servers)
> 3. Runlevel 5 = Multi-user with GUI (desktops)
> 4. `init 0` = Shutdown, `init 6` = Reboot
> 5. `systemctl set-default multi-user.target` se permanent GUI disable

---

## **Topic 4: Linux File System Hierarchy**

### **1. Topic ka Naam / Ek Line Mein Summary** ðŸš€
**Linux File System Hierarchy:** Linux ka directory structure - har folder ka apna specific kaam aur jagah.

### **2. Ye Kya Hai? (What is it?)**
Linux File System Hierarchy ek standardized tree structure hai jahan har directory ka ek specific purpose hota hai. Ye `/` (root) se shuru hota hai aur branches ki tarah failta hai.

**Analogy:** Ye ek organized library ki tarah hai. `/bin` tools ka section hai, `/etc` configuration books ka section, `/home` har user ki personal shelf, `/var` changing data ka section (jaise newspapers), aur `/tmp` temporary notes ka dustbin.

### **3. Kyun Zaroori Hai? (Why is it important?)**
**Pentester ke liye:**
- Sensitive files kahan milegi ye pata hona (passwords, configs, logs)
- Writable directories dhoondhna (privilege escalation ke liye)
- Backup files aur temporary files dhoondhna
- System enumeration ke liye

**VPS Admin ke liye:**
- Files ko sahi jagah rakhna
- Disk space management
- Backup strategy banana
- Troubleshooting (logs kahan hain, configs kahan hain)
- Security (kaun si directory kaun access kar sakta hai)

### **4. Ise Kab Use Karna Chahiye? (When to use it?)**
- Naya Linux system use kar rahe hain
- Files dhoondhni hain
- Services configure karni hain
- Pentesting mein enumeration kar rahe hain
- Disk space issues troubleshoot kar rahe hain
- Backup/restore kar rahe hain

### **5. Agar Ye Pata Nahi Hoga Toh Kya Hoga? (If not known then what?)** ðŸ˜Ÿ
Aap files dhoondhne mein ghanto waste karenge. Pentesting mein important files miss ho jayengi. Admin ke roop mein aap galat jagah files rakhenge (jaise logs ko `/home` mein). System troubleshooting impossible ho jayegi.

### **6. Ye Kaise Kaam Karta Hai? / Syntax aur Options**

**Main Directories aur Unka Purpose:**

**`/` (Root Directory)**
- Poore file system ka starting point
- Sabse upar ki directory
- Iske andar hi saari directories hain

**`/root`**
- Root user ka home directory
- Normal users yahan access nahi kar sakte
- Sensitive admin files yahan hoti hain

**`/home`**
- Normal users ke home directories
- `/home/username` format mein
- Har user ko apne folder mein full access

**`/etc`**
- System configuration files
- Service configs (nginx, ssh, mysql)
- Startup scripts
- Password files (`/etc/passwd`, `/etc/shadow`)

**`/var`**
- Variable data (jo change hota rehta hai)
- `/var/log` - System logs
- `/var/www` - Web server files
- `/var/mail` - Email storage
- `/var/tmp` - Temporary files (reboot ke baad bhi rahti hain)

**`/tmp`**
- Temporary files
- Reboot ke baad delete ho jaati hain
- Sabko write permission hoti hai
- Pentesting mein exploit upload karne ke liye use hota hai

**`/bin`**
- Essential user binaries
- Basic commands (ls, cp, mv, cat, bash)
- System boot ke liye zaroori

**`/sbin`**
- System binaries (admin commands)
- Root user ke liye (ifconfig, iptables, reboot)
- System maintenance tools

**`/usr`**
- User programs aur data
- `/usr/bin` - User commands
- `/usr/sbin` - System admin commands
- `/usr/local` - Locally installed software

**`/boot`**
- Boot loader files
- Kernel images (vmlinuz)
- initramfs files
- GRUB configuration

**`/dev`**
- Device files
- Hardware ko files ki tarah represent karta hai
- `/dev/sda` - Hard disk
- `/dev/null` - Black hole (data delete karne ke liye)

**`/proc`**
- Virtual filesystem
- Running processes ki info
- System info (`/proc/cpuinfo`, `/proc/meminfo`)

**`/sys`**
- Virtual filesystem
- Kernel aur hardware info

### **7. Command Example (Poori Explanation ke Saath)**

**File System Structure dekhna:**
```bash
tree -L 1 -d /
```

| Command Part | Matlab |
|--------------|--------|
| `tree` | Directory structure tree format mein dikhata hai |
| `-L 1` | Sirf 1 level deep (root ke immediate children) |
| `-d` | Sirf directories, files nahi |
| `/` | Root directory se shuru karo |

**Expected Output:**
```
/
â”œâ”€â”€ bin
â”œâ”€â”€ boot
â”œâ”€â”€ dev
â”œâ”€â”€ etc
â”œâ”€â”€ home
â”œâ”€â”€ root
â”œâ”€â”€ tmp
â”œâ”€â”€ usr
â”œâ”€â”€ var
â””â”€â”€ ...
```

**Disk usage directory-wise:**
```bash
sudo du -sh /* 2>/dev/null | sort -h
```

| Command Part | Matlab |
|--------------|--------|
| `du` | Disk usage calculate karta hai |
| `-s` | Summary (total per directory) |
| `-h` | Human-readable (MB, GB) |
| `/*` | Root ke saare immediate children |
| `2>/dev/null` | Errors hide karo |
| `sort -h` | Size ke hisaab se sort karo |

**Expected Output:**
```
4.0K    /srv
16M     /root
500M    /boot
2.0G    /home
5.0G    /usr
10G     /var
```

### **8. Beginners ki Aam Galtiyan (Common Mistakes)**
- `/root` aur `/` ko confuse karna (dono alag hain)
- Important files `/tmp` mein rakhna (reboot ke baad delete ho jayengi)
- `/etc` mein bina backup ke directly edit karna
- `/home` aur `/root` ko same samajhna
- Windows ki tarah `C:\` dhoondhna (Linux mein drive letters nahi hote)

### **9. Best Practices / Pro Tips**
- **CRITICAL Fix:** `/etc` ki koi bhi file edit karne se pehle backup: `sudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak`
- Pentesting mein hamesha `/tmp` check karein - writable hai aur exploits upload karne ke liye perfect
- **Stealth Tip:** `/dev/shm` RAM-based filesystem hai - yahan files disk par nahi likhi jaati (forensics se bach sakte hain)
- Logs hamesha `/var/log` mein hote hain - troubleshooting ka pehla stop
- `find / -type f -name "*.conf" 2>/dev/null` se saari config files dhoondhein

### **10. Asli Duniya ka Scenario (Real-World Scenario)**
Ek pentester ko web server par RCE (Remote Code Execution) mila. Usne pehle `/tmp` mein apna privilege escalation exploit upload kiya (kyunki `/tmp` writable hai). Phir usne `/etc/passwd` aur `/etc/shadow` check kiye (password hashes ke liye). `/var/www/html` mein web files dekhi. `/var/log/apache2/access.log` se pata chala ki admin kaun sa IP use karta hai. `/home` mein users ke SSH keys dhoondhne ki koshish ki. Agar use file system hierarchy ka gyaan na hota, to wo randomly files dhoondhta rehta.

### **11. Checklist / Chota Recap (TL;DR)**
- `/` = Root directory (sabse upar)
- `/root` = Root user ka home
- `/home` = Normal users ke homes
- `/etc` = Configuration files
- `/var/log` = System logs
- `/tmp` = Temporary files (writable by all)
- `/bin` & `/sbin` = Commands/binaries

### **12. Aksar Puche Jaane Wale Sawaal (FAQs)**

**Q1: `/root` aur `/home` mein kya fark hai?**
A: `/root` sirf root user ka home hai. `/home` mein saare normal users ke folders hote hain (`/home/john`, `/home/alice`).

**Q2: `/tmp` aur `/var/tmp` mein kya fark hai?**
A: `/tmp` reboot ke baad clean ho jata hai. `/var/tmp` reboot ke baad bhi files rahti hain.

**Q3: `/bin` aur `/sbin` mein kya fark hai?**
A: `/bin` mein basic user commands hain (ls, cat). `/sbin` mein system admin commands hain (ifconfig, iptables).

**Q4: `/proc` aur `/sys` real directories hain?**
A: Nahi, ye virtual filesystems hain. Ye disk par nahi hote, RAM mein hote hain. Ye kernel information provide karte hain.

**Q5: Pentesting mein sabse important directories kaun si hain?**
A: `/etc` (configs), `/var/log` (logs), `/tmp` (writable), `/home` (user data), `/root` (admin data), `/var/www` (web files).

### **13. Practice ke liye Task**
1. `ls -la /` se root directory ki saari directories dekhein
2. `du -sh /var/log` se log files ka size check karein
3. `ls -la /tmp` se temporary files dekhein
4. `cat /etc/passwd | wc -l` se total users count karein
5. `find /etc -name "*.conf" | head -10` se config files dhoondhein

**Expected Output:**
- Root directory mein 15-20 directories
- `/var/log` typically 100MB-1GB
- `/tmp` mein kuch temporary files
- 30-50 users (system users included)
- 10 config files ki list

### **14. Extra / Advanced Jaankari (Optional)**
- **FHS (Filesystem Hierarchy Standard):** Ye ek official standard hai jo define karta hai ki kaun si directory kahan honi chahiye
- **Mount Points:** `/mnt` aur `/media` external drives mount karne ke liye use hote hain
- **`/opt`:** Optional/third-party software ke liye (jaise `/opt/google/chrome`)
- **`/dev/shm`:** RAM-based temporary filesystem - bahut fast, lekin reboot par delete
- **Symbolic Links:** `/bin` actually `/usr/bin` ka symlink ho sakta hai modern systems mein

### **15. Aakhri Choti Summary (5 lines)**
- Linux file system ek tree structure hai jo `/` se shuru hota hai
- Har directory ka ek specific purpose hai (configs, logs, binaries, etc.)
- `/etc` mein configs, `/var/log` mein logs, `/tmp` mein temporary files
- Pentesting mein `/tmp` writable hai aur `/etc` mein sensitive files hain
- File system hierarchy ka gyaan troubleshooting aur pentesting dono ke liye critical hai

> **Ye Zaroor Yaad Rakhein**
> 1. `/` root directory hai, `/root` root user ka home
> 2. `/etc` = Configurations, `/var/log` = Logs
> 3. `/tmp` sabke liye writable hai (pentesting mein useful)
> 4. `/home/username` har user ka personal space
> 5. `/bin` & `/sbin` mein commands hain, `/boot` mein kernel

---

## **Module 1 Takeaway**

Is module mein humne Linux ki buniyaad seekhi - boot process se lekar file system hierarchy tak. Boot process samajhna troubleshooting aur pentesting dono ke liye zaroori hai. GRUB se password bypass ho sakta hai agar physical access ho. Runlevels aur Systemd Targets system behavior control karte hain - servers ko `multi-user.target` par run karna chahiye GUI ke bina. File system hierarchy ka gyaan har Linux user ke liye fundamental hai - aapko pata hona chahiye ki configs kahan hain (`/etc`), logs kahan hain (`/var/log`), aur temporary files kahan rakhni hain (`/tmp`). Ye foundation agle modules ke liye bahut important hai.

