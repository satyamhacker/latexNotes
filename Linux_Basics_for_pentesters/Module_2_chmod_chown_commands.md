# **Module 2: User, Group aur File Permissions Management (Part 2)**

## **Topic 3: `chmod` Command (Symbolic & Octal methods)**

### **1. Topic ka Naam / Ek Line Mein Summary** ðŸš€
**chmod Command:** File aur directory permissions ko change karne ka Swiss Army knife - symbolic aur octal dono tareeke se.

### **2. Ye Kya Hai? (What is it?)**
`chmod` (Change Mode) command se hum file aur directory ki permissions ko modify karte hain. Ye do tareeke se kaam karta hai: Symbolic method (letters use karke: u, g, o, r, w, x) aur Octal method (numbers use karke: 0-7).

**Analogy:** Sochiye aapke ghar ki chabi hai. `chmod` wo tool hai jisse aap decide karte hain ki kaun sa darwaza (file) kaun khol sakta hai (read), kaun andar ja sakta hai (execute), aur kaun furniture move kar sakta hai (write). Aap ye ya to words mein bata sakte hain ("owner ko sab kuch do") ya numbers mein (755).

### **3. Kyun Zaroori Hai? (Why is it important?)**
**Pentester ke liye:**
- Exploit files ko executable banana
- Writable files identify karna
- Permission misconfigurations exploit karna
- Post-exploitation mein files hide karna
- Backdoor scripts ko proper permissions dena

**VPS Admin ke liye:**
- Security hardening - unnecessary permissions remove karna
- Web server files secure karna
- Scripts ko executable banana
- Service configuration files protect karna
- Compliance requirements meet karna

### **4. Ise Kab Use Karna Chahiye? (When to use it?)**
- Script banane ke baad (executable banana)
- Web files upload karne ke baad
- Security audit ke dauran
- Service configuration ke baad
- Pentesting mein exploit upload karne ke baad

### **5. Agar Ye Pata Nahi Hoga Toh Kya Hoga? (If not known then what?)** ðŸ˜Ÿ
Scripts run nahi hongi (execute permission nahi). Security holes rahenge (777 permissions). Pentesting mein uploaded exploits execute nahi kar payenge. Production mein unauthorized access ho sakta hai.

### **6. Ye Kaise Kaam Karta Hai? / Syntax aur Options**

**Symbolic Method:**
```bash
chmod [who][operation][permissions] filename
```
- **who:** u (user), g (group), o (others), a (all)
- **operation:** + (add), - (remove), = (set exactly)
- **permissions:** r (read), w (write), x (execute)

**Octal Method:**
```bash
chmod [number] filename
```
- **Numbers:** Sum of r=4, w=2, x=1
- **Format:** [owner][group][others]

**Octal Values:**
- 0 = --- (no permissions)
- 1 = --x (execute only)
- 2 = -w- (write only)
- 3 = -wx (write + execute)
- 4 = r-- (read only)
- 5 = r-x (read + execute)
- 6 = rw- (read + write)
- 7 = rwx (full permissions)

**Common Permissions:**
- **644** = rw-r--r-- (files: owner read/write, others read)
- **755** = rwxr-xr-x (directories/scripts: owner full, others read/execute)
- **600** = rw------- (sensitive files: only owner)
- **700** = rwx------ (private directories: only owner)
- **777** = rwxrwxrwx (dangerous: everyone full access)

**Recursive Option:**
```bash
chmod -R 755 directory/
```

### **7. Command Example (Poori Explanation ke Saath)**

**Scenario 1: Script ko executable banana (Symbolic)**
```bash
chmod +x script.sh
```

| Command Part | Matlab |
|--------------|--------|
| `chmod` | Change mode command |
| `+x` | Execute permission add karo (sabko) |
| `script.sh` | Target file |

**Expected Output:** No output (success), ab `./script.sh` se run kar sakte hain.

**Scenario 2: Script ko executable banana (Octal)**
```bash
chmod 755 script.sh
```

| Command Part | Matlab |
|--------------|--------|
| `chmod` | Change mode command |
| `755` | Owner: rwx (7), Group: r-x (5), Others: r-x (5) |
| `script.sh` | Target file |

**Scenario 3: Sensitive file secure karna**
```bash
chmod 600 ~/.ssh/id_rsa
```

| Command Part | Matlab |
|--------------|--------|
| `600` | Owner: rw- (6), Group: --- (0), Others: --- (0) |
| `~/.ssh/id_rsa` | SSH private key |

**Expected Output:** Sirf owner read/write kar sakta hai, baaki koi nahi.

**Scenario 4: Others se permissions remove karna**
```bash
chmod o-rwx file.txt
```

| Command Part | Matlab |
|--------------|--------|
| `o` | Others (baaki sab log) |
| `-` | Remove karo |
| `rwx` | Read, write, execute teeno |
| `file.txt` | Target file |

**Scenario 5: Group ko specific permissions dena**
```bash
chmod g=rw file.txt
```

| Command Part | Matlab |
|--------------|--------|
| `g` | Group |
| `=` | Exactly set karo (pehle wale replace) |
| `rw` | Read aur write |

**Scenario 6: Directory aur uski files recursively**
```bash
chmod -R 755 /var/www/html/
```

| Command Part | Matlab |
|--------------|--------|
| `-R` | Recursive (directory + andar ki sab files) |
| `755` | Standard web permissions |
| `/var/www/html/` | Web root directory |

### **8. Beginners ki Aam Galtiyan (Common Mistakes)**
- `chmod +x` ke baad `./` lagana bhoolna (script run nahi hogi)
- `chmod 777` har jagah use karna (major security risk)
- Symbolic aur octal ko mix karna: `chmod u+755` (galat)
- SSH keys ko 644 rakhna (600 hona chahiye)
- Recursive chmod se pehle backup na lena
- `chmod` aur `chown` ko confuse karna

### **9. Best Practices / Pro Tips**
- **CRITICAL Fix:** SSH private keys hamesha `600`, public keys `644` permissions
- Web files: `644` (HTML, CSS, JS), Directories: `755`, Scripts: `755`
- **Stealth Tip:** Pentesting mein uploaded shell ko `chmod +x` karna na bhoolein
- Production mein kabhi `777` use na karein - specific permissions dein
- `chmod -R` use karne se pehle test environment mein try karein
- `find` ke saath combine karein: `find . -type f -exec chmod 644 {} \;`

### **10. Asli Duniya ka Scenario (Real-World Scenario)**
Ek web developer ne apni website deploy ki aur sab files ko `chmod 777` kar diya "taaki koi problem na ho". Ek pentester ne site scan ki, dekha ki `.git` directory world-writable hai, usne malicious code inject kiya, aur site hack ho gayi. Agar developer ne proper permissions use kiye hote (files: 644, directories: 755), to ye attack possible nahi hota.

Dusri scenario: Ek pentester ne file upload vulnerability exploit ki, PHP shell upload kiya, lekin execute nahi ho raha tha. Usne command injection vulnerability use karke `chmod +x shell.php` chalaya, aur phir shell successfully execute ho gaya.

### **11. Checklist / Chota Recap (TL;DR)**
- Symbolic: `chmod u+x file` (user ko execute)
- Octal: `chmod 755 file` (rwxr-xr-x)
- Common: 644 (files), 755 (dirs/scripts), 600 (sensitive)
- Recursive: `chmod -R 755 directory/`
- Script executable: `chmod +x script.sh`
- Secure file: `chmod 600 file`

### **12. Aksar Puche Jaane Wale Sawaal (FAQs)**

**Q1: `chmod +x` aur `chmod 755` mein kya fark hai?**
A: `+x` existing permissions ke upar execute add karta hai. `755` complete permissions set karta hai (rwxr-xr-x).

**Q2: `chmod 777` kyun dangerous hai?**
A: Isse sabko full permissions mil jaati hain - koi bhi file modify, delete, execute kar sakta hai. Major security risk.

**Q3: SSH key ko `chmod 600` kyun karna zaroori hai?**
A: SSH agar private key ko 600 se zyada permissions dekhe to security risk samajh kar connection refuse kar deta hai.

**Q4: Symbolic aur Octal mein kaun sa better hai?**
A: Octal faster hai aur precise. Symbolic readable hai aur specific changes ke liye better (jaise sirf execute add karna).

**Q5: `chmod -R 777` accidentally kar diya, kaise fix karein?**
A: Backup se restore karein. Ya manually: files ko 644, directories ko 755 set karein using find commands.

### **13. Practice ke liye Task**
1. `touch test.txt` - File banayein
2. `ls -l test.txt` - Current permissions dekhein
3. `chmod 600 test.txt` - Owner-only permissions
4. `ls -l test.txt` - Verify karein
5. `chmod u+x test.txt` - Execute add karein
6. `ls -l test.txt` - Final permissions dekhein

**Expected Output:**
- Initial: `-rw-r--r--`
- After 600: `-rw-------`
- After u+x: `-rwx------`

### **14. Extra / Advanced Jaankari (Optional)**
- **Setuid/Setgid:** `chmod u+s file` (SUID), `chmod g+s file` (SGID)
- **Sticky Bit:** `chmod +t directory` (sirf owner delete kar sakta hai)
- **Numeric with Special:** `chmod 4755 file` (SUID + 755)
- **Reference File:** `chmod --reference=file1 file2` (file1 ki permissions copy)
- **Verbose Mode:** `chmod -v 755 file` (changes dikhata hai)

### **15. Aakhri Choti Summary (5 lines)**
- `chmod` permissions change karta hai - symbolic (letters) ya octal (numbers)
- Common: 644 (files), 755 (scripts/dirs), 600 (sensitive), 700 (private)
- Symbolic: `u+x` (add), `o-w` (remove), `g=rw` (set)
- Octal: r=4, w=2, x=1 (add karke use karein)
- Production mein kabhi 777 use na karein

> **Ye Zaroor Yaad Rakhein**
> 1. Scripts ko executable banana: `chmod +x script.sh`
> 2. SSH keys: `chmod 600 ~/.ssh/id_rsa`
> 3. Web files: 644, Web directories: 755
> 4. `chmod 777` = Security nightmare
> 5. Recursive changes se pehle backup lein

---

## **Topic 4: `chown` aur `chgrp` Command**

### **1. Topic ka Naam / Ek Line Mein Summary** ðŸš€
**chown aur chgrp Commands:** File aur directory ka owner aur group change karna - ownership management.

### **2. Ye Kya Hai? (What is it?)**
`chown` (Change Owner) command se file/directory ka owner aur group change karte hain. `chgrp` (Change Group) sirf group change karta hai. Ye commands decide karti hain ki file "belong" kaun ko karti hai.

**Analogy:** Sochiye ek car hai. Owner wo hai jiske naam par car registered hai. Group uski family hai jo car use kar sakti hai. `chown` se aap car ka ownership transfer kar sakte hain (jaise sale karna). `chgrp` se aap sirf family change kar sakte hain (jaise shaadi ke baad).

### **3. Kyun Zaroori Hai? (Why is it important?)**
**Pentester ke liye:**
- File ownership check karna (kaun kis file ka owner hai)
- Privilege escalation opportunities dhoondhna
- Misconfigured ownership exploit karna
- Post-exploitation mein files ko specific user assign karna
- Service accounts identify karna

**VPS Admin ke liye:**
- Web files ko web server user (www-data, nginx) assign karna
- Service files ko proper user assign karna
- Team collaboration - files ko team group assign karna
- Security - sensitive files ko root ownership dena
- Migration - files ko naye user transfer karna

### **4. Ise Kab Use Karna Chahiye? (When to use it?)**
- Files upload karne ke baad (web server ko access dena)
- Service setup karte waqt
- User migration ke dauran
- Security hardening ke liye
- Team collaboration setup mein
- Pentesting mein enumeration phase

### **5. Agar Ye Pata Nahi Hoga Toh Kya Hoga? (If not known then what?)** ðŸ˜Ÿ
Web server files access nahi kar payega (permission denied errors). Services fail ho jayengi. Team members files access nahi kar payenge. Pentesting mein ownership-based vulnerabilities miss ho jayengi.

### **6. Ye Kaise Kaam Karta Hai? / Syntax aur Options**

**chown Syntax:**
```bash
# Sirf owner change
chown username file

# Sirf group change
chown :groupname file

# Owner aur group dono
chown username:groupname file

# Recursive (directory + contents)
chown -R username:groupname directory/
```

**chgrp Syntax:**
```bash
# Group change
chgrp groupname file

# Recursive
chgrp -R groupname directory/
```

**Important Options:**
- `-R` : Recursive (directory aur uski saari contents)
- `-v` : Verbose (changes dikhata hai)
- `--reference=file1` : file1 ki ownership copy karo

### **7. Command Example (Poori Explanation ke Saath)**

**Scenario 1: Web files ko web server assign karna**
```bash
sudo chown www-data:www-data /var/www/html/index.html
```

| Command Part | Matlab |
|--------------|--------|
| `sudo` | Root privileges (ownership change ke liye zaroori) |
| `chown` | Change owner command |
| `www-data` | New owner (web server user) |
| `:www-data` | New group (web server group) |
| `/var/www/html/index.html` | Target file |

**Expected Output:** No output (success). File ab www-data user ka hai.

**Scenario 2: Sirf owner change karna**
```bash
sudo chown john report.pdf
```

| Command Part | Matlab |
|--------------|--------|
| `john` | New owner |
| `report.pdf` | Target file |

**Verify:** `ls -l report.pdf` â†’ `-rw-r--r-- 1 john oldgroup ...`

**Scenario 3: Sirf group change karna (chown se)**
```bash
sudo chown :developers project.txt
```

| Command Part | Matlab |
|--------------|--------|
| `:developers` | Colon se pehle kuch nahi = sirf group change |
| `project.txt` | Target file |

**Scenario 4: Sirf group change karna (chgrp se)**
```bash
sudo chgrp developers project.txt
```

| Command Part | Matlab |
|--------------|--------|
| `chgrp` | Change group command |
| `developers` | New group |
| `project.txt` | Target file |

**Scenario 5: Recursive ownership change**
```bash
sudo chown -R nginx:nginx /var/www/mysite/
```

| Command Part | Matlab |
|--------------|--------|
| `-R` | Recursive (directory + sab files) |
| `nginx:nginx` | Owner aur group dono nginx |
| `/var/www/mysite/` | Target directory |

**Expected Output:** Directory aur uski saari files nginx user ki ho jayengi.

**Scenario 6: Reference file se copy karna**
```bash
sudo chown --reference=file1.txt file2.txt
```

| Command Part | Matlab |
|--------------|--------|
| `--reference=file1.txt` | file1 ki ownership dekho |
| `file2.txt` | Wahi ownership file2 ko do |

### **8. Beginners ki Aam Galtiyan (Common Mistakes)**
- `sudo` ke bina `chown` chalane ki koshish (permission denied)
- `chown user.group` use karna instead of `user:group` (purana syntax)
- Recursive chown se pehle backup na lena
- System files ka owner change karna (system break ho sakta hai)
- `chown` aur `chmod` ko confuse karna
- Web files ko root ownership dena (web server access nahi kar payega)

### **9. Best Practices / Pro Tips**
- **CRITICAL Fix:** Web files hamesha web server user ko assign karein (www-data, nginx, apache)
- System files (`/etc`, `/bin`) ka owner kabhi change na karein
- **Stealth Tip:** Pentesting mein `find / -user username` se specific user ki files dhoondhein
- Recursive operations se pehle test environment mein try karein
- `ls -l` se verify karein ki ownership sahi change hui
- Service files ko service user assign karein (mysql files â†’ mysql user)

### **10. Asli Duniya ka Scenario (Real-World Scenario)**
Ek developer ne WordPress install kiya aur saari files root user ki ownership mein chhod di. WordPress updates install nahi ho rahe the kyunki web server (www-data) files modify nahi kar sakta tha. Admin ne `sudo chown -R www-data:www-data /var/www/wordpress/` chalaya aur problem solve ho gayi.

Pentesting scenario: Ek pentester ne dekha ki `/var/www/html/uploads` directory ka owner root hai lekin group www-data hai aur group ko write permission hai. Usne file upload vulnerability exploit ki aur successfully shell upload kar liya kyunki web server (www-data group member) write kar sakta tha.

### **11. Checklist / Chota Recap (TL;DR)**
- `chown user file` - Sirf owner change
- `chown :group file` - Sirf group change
- `chown user:group file` - Dono change
- `chgrp group file` - Sirf group change
- `chown -R user:group dir/` - Recursive
- Hamesha `sudo` ke saath use karein

### **12. Aksar Puche Jaane Wale Sawaal (FAQs)**

**Q1: `chown` aur `chgrp` mein kya fark hai?**
A: `chown` owner aur group dono change kar sakta hai. `chgrp` sirf group change karta hai. Functionality overlap hai.

**Q2: Ownership change karne ke liye root access kyun zaroori hai?**
A: Security ke liye - agar koi bhi ownership change kar sake to files chura sakte hain ya unauthorized access le sakte hain.

**Q3: Web files ka owner kaun hona chahiye?**
A: Web server user (www-data, nginx, apache) - taaki web server files read/write kar sake.

**Q4: `chown user.group` aur `chown user:group` mein kya fark hai?**
A: Dono same kaam karte hain, lekin `:` modern aur recommended syntax hai. `.` purana hai.

**Q5: Kya normal user apni files ka owner change kar sakta hai?**
A: Nahi. Sirf root user ownership change kar sakta hai. Normal user sirf permissions change kar sakta hai (chmod).

### **13. Practice ke liye Task**
1. `touch myfile.txt` - File banayein
2. `ls -l myfile.txt` - Current ownership dekhein
3. `sudo chown root myfile.txt` - Owner root karein
4. `ls -l myfile.txt` - Verify karein
5. `sudo chown $USER myfile.txt` - Wapas apne user ko assign karein
6. `ls -l myfile.txt` - Final check

**Expected Output:**
- Initial: Current user ownership
- After root: `root` as owner
- After $USER: Wapas current user

### **14. Extra / Advanced Jaankari (Optional)**
- **Numeric UID/GID:** `chown 1000:1000 file` (user ID se bhi change kar sakte hain)
- **Symbolic Links:** `chown -h` symlink khud ko change karta hai, target ko nahi
- **Preserve Root:** `chown --preserve-root` accidentally `/` change hone se rokta hai
- **From User:** `chown --from=olduser newuser file` (sirf agar olduser owner ho)
- **Verbose:** `chown -v` changes dikhata hai

### **15. Aakhri Choti Summary (5 lines)**
- `chown` ownership change karta hai (owner aur/ya group)
- `chgrp` sirf group change karta hai
- Web files ko web server user assign karein (www-data, nginx)
- Hamesha `sudo` ke saath use karein
- Recursive operations se pehle backup lein

> **Ye Zaroor Yaad Rakhein**
> 1. `chown user:group file` - Owner aur group dono change
> 2. `chown :group file` - Sirf group change
> 3. Web files: `chown www-data:www-data`
> 4. Recursive: `chown -R user:group directory/`
> 5. Ownership change ke liye root access zaroori

---

## **Module 2 Takeaway**

Is module mein humne Linux ki security ki buniyaad seekhi - users, groups, aur permissions. User management se hum control karte hain ki kaun system access kar sakta hai. File permissions decide karte hain ki kaun kya kar sakta hai. `chmod` se permissions change karte hain (symbolic ya octal), `chown`/`chgrp` se ownership change karte hain. Pentesting mein ye sab enumeration aur privilege escalation ke liye critical hain - SUID binaries, writable directories, misconfigured permissions. Admin ke liye ye proper security aur access control ki foundation hai. Yaad rakhein: least privilege principle follow karein - sirf utni hi permissions do jitni zaroori hai.

