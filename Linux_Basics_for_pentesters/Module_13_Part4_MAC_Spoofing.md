# **Module 13: Miscellaneous Services & Techniques (Part 4)** ğŸ”§âš™ï¸

---

## **Topic 4: MAC Address Spoofing with macchanger** ğŸ­ğŸ”€

---

### **1ï¸âƒ£ Topic Summary (1-2 lines)**

MAC address spoofing apne network interface ka hardware address temporarily change karna hai using macchanger tool - anonymity, bypass MAC filtering, aur network testing ke liye essential pentesting technique! ğŸ­

---

### **2ï¸âƒ£ Detailed Explanation with Analogy** ğŸ§ 

**Kya hai MAC Address?**

- **MAC** = Media Access Control Address
- **Format** = 48-bit identifier (12 hex digits)
- **Example** = `00:11:22:33:44:55`
- **Purpose** = Network interface ka unique hardware address
- **Scope** = Local network (Layer 2)

**MAC Address Structure:**
```
00:11:22:33:44:55
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”´â”€â”€ Device-specific (NIC)
â””â”€â”€â”´â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Manufacturer (OUI - Organizationally Unique Identifier)

First 6 digits = Vendor (00:11:22 = Cisco)
Last 6 digits = Device serial
```

**MAC Spoofing:**
Temporarily changing your network card's MAC address to:
- Hide identity
- Bypass MAC filtering
- Impersonate another device
- Test network security

**macchanger Tool:**
- Command-line utility
- Temporary changes (resets on reboot)
- Random or specific MAC
- Vendor preservation option

**Analogy:**
Socho MAC address ek **car license plate** hai:

- **Real MAC** = Original license plate (factory assigned)
- **Spoofed MAC** = Fake license plate (temporary cover)
- **Network** = Highway (traffic monitoring)
- **Router** = Toll booth (checks license plates)
- **MAC Filtering** = VIP lane (only allowed plates)
- **macchanger** = Plate changing tool

Jaise koi apni car ka license plate temporarily change kar sakta hai (legal issues aside), waise hi MAC address change kar sakte ho. Traffic cameras (network monitoring) ko lagega koi aur vehicle hai!

**Important:** MAC spoofing sirf local network pe kaam karta hai (Layer 2), internet pe nahi!

---

### **3ï¸âƒ£ Why is this Important?** ğŸ¯

**System Admin Perspective:**
- âœ… **Network Testing** - MAC filtering test karna
- âœ… **Troubleshooting** - MAC conflicts resolve karna
- âœ… **Device Replacement** - Old device ka MAC use karna
- âœ… **License Management** - MAC-based licenses
- âœ… **Security Testing** - MAC filtering effectiveness check
- âœ… **Privacy** - Public WiFi pe anonymity

**Pentester Perspective:**
- ğŸ” **Bypass MAC Filtering** - Whitelist bypass karna
- ğŸ” **Anonymity** - Identity hide karna
- ğŸ” **ARP Spoofing** - Man-in-the-middle attacks
- ğŸ” **Wireless Attacks** - WiFi penetration testing
- ğŸ” **Device Impersonation** - Authorized device banne ka
- ğŸ” **Evade Detection** - IDS/IPS bypass

---

### **4ï¸âƒ£ Real-World Use Cases** ğŸ’¼

**Admin Use Cases:**
1. **Device Replacement** - New NIC but MAC-based DHCP reservation
2. **License Testing** - Software licensed to specific MAC
3. **Network Troubleshooting** - MAC conflict resolution
4. **Privacy on Public WiFi** - Hide real MAC address
5. **Testing MAC Filtering** - Security policy validation
6. **Virtual Machines** - Unique MAC for each VM

**Pentester Use Cases:**
1. **Bypass MAC Whitelist** - Access restricted network
2. **WiFi Penetration** - Bypass MAC filtering on WiFi
3. **ARP Poisoning** - MITM attack preparation
4. **Rogue AP Detection** - Test wireless security
5. **Device Impersonation** - Clone authorized device
6. **Evade Tracking** - Avoid network monitoring

---

### **5ï¸âƒ£ What if NOT Done Properly?** âš ï¸

**Admin Consequences:**
- âŒ **MAC Conflicts** - Two devices same MAC = network issues
- âŒ **Permanent Changes** - Wrong tool can brick NIC
- âŒ **License Violations** - MAC-based license issues
- âŒ **Network Confusion** - DHCP/ARP table corruption
- âŒ **Lost Connectivity** - Wrong MAC = no network access

**Security Consequences:**
- ğŸš¨ **Unauthorized Access** - Attacker bypasses MAC filtering
- ğŸš¨ **Device Impersonation** - Attacker clones trusted device
- ğŸš¨ **ARP Poisoning** - MITM attacks
- ğŸš¨ **Tracking Evasion** - Malicious users hide identity
- ğŸš¨ **False Security** - MAC filtering alone is weak

---

### **6ï¸âƒ£ Syntax & Installation** ğŸ“

#### **Installation:**
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install macchanger

# CentOS/RHEL
sudo yum install macchanger

# Arch Linux
sudo pacman -S macchanger

# From source
git clone https://github.com/alobbs/macchanger.git
cd macchanger
./configure
make
sudo make install
```

#### **Basic Syntax:**
```bash
# Show current MAC
macchanger -s interface

# Random MAC (any vendor)
sudo macchanger -r interface

# Random MAC (same vendor)
sudo macchanger -e interface

# Specific MAC
sudo macchanger -m XX:XX:XX:XX:XX:XX interface

# Reset to original
sudo macchanger -p interface

# List known vendors
macchanger -l
```

---

### **7ï¸âƒ£ Detailed Examples with Tables** ğŸ’»

#### **Example 1: View Current MAC Address**

**Command:**
```bash
# Method 1: macchanger
macchanger -s eth0

# Method 2: ip command
ip link show eth0

# Method 3: ifconfig
ifconfig eth0
```

**Output (macchanger):**
```
Current MAC:   00:0c:29:3a:5b:7c (VMware, Inc.)
Permanent MAC: 00:0c:29:3a:5b:7c (VMware, Inc.)
```

| **Field** | **Value** | **Meaning** |
|----------|----------|-------------|
| Current MAC | `00:0c:29:3a:5b:7c` | Currently active MAC |
| Permanent MAC | `00:0c:29:3a:5b:7c` | Factory-assigned MAC |
| Vendor | VMware, Inc. | Manufacturer (from OUI) |

**OUI Breakdown:**
```
00:0c:29 = VMware, Inc.
3a:5b:7c = Device-specific
```

---

#### **Example 2: Random MAC Address (Any Vendor)**

**Step 1: Disable Interface**
```bash
# Must disable interface before changing MAC
sudo ip link set eth0 down
```

**Step 2: Change MAC**
```bash
sudo macchanger -r eth0
```

**Output:**
```
Current MAC:   00:0c:29:3a:5b:7c (VMware, Inc.)
Permanent MAC: 00:0c:29:3a:5b:7c (VMware, Inc.)
New MAC:       d4:3d:7e:a2:b1:c8 (Apple, Inc.)
```

| **Parameter** | **Meaning** | **Result** |
|--------------|-------------|-----------|
| `-r` | Random MAC | Completely random vendor + device |
| `eth0` | Interface | Network interface to change |

**Step 3: Enable Interface**
```bash
sudo ip link set eth0 up
```

**Step 4: Verify**
```bash
macchanger -s eth0
# Current MAC: d4:3d:7e:a2:b1:c8 (Apple, Inc.)

ip link show eth0
# link/ether d4:3d:7e:a2:b1:c8
```

---

#### **Example 3: Random MAC (Same Vendor)**

**Use Case:** Keep same vendor but change device part

**Command:**
```bash
sudo ip link set eth0 down
sudo macchanger -e eth0
sudo ip link set eth0 up
```

**Output:**
```
Current MAC:   00:0c:29:3a:5b:7c (VMware, Inc.)
Permanent MAC: 00:0c:29:3a:5b:7c (VMware, Inc.)
New MAC:       00:0c:29:f1:d2:e3 (VMware, Inc.)
```

| **Before** | **After** | **Change** |
|-----------|---------|-----------|
| `00:0c:29:3a:5b:7c` | `00:0c:29:f1:d2:e3` | Vendor same, device changed |
| VMware, Inc. | VMware, Inc. | Vendor preserved |

**Why?** Less suspicious - same manufacturer, different device

---

#### **Example 4: Specific MAC Address**

**Use Case:** Clone another device's MAC

**Scenario:** Authorized device MAC = `aa:bb:cc:dd:ee:ff`

**Command:**
```bash
sudo ip link set eth0 down
sudo macchanger -m aa:bb:cc:dd:ee:ff eth0
sudo ip link set eth0 up
```

**Output:**
```
Current MAC:   00:0c:29:3a:5b:7c (VMware, Inc.)
Permanent MAC: 00:0c:29:3a:5b:7c (VMware, Inc.)
New MAC:       aa:bb:cc:dd:ee:ff (Unknown vendor)
```

**Verification:**
```bash
macchanger -s eth0
# Current MAC: aa:bb:cc:dd:ee:ff

ip addr show eth0 | grep ether
# link/ether aa:bb:cc:dd:ee:ff
```

| **Parameter** | **Value** | **Purpose** |
|--------------|----------|-------------|
| `-m` | Specific MAC | Set exact MAC address |
| `aa:bb:cc:dd:ee:ff` | Target MAC | MAC to impersonate |

---

#### **Example 5: Reset to Original MAC**

**Command:**
```bash
sudo ip link set eth0 down
sudo macchanger -p eth0
sudo ip link set eth0 up
```

**Output:**
```
Current MAC:   aa:bb:cc:dd:ee:ff (Unknown vendor)
Permanent MAC: 00:0c:29:3a:5b:7c (VMware, Inc.)
New MAC:       00:0c:29:3a:5b:7c (VMware, Inc.)
```

| **Parameter** | **Meaning** | **Result** |
|--------------|-------------|-----------|
| `-p` | Permanent | Reset to factory MAC |

**Alternative (Reboot):**
```bash
# MAC automatically resets on reboot
sudo reboot
```

---

#### **Example 6: Automated Script**

**Script: `change_mac.sh`**
```bash
#!/bin/bash

INTERFACE="eth0"

# Check if running as root
if [ "$EUID" -ne 0 ]; then
    echo "Run as root!"
    exit 1
fi

# Show current MAC
echo "[*] Current MAC:"
macchanger -s $INTERFACE

# Disable interface
echo "[*] Disabling interface..."
ip link set $INTERFACE down

# Change MAC
echo "[*] Changing MAC..."
macchanger -r $INTERFACE

# Enable interface
echo "[*] Enabling interface..."
ip link set $INTERFACE up

# Show new MAC
echo "[*] New MAC:"
macchanger -s $INTERFACE

# Restart networking (optional)
echo "[*] Restarting NetworkManager..."
systemctl restart NetworkManager

echo "[+] Done!"
```

**Usage:**
```bash
chmod +x change_mac.sh
sudo ./change_mac.sh
```

**Output:**
```
[*] Current MAC:
Current MAC:   00:0c:29:3a:5b:7c (VMware, Inc.)
[*] Disabling interface...
[*] Changing MAC...
New MAC:       52:a1:b3:c4:d5:e6 (Unknown vendor)
[*] Enabling interface...
[*] New MAC:
Current MAC:   52:a1:b3:c4:d5:e6 (Unknown vendor)
[*] Restarting NetworkManager...
[+] Done!
```

---

### **8ï¸âƒ£ Common Mistakes & How to Avoid** âŒâ¡ï¸âœ…

| **Mistake** | **Problem** | **Solution** |
|------------|-------------|--------------|
| Forgot to disable interface | MAC change fails | `ip link set eth0 down` first |
| Didn't enable after change | No network connectivity | `ip link set eth0 up` after |
| Used invalid MAC format | Command fails | Use `XX:XX:XX:XX:XX:XX` format |
| Changed wrong interface | Lost network access | Check interface name: `ip link` |
| Permanent MAC conflict | Two devices same MAC | Use random MAC, not duplicate |
| Forgot to restart NetworkManager | DHCP not working | `systemctl restart NetworkManager` |
| Used on WiFi without disabling | Connection drops | Disable WiFi first |
| Didn't check if worked | Assuming it changed | Verify with `macchanger -s` |

---

### **9ï¸âƒ£ Best Practices & Pro Tips** â­

**Safe MAC Changing:**
```bash
# 1. Check interface name
ip link show

# 2. Disable interface
sudo ip link set eth0 down

# 3. Change MAC
sudo macchanger -r eth0

# 4. Enable interface
sudo ip link set eth0 up

# 5. Restart networking
sudo systemctl restart NetworkManager

# 6. Verify
macchanger -s eth0
ip addr show eth0
```

**Persistent MAC Change (Survives Reboot):**

**Method 1: NetworkManager**
```bash
sudo nano /etc/NetworkManager/conf.d/mac-randomization.conf
```

```ini
[device]
wifi.scan-rand-mac-address=yes

[connection]
wifi.cloned-mac-address=random
ethernet.cloned-mac-address=random
```

```bash
sudo systemctl restart NetworkManager
```

**Method 2: systemd-networkd**
```bash
sudo nano /etc/systemd/network/00-default.link
```

```ini
[Match]
MACAddress=00:0c:29:3a:5b:7c

[Link]
MACAddress=aa:bb:cc:dd:ee:ff
```

**Method 3: Startup Script**
```bash
sudo nano /etc/rc.local
```

```bash
#!/bin/bash
ip link set eth0 down
macchanger -r eth0
ip link set eth0 up
exit 0
```

```bash
sudo chmod +x /etc/rc.local
```

**Pro Tips:**
- ğŸ’¡ **Test first** in VM before production
- ğŸ’¡ **Document original MAC** before changing
- ğŸ’¡ **Use `-e` option** for same vendor (less suspicious)
- ğŸ’¡ **Avoid multicast bit** (2nd bit of 1st byte)
- ğŸ’¡ **Check local bit** (1st bit of 1st byte = 0 for unicast)
- ğŸ’¡ **Restart DHCP** after MAC change
- ğŸ’¡ **WiFi needs more care** - disconnect first

---

### **ğŸ”Ÿ Real-World Scenario** ğŸŒ

#### **Scenario 1: Pentester - Bypass MAC Filtering**

**Target:** Corporate WiFi with MAC whitelist
**Goal:** Gain unauthorized access

**Reconnaissance:**
```bash
# 1. Scan for connected devices
sudo airodump-ng wlan0

# Output shows authorized devices:
# BSSID: AA:BB:CC:DD:EE:FF (Router)
# Station: 11:22:33:44:55:66 (Authorized laptop)

# 2. Note authorized MAC
AUTHORIZED_MAC="11:22:33:44:55:66"
```

**Attack:**
```bash
# 3. Disable WiFi
sudo ip link set wlan0 down

# 4. Spoof to authorized MAC
sudo macchanger -m 11:22:33:44:55:66 wlan0

# Output:
# Current MAC:   00:11:22:33:44:55 (Intel)
# New MAC:       11:22:33:44:55:66 (Dell Inc.)

# 5. Enable WiFi
sudo ip link set wlan0 up

# 6. Connect to network
sudo nmcli dev wifi connect "CorporateWiFi" password "password123"

# 7. Connected! âœ“
ping 8.8.8.8
# PING 8.8.8.8: 64 bytes from 8.8.8.8: icmp_seq=1 ttl=57 time=15.2 ms
```

**Result:** Bypassed MAC filtering! ğŸ¯

**Note:** This is for authorized penetration testing only!

---

#### **Scenario 2: Admin - Replace Network Card**

**Problem:**
```
Server NIC failed
DHCP reservation based on MAC: 00:11:22:33:44:55
New NIC has different MAC: aa:bb:cc:dd:ee:ff
Need same IP without changing DHCP config
```

**Solution:**
```bash
# 1. Check new MAC
ip link show eth0
# link/ether aa:bb:cc:dd:ee:ff

# 2. Change to old MAC
sudo ip link set eth0 down
sudo macchanger -m 00:11:22:33:44:55 eth0
sudo ip link set eth0 up

# 3. Restart networking
sudo systemctl restart networking

# 4. Verify IP
ip addr show eth0
# inet 192.168.1.100/24 (Same IP as before!)

# 5. Make persistent
sudo nano /etc/network/interfaces
```

```
auto eth0
iface eth0 inet dhcp
    hwaddress ether 00:11:22:33:44:55
```

**Result:** Server has same IP without DHCP reconfiguration! âœ…

---

#### **Scenario 3: Pentester - WiFi Deauth + MAC Cloning**

**Advanced Attack:**
```bash
# 1. Monitor network
sudo airodump-ng wlan0mon

# Target AP: AA:BB:CC:DD:EE:FF
# Client: 11:22:33:44:55:66

# 2. Deauthenticate client
sudo aireplay-ng --deauth 10 -a AA:BB:CC:DD:EE:FF -c 11:22:33:44:55:66 wlan0mon

# Client disconnected!

# 3. Quickly change MAC to client's MAC
sudo ip link set wlan0 down
sudo macchanger -m 11:22:33:44:55:66 wlan0
sudo ip link set wlan0 up

# 4. Connect before client reconnects
sudo nmcli dev wifi connect "TargetWiFi" password "captured_password"

# 5. Now you're the "authorized" device!
```

**Result:** Impersonated authorized device! ğŸ­

---

#### **Scenario 4: Privacy - Public WiFi**

**Use Case:** Coffee shop WiFi tracking prevention

**Problem:**
```
Coffee shop tracks customers by MAC address
Builds profile: visit frequency, duration, websites
Privacy concern!
```

**Solution:**
```bash
# Before connecting to public WiFi:

# 1. Change MAC
sudo ip link set wlan0 down
sudo macchanger -r wlan0
sudo ip link set wlan0 up

# 2. Connect to WiFi
# 3. Use VPN for additional privacy

# Each visit = different MAC = no tracking!
```

**Automated (NetworkManager):**
```bash
sudo nano /etc/NetworkManager/conf.d/wifi-random-mac.conf
```

```ini
[device-mac-randomization]
wifi.scan-rand-mac-address=yes

[connection-mac-randomization]
wifi.cloned-mac-address=random
```

```bash
sudo systemctl restart NetworkManager
```

**Result:** Anonymous on public WiFi! ğŸ•µï¸

---

### **1ï¸âƒ£1ï¸âƒ£ Troubleshooting Checklist** âœ…

**MAC Change Not Working:**
```bash
# Check if interface is down
ip link show eth0
# Should show: state DOWN

# Try manual method
sudo ip link set eth0 address aa:bb:cc:dd:ee:ff

# Check driver support
ethtool -i eth0
# Some drivers don't support MAC change

# Check for hardware restrictions
dmesg | grep -i mac
```

**Lost Network Connectivity:**
```bash
# Reset to original MAC
sudo ip link set eth0 down
sudo macchanger -p eth0
sudo ip link set eth0 up

# Restart NetworkManager
sudo systemctl restart NetworkManager

# Release and renew DHCP
sudo dhclient -r eth0
sudo dhclient eth0
```

**MAC Reverts on Reboot:**
```bash
# Make persistent (choose one method):

# Method 1: NetworkManager
sudo nano /etc/NetworkManager/conf.d/mac.conf
[connection]
ethernet.cloned-mac-address=aa:bb:cc:dd:ee:ff

# Method 2: systemd service
sudo nano /etc/systemd/system/macchange.service
```

```ini
[Unit]
Description=Change MAC address
Wants=network-pre.target
Before=network-pre.target

[Service]
Type=oneshot
ExecStart=/usr/bin/ip link set eth0 down
ExecStart=/usr/bin/macchanger -m aa:bb:cc:dd:ee:ff eth0
ExecStart=/usr/bin/ip link set eth0 up

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable macchange.service
```

**WiFi Not Connecting After MAC Change:**
```bash
# Disconnect first
sudo nmcli dev disconnect wlan0

# Change MAC
sudo ip link set wlan0 down
sudo macchanger -r wlan0
sudo ip link set wlan0 up

# Restart NetworkManager
sudo systemctl restart NetworkManager

# Reconnect
sudo nmcli dev wifi connect "SSID" password "password"
```

---

### **1ï¸âƒ£2ï¸âƒ£ FAQs** â“

**Q1: Kya MAC spoofing illegal hai?**
```
Depends on context:

Legal:
- Your own devices
- Authorized penetration testing
- Privacy on public WiFi
- Network troubleshooting
- Testing/research

Illegal:
- Unauthorized network access
- Bypassing paid services
- Identity theft
- Fraud

Always get written permission for pentesting!
```

**Q2: Kya MAC change permanent hai?**
```
NO! macchanger changes are temporary

Resets on:
- System reboot
- Interface restart
- NetworkManager restart

For persistent: Use NetworkManager config or systemd service
```

**Q3: Kya WiFi aur Ethernet dono pe kaam karta hai?**
```
YES! Works on both:

Ethernet (eth0, enp0s3):
- Usually straightforward
- Most drivers support

WiFi (wlan0, wlp2s0):
- Needs interface down first
- Disconnect from network
- Some drivers have issues

Check: ethtool -i interface_name
```

**Q4: Kya router MAC spoofing detect kar sakta hai?**
```
Difficult but possible:

Detection methods:
- TTL analysis (OS fingerprinting)
- Traffic pattern analysis
- Timing analysis
- OUI vendor mismatch

Prevention:
- Use same vendor MAC (-e option)
- Match OS behavior
- Avoid suspicious patterns
```

**Q5: Multicast aur unicast MAC kya hai?**
```
MAC address 1st byte, 1st bit:

Unicast (0):
- 00:XX:XX:XX:XX:XX (even 1st digit)
- Normal device MAC
- Use this for spoofing

Multicast (1):
- 01:XX:XX:XX:XX:XX (odd 1st digit)
- Group addressing
- Don't use for spoofing

Example:
00:11:22:33:44:55 = Unicast âœ“
01:11:22:33:44:55 = Multicast âœ—
```

---

### **1ï¸âƒ£3ï¸âƒ£ Practice Tasks** ğŸ¯

**Beginner:**
1. âœ… Install macchanger
2. âœ… View current MAC address
3. âœ… Change to random MAC
4. âœ… Reset to original MAC
5. âœ… Verify changes with multiple commands

**Intermediate:**
1. âœ… Change MAC keeping same vendor
2. âœ… Set specific MAC address
3. âœ… Create MAC change script
4. âœ… Make MAC change persistent
5. âœ… Test on both Ethernet and WiFi

**Advanced:**
1. âœ… Setup automatic random MAC on boot
2. âœ… Configure NetworkManager for random MAC
3. âœ… Create systemd service for MAC change
4. âœ… Implement MAC rotation script (changes every hour)
5. âœ… Test MAC filtering bypass in lab

**Pentester:**
1. ğŸ” Enumerate authorized MACs on network
2. ğŸ” Clone authorized device MAC
3. ğŸ” Bypass MAC whitelist on WiFi
4. ğŸ” Test ARP spoofing with spoofed MAC
5. ğŸ” Combine with deauth attack

---

### **1ï¸âƒ£4ï¸âƒ£ Advanced Information** ğŸš€

#### **MAC Address Bit Structure:**
```
Bit 0 (LSB of 1st byte):
  0 = Unicast (individual device)
  1 = Multicast (group)

Bit 1 (2nd bit of 1st byte):
  0 = Globally unique (OUI assigned)
  1 = Locally administered (custom)

Example:
00:11:22:33:44:55
â”‚â””â”€ Bit 0 = 0 (Unicast)
â””â”€â”€ Bit 1 = 0 (Global)

02:11:22:33:44:55
â”‚â””â”€ Bit 0 = 0 (Unicast)
â””â”€â”€ Bit 1 = 1 (Local) - Good for spoofing!
```

#### **OUI Database:**
```bash
# List all vendors
macchanger -l | less

# Search specific vendor
macchanger -l | grep -i "apple"
# 0004:0c = Apple, Inc.
# 0004:0d = Apple, Inc.

# Use specific vendor
sudo macchanger -m 00:04:0c:XX:XX:XX eth0
```

#### **Advanced Spoofing Script:**
```bash
#!/bin/bash
# smart_mac_change.sh

INTERFACE="$1"
MODE="$2"

if [ -z "$INTERFACE" ] || [ -z "$MODE" ]; then
    echo "Usage: $0 <interface> <random|vendor|specific|reset>"
    exit 1
fi

case $MODE in
    random)
        echo "[*] Setting random MAC..."
        ip link set $INTERFACE down
        macchanger -r $INTERFACE
        ip link set $INTERFACE up
        ;;
    vendor)
        echo "[*] Setting random MAC (same vendor)..."
        ip link set $INTERFACE down
        macchanger -e $INTERFACE
        ip link set $INTERFACE up
        ;;
    specific)
        read -p "Enter MAC address: " MAC
        ip link set $INTERFACE down
        macchanger -m $MAC $INTERFACE
        ip link set $INTERFACE up
        ;;
    reset)
        echo "[*] Resetting to permanent MAC..."
        ip link set $INTERFACE down
        macchanger -p $INTERFACE
        ip link set $INTERFACE up
        ;;
    *)
        echo "Invalid mode!"
        exit 1
        ;;
esac

systemctl restart NetworkManager
echo "[+] Done!"
macchanger -s $INTERFACE
```

#### **MAC Rotation (Hourly):**
```bash
# Cron job for hourly MAC change
sudo crontab -e

# Add:
0 * * * * /usr/local/bin/rotate_mac.sh
```

**rotate_mac.sh:**
```bash
#!/bin/bash
INTERFACE="wlan0"
ip link set $INTERFACE down
macchanger -r $INTERFACE
ip link set $INTERFACE up
systemctl restart NetworkManager
```

---

### **1ï¸âƒ£5ï¸âƒ£ Final Summary** ğŸ“‹

**MAC Spoofing = Changing Network Interface Hardware Address**

**Key Commands:**
```bash
# View MAC
macchanger -s eth0

# Random MAC
sudo macchanger -r eth0

# Same vendor
sudo macchanger -e eth0

# Specific MAC
sudo macchanger -m XX:XX:XX:XX:XX:XX eth0

# Reset
sudo macchanger -p eth0
```

**Workflow:**
```bash
1. ip link set eth0 down
2. macchanger -r eth0
3. ip link set eth0 up
4. systemctl restart NetworkManager
```

**Use Cases:**
- ğŸ­ **Anonymity** - Hide identity on public WiFi
- ğŸ­ **Bypass Filtering** - Access MAC-restricted networks
- ğŸ­ **Device Replacement** - Keep same MAC on new hardware
- ğŸ­ **Testing** - Security testing and troubleshooting
- ğŸ­ **Privacy** - Prevent tracking

**Security Implications:**
- ğŸ”’ **Admin:** MAC filtering alone is weak security
- ğŸ”’ **Pentester:** Easy to bypass MAC-based access control
- ğŸ”’ **Defense:** Use 802.1X authentication, not just MAC filtering

**Remember:** MAC spoofing is Layer 2 only - doesn't affect IP address or internet routing! ğŸ­

---

**Module 13 Complete! ğŸ‰**

**Topics Covered:**
1. âœ… SAMBA Server Setup
2. âœ… Linux Root Password Reset
3. âœ… SSL/TLS Certificate Management
4. âœ… MAC Address Spoofing

---

**ğŸŠ COURSE COMPLETE! ğŸŠ**

**All 13 Modules Finished:**
1. âœ… Linux Boot Process & File System
2. âœ… User, Group & Permissions
3. âœ… Essential Linux Toolbox
4. âœ… Service Management
5. âœ… Reconnaissance & Enumeration
6. âœ… Privilege Escalation
7. âœ… Post-Exploitation
8. âœ… Persistence & Data Exfiltration
9. âœ… Security Hardening
10. âœ… Backup & Restore
11. âœ… Logging & Auditing
12. âœ… Monitoring & Alerting
13. âœ… Miscellaneous Services

**Congratulations! You're now a Linux Pentesting & Admin Pro! ğŸš€ğŸ”¥**

---

**Happy Hacking & Administering! ğŸ­âœ¨**
