**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸŒ Module 1: Networking Fundamentals (Foundation)

---

## ğŸ“š Topic 1.1: TCP/IP vs OSI Model

### 1. ğŸ¯ Topic/Flag:
**TCP/IP Model vs OSI Model**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Yeh do reference models hain jo batate hain ki network communication kaise hoti hai - TCP/IP ek practical 4-layer model hai aur OSI ek theoretical 7-layer model hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Ek pentester ko yeh samajhna zaroori hai ki data network mein kis layer par travel karta hai, taaki woh yeh jaan sake ki attack kis layer par karna hai (jaise Layer 3 par IP spoofing ya Layer 7 par application attacks).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
Jab aap Nmap scan karte ho, toh aapko pata hona chahiye ki aapka packet kis layer tak ja raha hai - Transport layer (ports), Network layer (IP routing), ya Application layer (service detection). Isse aap firewall rules aur network architecture ko samajh sakte ho.

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**TCP/IP Model (4 Layers - Bottom se Top):**
- 1) Network Layer
- 2) Internet Layer
- 3) Transport Layer
- 4) Application Layer

**OSI Model (7 Layers - Bottom se Top):**
- 1) Physical (Please)
- 2) Data Link (Do)
- 3) Network (Not)
- 4) Transport (Throw)
- 5) Session (Sausage)
- 6) Presentation (Pizza)
- 7) Application (Away)

**Mapping:**
- TCP/IP ka Application Layer = OSI ke Application + Presentation + Session
- TCP/IP ka Transport Layer = OSI ka Transport Layer
- TCP/IP ka Internet Layer = OSI ka Network Layer
- TCP/IP ka Network Layer = OSI ke Data Link + Physical

### 6. ğŸ‘ Pros (Fayde)
- TCP/IP real-world mein use hota hai (Internet isi par chalta hai)
- OSI troubleshooting aur teaching ke liye perfect hai
- Dono models network communication ko samajhne mein madad karte hain

### 7. ğŸ‘ Cons (Nuksaan)
- OSI sirf theoretical hai, practical implementation TCP/IP hai
- Beginners ke liye dono models confusing ho sakte hain
- Real attacks mein sirf layer numbers yaad rakhna kaam nahi aata, practical understanding zaroori hai

### 8. âŒ¨ï¸ Syntax (Command)
```
N/A (Yeh theoretical concept hai, koi command nahi)
```

### 9. ğŸ’» Practice Command
```bash
# Nmap scan karte waqt verbosity badhao taaki aap dekh sako ki kis layer par kya ho raha hai
nmap -sS -v scanme.nmap.org

# Wireshark mein packets capture karke dekho ki har layer par data kaise change hota hai
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab bhi aap kisi attack ya scan ki planning karo, pehle socho ki woh attack OSI model ki kis layer par hoga. Layer 2 (ARP Spoofing), Layer 3 (IP Spoofing), Layer 4 (Port Scanning), ya Layer 7 (SQL Injection). Isse aapko defense mechanisms (firewalls, IDS) ko bypass karne mein madad milegi.

**Common Mistake:** Beginners sirf port numbers (Layer 4) par focus karte hain aur bhool jaate hain ki network layer (Layer 3) par IP filtering ho sakti hai ya data link layer (Layer 2) par MAC filtering.

---

## ğŸ“š Topic 1.2: OSI Model ki 7 Layers

### 1. ğŸ¯ Topic/Flag:
**OSI Model - 7 Layers Deep Dive**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
OSI (Open System Interconnection) ek 7-layer reference model hai jo dikhata hai ki data ek computer se dusre computer tak kaise travel karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Har layer par alag-alag attacks possible hain. Ek expert pentester ko pata hona chahiye ki Layer 2 par ARP Poisoning, Layer 3 par IP Spoofing, Layer 4 par SYN Flood, aur Layer 7 par XSS/SQLi attacks kaise karte hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
Jab aap reconnaissance kar rahe ho, toh aapko har layer ki information chahiye:
- Physical: Kya network wired hai ya wireless?
- Data Link: MAC addresses kya hain?
- Network: IP ranges kya hain?
- Transport: Kaun se ports khule hain?
- Application: Kaun si services chal rahi hain?

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Real-Life Example (Facebook par message bhejne ka process):**

**Layer 7 - Application:** Aap Facebook app kholte ho aur message type karte ho.

**Layer 6 - Presentation:** App data ko encrypt karta hai (HTTPS) aur proper format mein convert karta hai.

**Layer 5 - Session:** Aap login karte ho aur ek valid session create hota hai (cookies/tokens).

**Layer 4 - Transport:** Browser `www.facebook.com` ko TCP connection (port 443) ke zariye connect karta hai.

**Layer 3 - Network:** Aapka router IP address use karke sabse paas ke Facebook server tak packet route karta hai.

**Layer 2 - Data Link:** NIC (Network Interface Card) aur MAC address use karke local network par data bhejta hai.

**Layer 1 - Physical:** Aapka computer/phone physically on hai aur wifi/ethernet cable se connected hai.

### 6. ğŸ‘ Pros (Fayde)
- Har layer ko alag se troubleshoot kar sakte ho
- Network problems ko systematically solve kar sakte ho
- Attacks ko categorize karna aasan ho jata hai

### 7. ğŸ‘ Cons (Nuksaan)
- Sirf theoretical model hai, real implementation TCP/IP hai
- Sabhi 7 layers ko yaad rakhna mushkil ho sakta hai
- Over-complication ho sakti hai simple problems ke liye

### 8. âŒ¨ï¸ Syntax (Command)
```
N/A (Theoretical concept)
```

### 9. ğŸ’» Practice Command
```bash
# Wireshark mein packet capture karke har layer ko analyze karo
# Nmap scan karte waqt --packet-trace use karo to see layer-by-layer breakdown
nmap --packet-trace -p 80 scanme.nmap.org

# Traceroute se Layer 3 (Network) routing path dekho
traceroute google.com
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Yaad rakhne ka tarika - **"Please Do Not Throw Sausage Pizza Away"** (Physical, Data Link, Network, Transport, Session, Presentation, Application). Jab bhi network issue ho, bottom se top tak check karo - pehle cable check karo (Physical), phir MAC (Data Link), phir IP (Network), aur aise hi upar jao.

**Common Mistake:** Beginners seedha Application layer (Layer 7) par attack karne ki sochte hain (jaise SQL Injection) aur bhool jaate hain ki agar Layer 3 par firewall hai toh unka traffic hi block ho jayega. Hamesha bottom layers pehle check karo.

---

## ğŸ“š Topic 1.3: OSI Data Flow (Segments, Packets, Frames)

### 1. ğŸ¯ Topic/Flag:
**Data Encapsulation - Har Layer Par Data Ka Naam**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Jab data OSI model ki layers se travel karta hai, toh har layer par uska naam aur format change hota hai - yeh process "encapsulation" kehlata hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aap Wireshark mein packets analyze karte ho ya Nmap ke raw packets dekhte ho, toh aapko pata hona chahiye ki "Frame", "Packet", aur "Segment" mein kya farak hai. Isse aap samajh sakte ho ki firewall kis layer par filtering kar raha hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
Jab aap packet crafting tools (jaise Scapy ya Nping) use karte ho, toh aapko manually "segments" (TCP header), "packets" (IP header), aur "frames" (Ethernet header) banana padta hai. Agar aapko data flow samajh nahi hai, toh aap custom packets nahi bana paoge.

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Data Flow (Top to Bottom - Sending):**

- **Layer 7-6-5 (Application/Presentation/Session):** DATA
- **Layer 4 (Transport):** SEGMENTS (TCP/UDP header add hota hai)
- **Layer 3 (Network):** PACKETS (IP header add hota hai)
- **Layer 2 (Data Link):** FRAMES (MAC header add hota hai)
- **Layer 1 (Physical):** BITS (electrical signals mein convert hota hai)

**Receiving Side (Bottom to Top):**
Bits â†’ Frames â†’ Packets â†’ Segments â†’ Data (har layer apna header remove karti hai)

### 6. ğŸ‘ Pros (Fayde)
- Har layer apna kaam independently kar sakti hai
- Troubleshooting aasan ho jata hai (jaise "problem Layer 2 par hai ya Layer 3 par?")
- Security har layer par implement ho sakti hai

### 7. ğŸ‘ Cons (Nuksaan)
- Har layer header add karta hai, jisse packet size badh jata hai (overhead)
- Processing time zyada lagta hai
- Complexity badh jati hai

### 8. âŒ¨ï¸ Syntax (Command)
```
N/A (Concept hai)
```

### 9. ğŸ’» Practice Command
```bash
# Wireshark mein packet capture karo aur dekho:
# - Ethernet Frame (Layer 2)
# - IP Packet (Layer 3)
# - TCP Segment (Layer 4)
# - HTTP Data (Layer 7)

# Nmap se raw packet capture karo
nmap --packet-trace -sS -p 80 scanme.nmap.org

# Tcpdump se specific layer ka data dekho
tcpdump -i eth0 -nn -X port 80
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab bhi aap firewall bypass karne ki koshish karo, socho ki firewall kis layer par kaam kar raha hai. Agar woh Layer 3 (IP) par filter kar raha hai, toh aapko IP spoofing karni padegi. Agar Layer 4 (Port) par hai, toh source port manipulation (`--source-port`) kaam aayega. Agar Layer 7 (Application) par hai, toh aapko payload obfuscation karni padegi.

**Common Mistake:** Beginners "packet" aur "frame" ko same samajhte hain. Yaad rakho: Frame = Layer 2 (MAC addresses), Packet = Layer 3 (IP addresses), Segment = Layer 4 (Port numbers).

---

## ğŸ“š Topic 1.4: TCP vs UDP (Connection-oriented vs Connection-less)

### 1. ğŸ¯ Topic/Flag:
**TCP vs UDP - Reliable vs Fast**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
TCP (Transmission Control Protocol) aur UDP (User Datagram Protocol) do transport layer protocols hain - TCP reliable hai lekin slow, UDP fast hai lekin unreliable.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Nmap mein alag-alag scan types TCP aur UDP ke liye hain (`-sS` for TCP, `-sU` for UDP). Agar aapko dono protocols ka farak nahi pata, toh aap UDP services (jaise DNS, DHCP, SNMP) ko miss kar doge jo exploitation ke liye critical ho sakti hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **TCP Scanning:** Web servers (80, 443), SSH (22), FTP (21) - yeh sab TCP ports hain
- **UDP Scanning:** DNS (53), DHCP (67), SNMP (161), TFTP (69) - yeh sab UDP ports hain
- UDP scan karna TCP se zyada mushkil hai kyunki UDP mein acknowledgement nahi hota

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**TCP (Connection-Oriented):**
- Client â†’ SYN â†’ Server
- Server â†’ SYN-ACK â†’ Client
- Client â†’ ACK â†’ Server
- (Connection established, data transfer, connection close)
- **Acknowledgement hota hai** (reliable)
- **Slower** hai

**UDP (Connection-Less):**
- Client â†’ Request â†’ Server
- Server â†’ Response â†’ Client
- **Koi acknowledgement nahi** (unreliable)
- **Faster** hai

### 6. ğŸ‘ Pros (Fayde)
**TCP:**
- Reliable hai (data loss nahi hota)
- Order maintain hota hai (packets sequence mein aate hain)
- Error checking hoti hai

**UDP:**
- Fast hai (no overhead of handshake)
- Real-time applications ke liye perfect (video streaming, gaming, VoIP)
- Broadcast/Multicast support karta hai

### 7. ğŸ‘ Cons (Nuksaan)
**TCP:**
- Slow hai (3-way handshake ki wajah se)
- Overhead zyada hai (acknowledgements, sequence numbers)
- DDoS attacks ke liye vulnerable (SYN Flood)

**UDP:**
- Unreliable hai (packets loss ho sakte hain)
- No error checking
- No congestion control

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# TCP Scan (default)
nmap -sS <target>

# UDP Scan
nmap -sU <target>

# Dono saath mein
nmap -sS -sU <target>
```

### 9. ğŸ’» Practice Command
```bash
# TCP ports scan karo (fast)
nmap -sS -p 22,80,443 scanme.nmap.org -v

# UDP ports scan karo (slow, patience chahiye)
nmap -sU -p 53,67,161 scanme.nmap.org -v

# Top 100 TCP aur UDP ports scan karo
nmap -sS -sU --top-ports 100 192.168.1.1 -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** UDP scanning bahut slow hoti hai kyunki UDP mein response nahi milta agar port open hai. Isliye hamesha UDP scan ke saath `--max-retries 1` aur `-T4` use karo taaki time bach sake. Aur sirf important UDP ports (53, 161, 69) ko target karo, saare 65535 ports mat scan karo.

**Common Mistake:** Beginners sirf TCP scan karte hain aur UDP ko ignore kar dete hain. Lekin real pentesting mein UDP services (jaise SNMP port 161) bahut critical information leak kar sakti hain (community strings, device configs). Hamesha dono scan karo.

---

## ğŸ“š Topic 1.5: TCP 3-Way Handshake (SYN, SYN-ACK, ACK)

### 1. ğŸ¯ Topic/Flag:
**TCP 3-Way Handshake - Connection Kaise Banta Hai**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
TCP 3-Way Handshake ek process hai jisme client aur server ek dusre se "hello" bolte hain aur connection establish karte hain - isme 3 steps hote hain: SYN, SYN-ACK, ACK.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Nmap ke sabse important scans (jaise `-sS` SYN scan aur `-sT` TCP Connect scan) is handshake par based hain. Agar aapko yeh nahi pata ki handshake kaise hota hai, toh aap samajh nahi paoge ki Nmap kaise ports ko "open", "closed", ya "filtered" detect karta hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **SYN Scan (`-sS`):** Sirf SYN bhejta hai, SYN-ACK milne par port "open" maan leta hai, ACK nahi bhejta (stealth)
- **TCP Connect Scan (`-sT`):** Poora 3-way handshake complete karta hai (noisy lekin reliable)
- **SYN Flood Attack:** Attacker sirf SYN bhejta hai, ACK nahi bhejta, jisse server ke resources exhaust ho jaate hain (DoS)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Step 1 - SYN (Synchronization):**
- Client server ko SYN packet bhejta hai
- Matlab: "Main tumse baat karna chahta hoon, kya tum ready ho?"

**Step 2 - SYN-ACK (Synchronization-Acknowledgement):**
- Server client ko SYN-ACK packet bhejta hai
- Matlab: "Haan, main ready hoon. Tum bhi ready ho?"

**Step 3 - ACK (Acknowledgement):**
- Client server ko ACK packet bhejta hai
- Matlab: "Haan, main bhi ready hoon. Chalo baat karte hain."

**Connection Established!** Ab data transfer ho sakta hai.

### 6. ğŸ‘ Pros (Fayde)
- Reliable connection establish hota hai
- Dono sides confirm karte hain ki woh ready hain
- Error handling aur flow control possible hai

### 7. ğŸ‘ Cons (Nuksaan)
- Time lagta hai (3 packets exchange hote hain)
- SYN Flood attacks ke liye vulnerable
- Overhead zyada hai UDP ke comparison mein

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# SYN Scan (half-open, sirf SYN bhejta hai)
nmap -sS <target>

# TCP Connect Scan (poora handshake)
nmap -sT <target>
```

### 9. ğŸ’» Practice Command
```bash
# SYN scan karo aur Wireshark mein packets dekho
nmap -sS -p 80 scanme.nmap.org --packet-trace

# TCP Connect scan karo (poora handshake)
nmap -sT -p 22,80,443 scanme.nmap.org -v

# Tcpdump se handshake capture karo
tcpdump -i eth0 'tcp[tcpflags] & (tcp-syn|tcp-ack) != 0' -nn
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab aap Wireshark mein packets analyze karo, toh TCP flags ko dhyaan se dekho:
- **SYN flag set** = Connection request
- **SYN+ACK flags set** = Connection accepted
- **ACK flag set** = Connection established
- **RST flag set** = Connection rejected (port closed)
- **FIN flag set** = Connection close ho raha hai

Agar aapko yeh flags samajh aa gaye, toh aap Nmap ke saare scan types (SYN, FIN, XMAS, NULL) ko easily samajh jaoge.

**Common Mistake:** Beginners sochte hain ki SYN scan (`-sS`) aur TCP Connect scan (`-sT`) same hain. Lekin farak yeh hai ki SYN scan sirf 2 steps karta hai (SYN, SYN-ACK) aur ACK nahi bhejta, isliye woh "half-open" aur "stealthy" hai. TCP Connect scan poora handshake karta hai, isliye woh logs mein pakda jaata hai.

---

**ğŸ“ Module 1 Complete!**

Aapne networking fundamentals seekh liye - ab aap samajh gaye ki:
- TCP/IP aur OSI models kya hain aur pentesting mein kyun zaroori hain
- Data har layer par kaise travel karta hai (Bits, Frames, Packets, Segments)
- TCP aur UDP mein kya farak hai aur Nmap mein dono ko kaise scan karte hain
- TCP 3-Way Handshake kaise kaam karta hai aur Nmap ke scans isme kaise involved hain

**Next Module:** Module 2 - Network & IP Concepts (Legal Considerations, Network Types, IP/MAC Addresses)

Jab aap ready ho, mujhe bolo aur main Module 2 bana dunga! ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸŒ Module 2: Network & IP Concepts

---

## ğŸ“š Topic 2.1: Legal Considerations (Scanning kab legal/illegal hai)

### 1. ğŸ¯ Topic/Flag:
**Port Scanning - Legal ya Illegal?**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Yeh ethical aur legal guidelines hain jo batati hain ki aap kab aur kahan Nmap scanning kar sakte ho bina legal trouble mein pade.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Ek professional pentester ko hamesha legal boundaries pata honi chahiye. Bina permission ke scanning karna Computer Fraud and Abuse Act (USA) ya IT Act 2000 (India) ke under crime hai. Jail bhi ho sakti hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Hamesha client se **written permission** (signed contract) lo
- Sirf authorized IP ranges ko scan karo
- Scanning se pehle **Rules of Engagement (RoE)** document taiyaar karo
- Apne scans ko log karo (proof ke liye ki aapne kya kiya)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**âœ… Legal Scanning (Jab aap scan kar sakte ho):**
- Aap us network/system ke **owner** ho
- Aapke paas **explicit written permission** hai
- Aap authorized penetration testing kar rahe ho (contract ke saath)
- Aap apne khud ke lab environment mein practice kar rahe ho

**âŒ Illegal Scanning (Jab aap scan NAHI kar sakte):**
- Aapke paas permission **nahi** hai
- Aap kisi aur ke network ko bina ijaazat scan kar rahe ho
- Aapki scanning se service **down** ho rahi hai (DoS)
- Aap scanning ke baad unauthorized access le rahe ho

### 6. ğŸ‘ Pros (Fayde)
- Legal scanning se aapko protection milti hai
- Client trust badhta hai
- Professional reputation banti hai
- Court mein aapke paas proof hota hai

### 7. ğŸ‘ Cons (Nuksaan)
- Permission lene mein time lagta hai
- Kuch clients hesitate karte hain permission dene mein
- Legal paperwork boring ho sakta hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Legal practice targets (publicly allowed)
nmap scanme.nmap.org
nmap -sS testphp.vulnweb.com

# Apne khud ke local network ko scan karo
nmap 192.168.1.0/24

# NEVER do this without permission
# nmap <random-company-ip>  âŒ ILLEGAL
```

### 9. ğŸ’» Practice Command
```bash
# Safe practice targets jo publicly scanning allow karte hain
nmap -sS -p 80,443 scanme.nmap.org -v
nmap -A testphp.vulnweb.com

# Apne khud ke VM lab setup karo
# Metasploitable, DVWA, HackTheBox labs
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha ek **"Get Out of Jail Free Card"** rakho - matlab ek signed document jisme client ne aapko permission di ho. Isme yeh mention ho: "I authorize [Your Name] to perform security testing on [IP ranges] from [Start Date] to [End Date]." Yeh document PDF mein save karke apne paas rakho.

**Common Mistake:** Beginners sochte hain "Main toh sirf port scan kar raha hoon, koi hack nahi kar raha, toh legal hai." GALAT! Bina permission ke port scanning bhi illegal hai. Hamesha permission lo, chahe aap sirf `-sS` scan hi kyun na chala rahe ho.

---

## ğŸ“š Topic 2.2: Internet vs Intranet vs Extranet

### 1. ğŸ¯ Topic/Flag:
**Internet, Intranet, Extranet - Network Ke Types**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Yeh teen alag-alag network types hain jo define karte hain ki kaun kis resources ko access kar sakta hai - Internet (sabke liye), Intranet (company ke andar), Extranet (selected partners ke liye).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aap reconnaissance kar rahe ho, toh aapko pata hona chahiye ki target Internet par publicly exposed hai, ya woh ek internal Intranet resource hai, ya Extranet (VPN/Partner portal) hai. Isse aapki attack strategy change hoti hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Internet:** Public-facing websites, APIs - yahan se recon shuru karo (Google Dorking, Shodan)
- **Intranet:** Internal company network - yahan tak pahunchne ke liye pehle perimeter breach karna padega (phishing, VPN exploit)
- **Extranet:** Partner portals, B2B systems - yahan weak authentication check karo

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Internet:**
- **Definition:** Globally connected network of computers
- **Access:** Koi bhi access kar sakta hai (public)
- **Example:** Google.com, Facebook.com, YouTube.com
- **Security:** Firewalls, WAF, DDoS protection

**Intranet:**
- **Definition:** Private network within an organization
- **Access:** Sirf company employees (internal)
- **Example:** Company ka internal HR portal, file servers
- **Security:** Internal firewalls, VLANs, access control

**Extranet:**
- **Definition:** Controlled private network for external partners
- **Access:** Selected vendors, partners, customers
- **Example:** Supplier portal, B2B exchange, client dashboard
- **Security:** VPN, strong authentication, encryption

### 6. ğŸ‘ Pros (Fayde)
- Clear separation of public aur private resources
- Security layers implement karna aasan
- Access control properly define ho sakta hai

### 7. ğŸ‘ Cons (Nuksaan)
- Intranet resources ko access karna mushkil (pentester ke liye challenge)
- Extranet misconfiguration se data leak ho sakta hai
- Complexity badh jati hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Internet scanning (public targets)
nmap -sS example.com

# Intranet scanning (internal network - agar aap andar ho)
nmap -sS 10.0.0.0/8
nmap -sS 172.16.0.0/12
nmap -sS 192.168.0.0/16

# Extranet scanning (VPN se connect karke)
# Pehle VPN connect karo, phir scan karo
```

### 9. ğŸ’» Practice Command
```bash
# Public Internet target scan
nmap -sS -p 80,443 scanme.nmap.org -v

# Internal network discovery (agar aap company network par ho)
nmap -sn 192.168.1.0/24

# Check karo ki koi service publicly exposed toh nahi
nmap -sS --top-ports 1000 <company-public-ip>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab aap external pentest kar rahe ho, toh hamesha check karo ki koi internal service accidentally Internet par exposed toh nahi hai. Jaise koi company ka internal database (port 3306, 5432) ya admin panel (port 8080) public IP par khula ho. Yeh common misconfiguration hai aur easy win hai pentester ke liye.

**Common Mistake:** Beginners sirf Internet-facing assets ko scan karte hain aur Intranet ko ignore kar dete hain. Lekin real pentesting mein, ek baar aap ek foothold (jaise phishing se ek employee ka laptop compromise) le lo, toh Intranet scanning se aapko crown jewels (databases, domain controllers) milte hain.

---

## ğŸ“š Topic 2.3: Network Types (LAN, MAN, WAN, PAN, CAN, SAN, VPN)

### 1. ğŸ¯ Topic/Flag:
**Network Types - Size aur Scope Ke Hisaab Se**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Networks ko unke geographical size aur purpose ke hisaab se categorize kiya jata hai - LAN (local), MAN (city), WAN (country/world), etc.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Har network type ki alag security posture hoti hai. LAN par aap ARP spoofing kar sakte ho, WAN par aapko routing attacks karne padenge, VPN par encryption break karna padega. Network type samajhne se aapki attack vector clear hoti hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **LAN:** Local attacks (ARP poisoning, MITM, LLMNR/NBT-NS poisoning)
- **WAN:** BGP hijacking, routing attacks (advanced)
- **VPN:** VPN vulnerabilities (weak encryption, credential stuffing)
- **PAN:** Bluetooth attacks, wireless keyboard sniffing

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**LAN (Local Area Network):**
- **Size:** Ek building, office, school
- **Speed:** Fast (1 Gbps - 10 Gbps)
- **Security:** Secure (kyunki local hai)
- **Example:** Office ka network, home wifi
- **Pentesting:** ARP spoofing, VLAN hopping, rogue DHCP

**MAN (Metropolitan Area Network):**
- **Size:** Ek city ya town
- **Speed:** Medium (100 Mbps - 1 Gbps)
- **Security:** Moderate
- **Example:** City-wide wifi, cable TV network
- **Pentesting:** ISP-level attacks, routing manipulation

**WAN (Wide Area Network):**
- **Size:** Country, continent, world
- **Speed:** Variable (depends on connection)
- **Security:** Complex (multiple hops)
- **Example:** Internet, corporate multi-branch network
- **Pentesting:** BGP hijacking, DNS poisoning

**PAN (Personal Area Network):**
- **Size:** Personal workspace (10 meters)
- **Speed:** Low to Medium
- **Security:** Often weak
- **Example:** Bluetooth, Zigbee, hotspot
- **Pentesting:** Bluetooth sniffing, wireless keyboard attacks

**CAN (Campus Area Network):**
- **Size:** University campus, corporate campus
- **Speed:** Fast
- **Security:** Moderate
- **Example:** University network
- **Pentesting:** Similar to LAN attacks

**SAN (Storage Area Network):**
- **Size:** Data center
- **Speed:** Very fast (dedicated storage)
- **Security:** High (critical data)
- **Example:** Enterprise storage systems
- **Pentesting:** iSCSI attacks, storage misconfigurations

**VPN (Virtual Private Network):**
- **Size:** Encrypted tunnel over Internet
- **Speed:** Depends on Internet connection
- **Security:** High (encryption)
- **Example:** Corporate VPN, NordVPN, ExpressVPN
- **Pentesting:** Weak encryption, credential attacks, VPN vulnerabilities

### 6. ğŸ‘ Pros (Fayde)
- Har network type apne use case ke liye optimized hai
- Security requirements clear hain
- Troubleshooting aasan hai

### 7. ğŸ‘ Cons (Nuksaan)
- Har network type ke liye alag security measures chahiye
- Complexity badh jati hai
- Cost bhi vary karta hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# LAN scanning
nmap -sn 192.168.1.0/24

# WAN target scanning
nmap -sS example.com

# VPN se connect karke internal network scan
# (pehle VPN connect karo)
```

### 9. ğŸ’» Practice Command
```bash
# Apne local LAN ko discover karo
nmap -sn 192.168.1.0/24 -v

# Check karo ki kaun se devices online hain
nmap -sP 10.0.0.0/24

# Bluetooth devices scan karo (PAN)
hcitool scan

# VPN vulnerabilities check karo
nmap --script ssl-enum-ciphers -p 443,1194 <vpn-server>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab aap corporate pentest kar rahe ho, toh sabse pehle yeh identify karo ki target network kis type ka hai. Agar LAN hai, toh aap physically on-site jaake rogue device laga sakte ho (Raspberry Pi with Nmap). Agar WAN hai, toh remote attacks karne padenge. Agar VPN hai, toh pehle VPN credentials compromise karo (phishing, credential stuffing).

**Common Mistake:** Beginners LAN aur WAN ko confuse karte hain. Yaad rakho: LAN = Local (192.168.x.x, 10.x.x.x), WAN = Wide (public IPs). Agar aap LAN par ho aur WAN attacks try kar rahe ho, toh woh kaam nahi karenge (jaise BGP hijacking LAN par possible nahi hai).

---

## ğŸ“š Topic 2.4: Network Topologies (Bus, Star, Ring, Hybrid)

### 1. ğŸ¯ Topic/Flag:
**Network Topologies - Network Ka Physical/Logical Layout**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Network topology batata hai ki devices ek network mein physically ya logically kaise connected hain - Bus (ek line), Star (central hub), Ring (circle), Hybrid (mix).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Topology samajhne se aapko pata chalta hai ki agar aap ek device compromise karte ho, toh aap network ke baaki devices tak kaise pahunch sakte ho. Star topology mein central switch compromise karo, Ring mein kisi bhi node se traffic sniff karo.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Bus Topology:** Agar aap ek node compromise karo, toh poore network ka traffic sniff kar sakte ho (rare nowadays)
- **Star Topology:** Central switch/router ko target karo - woh compromise ho gaya toh poora network tumhara
- **Ring Topology:** Kisi bhi node se traffic intercept kar sakte ho
- **Hybrid:** Complex hai, multiple attack vectors possible hain

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Bus Topology:**
- Sabhi devices ek single cable (backbone) se connected hain
- Data har node tak jaata hai, sirf destination node accept karta hai
- **Pentesting:** Packet sniffing aasan hai (sabhi packets sabko dikhte hain)
- **Problem:** Agar backbone fail ho jaye, poora network down

**Star Topology:**
- Sabhi devices ek central hub/switch se connected hain
- Data pehle hub par jaata hai, phir destination tak
- **Pentesting:** Central switch compromise karo (ARP spoofing, MAC flooding)
- **Benefit:** Ek device fail ho toh baaki network chalta rehta hai

**Ring Topology:**
- Devices ek circle mein connected hain
- Data clockwise ya anticlockwise travel karta hai
- **Pentesting:** Kisi bhi node se traffic intercept karo
- **Problem:** Ek device fail ho toh poora ring break ho sakta hai

**Hybrid Topology:**
- Multiple topologies ka combination (Star + Bus, Star + Ring)
- **Pentesting:** Complex, har section ko alag analyze karo
- **Benefit:** Flexible aur scalable

### 6. ğŸ‘ Pros (Fayde)
- Har topology apne use case ke liye best hai
- Troubleshooting mein madad milti hai
- Network design optimize kar sakte ho

### 7. ğŸ‘ Cons (Nuksaan)
- Kuch topologies expensive hain (Star)
- Kuch topologies mein single point of failure hai (Bus, Ring)
- Complex topologies manage karna mushkil

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Network topology discover karne ke liye
nmap -sn 192.168.1.0/24 --traceroute

# Central gateway/router identify karo
ip route | grep default

# Network map banao
nmap -sS --traceroute -oX network_map.xml 192.168.1.0/24
```

### 9. ğŸ’» Practice Command
```bash
# Network devices discover karo
nmap -sn 192.168.1.0/24 -v

# Traceroute se path dekho (topology hint milega)
nmap --traceroute scanme.nmap.org

# ARP table dekho (local network topology)
arp -a

# Network diagram banao (Zenmap use karo)
zenmap
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Modern networks mostly Star topology use karte hain (central switch/router). Pentesting mein, sabse pehle gateway/router ka IP identify karo (`ip route` ya `ipconfig`). Phir us gateway par ARP spoofing karke MITM attack karo - isse aap poore network ka traffic intercept kar sakte ho.

**Common Mistake:** Beginners topology ko ignore kar dete hain aur seedha port scanning shuru kar dete hain. Lekin agar aapko topology pata hai, toh aap smarter attacks kar sakte ho. Jaise Star topology mein central switch par MAC flooding attack karke switch ko hub mode mein daal sakte ho, jisse sabka traffic aapko dikhne lagega.

---

## ğŸ“š Topic 2.5: IP Address vs MAC Address (Logical vs Physical)

### 1. ğŸ¯ Topic/Flag:
**IP Address vs MAC Address - Network Identification**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
IP address ek logical address hai (Layer 3) jo Internet par devices ko identify karta hai, aur MAC address ek physical address hai (Layer 2) jo local network par devices ko identify karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
IP spoofing aur MAC spoofing dono alag attacks hain. IP spoofing se aap remote attacks kar sakte ho, MAC spoofing se aap local network par identity hide kar sakte ho (MAC filtering bypass, ARP poisoning).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **IP Address:** Remote scanning, geolocation, IP-based filtering bypass
- **MAC Address:** Local network attacks (ARP spoofing, MAC filtering bypass, rogue device)
- **Combination:** Agar aap dono spoof karo, toh aap network par "invisible" ban sakte ho

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**IP Address (Logical Address - Layer 3):**
- **Format:** Dotted decimal (IPv4: `192.168.1.10`, IPv6: `2001:0db8::1`)
- **Assigned by:** ISP, DHCP server, manually
- **Scope:** Internet-wide (globally routable)
- **Changes:** Haan (network change karne par badal sakta hai)
- **Example:** `192.168.1.100` (private), `8.8.8.8` (public - Google DNS)

**MAC Address (Physical Address - Layer 2):**
- **Format:** Hexadecimal (6 octets: `AA:BB:CC:DD:EE:FF`)
- **Assigned by:** NIC manufacturer (hardware mein burned)
- **Scope:** Local network only (not routable)
- **Changes:** Nahi (fixed, lekin spoof kiya ja sakta hai)
- **Example:** `00:1A:2B:3C:4D:5E`

**IPv4 vs IPv6:**
- **IPv4:** 32-bit (4.3 billion addresses) - `192.168.1.1`
- **IPv6:** 128-bit (340 undecillion addresses) - `2001:0db8:85a3::8a2e:0370:7334`

### 6. ğŸ‘ Pros (Fayde)
**IP Address:**
- Globally unique (public IPs)
- Routing possible hai
- Geolocation se location pata chal sakta hai

**MAC Address:**
- Hardware-level identification
- Local network par reliable
- ARP protocol ke liye zaroori

### 7. ğŸ‘ Cons (Nuksaan)
**IP Address:**
- Spoof karna aasan hai
- Dynamic IPs track karna mushkil
- NAT ke peeche hide ho sakte hain

**MAC Address:**
- Sirf local network par kaam karta hai
- Spoof karna bahut aasan hai
- Privacy concern (tracking possible)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Apna IP address dekho
ip addr show  # Linux
ipconfig      # Windows

# Apna MAC address dekho
ip link show  # Linux
getmac        # Windows

# MAC address spoof karo
macchanger -r eth0  # Linux (random MAC)
macchanger -m AA:BB:CC:DD:EE:FF eth0  # Specific MAC

# IP address spoof karo (Nmap mein)
nmap -S <spoofed-ip> <target>
```

### 9. ğŸ’» Practice Command
```bash
# Local network par IP aur MAC mapping dekho
arp -a

# Nmap se MAC addresses discover karo
nmap -sn 192.168.1.0/24

# MAC vendor identify karo
nmap -sS --script=mac-geolocation 192.168.1.1

# IP geolocation check karo
curl ipinfo.io/<target-ip>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Jab aap corporate network par pentest kar rahe ho aur MAC filtering enabled hai (sirf authorized MACs ko network access), toh pehle ek legitimate device ka MAC address sniff karo (Wireshark se), phir apne device ka MAC us address se spoof karo (`macchanger`). Isse aap MAC filtering bypass kar sakte ho aur network par entry le sakte ho.

**Common Mistake:** Beginners sochte hain ki MAC address change nahi ho sakta kyunki woh "hardware address" hai. GALAT! MAC address software se easily spoof ho sakta hai. Isliye MAC filtering ek weak security measure hai - ek pentester ke liye yeh koi barrier nahi hai.

---

**ğŸ“ Module 2 Complete!**

Aapne Network & IP Concepts seekh liye - ab aap samajh gaye ki:
- Port scanning kab legal hai aur kab illegal (hamesha permission lo!)
- Internet, Intranet, aur Extranet mein kya farak hai
- Network types (LAN, WAN, VPN, etc.) aur unki security implications
- Network topologies aur unpar attacks kaise karte hain
- IP aur MAC addresses mein farak aur dono ko kaise spoof karte hain

**Next Module:** Module 3 - Ports & Protocols (FTP, SSH, HTTP, DNS, etc.)

Jab ready ho, bolo aur main Module 3 bana dunga! ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ”Œ Module 3: Ports & Protocols (The Gateways)

---

## ğŸ“š Topic 3.1: Ports & Protocols Kya Hain (Total 65535)

### 1. ğŸ¯ Topic/Flag:
**Ports & Protocols - Network Communication Ka Darwaza**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Port ek virtual endpoint hai jo client aur server ke beech communication ka medium hai. Protocol ek set of rules hai jo define karta hai ki communication kaise hogi. Total 65535 ports hain (0-65535).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Port scanning pentesting ka sabse pehla step hai. Agar aapko ports aur protocols nahi pata, toh aap kuch bhi exploit nahi kar paoge. Har port ek potential entry point hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Open ports identify karo (yeh services chal rahi hain)
- Service version detect karo (vulnerabilities dhoondhne ke liye)
- Uncommon ports check karo (backdoors, hidden services)
- Port-based filtering bypass karo

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Port Analogy:**
Ek building (server) mein bahut saare darwaze (ports) hain. Har darwaza ek specific service ke liye hai:
- Darwaza 80: HTTP (web traffic)
- Darwaza 22: SSH (secure login)
- Darwaza 443: HTTPS (secure web)

**Port Ranges:**
- **0-1023:** Well-known ports (HTTP:80, SSH:22, FTP:21)
- **1024-49151:** Registered ports (MySQL:3306, RDP:3389)
- **49152-65535:** Dynamic/Private ports (temporary connections)

**Formula:** Total ports = 2^16 - 1 = 65536 - 1 = 65535

### 6. ğŸ‘ Pros (Fayde)
- Har service ka dedicated port hai (organization)
- Multiple services ek hi machine par chal sakti hain
- Port-based filtering possible hai (firewall rules)

### 7. ğŸ‘ Cons (Nuksaan)
- Open ports = attack surface
- Port scanning se attacker ko information mil jati hai
- Default ports easily targeted hote hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic port scan
nmap <target>

# Specific ports scan
nmap -p 80,443,22 <target>

# Port range scan
nmap -p 1-1000 <target>

# All ports scan
nmap -p- <target>
```

### 9. ğŸ’» Practice Command
```bash
# Top 100 common ports scan
nmap --top-ports 100 scanme.nmap.org -v

# Specific ports with service detection
nmap -p 22,80,443 -sV scanme.nmap.org

# All 65535 ports scan (slow)
nmap -p- -T4 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha uncommon ports bhi scan karo. Admins aksar important services ko non-standard ports par run karte hain (jaise SSH ko port 2222 par). `nmap -p-` use karke saare ports scan karo, sirf top 1000 par mat ruko.

**Common Mistake:** Beginners sirf well-known ports (80, 443, 22) scan karte hain aur high ports (8000-9000) ignore kar dete hain. Lekin real pentesting mein, backdoors aur hidden services aksar high ports par milte hain.

---

## ğŸ“š Topic 3.2: FTP (20, 21) & SSH (22)

### 1. ğŸ¯ Topic/Flag:
**FTP (File Transfer Protocol) - Port 20, 21 | SSH (Secure Shell) - Port 22**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
FTP file upload/download ke liye use hota hai (insecure). SSH remote login aur secure command execution ke liye use hota hai (encrypted).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
- **FTP:** Anonymous login check karo, weak credentials brute-force karo, sensitive files download karo
- **SSH:** Weak passwords crack karo, private keys dhoondhne ki koshish karo, SSH tunneling ke liye use karo

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **FTP:** Anonymous FTP check (`anonymous:anonymous`), directory traversal, file upload (web shell)
- **SSH:** Password brute-force, key-based authentication bypass, SSH tunneling for pivoting

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**FTP (Port 20, 21):**
- **Port 21:** Control connection (commands bhejne ke liye)
- **Port 20:** Data connection (files transfer ke liye)
- **Insecure:** Plain text (credentials visible in Wireshark)

**SSH (Port 22):**
- Encrypted connection (secure)
- Authentication: Password ya private key
- Remote command execution possible

### 6. ğŸ‘ Pros (Fayde)
**FTP:** Simple, widely supported, fast file transfer
**SSH:** Encrypted, secure, versatile (tunneling, SFTP, SCP)

### 7. ğŸ‘ Cons (Nuksaan)
**FTP:** Insecure (plain text), vulnerable to MITM
**SSH:** Brute-force attacks possible, misconfiguration common

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# FTP scan
nmap -p 21 --script ftp-anon <target>

# SSH scan
nmap -p 22 -sV <target>

# FTP connect
ftp <target-ip>

# SSH connect
ssh user@<target-ip> -p 22
```

### 9. ğŸ’» Practice Command
```bash
# Check FTP anonymous login
nmap -p 21 --script ftp-anon scanme.nmap.org

# SSH brute-force (ethical testing only!)
nmap -p 22 --script ssh-brute --script-args userdb=users.txt,passdb=pass.txt <target>

# SSH version detection
nmap -p 22 -sV --script ssh2-enum-algos <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Agar FTP anonymous login enabled hai, toh turant check karo ki kya aap files upload kar sakte ho. Agar web server ka root directory FTP se accessible hai, toh aap web shell upload karke RCE (Remote Code Execution) le sakte ho.

**Common Mistake:** SSH par brute-force karte waqt rate limiting ignore karna. Modern SSH servers fail2ban use karte hain jo aapka IP block kar denge. Hamesha `--scan-delay` use karo.

---

## ğŸ“š Topic 3.3: Telnet (23) & RDP (3389)

### 1. ğŸ¯ Topic/Flag:
**Telnet (Telecommunication Network) - Port 23 | RDP (Remote Desktop Protocol) - Port 3389**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Telnet unencrypted remote login hai (legacy, insecure). RDP Windows machines ko remotely control karne ke liye hai (GUI access).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
- **Telnet:** Agar open hai toh easy win (no encryption, credentials sniff karo)
- **RDP:** Windows exploitation ka main gateway, BlueKeep jaise critical vulnerabilities

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Telnet:** Banner grabbing, service enumeration, MITM attacks
- **RDP:** Brute-force attacks, BlueKeep (CVE-2019-0708) exploit, session hijacking

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Telnet (Port 23):**
- Unencrypted connection
- Plain text credentials
- Legacy protocol (SSH ne replace kar diya)

**RDP (Port 3389):**
- Microsoft protocol
- GUI access (full desktop control)
- Encryption available (lekin vulnerabilities hain)

### 6. ğŸ‘ Pros (Fayde)
**Telnet:** Simple, lightweight
**RDP:** Full GUI access, easy to use

### 7. ğŸ‘ Cons (Nuksaan)
**Telnet:** Completely insecure, MITM vulnerable
**RDP:** Brute-force attacks, BlueKeep vulnerability

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Telnet scan
nmap -p 23 <target>

# RDP scan
nmap -p 3389 <target>

# Telnet connect
telnet <target-ip> 23

# RDP vulnerability check
nmap -p 3389 --script rdp-vuln-ms12-020 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Check Telnet banner
nmap -p 23 -sV --script banner <target>

# RDP BlueKeep vulnerability scan
nmap -p 3389 --script rdp-vuln-ms12-020 <target>

# RDP encryption check
nmap -p 3389 --script rdp-enum-encryption <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Agar RDP open hai aur BlueKeep vulnerable hai, toh yeh critical finding hai. Lekin exploit karne se pehle client se permission lo kyunki BlueKeep exploit system ko crash kar sakta hai (DoS).

**Common Mistake:** Telnet ko ignore karna kyunki "yeh toh purana hai". Lekin agar Telnet open hai, toh yeh sabse aasan entry point hai - Wireshark se credentials sniff karo aur seedha login karo.

---

## ğŸ“š Topic 3.4: Email Protocols (SMTP: 25, POP3: 110, IMAP: 143)

### 1. ğŸ¯ Topic/Flag:
**SMTP (Simple Mail Transfer Protocol) - Port 25 | POP3 (Post Office Protocol) - Port 110 | IMAP (Internet Message Access Protocol) - Port 143**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
SMTP emails bhejne ke liye, POP3 aur IMAP emails receive karne ke liye use hote hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
- **SMTP:** Email spoofing, open relay check, user enumeration (VRFY command)
- **POP3/IMAP:** Credential brute-force, email harvesting

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **SMTP:** Phishing emails bhejne ke liye open relay dhoondhna, user enumeration
- **POP3/IMAP:** Email accounts compromise karna, sensitive information nikalna

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Email Flow:**
1. User email compose karta hai
2. SMTP (Port 25) se email bhejta hai
3. Recipient ka mail server email receive karta hai
4. User POP3 (110) ya IMAP (143) se email download karta hai

**Difference:**
- **POP3:** Emails download karke server se delete kar deta hai
- **IMAP:** Emails server par hi rehte hain (sync across devices)

### 6. ğŸ‘ Pros (Fayde)
- Email communication ka backbone
- Widely supported
- Multiple protocols (flexibility)

### 7. ğŸ‘ Cons (Nuksaan)
- SMTP open relay = spam/phishing
- Plain text authentication (agar SSL/TLS nahi hai)
- User enumeration possible

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# SMTP scan
nmap -p 25 --script smtp-enum-users <target>

# POP3 scan
nmap -p 110 -sV <target>

# IMAP scan
nmap -p 143 -sV <target>
```

### 9. ğŸ’» Practice Command
```bash
# SMTP user enumeration
nmap -p 25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} <target>

# SMTP open relay check
nmap -p 25 --script smtp-open-relay <target>

# POP3 brute-force
nmap -p 110 --script pop3-brute <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** SMTP par VRFY command use karke valid usernames enumerate kar sakte ho. Phir un usernames par password brute-force karo. Yeh technique "username harvesting" kehlati hai aur phishing campaigns ke liye bahut useful hai.

**Common Mistake:** SMTP ko sirf "email bhejne" ke liye samajhna. SMTP se aap user enumeration, open relay abuse, aur email spoofing bhi kar sakte ho.

---

## ğŸ“š Topic 3.5: DNS (53) & DHCP (67)

### 1. ğŸ¯ Topic/Flag:
**DNS (Domain Name System) - Port 53 | DHCP (Dynamic Host Configuration Protocol) - Port 67**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
DNS domain names ko IP addresses mein convert karta hai. DHCP devices ko automatically IP addresses assign karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
- **DNS:** Zone transfer attacks, DNS enumeration, subdomain discovery, DNS cache poisoning
- **DHCP:** Rogue DHCP server attacks, DHCP starvation, network reconnaissance

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **DNS:** Subdomains discover karo (hidden assets), zone transfer try karo, DNS tunneling for exfiltration
- **DHCP:** Network mapping, MITM attacks (rogue DHCP server)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**DNS (Port 53):**
- User: "google.com kya hai?"
- DNS: "216.58.200.174"
- Bidirectional mapping: Domain â†” IP

**DHCP (Port 67):**
- DORA Process (next topic mein detail)
- Device network par aata hai
- DHCP server automatically IP assign karta hai

### 6. ğŸ‘ Pros (Fayde)
**DNS:** Human-readable names, distributed system
**DHCP:** Automatic IP assignment, easy network management

### 7. ğŸ‘ Cons (Nuksaan)
**DNS:** Cache poisoning, zone transfer leaks, DNS tunneling abuse
**DHCP:** Rogue server attacks, IP exhaustion attacks

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# DNS enumeration
nmap -p 53 --script dns-zone-transfer <target>

# DHCP discovery
nmap --script broadcast-dhcp-discover

# DNS brute-force subdomains
nmap --script dns-brute <domain>
```

### 9. ğŸ’» Practice Command
```bash
# DNS zone transfer attempt
nmap -p 53 --script dns-zone-transfer --script-args dns-zone-transfer.domain=example.com <dns-server>

# DNS service version
nmap -p 53 -sU -sV <target>

# DHCP discover on local network
nmap --script broadcast-dhcp-discover -e eth0
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** DNS zone transfer agar successful ho jaye, toh aapko poore domain ka map mil jata hai (sabhi subdomains, internal IPs). Yeh reconnaissance ka goldmine hai. Hamesha `dns-zone-transfer` script try karo.

**Common Mistake:** DNS ko sirf UDP (port 53) par scan karna. DNS TCP bhi use karta hai (zone transfers ke liye). Hamesha dono scan karo: `nmap -p 53 -sU -sT <target>`

---

## ğŸ“š Topic 3.6: DORA Process (Discover, Offer, Request, Acknowledge)

### 1. ğŸ¯ Topic/Flag:
**DORA Process - DHCP IP Assignment Ka 4-Step Process**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
DORA ek 4-step process hai jisme DHCP client (device) DHCP server se IP address request karta hai aur receive karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
DORA process samajhne se aap DHCP attacks kar sakte ho - DHCP starvation (saare IPs exhaust karna), rogue DHCP server (MITM), aur network reconnaissance.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **DHCP Starvation:** Saare available IPs request karke legitimate users ko deny karna
- **Rogue DHCP Server:** Apna DHCP server setup karke clients ko malicious gateway assign karna (MITM)
- **Network Mapping:** DHCP responses se network range aur gateway identify karna

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Step 1 - DISCOVER:**
- Client: "Koi DHCP server hai? Mujhe IP chahiye!"
- Broadcast message (255.255.255.255)

**Step 2 - OFFER:**
- Server: "Haan, main hoon. Yeh lo IP: 192.168.1.100"
- Server available IP offer karta hai

**Step 3 - REQUEST:**
- Client: "Theek hai, main yeh IP 192.168.1.100 lena chahta hoon"
- Client formally request karta hai

**Step 4 - ACKNOWLEDGE:**
- Server: "Done! Yeh IP tumhara hai. Gateway: 192.168.1.1, DNS: 8.8.8.8"
- Server confirm karta hai aur additional info deta hai

### 6. ğŸ‘ Pros (Fayde)
- Automatic IP assignment (manual configuration nahi chahiye)
- Centralized management
- IP conflicts avoid hote hain

### 7. ğŸ‘ Cons (Nuksaan)
- Rogue DHCP server attacks possible
- DHCP starvation attacks
- No authentication (koi bhi DHCP server ban sakta hai)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# DHCP discover
nmap --script broadcast-dhcp-discover

# DHCP information gathering
nmap --script dhcp-discover <target>
```

### 9. ğŸ’» Practice Command
```bash
# Local network par DHCP discover
nmap --script broadcast-dhcp-discover -e eth0

# DHCP server information
nmap -sU -p 67 --script dhcp-discover <dhcp-server-ip>

# Yara tool se DHCP starvation (ethical testing only!)
# yersinia -G  (GUI mode)
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Agar aap local network par ho, toh rogue DHCP server attack bahut powerful hai. Raspberry Pi par DHCP server setup karo aur apne aap ko gateway declare karo. Sabhi naye devices aapke through internet access karenge, aur aap MITM kar sakte ho.

**Common Mistake:** DORA process ko sirf "IP milne ka tareeka" samajhna. Lekin pentesting mein, yeh ek attack vector hai. DHCP starvation se DoS kar sakte ho, rogue DHCP se MITM kar sakte ho.

---

## ğŸ“š Topic 3.7: HTTP (80) & HTTPS (443)

### 1. ğŸ¯ Topic/Flag:
**HTTP (Hypertext Transfer Protocol) - Port 80 | HTTPS (HTTP Secure) - Port 443**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
HTTP web pages access karne ka protocol hai (insecure). HTTPS encrypted version hai (TLS/SSL ke saath).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh sabse common ports hain pentesting mein. 90% web applications in ports par chalti hain. SQL injection, XSS, CSRF, authentication bypass - sabhi attacks yahan hote hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **HTTP:** Web application vulnerabilities (SQLi, XSS, LFI, RFI)
- **HTTPS:** SSL/TLS vulnerabilities (Heartbleed, weak ciphers), certificate issues
- **Both:** Directory brute-forcing, API enumeration, authentication bypass

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**HTTP (Port 80):**
- Plain text communication
- No encryption
- Fast (no encryption overhead)
- Vulnerable to MITM

**HTTPS (Port 443):**
- Encrypted communication (TLS/SSL)
- Certificate-based authentication
- Slower (encryption overhead)
- Secure against MITM (agar properly configured ho)

### 6. ğŸ‘ Pros (Fayde)
**HTTP:** Fast, simple, no certificate needed
**HTTPS:** Secure, encrypted, trusted (green padlock)

### 7. ğŸ‘ Cons (Nuksaan)
**HTTP:** Insecure, credentials visible, MITM vulnerable
**HTTPS:** Misconfiguration common, certificate errors, weak ciphers

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# HTTP scan
nmap -p 80 -sV <target>

# HTTPS scan
nmap -p 443 -sV <target>

# HTTP methods enumeration
nmap -p 80 --script http-methods <target>

# SSL/TLS vulnerabilities
nmap -p 443 --script ssl-enum-ciphers <target>
```

### 9. ğŸ’» Practice Command
```bash
# Web server detection
nmap -p 80,443 -sV --script http-title scanme.nmap.org

# Directory brute-force
nmap -p 80 --script http-enum scanme.nmap.org

# SSL certificate check
nmap -p 443 --script ssl-cert scanme.nmap.org

# Heartbleed vulnerability check
nmap -p 443 --script ssl-heartbleed <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha HTTP aur HTTPS dono check karo. Kabhi-kabhi developers HTTP par insecure version chhodte hain (testing ke liye) jo production mein bhi accessible rehta hai. Agar HTTP par login page mil jaye, toh credentials plain text mein travel karenge.

**Common Mistake:** Sirf port 80 aur 443 scan karna. Web servers aksar non-standard ports par bhi chalte hain (8080, 8443, 8000, 3000). Hamesha `--top-ports 1000` ya `-p-` use karo taaki hidden web services miss na ho.

---

**ğŸ“ Module 3 Complete!**

Aapne Ports & Protocols seekh liye - ab aap samajh gaye ki:
- Ports kya hain aur 65535 ports ka significance
- FTP, SSH, Telnet, RDP ke vulnerabilities aur exploitation
- Email protocols (SMTP, POP3, IMAP) aur unke attacks
- DNS aur DHCP ka pentesting perspective
- DORA process aur DHCP attacks
- HTTP/HTTPS vulnerabilities aur SSL/TLS issues

**Next Module:** Module 4 - Nmap Basics & Core Scan Types (TCP Connect, SYN Scan)

Ready ho toh bolo! ğŸš€



=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ” Module 4: Nmap Basics & Core Scan Types

---

## ğŸ“š Topic 4.1: Nmap Introduction & Installation (Windows/Linux)

### 1. ğŸ¯ Topic/Flag:
**Nmap - Network Mapper (Installation & Setup)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ek free, open-source network scanner hai jo ports, services, OS detection, aur vulnerabilities scan karne ke liye use hota hai. Gordon Lyon (Fyodor) ne 1997 mein banaya tha.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Nmap pentesting ka sabse important tool hai. Bina Nmap ke aap reconnaissance nahi kar sakte. Yeh har pentester ki toolkit ka foundation hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Network discovery (kaun se hosts alive hain)
- Port scanning (kaun se services chal rahi hain)
- Service version detection (vulnerabilities dhoondhne ke liye)
- OS fingerprinting (target system identify karna)
- Vulnerability scanning (NSE scripts ke saath)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
Nmap packets bhejta hai aur responses analyze karta hai:
- SYN packet bhejo â†’ SYN-ACK mila = Port open
- SYN packet bhejo â†’ RST mila = Port closed
- SYN packet bhejo â†’ Koi response nahi = Port filtered

### 6. ğŸ‘ Pros (Fayde)
- Free aur open-source
- Cross-platform (Windows, Linux, macOS)
- Powerful NSE (Nmap Scripting Engine)
- Active development (regular updates)
- Industry standard tool

### 7. ğŸ‘ Cons (Nuksaan)
- Noisy scans logs mein detect ho sakte hain
- Slow ho sakta hai (agar stealth mode mein)
- Learning curve hai (bahut saare options)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic syntax
nmap [Scan Type] [Options] <target>

# Simple scan
nmap <target-ip>

# Version check
nmap --version
```

### 9. ğŸ’» Practice Command
```bash
# Windows Installation:
# 1. www.nmap.org se download karo
# 2. nmap-setup.exe install karo
# 3. npcap install karo (packet capture ke liye)

# Linux Installation:
# Debian/Ubuntu/Kali
sudo apt-get update && sudo apt-get install nmap -y

# RHEL/CentOS
sudo yum install nmap -y

# Version check
nmap --version

# First scan
nmap scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Installation ke baad hamesha `nmap --version` aur `nmap --help` run karo. Latest version use karo kyunki purane versions mein bugs aur missing features ho sakte hain. Npcap/Winpcap install karna mat bhoolna (Windows par).

**Common Mistake:** Windows par Nmap install karne ke baad Npcap install nahi karna. Bina Npcap ke raw packet scans (jaise `-sS`) kaam nahi karenge.

---

## ğŸ“š Topic 4.2: TCP Connect Scan (`-sT`)

### 1. ğŸ¯ Topic/Flag:
**TCP Connect Scan (`-sT`) - Full 3-Way Handshake**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
TCP Connect scan poora 3-way handshake (SYN, SYN-ACK, ACK) complete karta hai. Yeh sabse basic aur reliable scan hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh scan tab use hota hai jab aapke paas root/admin privileges nahi hain ya jab aapko 100% accurate results chahiye (stealth ki zaroorat nahi).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Non-privileged user ke liye (root access nahi hai)
- Accurate results chahiye (false positives avoid karne ke liye)
- Testing environments mein jahan stealth zaroori nahi

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Full 3-Way Handshake:**
1. Nmap â†’ SYN â†’ Target
2. Target â†’ SYN-ACK â†’ Nmap (Port OPEN)
3. Nmap â†’ ACK â†’ Target
4. Nmap â†’ RST â†’ Target (Connection close)

**Agar port closed:**
- Target â†’ RST â†’ Nmap

### 6. ğŸ‘ Pros (Fayde)
- Sabse reliable scan (accurate results)
- Root/admin privileges nahi chahiye
- Firewall bypass ho sakta hai (kyunki legitimate connection hai)
- Kisi bhi OS par kaam karta hai

### 7. ğŸ‘ Cons (Nuksaan)
- Noisy hai (logs mein easily detect hota hai)
- Slow hai (poora handshake complete karna padta hai)
- IDS/IPS trigger kar sakta hai
- Connection attempts log ho jaate hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic TCP Connect scan
nmap -sT <target>

# Specific ports
nmap -sT -p 22,80,443 <target>

# Verbose output
nmap -sT -v <target>
```

### 9. ğŸ’» Practice Command
```bash
# Simple TCP Connect scan
nmap -sT scanme.nmap.org -v

# Multiple ports scan
nmap -sT -p 21,22,80,443,3389 192.168.1.1 -v

# All ports scan (slow)
nmap -sT -p- scanme.nmap.org

# With service detection
nmap -sT -sV -p 80,443 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Agar aapke paas root access nahi hai, toh Nmap automatically `-sT` scan use karega (even if you specify `-sS`). Check karo `id` command se ki aap root ho ya nahi. Non-root users ke liye `-sT` hi option hai.

**Common Mistake:** `-sT` scan ko "beginner scan" samajhna. Yeh sabse reliable scan hai aur production environments mein jahan accuracy zaroori hai, wahan yeh best choice hai. Stealth hamesha zaroori nahi hota.

---

## ğŸ“š Topic 4.3: TCP Stealth/SYN Scan (`-sS`)

### 1. ğŸ¯ Topic/Flag:
**TCP SYN Scan (`-sS`) - Half-Open Stealth Scan**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
SYN scan sirf 2 steps karta hai (SYN, SYN-ACK), ACK nahi bhejta. Isse "half-open" ya "stealth" scan kehte hain kyunki connection complete nahi hota.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh Nmap ka default scan hai (agar root access hai). Fast, efficient, aur relatively stealthy. Professional pentesters ka go-to scan hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Fast scanning (thousands of ports quickly)
- Stealth mode (purane IDS systems ko bypass kar sakta hai)
- Default choice for most pentests
- Large networks scan karne ke liye

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Half-Open Handshake:**
1. Nmap â†’ SYN â†’ Target
2. Target â†’ SYN-ACK â†’ Nmap (Port OPEN hai!)
3. Nmap â†’ RST â†’ Target (Connection abort, ACK nahi bheja)

**Kyun stealth hai?**
- Purane systems mein sirf complete connections log hote the
- Half-open connections ignore ho jaate the
- Modern systems ab yeh bhi log karte hain (less stealthy now)

**Agar port closed:**
- Target â†’ RST â†’ Nmap

### 6. ğŸ‘ Pros (Fayde)
- Fast (ACK wait nahi karna padta)
- Efficient (kam packets)
- Relatively stealthy (purane IDS bypass)
- Nmap ka default scan (root access ke saath)

### 7. ğŸ‘ Cons (Nuksaan)
- Root/admin privileges chahiye
- Modern IDS/IPS detect kar lete hain
- Kuch firewalls SYN packets drop kar dete hain
- Ab utna stealthy nahi raha (2024 mein)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic SYN scan (requires root)
sudo nmap -sS <target>

# Specific ports
sudo nmap -sS -p 22,80,443 <target>

# Fast scan
sudo nmap -sS -T4 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Simple SYN scan
sudo nmap -sS scanme.nmap.org -v

# Top 1000 ports (fast)
sudo nmap -sS --top-ports 1000 192.168.1.1 -T4

# All ports with version detection
sudo nmap -sS -p- -sV scanme.nmap.org

# SYN scan with packet trace (learning ke liye)
sudo nmap -sS -p 80 --packet-trace scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-sS` scan ko hamesha `-T4` (timing template) ke saath use karo taaki fast ho. Default timing bahut slow hai. Lekin agar IDS bypass karna hai, toh `-T2` ya `-T1` use karo (slow but stealthy).

**Common Mistake:** Bina root access ke `-sS` scan try karna. Agar aap root nahi ho, toh Nmap automatically `-sT` scan use karega aur aapko pata bhi nahi chalega. Hamesha `sudo` use karo ya root user se login karo.

---

**ğŸ“ Module 4 Complete!**

Aapne Nmap Basics aur Core Scan Types seekh liye:
- Nmap installation (Windows/Linux)
- TCP Connect Scan (`-sT`) - Reliable lekin noisy
- TCP SYN Scan (`-sS`) - Fast aur relatively stealthy

**Key Takeaways:**
- `-sT` = Full handshake, no root needed, noisy
- `-sS` = Half-open, root needed, faster, default choice

**Next Module:** Module 5 - Advanced Stealth Scan Techniques (NULL, FIN, XMAS)

Ready? Bolo! ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ¥· Module 5: Advanced Stealth Scan Techniques (OS Fingerprinting)

---

## ğŸ“š Topic 5.1: NULL Scan (`-sN`)

### 1. ğŸ¯ Topic/Flag:
**NULL Scan (`-sN`) - Sabhi Flags OFF**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
NULL scan ek packet bhejta hai jisme TCP header ke sabhi flags OFF (null) hote hain. Yeh firewall aur IDS ko confuse karne ke liye use hota hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh scan stateful firewalls ko bypass kar sakta hai jo sirf SYN packets check karte hain. Non-Windows systems par kaam karta hai (RFC 793 loophole).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Firewall bypass (jo SYN/ACK packets filter karte hain)
- OS fingerprinting (Windows vs Linux detection)
- Stealthy reconnaissance (purane IDS systems bypass)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**RFC 793 Rule:**
- Agar port CLOSED hai â†’ RST packet bhejo
- Agar port OPEN hai â†’ Ignore karo (koi response nahi)

**NULL Scan Process:**
1. Nmap â†’ NULL packet (no flags) â†’ Target
2. **Port Closed:** Target â†’ RST/ACK â†’ Nmap
3. **Port Open:** (No response) â†’ Nmap assumes OPEN|FILTERED

**Windows Problem:**
- Windows RFC 793 follow nahi karta
- Sabhi ports ke liye RST bhejta hai
- Isliye Windows par unreliable results

### 6. ğŸ‘ Pros (Fayde)
- Stealthy (kuch firewalls bypass)
- OS fingerprinting mein help (Windows vs Linux)
- Purane IDS systems detect nahi kar paate

### 7. ğŸ‘ Cons (Nuksaan)
- Windows par kaam nahi karta (unreliable)
- Modern firewalls detect kar lete hain
- Slow hai (response wait karna padta hai)
- Results ambiguous (open|filtered)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic NULL scan
sudo nmap -sN <target>

# With verbosity
sudo nmap -sN -v <target>

# Specific ports
sudo nmap -sN -p 22,80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# NULL scan on Linux target
sudo nmap -sN scanme.nmap.org -v

# Compare with Windows target (unreliable)
sudo nmap -sN <windows-ip> -p 80,443

# With packet trace (learning)
sudo nmap -sN -p 80 --packet-trace scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** NULL scan use karke OS fingerprinting karo. Agar sabhi ports RST bhej rahe hain (even open ports), toh target Windows hai. Agar kuch ports silent hain, toh Linux/Unix hai. Yeh quick OS detection trick hai.

**Common Mistake:** NULL scan ko "ultimate stealth" samajhna. Modern firewalls aur IDS ab NULL packets bhi detect karte hain. Yeh sirf purane systems par effective hai.

---

## ğŸ“š Topic 5.2: FIN Scan (`-sF`)

### 1. ğŸ¯ Topic/Flag:
**FIN Scan (`-sF`) - FIN Flag Set**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
FIN scan ek packet bhejta hai jisme sirf FIN flag set hota hai. FIN normally connection close karne ke liye use hota hai, lekin yahan bina connection ke bheja jata hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh scan stateful firewalls ko bypass kar sakta hai jo sirf SYN packets monitor karte hain. FIN packets "legitimate connection close" ki tarah dikhte hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Firewall evasion (SYN-based filters bypass)
- Packet filters ko confuse karna
- Non-Windows targets par stealth scanning

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**RFC 793 Rule (same as NULL):**
- Closed port â†’ RST bhejo
- Open port â†’ Ignore karo

**FIN Scan Process:**
1. Nmap â†’ FIN packet â†’ Target
2. **Port Closed:** Target â†’ RST/ACK â†’ Nmap
3. **Port Open:** (No response) â†’ Nmap assumes OPEN|FILTERED

**Firewall Bypass Logic:**
- Firewall: "Yeh FIN packet hai, matlab connection close ho raha hai"
- Firewall: "Legitimate traffic hai, allow karo"
- Reality: Yeh scan packet hai!

### 6. ğŸ‘ Pros (Fayde)
- Stealthy (firewalls ko legitimate lagta hai)
- SYN-based filters bypass
- Packet filters ko confuse karta hai

### 7. ğŸ‘ Cons (Nuksaan)
- Windows par unreliable
- Modern stateful firewalls detect kar lete hain
- Results ambiguous (open|filtered)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic FIN scan
sudo nmap -sF <target>

# Multiple ports
sudo nmap -sF -p 1-1000 <target>

# Fast timing
sudo nmap -sF -T4 <target>
```

### 9. ğŸ’» Practice Command
```bash
# FIN scan on Linux server
sudo nmap -sF scanme.nmap.org -v

# Compare with SYN scan results
sudo nmap -sS scanme.nmap.org -v
sudo nmap -sF scanme.nmap.org -v

# With packet trace
sudo nmap -sF -p 80 --packet-trace scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** FIN scan ko SYN scan ke saath combine karke use karo. Pehle `-sS` se quick scan karo, phir suspicious ports par `-sF` se verify karo. Agar dono results match karte hain, toh port definitely open hai.

**Common Mistake:** FIN scan ko "better than SYN" samajhna. Yeh sirf specific scenarios mein useful hai (jab firewall SYN block kar raha ho). General scanning ke liye SYN scan hi best hai.

---

## ğŸ“š Topic 5.3: XMAS Scan (`-sX`)

### 1. ğŸ¯ Topic/Flag:
**XMAS Scan (`-sX`) - FIN, PSH, URG Flags Set**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
XMAS scan ek packet bhejta hai jisme FIN, PSH, aur URG flags set hote hain. Packet "Christmas tree ki tarah light up" hota hai (isliye naam XMAS).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh sabse unusual scan hai. Firewalls aur IDS ko confuse karta hai kyunki yeh combination normally kabhi nahi hota. Advanced evasion technique hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Maximum firewall evasion (unusual packet pattern)
- IDS signature bypass (rare packet combination)
- OS fingerprinting (Windows vs Unix behavior)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Packet Structure:**
- **FIN:** Connection close karo
- **PSH:** Data immediately push karo
- **URG:** Urgent data hai

**Yeh combination invalid hai!** (Connection close + urgent data = contradiction)

**XMAS Scan Process:**
1. Nmap â†’ FIN+PSH+URG packet â†’ Target
2. **Port Closed:** Target â†’ RST/ACK â†’ Nmap
3. **Port Open:** (No response) â†’ Nmap assumes OPEN|FILTERED

**Why "XMAS"?**
- Multiple flags set = lights on
- Christmas tree jaise dikhta hai (packet visualization mein)

### 6. ğŸ‘ Pros (Fayde)
- Maximum stealth (unusual packet)
- Firewalls ko confuse karta hai
- IDS signatures bypass (rare pattern)
- OS fingerprinting mein useful

### 7. ğŸ‘ Cons (Nuksaan)
- Windows par completely unreliable
- Bahut conspicuous (agar detect ho gaya toh obvious attack)
- Modern IDS ab yeh detect karte hain
- Results ambiguous

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic XMAS scan
sudo nmap -sX <target>

# With fragmentation (extra stealth)
sudo nmap -sX -f <target>

# Specific ports
sudo nmap -sX -p 22,80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# XMAS scan on Linux target
sudo nmap -sX scanme.nmap.org -v

# Compare all stealth scans
sudo nmap -sS scanme.nmap.org -p 80  # SYN
sudo nmap -sN scanme.nmap.org -p 80  # NULL
sudo nmap -sF scanme.nmap.org -p 80  # FIN
sudo nmap -sX scanme.nmap.org -p 80  # XMAS

# With packet trace (see the flags)
sudo nmap -sX -p 80 --packet-trace scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** XMAS scan ko "last resort" ke taur par use karo. Jab SYN, NULL, FIN sab fail ho jaaye (firewall block kar raha ho), tab XMAS try karo. Kabhi-kabhi firewalls ko yeh packet itna unusual lagta hai ki woh confused hokar allow kar dete hain.

**Common Mistake:** XMAS scan ko "best stealth scan" samajhna. Reality mein, yeh bahut conspicuous hai. Agar security team alert hai, toh XMAS scan turant red flag raise karega. Use wisely!

---

**ğŸ“ Module 5 Complete!**

Aapne Advanced Stealth Scans seekh liye:
- **NULL Scan (`-sN`):** Sabhi flags OFF
- **FIN Scan (`-sF`):** Sirf FIN flag
- **XMAS Scan (`-sX`):** FIN+PSH+URG flags

**Key Concepts:**
- Yeh sab RFC 793 loophole exploit karte hain
- Windows par unreliable (RFC follow nahi karta)
- Linux/Unix par kaam karte hain
- Modern firewalls ab detect kar lete hain
- OS fingerprinting mein useful

**Comparison Table:**

| Scan Type | Flags Set | Windows | Linux | Use Case |
|-----------|-----------|---------|-------|----------|
| SYN (`-sS`) | SYN | âœ… | âœ… | Default, fast |
| NULL (`-sN`) | None | âŒ | âœ… | Firewall bypass |
| FIN (`-sF`) | FIN | âŒ | âœ… | Stealth |
| XMAS (`-sX`) | FIN+PSH+URG | âŒ | âœ… | Max evasion |

**Next Module:** Module 6 - Other Scan Types & Firewall Check (UDP, ACK, IDLE)

Ready? ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ›¡ï¸ Module 6: Other Scan Types & Firewall Check

---

## ğŸ“š Topic 6.1: UDP Scan (`-sU`)

### 1. ğŸ¯ Topic/Flag:
**UDP Scan (`-sU`) - Connection-less Protocol Scanning**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
UDP scan connection-less UDP protocol ko scan karta hai. TCP se bilkul alag approach hai kyunki UDP mein acknowledgement nahi hota.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Critical services UDP par chalti hain (DNS:53, DHCP:67, SNMP:161, TFTP:69). Agar aap sirf TCP scan karte ho, toh yeh services miss ho jayengi jo exploitation ke liye goldmine ho sakti hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- DNS enumeration (port 53)
- SNMP community string brute-force (port 161)
- DHCP server discovery (port 67)
- TFTP file access (port 69)
- VoIP/SIP services (port 5060)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**UDP Scan Logic:**
1. Nmap â†’ UDP packet â†’ Target
2. **Port Open:** (No response) - UDP service silently accept karti hai
3. **Port Closed:** Target â†’ ICMP Port Unreachable â†’ Nmap
4. **Port Filtered:** (No response) - Firewall drop kar raha hai

**Problem:**
- Open aur Filtered mein farak nahi pata chalta (dono silent)
- Isliye result: **open|filtered**

**Why Slow?**
- Har packet ka response wait karna padta hai
- ICMP rate limiting (OS sirf limited ICMP responses bhejta hai)
- Retransmissions (packet loss ke liye)

### 6. ğŸ‘ Pros (Fayde)
- Critical UDP services discover kar sakte ho
- TCP scans se miss hone wali services milti hain
- SNMP, DNS jaise high-value targets

### 7. ğŸ‘ Cons (Nuksaan)
- Bahut slow (hours lag sakte hain)
- Results ambiguous (open|filtered)
- ICMP rate limiting se aur slow
- False positives/negatives common

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic UDP scan
sudo nmap -sU <target>

# Top UDP ports
sudo nmap -sU --top-ports 20 <target>

# Specific UDP ports
sudo nmap -sU -p 53,161,69 <target>

# Fast UDP scan
sudo nmap -sU -T4 --max-retries 1 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Top 100 UDP ports (recommended)
sudo nmap -sU --top-ports 100 scanme.nmap.org -v

# Critical UDP services
sudo nmap -sU -p 53,67,69,123,161 192.168.1.1 -T4

# UDP + TCP combined scan
sudo nmap -sS -sU -p U:53,161,T:80,443 <target>

# Version detection on UDP
sudo nmap -sU -sV -p 161 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** UDP scan bahut slow hai, isliye hamesha `--top-ports 100` ya specific ports (`-p 53,161,69`) use karo. Aur `--max-retries 1` aur `-T4` add karo speed ke liye. Kabhi bhi `-p-` (all 65535 UDP ports) mat karo - days lag jayenge!

**Common Mistake:** UDP scan ko ignore karna kyunki "slow hai". Lekin SNMP (161) aksar misconfigured hota hai aur device ka poora config leak kar sakta hai. Hamesha critical UDP ports scan karo.

---

## ğŸ“š Topic 6.2: ACK Scan (`-sA`) - Firewall Rule Check

### 1. ğŸ¯ Topic/Flag:
**ACK Scan (`-sA`) - Firewall Detection & Rule Mapping**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
ACK scan ports ko "open" ya "closed" detect nahi karta. Yeh sirf yeh batata hai ki port "filtered" hai ya "unfiltered" - matlab firewall rules map karne ke liye use hota hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh scan firewall ki presence aur uske rules ko identify karta hai. Aapko pata chal jata hai ki kaun se ports firewall filter kar raha hai aur kaun se nahi.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Firewall detection (hai ya nahi)
- Firewall rules mapping (kaun se ports filtered hain)
- Stateful vs Stateless firewall identification
- Firewall bypass strategy planning

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**ACK Scan Logic:**
1. Nmap â†’ ACK packet â†’ Target
2. **Unfiltered:** Target â†’ RST â†’ Nmap (firewall nahi hai ya allow kar raha hai)
3. **Filtered:** (No response ya ICMP error) â†’ Nmap (firewall block kar raha hai)

**Key Point:**
- ACK packets normally existing connection ka part hote hain
- Stateless firewalls ACK packets allow kar dete hain (legitimate connection samajh kar)
- Stateful firewalls check karte hain ki pehle SYN tha ya nahi

**Result:**
- **Unfiltered:** Port tak packet pahunch raha hai (firewall nahi ya allow hai)
- **Filtered:** Firewall block kar raha hai

### 6. ğŸ‘ Pros (Fayde)
- Firewall presence detect karta hai
- Firewall rules map kar sakte ho
- Stateful vs Stateless firewall identify
- Bypass strategy planning mein help

### 7. ğŸ‘ Cons (Nuksaan)
- Port open/closed nahi batata (sirf filtered/unfiltered)
- Standalone scan useful nahi (dusre scans ke saath use karo)
- Modern stateful firewalls easily detect karte hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic ACK scan
sudo nmap -sA <target>

# Specific ports
sudo nmap -sA -p 80,443,22 <target>

# Full port range
sudo nmap -sA -p- <target>
```

### 9. ğŸ’» Practice Command
```bash
# Firewall detection
sudo nmap -sA scanme.nmap.org -v

# Compare with SYN scan
sudo nmap -sS scanme.nmap.org -p 80,443  # Port status
sudo nmap -sA scanme.nmap.org -p 80,443  # Firewall status

# Identify filtered ports
sudo nmap -sA -p 1-1000 192.168.1.1 -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** ACK scan ko hamesha SYN scan ke saath combine karo. Pehle `-sS` se open ports dhoondhne, phir `-sA` se check karo ki kaun se ports firewall filter kar raha hai. Agar port "unfiltered" hai lekin "closed" hai, toh firewall bypass ho sakta hai (service start karne par).

**Common Mistake:** ACK scan ko standalone use karna aur confuse hona ki "yeh toh port open/closed nahi bata raha". ACK scan ka purpose hi alag hai - firewall detection, not port detection.

---

## ğŸ“š Topic 6.3: IDLE (Zombie) Scan (`-sI`) - Ultimate Stealth

### 1. ğŸ¯ Topic/Flag:
**IDLE/Zombie Scan (`-sI`) - Blind Stealth Scan**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
IDLE scan sabse advanced stealth technique hai jisme aap ek third-party "zombie" host use karte ho scanning ke liye. Target ko aapka IP address kabhi nahi dikhta - sirf zombie ka IP dikhta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh ultimate anonymity hai. Logs mein aapka IP nahi aayega, sirf zombie ka IP aayega. IDS/IPS bypass karne ka sabse powerful tareeka hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Complete anonymity (aapka IP hide)
- IDS/IPS bypass (zombie ko blame milega)
- IP-based filtering bypass
- Covert reconnaissance

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Requirements:**
- Ek "zombie" host chahiye (idle system with predictable IPID)
- Zombie ka IPID sequence predictable hona chahiye

**IDLE Scan Process:**
1. **Probe Zombie:** Nmap â†’ SYN â†’ Zombie, Zombie â†’ SYN-ACK â†’ Nmap (IPID = 100)
2. **Spoof Attack:** Nmap â†’ SYN (spoofed from Zombie IP) â†’ Target
3. **If Port Open:** Target â†’ SYN-ACK â†’ Zombie, Zombie â†’ RST â†’ Target (IPID = 101, incremented!)
4. **Probe Again:** Nmap â†’ SYN â†’ Zombie, Zombie â†’ SYN-ACK â†’ Nmap (IPID = 102)
5. **Result:** IPID increased by 2 = Port OPEN (zombie ne ek extra packet bheji)

**If Port Closed:**
- Target â†’ RST â†’ Zombie (zombie responds nahi karta)
- IPID sirf 1 se badhta hai (sirf Nmap ka probe)

**Why "Zombie"?**
- Zombie host ko pata bhi nahi chalta ki uska use ho raha hai
- Woh unconsciously scanning mein participate kar raha hai

### 6. ğŸ‘ Pros (Fayde)
- Ultimate stealth (aapka IP completely hidden)
- Logs mein zombie ka IP aayega
- IDS/IPS bypass
- IP-based filtering bypass

### 7. ğŸ‘ Cons (Nuksaan)
- Zombie host dhoondhna mushkil (predictable IPID chahiye)
- Bahut slow scan
- Modern OS mein IPID randomized hai (kaam nahi karta)
- Complex setup

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# IDLE scan (zombie required)
sudo nmap -sI <zombie-ip> <target>

# With specific ports
sudo nmap -sI <zombie-ip>:<port> <target> -p 80,443

# Find zombie hosts
sudo nmap --script ipidseq <potential-zombie>
```

### 9. ğŸ’» Practice Command
```bash
# Find potential zombie (predictable IPID)
sudo nmap --script ipidseq 192.168.1.0/24

# IDLE scan using zombie
sudo nmap -sI 192.168.1.50 scanme.nmap.org -p 80 -v

# Verify zombie is working
sudo nmap -O --osscan-guess 192.168.1.50
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Good zombie hosts: Printers, IP cameras, IoT devices (yeh aksar idle rehte hain aur predictable IPID use karte hain). Pehle `--script ipidseq` se zombie candidates scan karo, phir best zombie select karo.

**Common Mistake:** Modern systems (Windows 10+, Linux 4.18+) par IDLE scan try karna. Yeh systems randomized IPID use karte hain, toh scan fail ho jayega. Purane systems ya IoT devices par hi kaam karta hai.

---

## ğŸ“š Topic 6.4: Scan Types Summary (Revision)

### 1. ğŸ¯ Topic/Flag:
**Nmap Scan Types - Complete Comparison**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Yeh ek quick reference hai sabhi scan types ka - kab kaun sa scan use karna hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Har situation ke liye right scan choose karna zaroori hai. Wrong scan = time waste, detection, ya incomplete results.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
**Decision Tree:**
- **Fast & Accurate chahiye?** â†’ `-sS` (SYN Scan)
- **No root access?** â†’ `-sT` (TCP Connect)
- **Firewall bypass?** â†’ `-sN`, `-sF`, `-sX` (Stealth Scans)
- **UDP services?** â†’ `-sU` (UDP Scan)
- **Firewall detection?** â†’ `-sA` (ACK Scan)
- **Complete anonymity?** â†’ `-sI` (IDLE Scan)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Comparison Table:**

| Scan | Flag | Root? | Speed | Stealth | Windows | Use Case |
|------|------|-------|-------|---------|---------|----------|
| `-sS` | SYN | âœ… | Fast | Medium | âœ… | Default choice |
| `-sT` | Full | âŒ | Slow | Low | âœ… | No root access |
| `-sN` | None | âœ… | Slow | High | âŒ | Firewall bypass |
| `-sF` | FIN | âœ… | Slow | High | âŒ | Stealth |
| `-sX` | FIN+PSH+URG | âœ… | Slow | High | âŒ | Max evasion |
| `-sU` | UDP | âœ… | Very Slow | N/A | âœ… | UDP services |
| `-sA` | ACK | âœ… | Fast | Medium | âœ… | Firewall detect |
| `-sI` | Zombie | âœ… | Very Slow | Ultimate | âœ… | Anonymity |

### 6. ğŸ‘ Pros (Fayde)
- Har situation ke liye option hai
- Flexibility aur control
- Evasion techniques available

### 7. ğŸ‘ Cons (Nuksaan)
- Bahut saare options = confusion
- Wrong choice = waste of time
- Learning curve hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Recommended workflow
sudo nmap -sS --top-ports 1000 <target>  # Quick scan
sudo nmap -sU --top-ports 100 <target>   # UDP check
sudo nmap -sA -p 80,443 <target>         # Firewall check
```

### 9. ğŸ’» Practice Command
```bash
# Complete reconnaissance workflow
# Step 1: Fast TCP scan
sudo nmap -sS -T4 --top-ports 1000 192.168.1.1 -oN tcp_scan.txt

# Step 2: UDP critical ports
sudo nmap -sU -p 53,161,69 192.168.1.1 -oN udp_scan.txt

# Step 3: Firewall detection
sudo nmap -sA -p 80,443,22 192.168.1.1 -oN firewall_check.txt

# Step 4: Service detection on open ports
sudo nmap -sV -p <open-ports> 192.168.1.1 -oN services.txt
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Real pentesting mein ek hi scan type use nahi karte. Workflow banao:
1. Fast SYN scan (`-sS -T4`) - quick overview
2. UDP scan (`-sU --top-ports 100`) - critical services
3. ACK scan (`-sA`) - firewall mapping
4. Stealth scans (`-sN/-sF/-sX`) - agar firewall block kar raha ho
5. Service detection (`-sV`) - final enumeration

**Common Mistake:** Har scan type ko separately samajhna. Inhe combine karo! Jaise: `nmap -sS -sU -sV -p 80,443,53,161 <target>` - ek hi command mein TCP, UDP, aur version detection.

---

**ğŸ“ Module 6 Complete!**

Aapne Other Scan Types aur Firewall Detection seekh liya:
- **UDP Scan (`-sU`):** Critical UDP services
- **ACK Scan (`-sA`):** Firewall detection
- **IDLE Scan (`-sI`):** Ultimate stealth
- **Scan Types Summary:** Kab kaun sa scan use kare

**Key Takeaways:**
- UDP scan slow hai lekin critical services ke liye zaroori
- ACK scan firewall rules map karta hai
- IDLE scan ultimate anonymity deta hai (lekin mushkil)
- Har scan type ka apna use case hai

**Next Module:** Module 7 - Target Selection (IP ranges, subnets, file input)

Ready? ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ¯ Module 7: Target Selection (Target Chunna)

---

## ğŸ“š Topic 7.1: Single IP, Hostname, Range, Subnet (`/24`)

### 1. ğŸ¯ Topic/Flag:
**Target Selection - IP, Hostname, Range, Subnet**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ko target specify karne ke alag-alag tareeke - single IP, domain name, IP range, ya poora subnet.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Pentesting mein aapko kabhi ek server scan karna hota hai, kabhi poora network. Target selection ka sahi tarika jaanna time aur resources bachata hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Single IP:** Specific server testing (jaise production web server)
- **Hostname:** Domain-based scanning (DNS resolution automatic)
- **Range:** Specific IP block (jaise 192.168.1.1-50)
- **Subnet:** Poora network discovery (jaise /24 = 254 hosts)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Single IP:**
```bash
nmap 192.168.1.100
```
- Sirf ek IP address scan hota hai
- Default: Top 1000 ports

**Hostname/Domain:**
```bash
nmap scanme.nmap.org
nmap google.com
```
- Nmap pehle DNS lookup karta hai
- Domain ko IP mein convert karta hai
- Phir scan shuru hota hai

**IP Range:**
```bash
nmap 192.168.1.1-50
nmap 192.168.1.1-192.168.1.50
```
- Specified range ke sabhi IPs scan hote hain
- Example: 1-50 = 50 hosts

**Subnet (CIDR Notation):**
```bash
nmap 192.168.1.0/24
```
- `/24` = 256 IPs (192.168.1.0 to 192.168.1.255)
- `/16` = 65,536 IPs
- `/8` = 16,777,216 IPs

### 6. ğŸ‘ Pros (Fayde)
- Flexible targeting (ek se lekar thousands tak)
- CIDR notation se large networks easily scan
- Hostname support (DNS automatic resolve)

### 7. ğŸ‘ Cons (Nuksaan)
- Large subnets (/16, /8) bahut time lete hain
- DNS resolution fail ho sakta hai
- Range specify karte waqt typo se galat targets scan

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Single IP
nmap 192.168.1.1

# Hostname
nmap example.com

# IP Range
nmap 192.168.1.1-50

# Subnet
nmap 192.168.1.0/24

# Multiple targets
nmap 192.168.1.1 192.168.1.5 192.168.1.10
```

### 9. ğŸ’» Practice Command
```bash
# Single target scan
nmap scanme.nmap.org -v

# Range scan (1 to 50)
nmap 192.168.1.1-50 -v

# Subnet scan (all 254 hosts)
nmap 192.168.1.0/24 -sn

# Multiple specific IPs
nmap 192.168.1.1 192.168.1.100 192.168.1.200 -p 80,443
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Subnet scanning se pehle hamesha host discovery (`-sn`) karo taaki pata chale ki kitne hosts alive hain. Phir sirf alive hosts par detailed port scan karo. Isse time bachta hai: `nmap -sn 192.168.1.0/24 -oG - | grep "Up" | cut -d' ' -f2 > alive_hosts.txt` phir `nmap -iL alive_hosts.txt -sS -sV`

**Common Mistake:** `/24` subnet scan karte waqt `-p-` (all ports) use karna. Yeh 254 hosts Ã— 65535 ports = 16 million+ scans ho jayenge! Hamesha pehle `--top-ports 100` ya specific ports se shuru karo.

---

## ğŸ“š Topic 7.2: Input from File (`-iL`)

### 1. ğŸ¯ Topic/Flag:
**Target Input from File (`-iL`) - Bulk Scanning**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ek text file mein targets ki list rakhna aur Nmap ko us file se targets read karne ko kehna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Real pentesting mein aapko 100+ targets scan karne padte hain. Har baar command mein type karna impractical hai. File se input lena organized aur repeatable hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Bug bounty programs (company ke sabhi domains/IPs ek file mein)
- Continuous monitoring (same targets har mahine scan karo)
- Client-provided scope (client ne jo IPs/domains diye, unhe file mein save karo)
- Automation (scripts se file generate karke Nmap ko feed karo)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**File Format:**
```
# targets.txt
192.168.1.1
192.168.1.50
scanme.nmap.org
google.com
10.0.0.0/24
```

**Nmap Command:**
```bash
nmap -iL targets.txt
```

**Process:**
1. Nmap file ko line-by-line read karta hai
2. Har line ko ek target samajhta hai
3. Comments (`#`) ignore karta hai
4. Sabhi targets ko sequentially scan karta hai

### 6. ğŸ‘ Pros (Fayde)
- Organized aur repeatable
- Large-scale scanning easy
- Comments add kar sakte ho (documentation)
- Automation-friendly

### 7. ğŸ‘ Cons (Nuksaan)
- File path galat ho toh error
- File mein typo = galat targets scan
- Sequential scanning (parallel nahi, unless `-iL` ke saath `--max-parallelism` use karo)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic file input
nmap -iL targets.txt

# With options
nmap -iL targets.txt -p 80,443 -sV

# Verbose output
nmap -iL targets.txt -v -oN results.txt
```

### 9. ğŸ’» Practice Command
```bash
# Create target file
echo "192.168.1.1" > targets.txt
echo "192.168.1.100" >> targets.txt
echo "scanme.nmap.org" >> targets.txt
echo "google.com" >> targets.txt

# Scan from file
nmap -iL targets.txt -p 22,80,443 -v

# With service detection
nmap -iL targets.txt -sV --top-ports 100 -oA file_scan_results
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** File mein comments use karke targets ko organize karo:
```
# Production Servers
192.168.1.10
192.168.1.20

# Development Servers
192.168.2.10
192.168.2.20

# External Domains
example.com
test.example.com
```
Isse baad mein samajhna aasan hota hai ki kaun sa target kis category mein hai.

**Common Mistake:** File mein blank lines ya extra spaces dalna. Nmap blank lines ko ignore karta hai, lekin agar accidentally koi invalid entry ho (jaise `192.168.1.` incomplete IP), toh scan fail ho sakta hai. Hamesha file ko validate karo pehle.

---

## ğŸ“š Topic 7.3: Random Hosts (`-iR`)

### 1. ğŸ¯ Topic/Flag:
**Random Host Selection (`-iR`) - Internet-wide Scanning**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ko random public IP addresses generate karke scan karne ko kehna. Yeh Internet par random targets dhoondhne ke liye hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Research purposes ke liye (jaise "Internet par kitne servers port 22 open rakhte hain?"). Lekin yeh ethical aur legal boundaries ke andar hi use karna chahiye.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Security research (Internet-wide vulnerability statistics)
- Honeypot detection (random IPs scan karke patterns dhoondhna)
- Shodan-style reconnaissance (lekin manual)
- **WARNING:** Bina permission ke random IPs scan karna ILLEGAL hai!

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Command:**
```bash
nmap -iR 10
```
- Nmap 10 random public IPs generate karega
- Private ranges (192.168.x.x, 10.x.x.x) skip karega
- Har IP ko scan karega

**Process:**
1. Nmap random IP generate karta hai
2. Check karta hai ki woh private range mein toh nahi
3. Agar public IP hai, toh scan karta hai
4. Specified count tak repeat karta hai

### 6. ğŸ‘ Pros (Fayde)
- Internet-wide research possible
- Unexpected targets mil sakte hain
- Automation ke liye useful (random sampling)

### 7. ğŸ‘ Cons (Nuksaan)
- **LEGAL RISK:** Bina permission ke scanning illegal
- Slow (random IPs mein bahut se down/filtered honge)
- Results unpredictable
- ISP aapko block kar sakta hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Scan 10 random hosts
nmap -iR 10

# With specific ports
nmap -iR 50 -p 80,443

# Fast scan
nmap -iR 100 -F -T4
```

### 9. ğŸ’» Practice Command
```bash
# Scan 5 random hosts (for learning only!)
nmap -iR 5 -p 80 -v

# Random hosts with service detection
nmap -iR 10 -sV --top-ports 10

# Save results
nmap -iR 20 -p 22,80,443 -oN random_scan.txt
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-iR` ko hamesha `0` (infinite) ke saath use mat karo! Agar aap `nmap -iR 0` chalate ho, toh Nmap infinite loop mein chala jayega aur kabhi rukne wala nahi. Hamesha ek specific number do (jaise 10, 50, 100).

**Common Mistake:** Random scanning ko "safe" samajhna kyunki "koi specific target nahi hai". GALAT! Yeh bhi unauthorized scanning hai. Sirf research/learning environments mein use karo, ya phir legal permission ke saath. Real pentesting mein kabhi use mat karo.

---

## ğŸ“š Topic 7.4: Exclude Targets (`--exclude`, `--exclude-file`)

### 1. ğŸ¯ Topic/Flag:
**Exclude Targets (`--exclude`, `--exclude-file`) - Specific IPs Ko Chhodna**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ek range ya subnet scan karte waqt kuch specific IPs ko scan se exclude (bahar) karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Client aksar kehta hai "Poora network scan karo, LEKIN production database server (192.168.1.50) ko mat chhedna". Exclude feature se aap accidentally critical systems ko scan nahi karoge.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Critical production servers ko protect karna
- Client-specified "out of scope" systems
- Apne khud ke machines ko scan se bachana (jaise Nmap chala rahe ho jis machine se)
- Honeypots ko avoid karna (agar pata ho)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Single Exclude:**
```bash
nmap 192.168.1.0/24 --exclude 192.168.1.50
```
- Poora subnet scan hoga
- Sirf 192.168.1.50 skip hoga

**Multiple Exclude:**
```bash
nmap 192.168.1.0/24 --exclude 192.168.1.50,192.168.1.100,192.168.1.200
```
- Comma-separated list

**Exclude File:**
```bash
# exclude.txt
192.168.1.50
192.168.1.100
192.168.1.200

nmap 192.168.1.0/24 --excludefile exclude.txt
```

### 6. ğŸ‘ Pros (Fayde)
- Critical systems ko accidentally scan nahi hota
- Client requirements follow kar sakte ho
- Apne aap ko scan se bacha sakte ho
- File se bulk exclusion easy

### 7. ğŸ‘ Cons (Nuksaan)
- Exclude list maintain karna padta hai
- Typo se galat IP exclude ho sakta hai
- Agar exclude list badi ho, toh confusing

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Single exclude
nmap 192.168.1.0/24 --exclude 192.168.1.50

# Multiple exclude
nmap 192.168.1.0/24 --exclude 192.168.1.50,192.168.1.100

# Exclude file
nmap 192.168.1.0/24 --excludefile exclude.txt

# Exclude with range
nmap 192.168.1.0/24 --exclude 192.168.1.1-10
```

### 9. ğŸ’» Practice Command
```bash
# Scan subnet but exclude gateway
nmap 192.168.1.0/24 --exclude 192.168.1.1 -sn

# Exclude multiple critical servers
nmap 192.168.1.0/24 --exclude 192.168.1.50,192.168.1.100,192.168.1.200 -p 80,443

# Create exclude file
echo "192.168.1.1" > exclude.txt
echo "192.168.1.50" >> exclude.txt
nmap 192.168.1.0/24 --excludefile exclude.txt -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha apne khud ke IP ko exclude karo jab subnet scan kar rahe ho. Agar aap 192.168.1.100 se scan chal rahe ho, toh `--exclude 192.168.1.100` use karo. Isse aap apne aap ko scan nahi karoge (time waste) aur logs bhi clean rahenge.

**Common Mistake:** Exclude file mein comments ya blank lines dalna. Nmap exclude file mein sirf IPs expect karta hai, koi comments nahi. Agar aapne `# Production Server` likha, toh Nmap error dega. Sirf clean IP list rakho.

---

**ğŸ“ Module 7 Complete!**

Aapne Target Selection master kar liya:
- **Single IP, Hostname, Range, Subnet:** Flexible targeting
- **File Input (`-iL`):** Bulk scanning for large-scale pentests
- **Random Hosts (`-iR`):** Internet-wide research (legal permission ke saath!)
- **Exclude (`--exclude`):** Critical systems ko protect karna

**Key Takeaways:**
- Subnet scanning se pehle host discovery karo (time bachao)
- File input organized aur repeatable hai
- Random scanning legal risks hai - careful!
- Hamesha critical systems exclude karo

**Next Module:** Module 8 - Host Discovery (Host Zinda Hai?)

Ready? ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ” Module 8: Host Discovery (Host Zinda Hai?)

---

## ğŸ“š Topic 8.1: Default Ping Scan (`-sn` ya `-sP`)

### 1. ğŸ¯ Topic/Flag:
**Ping Scan (`-sn`) - Host Discovery Without Port Scanning**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ping scan sirf yeh check karta hai ki kaun se hosts network par "alive" (zinda) hain, bina unke ports scan kiye.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Large networks (jaise /16 subnet = 65,536 IPs) par pehle yeh jaanna zaroori hai ki kaun se hosts online hain. Phir sirf un alive hosts par detailed port scan karna time aur resources bachata hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Network mapping (kaun kaun online hai)
- Pre-scan reconnaissance (alive hosts ki list banana)
- Monitoring (kaun se hosts up/down hain)
- Large subnet scanning se pehle filtering

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Default Behavior:**
```bash
nmap -sn 192.168.1.0/24
```

**Nmap kya bhejta hai:**
1. **ICMP Echo Request** (traditional ping)
2. **TCP SYN** to port 443
3. **TCP ACK** to port 80
4. **ICMP Timestamp Request**

**Agar koi bhi response aata hai = Host UP**

**Output:**
```
Host is up (0.0010s latency).
MAC Address: AA:BB:CC:DD:EE:FF (Vendor Name)
```

**Note:** `-sP` purana flag hai (deprecated), ab `-sn` use karo.

### 6. ğŸ‘ Pros (Fayde)
- Fast (ports scan nahi hota)
- Network overview quickly mil jata hai
- Bandwidth kam use hota hai
- Large networks ke liye perfect

### 7. ğŸ‘ Cons (Nuksaan)
- Firewall ICMP block kar sakta hai (false negatives)
- Port information nahi milti
- Stealth nahi hai (logs mein dikhta hai)
- Kuch hosts respond nahi karte (even if alive)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic ping scan
nmap -sn <target>

# Subnet ping scan
nmap -sn 192.168.1.0/24

# With verbosity
nmap -sn 192.168.1.0/24 -v
```

### 9. ğŸ’» Practice Command
```bash
# Discover alive hosts in subnet
nmap -sn 192.168.1.0/24 -v

# Save alive hosts to file
nmap -sn 192.168.1.0/24 -oG - | grep "Up" | cut -d' ' -f2 > alive_hosts.txt

# Ping scan with reason
nmap -sn 192.168.1.0/24 --reason

# Fast ping scan
nmap -sn 192.168.1.0/24 -T4
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Ping scan ke results ko file mein save karo, phir us file se detailed scan karo:
```bash
# Step 1: Find alive hosts
nmap -sn 192.168.1.0/24 -oG - | grep "Up" | cut -d' ' -f2 > alive.txt

# Step 2: Detailed scan on alive hosts only
nmap -iL alive.txt -sS -sV -p- -oA detailed_scan
```
Yeh approach 10x faster hai compared to directly `/24` par port scan karna.

**Common Mistake:** Ping scan ko "stealth" samajhna. `-sn` scan bhi logs mein record hota hai aur IDS trigger kar sakta hai. Yeh sirf "fast discovery" hai, "stealth discovery" nahi.

---

## ğŸ“š Topic 8.2: No Ping Scan (`-Pn`) - Firewall Bypass

### 1. ğŸ¯ Topic/Flag:
**No Ping (`-Pn`) - Skip Host Discovery, Assume Host is UP**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ko host discovery (ping) skip karne ko kehna aur directly port scanning shuru karna. Yeh assume karta hai ki host alive hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Bahut saare firewalls ICMP (ping) packets ko block kar dete hain. Agar aap normal scan karte ho, toh Nmap sochega "host down hai" aur port scan nahi karega. `-Pn` se aap firewall ko bypass karke directly ports scan kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Windows Firewall bypass (default mein ICMP block hota hai)
- Strict firewall environments
- Jab aapko pata hai ki host alive hai lekin ping respond nahi kar raha
- Cloud servers (AWS, Azure) jo ICMP block karte hain

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Normal Scan (Without `-Pn`):**
1. Nmap â†’ ICMP Echo Request â†’ Target
2. Target Firewall â†’ Block (No Response)
3. Nmap: "Host is down, skip port scan"
4. **Result:** Koi ports nahi milte (even if open hain)

**With `-Pn`:**
1. Nmap â†’ Skip ping, directly port scan
2. Nmap â†’ SYN packets â†’ Target ports
3. Target â†’ SYN-ACK (if port open)
4. **Result:** Open ports mil jaate hain!

**Example:**
```bash
# Without -Pn (firewall blocks ping)
nmap 192.168.1.100
# Output: Host seems down

# With -Pn (bypass firewall)
nmap -Pn 192.168.1.100
# Output: Port 80 open, Port 443 open
```

### 6. ğŸ‘ Pros (Fayde)
- Firewall bypass (ICMP blocking se bachna)
- Guaranteed port scan (host down nahi maana jayega)
- Cloud environments mein zaroori
- Windows targets ke liye must

### 7. ğŸ‘ Cons (Nuksaan)
- Slow (har IP par port scan hoga, even if down)
- Bandwidth waste (down hosts par bhi scan)
- False positives (filtered ports ko open samajh sakte ho)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic no-ping scan
nmap -Pn <target>

# With port specification
nmap -Pn -p 80,443 <target>

# Full scan with no-ping
nmap -Pn -sS -sV -p- <target>
```

### 9. ğŸ’» Practice Command
```bash
# Bypass Windows Firewall
nmap -Pn 192.168.1.100 -v

# Scan specific ports without ping
nmap -Pn -p 22,80,443,3389 192.168.1.100

# Full aggressive scan
nmap -Pn -A -T4 scanme.nmap.org

# Subnet scan without ping (slow!)
nmap -Pn 192.168.1.0/24 --top-ports 100
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-Pn` ko hamesha specific targets par use karo, poore subnet par nahi. Agar aap `nmap -Pn 192.168.1.0/24 -p-` chalate ho, toh Nmap 254 hosts Ã— 65535 ports = 16 million+ scans karega (even if hosts down hain). Pehle `-sn` se alive hosts dhoondhne, phir un par `-Pn` use karo.

**Common Mistake:** Har scan mein `-Pn` use karna. Yeh sirf tab use karo jab aapko pata ho ki firewall ICMP block kar raha hai. Normal cases mein default ping discovery better hai (faster aur efficient).

---

## ğŸ“š Topic 8.3: Windows Firewall Rule Setup (Practice)

### 1. ğŸ¯ Topic/Flag:
**Windows Firewall Configuration - ICMP Blocking Practice**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Windows Defender Firewall mein ek custom rule banana jo sabhi incoming connections ko block kare, taaki aap `-Pn` flag ka practical use samajh sako.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Real-world mein clients ke systems par firewalls hote hain. Yeh practice lab setup aapko samajhne mein madad karti hai ki firewall kaise kaam karta hai aur Nmap se kaise bypass karte hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Firewall behavior samajhna
- `-Pn` flag ka importance demonstrate karna
- Client environments simulate karna
- Defense mechanisms test karna

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Setup Steps:**

**Step 1-2: Firewall Properties Allow Karo**
1. Search: `Windows Defender Firewall`
2. Click: `Windows Defender Firewall Properties`
3. **Domain Profile Tab:**
   - Inbound connections: **Allow**
   - Outbound connections: **Allow**
4. Repeat for **Private Profile** aur **Public Profile**
5. Click: **Apply**

**Result:** Ab aap Windows IP ko ping kar sakte ho.

**Step 3-7: Custom Block Rule Banao**
1. Search: `Windows Defender Firewall`
2. Left side: Click `Inbound Rules`
3. Right side: Click `New Rule`
4. Select: **Custom**
5. Protocol: **Any**
6. Local IP: **Any IP address**
7. Remote IP: **Any IP address**

**Step 8-12: Rule Complete Karo**
1. Action: **Block the connection**
2. Apply to: **Domain, Private, Public** (sabhi)
3. Name: `Block All Incoming` (koi bhi naam)
4. Click: **Finish**

**Result:** Ab Windows machine ping respond nahi karega!

**Testing:**
```bash
# From Kali/Linux
ping 192.168.1.100
# Result: Request timeout

nmap 192.168.1.100
# Result: Host seems down

nmap -Pn 192.168.1.100 -v
# Result: Ports scan ho jayenge!
```

### 6. ğŸ‘ Pros (Fayde)
- Real-world scenario practice
- Firewall behavior samajh aata hai
- `-Pn` ka importance clear hota hai
- Safe lab environment

### 7. ğŸ‘ Cons (Nuksaan)
- Windows machine chahiye (VM ya physical)
- Configuration time lagta hai
- Galat rule se network access block ho sakta hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Test without -Pn (will fail)
nmap 192.168.1.100 -v

# Test with -Pn (will work)
nmap -Pn 192.168.1.100 -v

# Verify firewall is blocking
ping 192.168.1.100
# Should timeout
```

### 9. ğŸ’» Practice Command
```bash
# Before firewall rule
ping 192.168.1.100
# Success

nmap 192.168.1.100
# Ports found

# After firewall rule
ping 192.168.1.100
# Timeout

nmap 192.168.1.100
# Host seems down

nmap -Pn 192.168.1.100 -p 80,443,3389 -v
# Ports found! Firewall bypassed
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Practice lab mein hamesha ek "restore point" rakho. Firewall rules galat configure ho jaaye toh aap network access kho sakte ho. Windows mein firewall rule banane se pehle screenshot lo ya rule ko export karo (`Export Policy` option).

**Common Mistake:** Firewall rule banate waqt "Outbound" connections bhi block karna. Sirf "Inbound" block karo, warna aapka Windows machine Internet se completely disconnect ho jayega aur aap remote se access nahi kar paoge.

---

**ğŸ“ Module 8 Complete!**

Aapne Host Discovery master kar liya:
- **Ping Scan (`-sn`):** Fast network discovery
- **No Ping (`-Pn`):** Firewall bypass technique
- **Windows Firewall Setup:** Practical lab for testing

**Key Takeaways:**
- Ping scan large networks ke liye time saver
- `-Pn` Windows aur cloud environments mein zaroori
- Hamesha pehle alive hosts dhoondhne, phir detailed scan
- Firewall behavior samajhna pentesting ka important part

**Workflow:**
```bash
# Step 1: Quick discovery
nmap -sn 192.168.1.0/24 -oG - | grep "Up" > alive.txt

# Step 2: Detailed scan (with -Pn for firewall bypass)
nmap -Pn -iL alive.txt -sS -sV --top-ports 1000 -oA results
```

**Next Module:** Module 9 - Port Selection & Scan Speed

Ready? ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# âš¡ Module 9: Port Selection & Scan Speed

---

## ğŸ“š Topic 9.1: Port by Name/Number (`-p ftp,80`)

### 1. ğŸ¯ Topic/Flag:
**Port Selection - Name ya Number Se**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ko specific ports scan karne ko kehna - port number (80) ya service name (http) dono se.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Time bachane ke liye sirf important ports scan karo. Web application testing mein sirf 80,443 chahiye, database testing mein 3306,5432 chahiye.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Web servers: `-p 80,443,8080,8443`
- Databases: `-p 3306,5432,1433,27017`
- Remote access: `-p 22,23,3389,5900`
- Custom applications: Client-specified ports

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Port numbers
nmap -p 80,443 <target>

# Service names
nmap -p http,https <target>

# Mix both
nmap -p 22,http,443,ftp <target>
```

Nmap internally service names ko port numbers mein convert karta hai (`/usr/share/nmap/nmap-services` file se).

### 6. ğŸ‘ Pros (Fayde)
- Fast (sirf specific ports)
- Targeted scanning
- Service names readable hain

### 7. ğŸ‘ Cons (Nuksaan)
- Agar galat ports select kiye toh important services miss
- Service names case-sensitive nahi lekin typo se error

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -p <port1,port2,...> <target>
nmap -p <service1,service2> <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -p 80,443 scanme.nmap.org
nmap -p http,https,ssh scanme.nmap.org
nmap -p 22,80,443,3389 192.168.1.1 -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Common port combinations yaad rakho:
- Web: `80,443,8080,8443`
- Mail: `25,110,143,465,587,993,995`
- DB: `3306,5432,1433,27017,6379`

**Common Mistake:** Service name mein typo (jaise `htttp` instead of `http`). Nmap error dega.

---

## ğŸ“š Topic 9.2: All Ports (`-p-`) & Only Open (`--open`)

### 1. ğŸ¯ Topic/Flag:
**All Ports Scan (`-p-`) aur Sirf Open Ports (`--open`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
`-p-` sabhi 65535 ports scan karta hai. `--open` sirf open ports display karta hai (closed/filtered hide).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Complete coverage ke liye sabhi ports scan karna zaroori hai. Hidden services aksar high ports (8000+) par chalti hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Comprehensive pentest: `-p-` mandatory
- Hidden backdoors: High ports check
- Clean output: `--open` se sirf relevant results

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# All 65535 ports
nmap -p- <target>
# Same as: nmap -p 1-65535 <target>

# Only show open ports
nmap -p- --open <target>
```

**Time:** `-p-` bahut slow hai (hours lag sakte hain). Hamesha `-T4` ke saath use karo.

### 6. ğŸ‘ Pros (Fayde)
- Complete coverage
- Hidden services mil jaati hain
- `--open` se output clean

### 7. ğŸ‘ Cons (Nuksaan)
- Bahut slow (hours)
- Network load zyada
- Noisy (IDS trigger)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -p- <target>
nmap -p- --open <target>
nmap -p 1-65535 --open <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -p- -T4 scanme.nmap.org
nmap -p- --open -T4 192.168.1.1
nmap -p 1-10000 --open scanme.nmap.org -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Pehle `--top-ports 1000` scan karo, phir `-p-` karo. Isse important ports jaldi mil jaate hain.

**Common Mistake:** `-p-` ko bina `-T4` ke chalana. Default timing bahut slow hai.

---

## ğŸ“š Topic 9.3: Port Knocking (Script)

### 1. ğŸ¯ Topic/Flag:
**Port Knocking - Hidden Ports Ko Activate Karna**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ek security technique jisme specific sequence mein ports ko "knock" (scan) karne par ek hidden port open ho jata hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Kuch servers port knocking use karte hain SSH ya admin panels ko hide karne ke liye. Agar aapko sequence pata hai, toh hidden service access kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- SSH hidden behind port knocking
- Admin panels protection
- CTF challenges
- Obfuscation-as-security bypass

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Example Sequence:** 7000 â†’ 8000 â†’ 9000 â†’ SSH (22) opens

```bash
# Manual knocking
nmap -p 7000 <target>
nmap -p 8000 <target>
nmap -p 9000 <target>
nmap -p 22 <target>  # Now SSH is open!

# Automated script
for x in {1..10000}; do nmap -p $x <target>; done
```

### 6. ğŸ‘ Pros (Fayde)
- Hidden services discover
- Security through obscurity bypass
- CTF mein useful

### 7. ğŸ‘ Cons (Nuksaan)
- Bahut slow
- Sequence guess karna mushkil
- Modern security mein rare

### 8. âŒ¨ï¸ Syntax (Command)
```bash
for x in {1..10000}; do nmap -p $x <target>; done
```

### 9. ğŸ’» Practice Command
```bash
# Sequential port scan (1 to 1000)
for x in {1..1000}; do nmap -p $x 192.168.1.1; done

# Specific sequence
nmap -p 7000 192.168.1.1
nmap -p 8000 192.168.1.1
nmap -p 9000 192.168.1.1
nmap -p 22 192.168.1.1 -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Port knocking sequences aksar documentation ya config files mein hote hain. Pehle `/etc/knockd.conf` ya similar files dhoondhne ki koshish karo.

**Common Mistake:** Bahut fast knocking. Kuch servers ko delay chahiye (1-2 seconds). `sleep 1` add karo loop mein.

---

## ğŸ“š Topic 9.4: Fast Scan (`-F`) - Top 100 Ports

### 1. ğŸ¯ Topic/Flag:
**Fast Scan (`-F`) - Quick Reconnaissance**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Sirf top 100 sabse common ports scan karna (default 1000 ke bajaay).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Quick reconnaissance ke liye. Jab aapko fast results chahiye aur time kam ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Initial recon (5 minutes mein overview)
- Large networks (hundreds of hosts)
- Time-constrained pentests
- Quick vulnerability assessment

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -F <target>
```

Nmap `/usr/share/nmap/nmap-services` file se top 100 most common ports select karta hai based on frequency.

**Comparison:**
- Default: 1000 ports (~10 seconds)
- `-F`: 100 ports (~1 second)
- `-p-`: 65535 ports (~hours)

### 6. ğŸ‘ Pros (Fayde)
- Bahut fast (seconds)
- Most common services cover
- Large networks ke liye perfect

### 7. ğŸ‘ Cons (Nuksaan)
- Uncommon services miss
- Incomplete coverage
- False sense of security

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -F <target>
nmap -F -T4 <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -F scanme.nmap.org -v
nmap -F 192.168.1.0/24 -T4
nmap -F --open 192.168.1.1
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-F` ko initial scan ke liye use karo, phir interesting hosts par detailed scan (`-p-`) karo.

**Common Mistake:** `-F` ko final scan samajhna. Yeh sirf quick recon hai, complete pentest nahi.

---

## ğŸ“š Topic 9.5: Sequential Scan (`-r`)

### 1. ğŸ¯ Topic/Flag:
**Sequential Port Scan (`-r`) - Random Nahi, Line Se**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ports ko random order ke bajaay sequential order (1, 2, 3...) mein scan karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Debugging aur troubleshooting ke liye. Jab aapko exact order mein results chahiye.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Debugging scan issues
- Predictable output (testing)
- IDS evasion (kuch cases mein)
- Documentation purposes

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Default (Random):**
```
Scanning: 443, 22, 80, 3389, 21...
```

**With `-r` (Sequential):**
```
Scanning: 1, 2, 3, 4, 5, 6...
```

### 6. ğŸ‘ Pros (Fayde)
- Predictable order
- Debugging easy
- Output organized

### 7. ğŸ‘ Cons (Nuksaan)
- IDS easily detect (pattern obvious)
- Slower (no optimization)
- Less stealthy

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -r <target>
nmap -r -p 1-1000 <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -r scanme.nmap.org -v
nmap -r -p 1-100 192.168.1.1
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-r` ko production pentesting mein avoid karo. Yeh IDS ko easily trigger karta hai. Sirf testing/debugging ke liye use karo.

**Common Mistake:** `-r` ko "stealth" samajhna. Yeh opposite hai - bahut predictable aur noisy.

---

## ğŸ“š Topic 9.6: Top Ports (`--top-ports 20`) & Port Ratio

### 1. ğŸ¯ Topic/Flag:
**Top Ports (`--top-ports`) aur Port Ratio (`--port-ratio`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
`--top-ports N` top N most common ports scan karta hai. `--port-ratio` frequency ke basis par ports select karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Customizable speed vs coverage. Aap decide karo kitne ports scan karne hain based on time aur requirements.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Quick scan: `--top-ports 10`
- Balanced: `--top-ports 100`
- Thorough: `--top-ports 1000`
- Custom: `--port-ratio 0.1`

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Top 20 ports
nmap --top-ports 20 <target>

# Port ratio (0.1 = 10% most common)
nmap --port-ratio 0.1 <target>
```

Nmap `nmap-services` file mein har port ki frequency stored hai. Top ports wahi hain jo Internet par sabse zyada open milte hain.

### 6. ğŸ‘ Pros (Fayde)
- Flexible (aap control karo)
- Time vs coverage balance
- Predictable scan time

### 7. ğŸ‘ Cons (Nuksaan)
- Uncommon services miss
- Ratio confusing ho sakta hai
- Not comprehensive

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --top-ports <N> <target>
nmap --port-ratio <0.0-1.0> <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap --top-ports 10 scanme.nmap.org -v
nmap --top-ports 100 192.168.1.1 --open
nmap --port-ratio 0.1 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Time-based selection:
- 1 minute: `--top-ports 10`
- 5 minutes: `--top-ports 100`
- 30 minutes: `--top-ports 1000`
- Hours: `-p-`

**Common Mistake:** `--port-ratio` ko percentage samajhna. Yeh 0.0 to 1.0 hai (0.1 = 10%, not 10).

---

**ğŸ“ Module 9 Complete!**

Port selection aur scan speed master kar liya! Ab aap jante ho:
- Specific ports kaise select karein
- Fast vs thorough scanning
- Port knocking technique
- Top ports optimization

**Next:** Module 10 - Service & OS Detection ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ”¬ Module 10: Service & OS Detection (Kaun sa Software/OS hai?)

---

## ğŸ“š Topic 10.1: Service Version Detection (`-sV`)

### 1. ğŸ¯ Topic/Flag:
**Service Version Detection (`-sV`) - Software Version Pata Karna**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Open ports par chal rahi services ka naam aur version number detect karna (jaise Apache 2.4.41, OpenSSH 7.9).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Version pata hone se aap specific vulnerabilities dhondh sakte ho. "Apache 2.4.41" Google karo aur CVEs mil jayenge.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Vulnerability research (searchsploit, exploit-db)
- CVE matching (specific version = specific exploits)
- Outdated software identification
- Compliance checking

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sV <target>
```

**Process:**
1. Port scan (kaun se ports open)
2. Service probes bhejta hai (specific requests)
3. Response analyze karta hai
4. `nmap-service-probes` database se match karta hai
5. Service name + version display karta hai

**Example Output:**
```
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
```

### 6. ğŸ‘ Pros (Fayde)
- Accurate version information
- Vulnerability research easy
- Exploit selection precise

### 7. ğŸ‘ Cons (Nuksaan)
- Slow (extra probes bhejta hai)
- Noisy (logs mein dikhta hai)
- Kuch services version hide karti hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -sV <target>
nmap -sV -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sV scanme.nmap.org -v
nmap -sV -p 22,80,443 192.168.1.1
nmap -sS -sV --top-ports 100 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-sV` results ko directly searchsploit mein use karo:
```bash
nmap -sV 192.168.1.1 -oX scan.xml
searchsploit --nmap scan.xml
```

**Common Mistake:** Har scan mein `-sV` use karna. Yeh slow hai, sirf final detailed scan mein use karo.

---

## ğŸ“š Topic 10.2: Version Intensity (`--version-light`, `--version-all`)

### 1. ğŸ¯ Topic/Flag:
**Version Detection Intensity - Light (2) to All (9)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Version detection ki "depth" control karna - light (fast, kam accurate) ya all (slow, zyada accurate).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Time vs accuracy trade-off. Quick scan chahiye toh light, complete info chahiye toh all.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Light (2):** Quick recon, hundreds of hosts
- **Default (7):** Normal pentesting
- **All (9):** Stubborn services, complete accuracy

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**Intensity Levels (0-9):**
- **0:** Banner grabbing only
- **2 (`--version-light`):** Light probes
- **7 (default):** Standard probes
- **9 (`--version-all`):** All possible probes

```bash
# Light (fast)
nmap -sV --version-light <target>

# All (slow but thorough)
nmap -sV --version-all <target>

# Custom intensity
nmap -sV --version-intensity 5 <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Customizable speed
- Accuracy control
- Resource management

### 7. ğŸ‘ Cons (Nuksaan)
- Light = less accurate
- All = very slow
- Confusing for beginners

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -sV --version-light <target>
nmap -sV --version-all <target>
nmap -sV --version-intensity <0-9> <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sV --version-light scanme.nmap.org -p 80
nmap -sV --version-all scanme.nmap.org -p 22
nmap -sV --version-intensity 5 192.168.1.1
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Pehle `--version-light` try karo. Agar version nahi mila, tab `--version-all` use karo us specific port par.

**Common Mistake:** Har port par `--version-all` use karna. Bahut slow ho jayega. Sirf stubborn services par use karo.

---

## ğŸ“š Topic 10.3: OS Detection (`-O`)

### 1. ğŸ¯ Topic/Flag:
**OS Detection (`-O`) - Operating System Fingerprinting**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Target machine ka operating system detect karna (Windows, Linux, macOS, etc.) aur version guess karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
OS pata hone se exploit selection easy. Windows exploits Linux par kaam nahi karenge. OS-specific attacks plan kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Exploit selection (Windows vs Linux)
- Attack strategy (OS-specific vulnerabilities)
- Network mapping (kaun sa OS kahan hai)
- Compliance (outdated OS versions)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -O <target>
```

**Fingerprinting Techniques:**
1. TCP/IP stack behavior
2. ICMP responses
3. TCP window sizes
4. TCP options
5. Sequence number patterns

**Example Output:**
```
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.9
```

### 6. ğŸ‘ Pros (Fayde)
- OS identification
- Version guessing
- Network inventory

### 7. ğŸ‘ Cons (Nuksaan)
- Requires root/admin
- Not always accurate
- Slow (extra probes)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
sudo nmap -O <target>
nmap -O -Pn <target>
```

### 9. ğŸ’» Practice Command
```bash
sudo nmap -O scanme.nmap.org -v
sudo nmap -O -Pn 192.168.1.1
sudo nmap -O --osscan-guess scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `-O` ko hamesha `-Pn` ke saath use karo agar firewall hai:
```bash
sudo nmap -O -Pn <target>
```

**Common Mistake:** Bina root ke `-O` chalana. Error aayega ya inaccurate results.

---

## ğŸ“š Topic 10.4: OS Scan Limits (`--max-os-retries`, `--osscan-limit`)

### 1. ğŸ¯ Topic/Flag:
**OS Detection Optimization - Retries aur Limits**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
OS detection ko optimize karna - kitni baar try kare aur kab skip kare.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Time bachana. Agar host OS detection ke liye suitable nahi, toh skip karo.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Large network scans (time save)
- Unreliable networks (kam retries)
- Targeted OS detection (sirf promising hosts)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Max retries (default 5)
nmap -O --max-os-retries 2 <target>

# Only scan if at least 1 open + 1 closed port
nmap -O --osscan-limit <target>
```

**`--osscan-limit` Logic:**
- OS detection accurate tabhi hai jab open + closed ports dono hon
- Agar sirf open ya sirf closed, toh skip karo

### 6. ğŸ‘ Pros (Fayde)
- Time saving
- Resource optimization
- Better accuracy (sirf suitable hosts)

### 7. ğŸ‘ Cons (Nuksaan)
- Kuch hosts skip ho sakte hain
- Less comprehensive

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -O --max-os-retries <N> <target>
nmap -O --osscan-limit <target>
```

### 9. ğŸ’» Practice Command
```bash
sudo nmap -O --max-os-retries 2 scanme.nmap.org
sudo nmap -O --osscan-limit 192.168.1.0/24
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Large networks par hamesha `--osscan-limit` use karo:
```bash
sudo nmap -O --osscan-limit 192.168.1.0/24
```

**Common Mistake:** `--max-os-retries 0` use karna. Yeh OS detection disable kar dega.

---

## ğŸ“š Topic 10.5: OS Detection (SMB Script) - `smb-os-discovery`

### 1. ğŸ¯ Topic/Flag:
**SMB OS Discovery - Windows-Specific OS Detection**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
SMB protocol use karke Windows machines ka OS version, computer name, domain info detect karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
`-O` se zyada accurate Windows detection. Domain info bhi milti hai (Active Directory environments).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Windows domain mapping
- Computer names collection
- Workgroup identification
- Active Directory recon

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script smb-os-discovery <target>
```

**SMB Protocol Query:**
1. Port 445 (SMB) par connect
2. SMB handshake
3. OS version request
4. Computer name, domain, workgroup info

**Example Output:**
```
| smb-os-discovery:
|   OS: Windows 10 Pro 19041 (Windows 10 Pro 6.3)
|   Computer name: DESKTOP-ABC123
|   NetBIOS computer name: DESKTOP-ABC123
|   Domain name: WORKGROUP
|   FQDN: DESKTOP-ABC123
```

### 6. ğŸ‘ Pros (Fayde)
- Very accurate (Windows)
- Extra info (computer name, domain)
- No root required

### 7. ğŸ‘ Cons (Nuksaan)
- Sirf Windows par kaam karta hai
- SMB port (445) open hona chahiye
- Firewall block kar sakta hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script smb-os-discovery <target>
nmap -p 445 --script smb-os-discovery <target>
```

### 9. ğŸ’» Practice Command
```bash
nmap --script smb-os-discovery 192.168.1.100 -v
nmap -p 445 --script smb-os-discovery 192.168.1.0/24
nmap --script smb-os-discovery -sV 192.168.1.100
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Windows networks mein yeh `-O` se better hai:
```bash
nmap -p 445 --script smb-os-discovery 192.168.1.0/24 -oG - | grep "Windows"
```

**Common Mistake:** Linux targets par use karna. SMB sirf Windows par hota hai (ya Samba servers).

---

**ğŸ“ Module 10 Complete!**

Service aur OS detection master kar liya! Ab aap jante ho:
- Service versions kaise detect karein (`-sV`)
- Version intensity control (`--version-light/all`)
- OS fingerprinting (`-O`)
- SMB-based Windows detection

**Key Workflow:**
```bash
# Step 1: Port scan
nmap -sS --top-ports 1000 <target> -oG ports.txt

# Step 2: Service detection on open ports
nmap -sV -p <open-ports> <target> -oN services.txt

# Step 3: OS detection
sudo nmap -O --osscan-limit <target> -oN os.txt

# Step 4: Windows-specific (if applicable)
nmap --script smb-os-discovery <target> -oN smb.txt
```

**Next:** Module 11 - Output Formats ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ’¾ Module 11: Output Formats (Result Save Karna)

---

## ğŸ“š Topic 11.1: Normal Output (`-oN`)

### 1. ğŸ¯ Topic/Flag:
**Normal Output (`-oN`) - Human-Readable Format**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ke results ko ek text file mein save karna jo terminal output jaisa dikhta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Client ko report dene ke liye, documentation ke liye, aur baad mein reference ke liye results save karna zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Client reports
- Documentation
- Evidence collection
- Team collaboration

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS <target> -oN output.txt
```
Terminal par jo dikhta hai wahi file mein save ho jata hai.

### 6. ğŸ‘ Pros (Fayde)
- Human-readable
- Easy to share
- Simple format

### 7. ğŸ‘ Cons (Nuksaan)
- Parsing difficult
- No automation-friendly
- Large files

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap <scan> -oN <filename.txt>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS scanme.nmap.org -oN scan_results.txt
nmap -sV -p 80,443 192.168.1.1 -oN web_scan.txt
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Filename mein date add karo: `scan_2024-01-15.txt`

**Common Mistake:** Existing file overwrite ho jati hai. `--append-output` use karo append ke liye.

---

## ğŸ“š Topic 11.2: XML Output (`-oX`)

### 1. ğŸ¯ Topic/Flag:
**XML Output (`-oX`) - Machine-Readable Format**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Results ko XML format mein save karna jo tools aur scripts easily parse kar sakte hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Automation, Metasploit integration, aur data processing ke liye XML zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Metasploit import (`db_import`)
- Custom scripts (Python, Bash)
- HTML conversion
- Database storage

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS <target> -oX scan.xml
```
Structured XML format mein data save hota hai.

### 6. ğŸ‘ Pros (Fayde)
- Machine-readable
- Easy parsing
- Tool integration
- Structured data

### 7. ğŸ‘ Cons (Nuksaan)
- Not human-friendly
- Large file size
- Needs processing

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap <scan> -oX <filename.xml>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS scanme.nmap.org -oX scan.xml
nmap -A 192.168.1.1 -oX detailed_scan.xml
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** XML ko Metasploit mein import karo:
```bash
msfconsole
msf> db_import scan.xml
```

**Common Mistake:** XML file ko text editor mein directly padhna. Pehle convert karo ya tool use karo.

---

## ğŸ“š Topic 11.3: XML to HTML/CSV Conversion

### 1. ğŸ¯ Topic/Flag:
**XML Conversion - HTML aur CSV Format**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
XML output ko readable HTML ya spreadsheet-friendly CSV mein convert karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Client-friendly reports (HTML) aur data analysis (CSV) ke liye conversion zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Professional reports (HTML)
- Excel analysis (CSV)
- Management presentations
- Data visualization

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
**XML to HTML:**
```bash
xsltproc scan.xml -o scan.html
```

**XML to CSV (Python):**
```bash
pip install parsecpy
python parsecpy -x scan.xml -c scan.csv
```

### 6. ğŸ‘ Pros (Fayde)
- Client-friendly
- Easy sharing
- Data analysis

### 7. ğŸ‘ Cons (Nuksaan)
- Extra tools needed
- Conversion time
- Formatting issues

### 8. âŒ¨ï¸ Syntax (Command)
```bash
xsltproc <input.xml> -o <output.html>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS scanme.nmap.org -oX scan.xml
xsltproc scan.xml -o scan.html
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** HTML report browser mein kholo - professional dikhta hai!

**Common Mistake:** `xsltproc` install nahi hona. `apt-get install xsltproc` pehle karo.

---

## ğŸ“š Topic 11.4: Greppable Output (`-oG`)

### 1. ğŸ¯ Topic/Flag:
**Greppable Output (`-oG`) - Grep-Friendly Format**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Results ko ek line-per-host format mein save karna jo `grep`, `awk`, `cut` se easily filter ho sake.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Quick filtering aur command-line processing ke liye best format.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Quick filtering (`grep "open"`)
- Bash scripting
- One-liners
- Fast analysis

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS <target> -oG scan.gnmap
```
Har host ek line mein, easily greppable.

**Example:**
```
Host: 192.168.1.1 ()  Ports: 22/open/tcp//ssh///, 80/open/tcp//http///
```

### 6. ğŸ‘ Pros (Fayde)
- Grep-friendly
- One-liners easy
- Fast processing
- Bash scripting

### 7. ğŸ‘ Cons (Nuksaan)
- Less detailed
- Not pretty
- Deprecated (Nmap recommends XML)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap <scan> -oG <filename.gnmap>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS 192.168.1.0/24 -oG scan.gnmap
grep "open" scan.gnmap
grep "22/open" scan.gnmap | cut -d' ' -f2
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Extract sirf open ports wale IPs:
```bash
nmap -sS 192.168.1.0/24 -oG - | grep "open" | cut -d' ' -f2 > alive.txt
```

**Common Mistake:** `-oG` ko modern tool samajhna. Yeh legacy hai, XML prefer karo.

---

## ğŸ“š Topic 11.5: Script Kiddie Output (`-oS`)

### 1. ğŸ¯ Topic/Flag:
**Script Kiddie Output (`-oS`) - L33t Speak Format**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Results ko "l33t speak" (hacker slang) mein save karna - ek joke/easter egg feature.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh zaroori NAHI hai! Sirf fun ke liye hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Koi practical use nahi
- Sirf entertainment
- Nmap developers ka joke

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS <target> -oS kiddie.txt
```
Normal text ko l33t speak mein convert karta hai:
- `Service` â†’ `S3rv1c3`
- `Port` â†’ `P0rt`

### 6. ğŸ‘ Pros (Fayde)
- Fun
- Unique
- Conversation starter

### 7. ğŸ‘ Cons (Nuksaan)
- Useless
- Unprofessional
- Hard to read

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap <scan> -oS <filename.txt>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS scanme.nmap.org -oS kiddie.txt
cat kiddie.txt
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Kabhi client ko `-oS` output mat bhejo! Unprofessional hai.

**Common Mistake:** Isse seriously lena. Yeh sirf joke hai.

---

## ğŸ“š Topic 11.6: All Formats (`-oA`)

### 1. ğŸ¯ Topic/Flag:
**All Formats (`-oA`) - Ek Saath Sabhi Formats**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ek hi command se Normal, XML, aur Greppable - teeno formats mein output save karna.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Flexibility - baad mein jo format chahiye woh use karo. Sabse best practice hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Professional pentesting
- Complete documentation
- Multiple use cases
- Future-proofing

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS <target> -oA scan_results
```

**Creates 3 files:**
- `scan_results.nmap` (Normal)
- `scan_results.xml` (XML)
- `scan_results.gnmap` (Greppable)

### 6. ğŸ‘ Pros (Fayde)
- All formats ek saath
- Flexible
- Best practice
- Time-saving

### 7. ğŸ‘ Cons (Nuksaan)
- 3 files create hoti hain
- Disk space zyada
- Koi major con nahi

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap <scan> -oA <basename>
```

### 9. ğŸ’» Practice Command
```bash
nmap -sS scanme.nmap.org -oA scan_results
ls scan_results.*
# Output: scan_results.nmap, scan_results.xml, scan_results.gnmap
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha `-oA` use karo! Yeh best practice hai:
```bash
nmap -sS -sV -p- <target> -oA full_scan_$(date +%Y%m%d)
```

**Common Mistake:** Sirf ek format save karna. Baad mein dusra format chahiye toh scan dubara karna padega.

---

**ğŸ“ Module 11 Complete!**

Output formats master kar liye! Ab aap jante ho:
- Normal (`-oN`): Human-readable
- XML (`-oX`): Machine-readable, Metasploit import
- Greppable (`-oG`): Command-line filtering
- Script Kiddie (`-oS`): Fun (useless)
- All formats (`-oA`): Best practice!

**Professional Workflow:**
```bash
# Always use -oA
nmap -sS -sV --top-ports 1000 <target> -oA scan_$(date +%Y%m%d)

# Then process as needed:
# - Read .nmap for quick review
# - Import .xml to Metasploit
# - Grep .gnmap for specific info
```

**Next:** Module 12 - NSE Basics ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ”§ Module 12: Nmap Scripting Engine (NSE) Basics

---

## ğŸ“š Topic 12.1: Default Script Scan (`-sC`)

### 1. ğŸ¯ Topic/Flag:
**Default Script Scan (`-sC`) - Safe Scripts Automatically**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ke built-in safe aur non-intrusive scripts ko automatically chalana jo common vulnerabilities aur service information detect karte hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh sabse quick aur safe tareeka hai initial reconnaissance ke liye. Bina manual script selection ke, aapko common vulnerabilities, service versions, aur misconfigurations ka pata chal jata hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Initial vulnerability assessment
- Service enumeration aur banner grabbing
- Common misconfigurations detect karna (default passwords, open shares)
- Client ko quick overview dena (safe scanning)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sC <target>
```
Yeh command "default" category ki saari scripts chalata hai. Yeh scripts safe hain aur target system ko harm nahi karte. Examples:
- `http-title`: Web page titles
- `ssh-hostkey`: SSH host keys
- `smb-os-discovery`: SMB OS information

### 6. ğŸ‘ Pros (Fayde)
- Safe aur non-intrusive (koi damage nahi)
- Comprehensive information gathering
- Time-saving (manual script selection nahi karna padta)
- Beginner-friendly

### 7. ğŸ‘ Cons (Nuksaan)
- Slow ho sakta hai (multiple scripts chalti hain)
- Limited scope (sirf safe scripts)
- Kuch advanced vulnerabilities miss ho sakte hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -sC <target>
# Ya equivalent
nmap --script=default <target>
```

### 9. ğŸ’» Practice Command
```bash
# Basic default script scan
nmap -sC scanme.nmap.org -v

# Service detection ke saath combine karo (recommended)
nmap -sC -sV scanme.nmap.org

# Specific ports par default scripts
nmap -sC -p 80,443,22 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Hamesha `-sC` ko `-sV` (service version detection) ke saath use karo: `nmap -sC -sV <target>`. Isse aapko service versions aur unke vulnerabilities dono ka pata chal jata hai. Yeh combination pentesting mein golden standard hai.

**Common Mistake:** `-sC` ko slow samajh kar skip karna. Lekin yeh scripts bahut valuable information dete hain jo manual enumeration mein hours lag sakte hain. Patience rakho aur hamesha use karo.

---

## ğŸ“š Topic 12.2: Script Help (`--script-help`)

### 1. ğŸ¯ Topic/Flag:
**Script Documentation (`--script-help`) - Built-in Manual**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Kisi specific NSE script ke baare mein detailed documentation, usage, aur examples dekhne ka built-in tareeka.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Har script ke different arguments aur use cases hote hain. Bina documentation ke aap script ka full potential use nahi kar sakte. Yeh time bachata hai aur mistakes avoid karta hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Script ke arguments samajhna (userdb, passdb, etc.)
- Usage examples dekhna
- Script ki capabilities aur limitations janna
- Troubleshooting (script kyun kaam nahi kar rahi)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script-help=<script-name>
```
Yeh command script ka complete documentation show karta hai including:
- Description
- Usage examples
- Arguments list
- Output format

### 6. ğŸ‘ Pros (Fayde)
- Built-in documentation (internet nahi chahiye)
- Examples included hain
- Arguments ki complete list
- Offline access

### 7. ğŸ‘ Cons (Nuksaan)
- Kuch scripts ka documentation incomplete ho sakta hai
- Terminal mein padhna mushkil ho sakta hai
- Koi interactive examples nahi

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script-help=<script-name>
# Multiple scripts
nmap --script-help=script1,script2
# Wildcard
nmap --script-help="http-*"
```

### 9. ğŸ’» Practice Command
```bash
# FTP brute-force script help
nmap --script-help=ftp-brute

# HTTP methods script help
nmap --script-help=http-methods

# All HTTP scripts help (wildcard)
nmap --script-help="http-*"

# SMB vulnerability scripts help
nmap --script-help="smb-vuln-*"
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Wildcard use karo category-wise help dekhne ke liye: `nmap --script-help="vuln"` ya `nmap --script-help="http-*"`. Isse aapko related scripts ka overview mil jata hai aur aap best script choose kar sakte ho.

**Common Mistake:** Script chalane se pehle help nahi padhna. Har script ke specific arguments hote hain (jaise userdb, passdb). Help padhne se aapko pata chal jata hai ki script ko properly kaise configure karna hai.

---

## ğŸ“š Topic 12.3: Script Arguments (`--script-args`)

### 1. ğŸ¯ Topic/Flag:
**Script Arguments (`--script-args`) - Custom Parameters**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
NSE scripts ko custom parameters aur arguments dena taaki aap apne specific requirements ke hisaab se scripts ko configure kar sako.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Default arguments se limited results milte hain. Custom wordlists, specific usernames, timeout values, aur other parameters set karke aap zyada effective aur targeted attacks kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Brute-force attacks mein custom wordlists use karna
- Specific usernames/passwords test karna
- Timeout values adjust karna (slow networks ke liye)
- Custom HTTP headers ya cookies set karna

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script=ftp-brute --script-args userdb=users.txt,passdb=passwords.txt <target>
```
Arguments comma-separated hote hain, no spaces. Common arguments:
- `userdb`: Username wordlist
- `passdb`: Password wordlist  
- `http.useragent`: Custom User-Agent
- `timeout`: Connection timeout

### 6. ğŸ‘ Pros (Fayde)
- Highly customizable
- Targeted attacks possible
- Custom wordlists use kar sakte ho
- Performance tuning possible

### 7. ğŸ‘ Cons (Nuksaan)
- Complex syntax (spaces nahi hone chahiye)
- Har script ke alag arguments hote hain
- Typos se scripts fail ho sakti hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script=<script> --script-args arg1=value1,arg2=value2 <target>
```

### 9. ğŸ’» Practice Command
```bash
# SSH brute-force with custom wordlists
nmap --script ssh-brute --script-args userdb=/usr/share/nmap/nselib/data/usernames.lst,passdb=/usr/share/nmap/nselib/data/passwords.lst -p 22 <target>

# HTTP brute-force with custom path
nmap --script http-brute --script-args http-brute.path=/admin/ -p 80 <target>

# SMB brute-force with specific users
nmap --script smb-brute --script-args userdb=users.txt,passdb=pass.txt -p 445 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Apne custom wordlists banao company-specific information ke saath. Jaise company name, employee names, common passwords. Yeh generic wordlists se zyada effective hote hain: `echo -e "admin\nadministrator\n<company-name>\n<ceo-name>" > custom_users.txt`

**Common Mistake:** Arguments mein spaces dena. `userdb=file.txt, passdb=pass.txt` GALAT hai. Sahi syntax: `userdb=file.txt,passdb=pass.txt` (no spaces after comma).

---

## ğŸ“š Topic 12.4: Specific Script (`--script=script-name`)

### 1. ğŸ¯ Topic/Flag:
**Specific Script Execution (`--script=script-name`) - Targeted Testing**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Ek ya multiple specific NSE scripts ko manually select karke chalana, instead of categories ya default scripts.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aapko specific vulnerability check karni ho (jaise CVE-2017-0144 EternalBlue) ya targeted enumeration karni ho, toh specific scripts zyada efficient aur fast hote hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Specific CVE vulnerabilities check karna
- Targeted service enumeration (sirf SMB, sirf HTTP)
- Known exploits test karna
- Custom vulnerability assessment

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script=smb-vuln-ms17-010 -p 445 <target>
```
Yeh sirf specified script chalata hai. Multiple scripts comma-separated list kar sakte ho:
```bash
nmap --script=script1,script2,script3 <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Fast execution (sirf required scripts)
- Precise testing
- Less noise (unwanted scripts nahi chalti)
- Resource efficient

### 7. ğŸ‘ Cons (Nuksaan)
- Script names yaad rakhne padà¤¤à¥‡ hain
- Manual selection required
- Kuch important scripts miss ho sakte hain

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Single script
nmap --script=<script-name> <target>

# Multiple scripts
nmap --script=script1,script2,script3 <target>
```

### 9. ğŸ’» Practice Command
```bash
# EternalBlue vulnerability check
nmap --script=smb-vuln-ms17-010 -p 445 <target>

# HTTP title aur methods check
nmap --script=http-title,http-methods -p 80 <target>

# FTP anonymous login check
nmap --script=ftp-anon -p 21 <target>

# SSL certificate information
nmap --script=ssl-cert -p 443 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Common vulnerability scripts ko bookmark kar lo: `smb-vuln-ms17-010` (EternalBlue), `http-vuln-cve2017-5638` (Struts), `ssl-heartbleed` (Heartbleed). Yeh scripts pentesting mein frequently use hote hain.

**Common Mistake:** Script name mein typo karna. Agar script exist nahi karti, toh Nmap error nahi deta, bas skip kar deta hai. Hamesha `--script-help` se verify karo ki script name correct hai.

---

## ğŸ“š Topic 12.5: Wildcard Scripts (`--script="http-*"`)

### 1. ğŸ¯ Topic/Flag:
**Wildcard Pattern Scripts (`--script="pattern*"`) - Category-wise Testing**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Wildcard patterns use karke multiple related scripts ko ek saath chalana, jaise saari HTTP scripts ya saari SMB scripts.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aapko specific service ki comprehensive testing karni ho (jaise web server ki saari vulnerabilities check karni ho), toh wildcard se saari related scripts ek saath chal jati hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Web application testing (`http-*`)
- SMB enumeration (`smb-*`)
- SSH testing (`ssh-*`)
- Vulnerability scanning (`vuln*`)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script="http-*" -p 80 <target>
```
Yeh saari scripts chalata hai jo "http-" se start hoti hain. Boolean operators bhi use kar sakte ho:
```bash
nmap --script="http-* and not http-brute" <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Comprehensive testing
- Time-saving (manual selection nahi karna padta)
- Category-wise organization
- Boolean operators support

### 7. ğŸ‘ Cons (Nuksaan)
- Slow execution (bahut saari scripts chalti hain)
- Unwanted scripts bhi chal sakti hain
- Resource intensive

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic wildcard
nmap --script="<pattern>*" <target>

# With Boolean operators
nmap --script="<pattern>* and not <exclude-pattern>" <target>
```

### 9. ğŸ’» Practice Command
```bash
# All HTTP scripts
nmap --script="http-*" -p 80 scanme.nmap.org

# All SMB scripts except brute-force
nmap --script="smb-* and not smb-brute" -p 445 <target>

# All SSH scripts
nmap --script="ssh-*" -p 22 <target>

# All vulnerability scripts
nmap --script="vuln*" <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Boolean operators use karke unwanted scripts exclude karo: `--script="http-* and not http-brute and not http-slowloris"`. Isse aapko comprehensive testing milti hai lekin dangerous scripts nahi chalti.

**Common Mistake:** Quotes use karna bhoolna. `--script=http-*` kaam nahi karega, `--script="http-*"` correct syntax hai. Bina quotes ke shell wildcard expand kar deta hai.

---

## ğŸ“š Topic 12.6: Update Database (`--script-updatedb`)

### 1. ğŸ¯ Topic/Flag:
**NSE Database Update (`--script-updatedb`) - Script Database Refresh**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ke NSE script database ko update karna taaki naye scripts aur categories properly recognize ho saken.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aap naye scripts install karte ho ya Nmap update karte ho, toh database update karna zaroori hai. Bina update ke naye scripts available nahi honge.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Nmap update ke baad database refresh karna
- Custom scripts install karne ke baad
- Script categories update karna
- Troubleshooting (jab scripts detect nahi ho rahi)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script-updatedb
```
Yeh command:
- `/usr/share/nmap/scripts/` directory scan karta hai
- Script categories update karta hai
- `script.db` file regenerate karta hai
- Naye scripts ko database mein add karta hai

### 6. ğŸ‘ Pros (Fayde)
- Latest scripts available ho jati hain
- Categories properly organized hoti hain
- Custom scripts recognize ho jati hain
- Fast execution (database indexed hoti hai)

### 7. ğŸ‘ Cons (Nuksaan)
- Internet connection chahiye (agar scripts download kar rahe ho)
- Time lagta hai (large script directory ke liye)
- Root/admin privileges chahiye

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script-updatedb
# Linux mein sudo chahiye
sudo nmap --script-updatedb
```

### 9. ğŸ’» Practice Command
```bash
# Basic update
sudo nmap --script-updatedb

# Check script database location
ls -la /usr/share/nmap/scripts/script.db

# Verify update worked
nmap --script-help=all | grep "Categories:"

# Check total scripts count
ls /usr/share/nmap/scripts/*.nse | wc -l
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Har Nmap update ke baad yeh command chalao. Agar aap custom scripts develop karte ho ya GitHub se naye scripts download karte ho, toh unhe `/usr/share/nmap/scripts/` mein copy karke `--script-updatedb` chalao.

**Common Mistake:** Update karna bhoolna. Agar naye scripts install karne ke baad database update nahi kiya, toh Nmap unhe recognize nahi karega aur "script not found" error dega.

---

**ğŸ“ Module 12 Complete!**

NSE Basics master kar liye! Ab aap jante ho:
- **Default Scripts (`-sC`):** Safe aur comprehensive initial scanning
- **Script Help (`--script-help`):** Built-in documentation aur examples
- **Script Arguments (`--script-args`):** Custom parameters aur wordlists
- **Specific Scripts (`--script=name`):** Targeted vulnerability testing
- **Wildcard Patterns (`--script="http-*"`):** Category-wise comprehensive testing
- **Database Update (`--script-updatedb`):** Latest scripts aur categories

**Professional NSE Workflow:**
```bash
# 1. Update database first
sudo nmap --script-updatedb

# 2. Initial safe scanning
nmap -sC -sV <target> -oA initial_scan

# 3. Targeted vulnerability testing
nmap --script="vuln*" <target> -oA vuln_scan

# 4. Service-specific testing
nmap --script="http-*" -p 80,443 <target>
nmap --script="smb-*" -p 445 <target>
```

**Next:** Module 13 - NSE Categories (vuln, exploit, dos, intrusive) ğŸš€

=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ­ Module 13: NSE Script Categories (Attack Types)

---

## ğŸ“š Topic 13.1: Categories (`safe`, `default`)

### 1. ğŸ¯ Topic/Flag:
**NSE Script Categories - Safe aur Default**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
NSE scripts ko categories mein organize kiya gaya hai based on unke behavior aur risk level. `safe` aur `default` sabse common categories hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Category-based scanning se aap control kar sakte ho ki kitna aggressive scan karna hai. Safe scripts target ko harm nahi karte, default scripts balanced hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Initial reconnaissance: `safe` category
- Standard pentesting: `default` category
- Client-approved testing: Safe scripts se shuru karo
- Risk management: Category se risk level control karo

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Safe Category:**
```bash
nmap --script=safe <target>
```
- Non-intrusive scripts
- Target ko harm nahi karte
- Information gathering only
- Client approval ke liye best

**Default Category:**
```bash
nmap --script=default <target>
# Ya simply
nmap -sC <target>
```
- Balanced scripts
- Safe + useful scripts
- `-sC` flag automatically yeh category use karta hai

**Categories List:**
- `safe`: Non-intrusive, harmless
- `default`: Standard, balanced
- `intrusive`: Aggressive, risky
- `vuln`: Vulnerability detection
- `exploit`: Active exploitation
- `dos`: Denial of Service
- `malware`: Malware detection
- `auth`: Authentication testing
- `brute`: Brute-force attacks
- `discovery`: Network discovery
- `broadcast`: Broadcast/multicast

### 6. ğŸ‘ Pros (Fayde)
- Organized aur categorized
- Risk control easy
- Client-friendly (safe category)
- Flexible selection

### 7. ğŸ‘ Cons (Nuksaan)
- Kuch scripts multiple categories mein hain
- Category names confusing ho sakte hain
- Har script ka category yaad rakhna mushkil

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Single category
nmap --script=<category> <target>

# Multiple categories
nmap --script=safe,default <target>

# Combine with other options
nmap -sV --script=safe <target>
```

### 9. ğŸ’» Practice Command
```bash
# Safe scripts only
nmap --script=safe scanme.nmap.org -v

# Default scripts (same as -sC)
nmap --script=default scanme.nmap.org

# Safe + default combined
nmap --script=safe,default 192.168.1.1 -p 80,443

# With service detection
nmap -sV --script=safe,default scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Client ko report dete waqt hamesha mention karo ki kaun si category use ki. "We ran safe and default category scripts only" - yeh professional aur transparent lagta hai.

**Common Mistake:** Sabhi categories ek saath chalana (`--script=*`). Yeh bahut risky hai aur target ko crash kar sakta hai. Hamesha specific categories select karo.

---

## ğŸ“š Topic 13.2: Vulnerability Scan (`--script=vuln`)

### 1. ğŸ¯ Topic/Flag:
**Vulnerability Detection Scripts (`--script=vuln`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Sabhi vulnerability detection scripts ko ek saath chalana jo known CVEs aur security issues check karte hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Yeh pentesting ka sabse important part hai. Vulnerabilities dhoondhna hi pentester ka main kaam hai. `vuln` category automatically sabhi vulnerability scripts run karti hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- CVE detection (jaise Heartbleed, EternalBlue)
- Known vulnerability scanning
- Exploit selection (vulnerability mili toh exploit dhoondhne)
- Client reporting (vulnerabilities list banana)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

```bash
nmap --script=vuln <target>
```

**Process:**
1. Nmap sabhi `vuln` category scripts load karta hai
2. Har script specific vulnerability check karta hai
3. Agar vulnerability milti hai, detailed output deta hai
4. CVE numbers aur references provide karta hai

**Common Vulnerabilities Detected:**
- **Heartbleed** (CVE-2014-0160): OpenSSL vulnerability
- **MS17-010** (EternalBlue): Windows SMB vulnerability
- **Shellshock**: Bash vulnerability
- **SQL Injection**: Web application vulnerability
- **XSS** (Cross-Site Scripting): Web vulnerability
- **CSRF** (Cross-Site Request Forgery)

**Example Output:**
```
| http-vuln-cve2017-5638:
|   VULNERABLE:
|   Apache Struts Remote Code Execution
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-5638
|     Risk factor: High
|     Description: Apache Struts 2.3.5 - 2.3.31, 2.5 - 2.5.10 vulnerable to RCE
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638
```

### 6. ğŸ‘ Pros (Fayde)
- Comprehensive vulnerability detection
- CVE references automatic
- Time-saving (sabhi vuln scripts ek saath)
- Exploit research easy (CVE number se)

### 7. ğŸ‘ Cons (Nuksaan)
- Bahut slow (sabhi scripts run hoti hain)
- False positives possible
- Target ko crash kar sakta hai (kuch scripts intrusive)
- Network load zyada

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Basic vuln scan
nmap --script=vuln <target>

# With specific ports
nmap --script=vuln -p 80,443,445 <target>

# With service detection
nmap -sV --script=vuln <target>
```

### 9. ğŸ’» Practice Command
```bash
# Scan for all vulnerabilities
nmap --script=vuln scanme.nmap.org -v

# Web server vulnerability scan
nmap --script=vuln -p 80,443 testphp.vulnweb.com

# SMB vulnerabilities (EternalBlue check)
nmap --script=vuln -p 445 192.168.1.100

# Save results for reporting
nmap --script=vuln 192.168.1.1 -oA vuln_scan_results
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Vulnerability mili toh turant Google/Searchsploit mein CVE number search karo:
```bash
# Nmap se vulnerability scan
nmap --script=vuln <target> -oN vuln.txt

# CVE number nikalo aur exploit dhoondhne
searchsploit CVE-2017-5638
```

**Common Mistake:** `vuln` scan ko production servers par bina permission ke chalana. Kuch vulnerability scripts intrusive hain aur service crash kar sakte hain. Hamesha client se permission lo aur off-hours mein scan karo.

---

## ğŸ“š Topic 13.3: DoS Scan (`--script=dos`)

### 1. ğŸ¯ Topic/Flag:
**Denial of Service Detection (`--script=dos`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Scripts jo check karti hain ki target DoS (Denial of Service) attacks ke liye vulnerable hai ya nahi.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
DoS vulnerabilities critical hain kyunki ek attacker service ko down kar sakta hai. Pentester ko yeh identify karna hota hai taaki client fix kar sake.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- DoS vulnerability detection
- Service availability testing
- Resilience testing
- **WARNING:** Yeh scripts target ko actually crash kar sakte hain!

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

```bash
nmap --script=dos <target>
```

**Process:**
1. DoS category scripts load hoti hain
2. Har script specific DoS vulnerability test karti hai
3. Kuch scripts actually malformed packets bhejti hain
4. Agar service crash hoti hai = Vulnerable

**Common DoS Vulnerabilities:**
- **SYN Flood**: TCP SYN packets se overwhelm karna
- **Slowloris**: HTTP connections ko slow rakhna
- **Ping of Death**: Oversized ICMP packets
- **Teardrop**: Fragmented packets se crash
- **SMBLoris**: SMB connections exhaust karna

**DANGER:**
DoS scripts **actually target ko crash kar sakti hain**! Production environments mein bahut careful rehna.

### 6. ğŸ‘ Pros (Fayde)
- DoS vulnerabilities identify
- Service resilience test
- Critical issues dhoondhne

### 7. ğŸ‘ Cons (Nuksaan)
- **Target crash ho sakta hai** (biggest risk!)
- Service downtime
- Client angry ho sakta hai
- Legal issues (bina permission ke)

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# DoS vulnerability scan
nmap --script=dos <target>

# Specific port
nmap --script=dos -p 80 <target>
```

### 9. ğŸ’» Practice Command
```bash
# ONLY on test environments!
nmap --script=dos 192.168.1.100 -p 80

# Check specific DoS vulnerability
nmap --script=http-slowloris-check testphp.vulnweb.com -p 80
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** DoS scripts ko **KABHI BHI** production par mat chalao bina explicit written permission ke. Hamesha test environment ya off-hours mein chalao. Client ko pehle warn karo ki "service temporarily unavailable ho sakti hai".

**Common Mistake:** DoS scan ko casually chalana. Yeh sabse risky category hai. Agar service crash hui aur client ko pata nahi tha, toh aap legal trouble mein aa sakte ho. Hamesha documented permission lo.

---

## ğŸ“š Topic 13.4: Exploit Scan (`--script=exploit`)

### 1. ğŸ¯ Topic/Flag:
**Active Exploitation Scripts (`--script=exploit`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Scripts jo sirf vulnerability detect nahi karti, balki actively exploit bhi karti hain (jaise RCE - Remote Code Execution).

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Vulnerability dhoondhna alag baat hai, use exploit karna alag. `exploit` category proof-of-concept attacks chalati hai to demonstrate impact.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Proof of Concept (PoC) exploitation
- Impact demonstration (client ko dikhana ki kitna serious hai)
- RCE (Remote Code Execution) testing
- **WARNING:** Yeh actual attacks hain, sirf authorized pentesting mein use karo!

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

```bash
nmap --script=exploit <target>
```

**Process:**
1. Exploit scripts load hoti hain
2. Known exploits try karti hain
3. Agar successful = Target compromised
4. Output mein exploitation details

**Common Exploits:**
- **MS17-010** (EternalBlue): SMB RCE
- **Shellshock**: Bash command injection
- **Struts RCE**: Apache Struts exploitation
- **SQL Injection**: Database exploitation
- **File Upload**: Malicious file upload

**Example:**
```
| http-vuln-cve2017-5638:
|   VULNERABLE:
|   Apache Struts Remote Code Execution
|     State: VULNERABLE (Exploitable)
|     Exploit: Successfully executed 'whoami' command
|     Output: www-data
```

### 6. ğŸ‘ Pros (Fayde)
- Actual exploitation (proof of impact)
- Client ko serious issue samajh aata hai
- Penetration depth (kitna andar ja sakte ho)
- Real-world attack simulation

### 7. ğŸ‘ Cons (Nuksaan)
- **Highly risky** (target compromise ho sakta hai)
- Legal implications (bina permission ke crime)
- Data loss possible
- Service disruption

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Exploit scan (DANGEROUS!)
nmap --script=exploit <target>

# Specific exploit
nmap --script=smb-vuln-ms17-010 -p 445 <target>
```

### 9. ğŸ’» Practice Command
```bash
# ONLY with written permission!
nmap --script=exploit testphp.vulnweb.com -p 80

# SMB exploitation check
nmap --script=smb-vuln-ms17-010 192.168.1.100 -p 445

# Web application exploitation
nmap --script=http-shellshock --script-args uri=/cgi-bin/test.sh <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Exploit scripts chalane se pehle hamesha client se **signed authorization letter** lo jisme explicitly likha ho: "You are authorized to perform active exploitation including but not limited to remote code execution." Yeh aapki legal protection hai.

**Common Mistake:** Exploit scripts ko "testing" ke naam par chalana. Yeh actual attacks hain. Agar aap bina permission ke RCE exploit chalate ho aur pakde jaate ho, toh yeh Computer Fraud and Abuse Act (USA) ya IT Act 2000 (India) ke under crime hai. Jail ho sakti hai!

---

## ğŸ“š Topic 13.5: Intrusive & Malware Scan

### 1. ğŸ¯ Topic/Flag:
**Intrusive Scripts (`intrusive`) aur Malware Detection (`http-malware-host`)**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
`intrusive` category mein aggressive scripts hain jo target ko harm kar sakti hain. `malware` scripts check karti hain ki target malware host kar raha hai ya nahi.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Intrusive testing se deep vulnerabilities milti hain. Malware detection se compromised servers identify hote hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Intrusive:** Deep penetration testing, aggressive enumeration
- **Malware:** Compromised server detection, malware hosting check
- Incident response (kya server already hacked hai?)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Intrusive Scripts:**
```bash
nmap --script=intrusive <target>
```
- Aggressive brute-force attacks
- Heavy enumeration
- Resource-intensive scans
- May crash services

**Malware Detection:**
```bash
nmap --script=http-malware-host <target>
```
- Checks if server hosts malware
- Google Safe Browsing API use karta hai
- Blacklist databases check karta hai

### 6. ğŸ‘ Pros (Fayde)
- **Intrusive:** Deep vulnerabilities, comprehensive testing
- **Malware:** Compromised servers identify, incident response

### 7. ğŸ‘ Cons (Nuksaan)
- **Intrusive:** Very risky, service crash, resource exhaustion
- **Malware:** False positives, API rate limits

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Intrusive scan
nmap --script=intrusive <target>

# Malware check
nmap --script=http-malware-host -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Intrusive scan (with permission!)
nmap --script=intrusive 192.168.1.100 -p 21,22,80

# Malware hosting check
nmap --script=http-malware-host scanme.nmap.org -p 80,443

# Check if website is blacklisted
nmap --script=http-google-malware testphp.vulnweb.com
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Intrusive scripts ko hamesha **last** mein chalao, jab aap safe aur default scripts se initial recon kar chuke ho. Aur hamesha client ko warn karo: "We will now run intrusive tests which may temporarily affect service availability."

**Common Mistake:** Intrusive scripts ko "default" samajhna. Yeh category naam mein hi "intrusive" hai - matlab aggressive aur risky. Production par kabhi bhi bina proper planning aur client approval ke mat chalao.

---

## ğŸ“š Topic 13.6: Boolean Expression (`--script="(default or broadcast) and not ssh-*"`)

### 1. ğŸ¯ Topic/Flag:
**Boolean Logic in Script Selection - AND, OR, NOT**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Multiple categories aur patterns ko combine karna using Boolean operators (AND, OR, NOT) for precise script selection.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Fine-grained control - aap exactly woh scripts chala sakte ho jo chahiye, aur jo nahi chahiye unhe exclude kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Complex filtering (specific scripts include/exclude)
- Category combinations
- Pattern matching with exclusions
- Custom scan profiles

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)

**Boolean Operators:**
- **AND:** Dono conditions true honi chahiye
- **OR:** Koi ek condition true ho
- **NOT:** Condition false honi chahiye

**Examples:**
```bash
# Default OR broadcast (dono categories)
nmap --script="default or broadcast" <target>

# Default AND safe (jo dono mein hain)
nmap --script="default and safe" <target>

# Default but NOT ssh scripts
nmap --script="default and not ssh-*" <target>

# Complex: (default OR vuln) AND NOT (dos OR exploit)
nmap --script="(default or vuln) and not (dos or exploit)" <target>
```

**Practical Example:**
```bash
# Run all HTTP scripts except brute-force
nmap --script="http-* and not http-brute" -p 80 <target>

# Safe + default but exclude slow scripts
nmap --script="(safe or default) and not *-slowloris*" <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Precise control
- Custom scan profiles
- Exclude risky scripts
- Combine multiple categories

### 7. ğŸ‘ Cons (Nuksaan)
- Complex syntax
- Easy to make mistakes
- Debugging difficult
- Quotes aur parentheses confusing

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script="<expression>" <target>

# Operators: and, or, not
# Grouping: ( )
# Wildcards: *
```

### 9. ğŸ’» Practice Command
```bash
# Default or broadcast
nmap --script="default or broadcast" 192.168.1.1

# All HTTP except brute-force
nmap --script="http-* and not http-brute" -p 80 scanme.nmap.org

# Safe + vuln but not dos
nmap --script="(safe or vuln) and not dos" 192.168.1.100

# Complex filtering
nmap --script="(default or discovery) and not (brute or dos)" <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Boolean expressions ko pehle test karo `--script-help` ke saath to see which scripts will run:
```bash
nmap --script-help="(default or vuln) and not dos"
# Yeh list dikhayega ki kaun si scripts run hongi
```

**Common Mistake:** Quotes bhoolna ya galat parentheses. Yeh error dega:
```bash
# WRONG
nmap --script=default or vuln <target>

# CORRECT
nmap --script="default or vuln" <target>
```
Hamesha double quotes use karo aur complex expressions mein parentheses properly balance karo!

---

**ğŸ“ Module 13 Complete!**

NSE Categories master kar liye! Ab aap jante ho:
- **Safe/Default:** Risk-based selection
- **Vuln:** Vulnerability detection (CVEs)
- **DoS:** Denial of Service testing (RISKY!)
- **Exploit:** Active exploitation (VERY RISKY!)
- **Intrusive/Malware:** Aggressive testing
- **Boolean Logic:** Precise script control

**Risk Levels:**
- ğŸŸ¢ Safe: No risk
- ğŸŸ¡ Default: Low risk
- ğŸŸ  Vuln: Medium risk
- ğŸ”´ Intrusive: High risk
- â›” DoS/Exploit: CRITICAL risk

**Next:** Module 14 - NSE for Reconnaissance ğŸš€


=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ” Module 14: NSE for Reconnaissance (Jaankari Nikaalna)

---

## ğŸ“š Topic 14.1: Traceroute (`--traceroute`, `traceroute-geolocation`)

### 1. ğŸ¯ Topic/Flag:
**Traceroute & Geolocation - Network Path Discovery**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Network path tracing jo dikhata hai ki aapka packet target tak pahunchne ke liye kaun se routers/hops se guzarta hai, aur geolocation se unki physical location bhi pata kar sakte hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Network topology samajhne ke liye, firewall/IDS locations identify karne ke liye, aur target ki geographical location aur ISP information nikalne ke liye zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Network infrastructure mapping
- Firewall aur IDS locations identify karna
- ISP aur hosting provider information
- Geographical location tracking
- Network bottlenecks aur filtering points dhoondhna

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --traceroute <target>
```
TTL (Time To Live) values incrementally increase karta hai aur har hop se ICMP Time Exceeded messages collect karta hai. Geolocation script IP addresses ko physical locations se map karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Network path visualization
- Geographical information
- ISP aur hosting details
- Firewall detection possible

### 7. ğŸ‘ Cons (Nuksaan)
- Slow process (multiple hops)
- Kuch routers respond nahi karte
- Geolocation accuracy variable hai

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --traceroute <target>
nmap --script traceroute-geolocation <target>
```

### 9. ğŸ’» Practice Command
```bash
# Basic traceroute
nmap --traceroute scanme.nmap.org

# Traceroute with geolocation
nmap --script traceroute-geolocation --script-args traceroute-geolocation.kml-file=trace.kml scanme.nmap.org

# Combined with port scan
nmap -sS -p 80,443 --traceroute google.com
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Traceroute results ko KML file mein save karke Google Earth mein visualize kar sakte ho: `--script-args traceroute-geolocation.kml-file=path.kml`. Isse client ko impressive geographical network map dikha sakte ho.

**Common Mistake:** Traceroute ko sirf "network debugging" tool samajhna. Pentesting mein yeh reconnaissance ka powerful tool hai jo target ki infrastructure aur geographical location reveal karta hai.

---

## ğŸ“š Topic 14.2: `robots.txt` Scan (`http-robots.txt`)

### 1. ğŸ¯ Topic/Flag:
**Robots.txt Discovery - Hidden Directories Enumeration**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Web servers ke robots.txt file ko automatically download aur analyze karna jo hidden directories, admin panels, aur sensitive paths reveal kar sakta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Robots.txt file mein developers aksar sensitive directories mention karte hain jo search engines se hide karna chahte hain. Yeh pentester ke liye goldmine hai hidden assets dhoondhne ke liye.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Hidden admin panels discover karna
- Backup files aur directories dhoondhna
- API endpoints aur documentation paths
- Development aur testing directories
- Sensitive configuration files

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script http-robots.txt -p 80,443 <target>
```
Script `/robots.txt` path par HTTP GET request bhejta hai aur response parse karta hai. "Disallow" entries ko extract karke potential interesting paths list karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Quick directory discovery
- No brute-force required
- Legitimate file (not suspicious)
- Often reveals admin areas

### 7. ğŸ‘ Cons (Nuksaan)
- Not all sites have robots.txt
- May contain outdated information
- Developers might not list sensitive paths

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script http-robots.txt -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Basic robots.txt scan
nmap --script http-robots.txt -p 80 scanme.nmap.org

# Multiple targets
nmap --script http-robots.txt -p 80,443 example.com,test.com

# With verbose output
nmap --script http-robots.txt -p 80 <target> -v
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Robots.txt mein mile paths ko manually browse karo. Aksar `/admin/`, `/backup/`, `/test/` jaise directories milte hain jo direct access allow karte hain. Yeh quick wins hain pentesting mein.

**Common Mistake:** Robots.txt results ko ignore karna. Developers sochte hain ki "Disallow" se paths hidden hain, lekin yeh actually roadmap hai attackers ke liye.

---

## ğŸ“š Topic 14.3: WAF Detect (`http-waf-detect`)

### 1. ğŸ¯ Topic/Flag:
**WAF Detection - Web Application Firewall Identification**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Web Application Firewall (WAF) ka detection karna jo web applications ko protect karta hai SQL injection, XSS, aur other attacks se.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
WAF detect karna zaroori hai kyunki agar WAF present hai, toh aapko evasion techniques use karni padegi. Bina WAF detection ke aapke payloads block ho jaenge.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Attack strategy planning (WAF bypass techniques)
- Payload modification requirements
- Rate limiting aur blocking thresholds
- WAF vendor identification (specific bypass methods)

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script http-waf-detect -p 80,443 <target>
```
Script malicious payloads bhejta hai aur response headers, status codes, aur content analyze karta hai. WAF signatures aur behavior patterns detect karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Early WAF detection
- Attack planning mein helpful
- Multiple WAF vendors detect karta hai
- False positive rate low hai

### 7. ğŸ‘ Cons (Nuksaan)
- Kuch advanced WAFs detect nahi ho sakte
- Detection attempts logged ho sakte hain
- Limited payload testing

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script http-waf-detect -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Basic WAF detection
nmap --script http-waf-detect -p 80,443 example.com

# With specific path
nmap --script http-waf-detect --script-args http-waf-detect.uri=/login -p 80 <target>

# Multiple paths testing
nmap --script http-waf-detect --script-args http-waf-detect.detectBodyChanges -p 80 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Agar WAF detect ho jaye, toh turant evasion planning shuru karo. CloudFlare detect hui hai toh IP-based bypass try karo, ModSecurity hai toh encoding techniques use karo.

**Common Mistake:** WAF detection ko ignore karke direct attacks karna. Isse aapka IP block ho sakta hai aur further testing impossible ho jati hai.

---

## ğŸ“š Topic 14.4: WAF Fingerprint (`http-waf-fingerprint` vs `wafw00f`)

### 1. ğŸ¯ Topic/Flag:
**WAF Fingerprinting - Detailed WAF Identification**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
WAF ka detailed fingerprinting karna jo specific vendor, version, aur configuration details reveal karta hai. Nmap script aur external tool `wafw00f` dono available hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Specific WAF vendor aur version pata hone se targeted bypass techniques use kar sakte ho. Har WAF ke alag weaknesses aur bypass methods hote hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Vendor-specific bypass techniques
- Known CVEs aur vulnerabilities
- Configuration weaknesses exploitation
- Evasion payload customization

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Nmap method
nmap --script http-waf-fingerprint -p 80,443 <target>

# wafw00f method
wafw00f <target>
```
Multiple test payloads bhejta hai aur response patterns analyze karta hai. Vendor signatures, error messages, aur behavior patterns match karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Detailed vendor information
- Version detection possible
- Multiple detection methods
- Bypass strategy planning

### 7. ğŸ‘ Cons (Nuksaan)
- Detection attempts logged
- Some WAFs have anti-fingerprinting
- Requires multiple requests

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Nmap fingerprinting
nmap --script http-waf-fingerprint -p 80,443 <target>

# wafw00f tool
wafw00f https://example.com
wafw00f -a https://example.com  # All tests
```

### 9. ğŸ’» Practice Command
```bash
# Nmap WAF fingerprinting
nmap --script http-waf-fingerprint -p 443 example.com

# wafw00f comprehensive scan
wafw00f -a -v https://example.com

# Multiple targets with wafw00f
wafw00f -l targets.txt
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `wafw00f` generally zyada accurate hai Nmap script se. Dono tools use karo cross-verification ke liye. Agar CloudFlare detect ho, toh origin IP dhoondhne ki koshish karo (censys.io, shodan.io).

**Common Mistake:** Sirf detection par ruk jana. WAF fingerprint karne ke baad specific bypass techniques research karo us vendor ke liye.

---

## ğŸ“š Topic 14.5: Email Enumeration (`http-grep`)

### 1. ğŸ¯ Topic/Flag:
**Email Address Harvesting - Contact Information Extraction**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Web pages se email addresses automatically extract karna using pattern matching aur regex techniques.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Email addresses social engineering, phishing campaigns, aur OSINT ke liye valuable hain. Employee emails se company structure aur naming conventions pata chalte hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Phishing campaign targets
- Social engineering reconnaissance
- Employee enumeration
- Domain naming patterns
- Contact information for social engineering

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script http-grep --script-args http-grep.match='[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}' -p 80,443 <target>
```
Web pages download karta hai aur regex patterns use karke email addresses extract karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Automated email harvesting
- Custom regex patterns
- Multiple pages scanning
- No manual browsing required

### 7. ğŸ‘ Cons (Nuksaan)
- Limited to visible content
- JavaScript-generated emails miss ho sakte hain
- Rate limiting issues

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script http-grep --script-args http-grep.match='<regex-pattern>' -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Email extraction
nmap --script http-grep --script-args http-grep.match='[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}' -p 80 example.com

# Phone number extraction
nmap --script http-grep --script-args http-grep.match='\d{3}-\d{3}-\d{4}' -p 80 <target>

# Custom pattern matching
nmap --script http-grep --script-args http-grep.match='admin|password|secret' -p 80 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Email addresses se company naming convention samajho. Agar `john.doe@company.com` mila, toh `firstname.lastname@company.com` pattern try karo other employees ke liye.

**Common Mistake:** Sirf email extraction par focus karna. Phone numbers, addresses, aur other sensitive information bhi extract kar sakte ho custom regex se.

---

## ğŸ“š Topic 14.6: Sitemap Generator (`http-sitemap-generator`)

### 1. ğŸ¯ Topic/Flag:
**Sitemap Generation - Website Structure Mapping**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Website ka complete sitemap generate karna jo saare accessible pages, directories, aur files ko systematically map karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Website ki complete structure samajhne ke liye, hidden pages discover karne ke liye, aur attack surface mapping ke liye zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Complete website mapping
- Hidden pages discovery
- Directory structure analysis
- Attack surface enumeration
- Content management system identification

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --script http-sitemap-generator -p 80,443 <target>
```
Starting page se crawling shuru karta hai, saare links follow karta hai, aur systematic sitemap banata hai. Depth aur scope control kar sakte ho.

### 6. ğŸ‘ Pros (Fayde)
- Comprehensive website mapping
- Automated crawling
- Hidden content discovery
- Structured output

### 7. ğŸ‘ Cons (Nuksaan)
- Time-consuming for large sites
- May miss JavaScript-generated content
- Can trigger rate limiting

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --script http-sitemap-generator -p 80,443 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Basic sitemap generation
nmap --script http-sitemap-generator -p 80 example.com

# With depth control
nmap --script http-sitemap-generator --script-args http-sitemap-generator.maxdepth=3 -p 80 <target>

# Save to file
nmap --script http-sitemap-generator --script-args http-sitemap-generator.savefile=sitemap.txt -p 80 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Generated sitemap ko carefully analyze karo. Admin panels, backup files, aur development directories aksar sitemap mein hidden hote hain jo manual browsing mein miss ho jaà¤¤à¥‡ hain.

**Common Mistake:** Large websites par unlimited depth crawling karna. Hamesha `maxdepth` parameter set karo time aur resources bachane ke liye.

---

**ğŸ“ Module 14 Complete!**

NSE Reconnaissance techniques master kar liye! Ab aap jante ho:
- **Traceroute & Geolocation:** Network path aur geographical mapping
- **Robots.txt Scanning:** Hidden directories aur admin panels discovery
- **WAF Detection:** Web Application Firewall identification
- **WAF Fingerprinting:** Detailed vendor aur version detection
- **Email Enumeration:** Contact information aur employee harvesting
- **Sitemap Generation:** Complete website structure mapping

**Professional Reconnaissance Workflow:**
```bash
# 1. Network path analysis
nmap --traceroute --script traceroute-geolocation <target>

# 2. Web reconnaissance
nmap --script http-robots.txt,http-waf-detect,http-sitemap-generator -p 80,443 <target>

# 3. Information harvesting
nmap --script http-grep --script-args http-grep.match='[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}' -p 80,443 <target>

# 4. WAF detailed analysis (if detected)
wafw00f -a <target>
```

**Next:** Module 15 - Firewall/IDS Evasion (Chakma Dena) ğŸš€

=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ›¡ï¸ Module 15: Firewall/IDS Evasion (Chakma Dena)

---

## ğŸ“š Topic 15.1: Decoy Scan (`-D`)

### 1. ğŸ¯ Topic/Flag:
**Decoy Scan (`-D`) - IP Address Spoofing for Stealth**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Multiple fake IP addresses use karke scanning karna taaki real source IP hide ho jaye aur IDS/firewall logs mein confusion create ho.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
IDS aur firewall logs mein aapka real IP address hide karne ke liye. Agar multiple IPs se scan aa rahi hai, toh admin ko pata nahi chalega ki actual attacker kaun hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Real IP address hiding
- IDS signature evasion
- Log analysis confusion
- Attribution avoidance
- Stealth reconnaissance

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -sS -D 192.168.1.100,192.168.1.101,ME,192.168.1.102 <target>
```
Nmap multiple source IPs se packets bhejta hai. Target ko lagta hai ki multiple hosts se scan ho rahi hai. "ME" aapka real IP represent karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Real IP hiding
- IDS confusion
- Log analysis difficult
- Attribution masking

### 7. ğŸ‘ Cons (Nuksaan)
- Slower scanning
- Network congestion
- May trigger more alerts
- Requires valid decoy IPs

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -sS -D <decoy1>,<decoy2>,ME,<decoy3> <target>
# Random decoys
nmap -sS -D RND:10 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Manual decoy IPs
nmap -sS -D 192.168.1.100,192.168.1.101,ME,192.168.1.102 -p 80,443 scanme.nmap.org

# Random decoys
nmap -sS -D RND:5 -p 22,80,443 <target>

# With stealth scan
nmap -sS -D 10.0.0.1,10.0.0.2,ME -T2 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Decoy IPs hamesha target ke same network range se choose karo taaki realistic lage. Agar target 192.168.1.x network par hai, toh decoys bhi 192.168.1.x range se lo. `RND:10` se 10 random decoys generate ho jaà¤¤à¥‡ hain.

**Common Mistake:** Dead ya non-existent IPs ko decoy banana. Isse scan fail ho sakti hai. Hamesha live IPs use karo jo target network se reachable ho.

---

## ğŸ“š Topic 15.2: Select Interface (`-e`)

### 1. ğŸ¯ Topic/Flag:
**Interface Selection (`-e`) - Network Interface Control**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Specific network interface select karna jisse packets bhejne hain, especially jab multiple network interfaces available ho.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Jab aapke paas multiple network connections hain (WiFi, Ethernet, VPN), toh specific interface se scanning karke traffic routing control kar sakte ho aur detection avoid kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- VPN interface se scanning
- Specific network path selection
- Traffic routing control
- Interface-based evasion
- Network segmentation bypass

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -e eth0 -sS <target>
```
Nmap specified interface se packets bhejta hai instead of default routing. Yeh especially useful hai jab aap VPN ya specific network segment se scan karna chahte ho.

### 6. ğŸ‘ Pros (Fayde)
- Traffic routing control
- VPN usage possible
- Network path selection
- Interface-specific scanning

### 7. ğŸ‘ Cons (Nuksaan)
- Interface must be active
- Routing complexity
- May require root privileges
- Limited to available interfaces

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -e <interface> <target>
# Example
nmap -e eth0 -sS <target>
nmap -e tun0 -sS <target>  # VPN interface
```

### 9. ğŸ’» Practice Command
```bash
# List available interfaces first
ip addr show  # Linux
ipconfig      # Windows

# Scan via specific interface
nmap -e eth0 -sS -p 80,443 scanme.nmap.org

# Scan via VPN interface
nmap -e tun0 -sS <target>

# Wireless interface scanning
nmap -e wlan0 -sS <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** VPN interface (tun0, wg0) se scanning karne se aapka real IP hide ho jata hai. Pehle `ip addr show` se available interfaces check karo, phir VPN connect karke us interface se scan karo.

**Common Mistake:** Interface name galat likhna. Linux mein `eth0`, `wlan0`, `tun0` common hain. Windows mein interface names different hote hain. Hamesha pehle interfaces list karo.

---

## ğŸ“š Topic 15.3: Spoof MAC Address (`--spoof-mac`)

### 1. ğŸ¯ Topic/Flag:
**MAC Address Spoofing (`--spoof-mac`) - Hardware Identity Masking**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Network interface ka MAC address change karna taaki local network par aapki real hardware identity hide ho jaye.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Local network par MAC-based filtering bypass karne ke liye, device tracking avoid karne ke liye, aur network access control circumvention ke liye zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- MAC filtering bypass
- Device identity hiding
- Network access control evasion
- Wireless network penetration
- Local network stealth

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --spoof-mac 0 <target>        # Random MAC
nmap --spoof-mac AA:BB:CC:DD:EE:FF <target>  # Specific MAC
nmap --spoof-mac Dell <target>     # Vendor-specific MAC
```
Nmap packets mein spoofed MAC address use karta hai. Yeh sirf local network (same subnet) par effective hai.

### 6. ğŸ‘ Pros (Fayde)
- MAC filtering bypass
- Device identity masking
- Vendor impersonation
- Local network stealth

### 7. ğŸ‘ Cons (Nuksaan)
- Only works on local network
- May require root privileges
- Some networks detect MAC spoofing
- Limited effectiveness across routers

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --spoof-mac 0 <target>                    # Random MAC
nmap --spoof-mac <MAC-address> <target>        # Specific MAC
nmap --spoof-mac <vendor> <target>             # Vendor MAC
```

### 9. ğŸ’» Practice Command
```bash
# Random MAC spoofing
sudo nmap --spoof-mac 0 -sS 192.168.1.1

# Specific MAC spoofing
sudo nmap --spoof-mac AA:BB:CC:DD:EE:FF -sS 192.168.1.0/24

# Vendor-specific spoofing
sudo nmap --spoof-mac Dell -sS <target>
sudo nmap --spoof-mac Apple -sS <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Pehle legitimate device ka MAC address sniff karo (Wireshark se), phir us MAC se spoof karke network access lo. Corporate networks mein aksar specific vendors (Dell, HP) ke MACs ko whitelist karte hain.

**Common Mistake:** MAC spoofing ko Internet-wide effective samajhna. MAC address sirf local network (Layer 2) par kaam karta hai. Router cross karne ke baad MAC change ho jata hai.

---

## ğŸ“š Topic 15.4: Custom Source Port (`--source-port`)

### 1. ğŸ¯ Topic/Flag:
**Source Port Manipulation (`--source-port`) - Port-based Firewall Bypass**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Scanning packets ka source port manually set karna taaki firewall rules bypass ho saken jo specific ports ko allow karte hain.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Bahut saare firewalls trusted ports (53-DNS, 80-HTTP, 443-HTTPS) se aane wale traffic ko allow karte hain. Source port spoof karke yeh trust exploit kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Firewall rule bypass
- Port-based filtering evasion
- Trusted port impersonation
- Stateless firewall circumvention
- Network access control bypass

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --source-port 53 -sS <target>
```
Nmap packets mein specified source port use karta hai. Firewall sochà¤¤à¤¾ hai ki yeh trusted service (DNS, HTTP) se aa raha hai aur allow kar deta hai.

### 6. ğŸ‘ Pros (Fayde)
- Firewall bypass
- Trusted port impersonation
- Simple technique
- Effective against stateless firewalls

### 7. ğŸ‘ Cons (Nuksaan)
- Limited to stateless firewalls
- Modern firewalls detect this
- May conflict with legitimate traffic
- Requires specific firewall misconfigurations

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --source-port <port> <target>
# Common trusted ports
nmap --source-port 53 <target>   # DNS
nmap --source-port 80 <target>   # HTTP
nmap --source-port 443 <target>  # HTTPS
```

### 9. ğŸ’» Practice Command
```bash
# DNS source port (most common bypass)
nmap --source-port 53 -sS -p 22,80,443 <target>

# HTTP source port
nmap --source-port 80 -sS <target>

# HTTPS source port
nmap --source-port 443 -sS <target>

# Multiple scans with different source ports
for port in 53 80 443; do nmap --source-port $port -sS <target>; done
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Port 53 (DNS) sabse effective hai kyunki har network mein DNS traffic allow hoti hai. Agar 53 kaam nahi kare, toh 80 aur 443 try karo. Kuch firewalls NTP (123) aur SNMP (161) bhi allow karte hain.

**Common Mistake:** Modern stateful firewalls par yeh technique use karna. Stateful firewalls connection state track karte hain, sirf source port nahi. Yeh technique sirf old/misconfigured firewalls par kaam karti hai.

---

## ğŸ“š Topic 15.5: Fake TTL (`--ttl`)

### 1. ğŸ¯ Topic/Flag:
**TTL Manipulation (`--ttl`) - Packet Lifetime Spoofing**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Packets ka Time To Live (TTL) value manually set karna taaki network fingerprinting avoid ho aur IDS signatures bypass ho saken.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
IDS systems aksar TTL values se OS fingerprinting karte hain. Custom TTL set karke aap apna OS hide kar sakte ho aur detection avoid kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- OS fingerprinting evasion
- IDS signature bypass
- Network device impersonation
- Packet filtering evasion
- Stealth scanning

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --ttl 64 -sS <target>
```
Nmap packets mein specified TTL value set karta hai. Different operating systems ke default TTL values alag hote hain (Windows: 128, Linux: 64, Cisco: 255).

### 6. ğŸ‘ Pros (Fayde)
- OS fingerprinting evasion
- IDS signature bypass
- Device impersonation
- Simple implementation

### 7. ğŸ‘ Cons (Nuksaan)
- Limited effectiveness
- Modern IDS use multiple factors
- May not fool advanced systems
- Requires knowledge of target environment

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --ttl <value> <target>
# Common OS TTL values
nmap --ttl 64 <target>   # Linux/Unix
nmap --ttl 128 <target>  # Windows
nmap --ttl 255 <target>  # Cisco/Network devices
```

### 9. ğŸ’» Practice Command
```bash
# Linux TTL impersonation
nmap --ttl 64 -sS -p 80,443 <target>

# Windows TTL impersonation
nmap --ttl 128 -sS <target>

# Network device impersonation
nmap --ttl 255 -sS <target>

# Random TTL values
nmap --ttl $((RANDOM % 255 + 1)) -sS <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Target network ke legitimate devices ka TTL observe karo (Wireshark se), phir same TTL use karke blend in karo. Agar network mein mostly Windows machines hain, toh TTL 128 use karo.

**Common Mistake:** Random TTL values use karna. Har network environment mein specific TTL patterns hote hain. Pehle reconnaissance karo, phir appropriate TTL choose karo.

---

## ğŸ“š Topic 15.6: Relay Proxies (`--proxies`)

### 1. ğŸ¯ Topic/Flag:
**Proxy Chain (`--proxies`) - Traffic Routing Through Intermediaries**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap traffic ko proxy servers ke through route karna taaki real source IP hide ho aur geographical location masking ho sake.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Anonymity maintain karne ke liye, geographical restrictions bypass karne ke liye, aur attribution avoidance ke liye proxy chains zaroori hain.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- IP address hiding
- Geographical location masking
- Attribution avoidance
- Network restrictions bypass
- Anonymity maintenance

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap --proxies http://proxy1:8080,http://proxy2:3128 <target>
```
Nmap traffic ko specified proxy chain ke through route karta hai. Har proxy next proxy ko forward karta hai, creating a chain.

### 6. ğŸ‘ Pros (Fayde)
- Complete IP hiding
- Geographical masking
- Attribution avoidance
- Multiple proxy support

### 7. ğŸ‘ Cons (Nuksaan)
- Very slow scanning
- Proxy reliability issues
- Limited scan types support
- May leave traces on proxies

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --proxies <proxy-url> <target>
# Multiple proxies
nmap --proxies http://proxy1:8080,http://proxy2:3128 <target>
# SOCKS proxy
nmap --proxies socks4://proxy:1080 <target>
```

### 9. ğŸ’» Practice Command
```bash
# Single HTTP proxy
nmap --proxies http://proxy.example.com:8080 -sT -p 80,443 <target>

# Multiple proxy chain
nmap --proxies http://proxy1:8080,http://proxy2:3128 -sT <target>

# SOCKS proxy (Tor)
nmap --proxies socks4://127.0.0.1:9050 -sT <target>

# With authentication
nmap --proxies http://user:pass@proxy:8080 -sT <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Tor network use karo maximum anonymity ke liye: `nmap --proxies socks4://127.0.0.1:9050 -sT <target>`. Lekin sirf TCP Connect scan (`-sT`) kaam karta hai proxy ke saath, SYN scan nahi.

**Common Mistake:** Free public proxies use karna jo unreliable aur logged hote hain. Hamesha trusted proxy services use karo ya apna proxy chain setup karo.

---

**ğŸ“ Module 15 Complete!**

Firewall/IDS Evasion techniques master kar liye! Ab aap jante ho:
- **Decoy Scan (`-D`):** Multiple fake IPs se scanning
- **Interface Selection (`-e`):** Specific network interface control
- **MAC Spoofing (`--spoof-mac`):** Hardware identity masking
- **Source Port (`--source-port`):** Trusted port impersonation
- **TTL Manipulation (`--ttl`):** OS fingerprinting evasion
- **Proxy Chains (`--proxies`):** Complete anonymity through intermediaries

**Professional Evasion Workflow:**
```bash
# 1. Reconnaissance phase (gather info about target defenses)
nmap -sS -T2 <target>

# 2. Stealth scanning with multiple evasion techniques
nmap -sS -D RND:10 --source-port 53 --ttl 64 -T1 <target>

# 3. MAC spoofing for local network
sudo nmap --spoof-mac Dell -sS 192.168.1.0/24

# 4. Maximum anonymity with proxy chain
nmap --proxies socks4://127.0.0.1:9050 -sT <target>

# 5. Interface-specific scanning via VPN
nmap -e tun0 -sS <target>
```

**Next:** Module 16 - Nmap & Beyond (Programming & GUI) ğŸš€

=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸ Module 16: Nmap & Beyond (Programming & GUI)

---

## ğŸ“š Topic 16.1: Nmap for Python (Simple Port Scanner)

### 1. ğŸ¯ Topic/Flag:
**Python Port Scanner - Custom Nmap Implementation**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Python mein basic port scanner banana jo Nmap ki functionality replicate kare aur custom requirements ke liye modify kiya ja sake.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Custom tools banane se aap specific requirements fulfill kar sakte ho, stealth techniques implement kar sakte ho, aur automated pentesting workflows create kar sakte ho.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Custom scanning logic implementation
- Automated vulnerability assessment
- Integration with other tools
- Stealth scanning techniques
- Custom reporting formats

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```python
import socket
import sys
from datetime import datetime

def scan_port(target, port):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(1)
        result = sock.connect_ex((target, port))
        sock.close()
        return result == 0
    except:
        return False

def port_scanner(target, ports):
    print(f"Starting scan on {target}")
    print(f"Time started: {datetime.now()}")
    
    open_ports = []
    for port in ports:
        if scan_port(target, port):
            open_ports.append(port)
            print(f"Port {port}: Open")
    
    return open_ports
```

### 6. ğŸ‘ Pros (Fayde)
- Complete customization possible
- Integration with other Python tools
- Custom logic implementation
- Lightweight and fast
- Easy to modify and extend

### 7. ğŸ‘ Cons (Nuksaan)
- Limited compared to Nmap
- No advanced scan types
- Manual implementation required
- Less optimized than Nmap

### 8. âŒ¨ï¸ Syntax (Command)
```python
# Basic usage
target = "scanme.nmap.org"
ports = [22, 80, 443, 8080]
open_ports = port_scanner(target, ports)
```

### 9. ğŸ’» Practice Command
```python
#!/usr/bin/env python3
import socket
import threading
from datetime import datetime

class PortScanner:
    def __init__(self, target, threads=100):
        self.target = target
        self.threads = threads
        self.open_ports = []
        
    def scan_port(self, port):
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(1)
            result = sock.connect_ex((self.target, port))
            if result == 0:
                self.open_ports.append(port)
                print(f"Port {port}: Open")
            sock.close()
        except:
            pass
    
    def scan_range(self, start_port, end_port):
        print(f"Scanning {self.target} from port {start_port} to {end_port}")
        
        for port in range(start_port, end_port + 1):
            thread = threading.Thread(target=self.scan_port, args=(port,))
            thread.start()

# Usage
scanner = PortScanner("scanme.nmap.org")
scanner.scan_range(1, 1000)
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Threading use karo fast scanning ke liye, lekin threads limit karo (100-200) taaki target server overwhelm na ho. Custom banners grab karne ke liye socket se data receive karo: `sock.recv(1024).decode()`

**Common Mistake:** Bina timeout ke socket connections banana. Isse script hang ho sakti hai. Hamesha `sock.settimeout(1)` use karo.

---

## ğŸ“š Topic 16.2: `python-nmap` Library

### 1. ğŸ¯ Topic/Flag:
**Python-Nmap Library - Nmap Integration with Python**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Python library jo Nmap ko Python scripts mein integrate karne ke liye use hoti hai, allowing programmatic access to Nmap functionality.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Automated pentesting workflows banane ke liye, Nmap results ko Python mein process karne ke liye, aur custom vulnerability assessment tools develop karne ke liye zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Automated vulnerability scanning
- Custom reporting systems
- Integration with other security tools
- Batch processing of targets
- Real-time monitoring systems

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```python
import nmap

nm = nmap.PortScanner()
result = nm.scan('127.0.0.1', '22-443')
print(nm.all_hosts())
print(nm['127.0.0.1'].all_protocols())
print(nm['127.0.0.1']['tcp'].keys())
```
Library Nmap command execute karta hai aur results ko Python objects mein parse karta hai.

### 6. ğŸ‘ Pros (Fayde)
- Full Nmap functionality access
- Easy Python integration
- Structured data output
- Extensive documentation
- Active development

### 7. ğŸ‘ Cons (Nuksaan)
- Requires Nmap installation
- Slower than direct Nmap
- Limited error handling
- Dependency on external tool

### 8. âŒ¨ï¸ Syntax (Command)
```python
# Installation
pip install python-nmap

# Basic usage
import nmap
nm = nmap.PortScanner()
nm.scan('target', 'port-range')
```

### 9. ğŸ’» Practice Command
```python
#!/usr/bin/env python3
import nmap
import json

class NmapScanner:
    def __init__(self):
        self.nm = nmap.PortScanner()
    
    def scan_network(self, network, ports='1-1000'):
        print(f"Scanning network: {network}")
        self.nm.scan(hosts=network, ports=ports, arguments='-sS -sV')
        
        results = {}
        for host in self.nm.all_hosts():
            results[host] = {
                'state': self.nm[host].state(),
                'protocols': {}
            }
            
            for protocol in self.nm[host].all_protocols():
                ports = self.nm[host][protocol].keys()
                results[host]['protocols'][protocol] = {}
                
                for port in ports:
                    port_info = self.nm[host][protocol][port]
                    results[host]['protocols'][protocol][port] = {
                        'state': port_info['state'],
                        'name': port_info['name'],
                        'version': port_info.get('version', 'unknown')
                    }
        
        return results
    
    def vulnerability_scan(self, target):
        print(f"Running vulnerability scan on {target}")
        self.nm.scan(target, arguments='--script vuln')
        
        for host in self.nm.all_hosts():
            if 'script' in self.nm[host]:
                for script_name, script_output in self.nm[host]['script'].items():
                    print(f"Script: {script_name}")
                    print(f"Output: {script_output}")

# Usage
scanner = NmapScanner()
results = scanner.scan_network('192.168.1.0/24')
print(json.dumps(results, indent=2))
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Results ko JSON format mein save karo future analysis ke liye: `json.dumps(results, indent=2)`. Isse aap data ko databases mein store kar sakte ho ya web dashboards mein display kar sakte ho.

**Common Mistake:** Large networks par bina timeout ke scan karna. Hamesha reasonable port ranges use karo aur timeout set karo: `nm.scan(timeout=300)`

---

## ğŸ“š Topic 16.3: Zenmap (The Nmap GUI)

### 1. ğŸ¯ Topic/Flag:
**Zenmap - Nmap Graphical User Interface**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ka official graphical user interface jo command-line Nmap ko user-friendly GUI mein wrap karta hai aur visual network mapping provide karta hai.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Beginners ke liye Nmap seekhà¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤, clients ko visual reports à¤¦à¤¿à¤–à¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤, aur network topology visualization à¤•à¥‡ à¤²à¤¿à¤ zaroori hai.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- Beginner-friendly Nmap interface
- Visual network topology mapping
- Client presentations à¤”à¤° reports
- Scan result comparison
- Profile-based scanning

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
Zenmap GUI interface provide karta hai à¤œà¤¹à¤¾à¤ à¤†à¤ª:
- Target specify à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹
- Scan profiles choose à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹
- Results à¤•à¥‹ visual format à¤®à¥‡à¤‚ à¤¦à¥‡à¤– à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹
- Network topology maps generate à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹
- Scan history maintain à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹

### 6. ğŸ‘ Pros (Fayde)
- User-friendly interface
- Visual network mapping
- Pre-configured scan profiles
- Result comparison features
- Scan history management
- Export capabilities

### 7. ğŸ‘ Cons (Nuksaan)
- Limited compared to command-line
- Resource intensive
- Less flexible than CLI
- May not have latest features

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Installation (Linux)
sudo apt-get install zenmap

# Installation (Windows)
# Download from nmap.org

# Launch
zenmap
```

### 9. ğŸ’» Practice Command
```
Zenmap GUI Operations:

1. Launch Zenmap
2. Enter target: scanme.nmap.org
3. Choose profile: "Quick scan"
4. Click "Scan"
5. View results in different tabs:
   - Nmap Output
   - Ports/Hosts
   - Topology
   - Host Details
6. Save scan: Scan â†’ Save Scan
7. Compare scans: Tools â†’ Compare Results
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Zenmap à¤•à¥‡ Topology tab à¤•à¤¾ use à¤•à¤°à¤•à¥‡ impressive network diagrams à¤¬à¤¨à¤¾ à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹ client presentations à¤•à¥‡ à¤²à¤¿à¤. Scan results à¤•à¥‹ XML format à¤®à¥‡à¤‚ export à¤•à¤°à¤•à¥‡ other tools à¤®à¥‡à¤‚ import à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹.

**Common Mistake:** Zenmap à¤•à¥‹ production pentesting tool à¤¸à¤®à¤à¤¨à¤¾. à¤¯à¤¹ mainly learning à¤”à¤° visualization à¤•à¥‡ à¤²à¤¿à¤ à¤¹à¥ˆ. Real pentesting à¤®à¥‡à¤‚ command-line Nmap à¤œà¥à¤¯à¤¾à¤¦à¤¾ powerful à¤”à¤° flexible à¤¹à¥ˆ.

---

**ğŸ“ Module 16 Complete!**

Nmap Programming & GUI techniques master à¤•à¤° à¤²à¤¿à¤! à¤…à¤¬ à¤†à¤ª à¤œà¤¾à¤¨à¤¤à¥‡ à¤¹à¥‹:
- **Python Port Scanner:** Custom scanning tools development
- **Python-Nmap Library:** Programmatic Nmap integration
- **Zenmap GUI:** Visual interface à¤”à¤° network mapping

**Professional Development Workflow:**
```python
# 1. Custom Python scanner for specific needs
import socket, threading

# 2. Python-nmap for automation
import nmap
nm = nmap.PortScanner()
results = nm.scan('target', '1-1000', arguments='-sS -sV')

# 3. Zenmap for visualization and client presentations
# GUI-based scanning and topology mapping

# 4. Integration example
def automated_assessment(target_list):
    scanner = nmap.PortScanner()
    for target in target_list:
        # Scan
        results = scanner.scan(target, arguments='-sS -sV --script vuln')
        # Process results
        generate_report(results)
        # Store in database
        store_results(results)
```

**Next:** Module 17 - Pro-Level Advanced Techniques (Final Module) ğŸš€

=============================================================

**NMAP: Zero-to-Pro Pentester Notes**

---

# ğŸš€ Module 17: Pro-Level Pentesting & Advanced Techniques

---

## ğŸ“š Topic 17.1: Timing Templates (`-T0` se `-T5`)

### 1. ğŸ¯ Topic/Flag:
**Timing Templates (`-T0` to `-T5`) - Speed vs Stealth Control**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap ke pre-configured timing templates jo scan speed aur stealth à¤•à¥‡ à¤¬à¥€à¤š balance provide à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚, T0 (paranoid) à¤¸à¥‡ T5 (insane) à¤¤à¤•.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Different scenarios à¤®à¥‡à¤‚ à¤…à¤²à¤— timing à¤šà¤¾à¤¹à¤¿à¤ - stealth operations à¤•à¥‡ à¤²à¤¿à¤ slow scanning (T0-T2), time-critical assessments à¤•à¥‡ à¤²à¤¿à¤ fast scanning (T4-T5). IDS evasion à¤•à¥‡ à¤²à¤¿à¤ timing crucial à¤¹à¥ˆ.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **T0-T1:** High-security environments, IDS evasion
- **T2:** Default stealth scanning
- **T3:** Normal scanning (default)
- **T4:** Fast internal network scans
- **T5:** Time-critical assessments, CTF competitions

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
nmap -T0 <target>  # Paranoid (5+ minutes between probes)
nmap -T1 <target>  # Sneaky (15 seconds between probes)
nmap -T2 <target>  # Polite (0.4 seconds between probes)
nmap -T3 <target>  # Normal (default)
nmap -T4 <target>  # Aggressive (faster, may trigger IDS)
nmap -T5 <target>  # Insane (very fast, high error rate)
```

### 6. ğŸ‘ Pros (Fayde)
- **T0-T2:** IDS evasion, stealth operations
- **T3:** Balanced performance
- **T4-T5:** Fast results, time-saving

### 7. ğŸ‘ Cons (Nuksaan)
- **T0-T2:** Very slow, time-consuming
- **T4-T5:** High detection probability, may miss results

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -T<0-5> <target>
# Examples
nmap -T0 <target>  # Slowest, stealthiest
nmap -T4 <target>  # Fast, aggressive
```

### 9. ğŸ’» Practice Command
```bash
# Stealth scan (IDS evasion)
nmap -T1 -sS -p 80,443 scanme.nmap.org

# Fast internal network scan
nmap -T4 -sS 192.168.1.0/24

# Paranoid scan (maximum stealth)
nmap -T0 -sS -p 22 <high-security-target>

# Speed comparison test
time nmap -T2 scanme.nmap.org
time nmap -T4 scanme.nmap.org
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Corporate environments à¤®à¥‡à¤‚ T2 use à¤•à¤°à¥‹ (stealth + reasonable speed). CTF competitions à¤®à¥‡à¤‚ T4-T5 use à¤•à¤°à¥‹ time bachà¤¾à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤. High-security targets à¤•à¥‡ à¤²à¤¿à¤ T0-T1 with custom delays.

**Common Mistake:** à¤¹à¤®à¥‡à¤¶à¤¾ T4-T5 use à¤•à¤°à¤¨à¤¾ speed à¤•à¥‡ à¤²à¤¿à¤. à¤¯à¤¹ IDS alerts trigger à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤”à¤° inaccurate results à¤¦à¥‡ à¤¸à¤•à¤¤à¤¾ à¤¹à¥ˆ. Environment à¤•à¥‡ à¤¹à¤¿à¤¸à¤¾à¤¬ à¤¸à¥‡ timing choose à¤•à¤°à¥‹.

---

## ğŸ“š Topic 17.2: Deeper Host Discovery (`-PS`, `-PA`, `-PU`)

### 1. ğŸ¯ Topic/Flag:
**Advanced Host Discovery - Custom Ping Techniques**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Standard ICMP ping à¤•à¥‡ à¤…à¤²à¤¾à¤µà¤¾ TCP SYN, TCP ACK, à¤”à¤° UDP packets use à¤•à¤°à¤•à¥‡ host discovery à¤•à¤°à¤¨à¤¾ à¤œà¤¬ traditional ping blocked à¤¹à¥‹.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Modern networks à¤®à¥‡à¤‚ ICMP ping blocked à¤¹à¥‹à¤¤à¥€ à¤¹à¥ˆ. Advanced ping techniques à¤¸à¥‡ firewalls bypass à¤•à¤°à¤•à¥‡ live hosts discover à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **`-PS`:** TCP SYN ping (firewall bypass)
- **`-PA`:** TCP ACK ping (stateful firewall bypass)  
- **`-PU`:** UDP ping (ICMP-filtered networks)
- **`-PE`:** ICMP Echo ping (traditional)
- **`-PP`:** ICMP Timestamp ping

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# TCP SYN Ping (most effective)
nmap -PS22,80,443 192.168.1.0/24

# TCP ACK Ping (bypass stateful firewalls)
nmap -PA80,443 192.168.1.0/24

# UDP Ping (when TCP filtered)
nmap -PU53,161,137 192.168.1.0/24

# Combined approach
nmap -PS22 -PA80 -PU53 192.168.1.0/24
```

### 6. ğŸ‘ Pros (Fayde)
- Firewall bypass capabilities
- Multiple discovery methods
- Higher success rate than ICMP
- Port-specific discovery

### 7. ğŸ‘ Cons (Nuksaan)
- Slower than ICMP ping
- May trigger security alerts
- Requires knowledge of open ports
- More complex configuration

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -PS<port-list> <target>  # TCP SYN ping
nmap -PA<port-list> <target>  # TCP ACK ping
nmap -PU<port-list> <target>  # UDP ping
nmap -PE <target>             # ICMP Echo ping
```

### 9. ğŸ’» Practice Command
```bash
# TCP SYN ping on common ports
nmap -PS22,80,443,3389 192.168.1.0/24 -sn

# TCP ACK ping (bypass stateful firewalls)
nmap -PA80,443 10.0.0.0/24 -sn

# UDP ping on DNS and SNMP
nmap -PU53,161 192.168.1.0/24 -sn

# Comprehensive host discovery
nmap -PS22,80,443 -PA80 -PU53,161 -PE 192.168.1.0/24 -sn

# Custom port combinations
nmap -PS21,22,23,25,53,80,110,443,993,995 <target-network> -sn
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** à¤¹à¤®à¥‡à¤¶à¤¾ multiple ping techniques combine à¤•à¤°à¥‹: `-PS22,80,443 -PA80 -PU53`. Different firewalls à¤…à¤²à¤— techniques block à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚. Common service ports use à¤•à¤°à¥‹ à¤œà¥‹ usually open à¤¹à¥‹à¤¤à¥‡ à¤¹à¥ˆà¤‚.

**Common Mistake:** Sirf default ICMP ping rely à¤•à¤°à¤¨à¤¾. Modern corporate networks à¤®à¥‡à¤‚ ICMP blocked à¤¹à¥‹à¤¤à¥€ à¤¹à¥ˆ. TCP/UDP ping techniques à¤œà¥à¤¯à¤¾à¤¦à¤¾ effective à¤¹à¥ˆà¤‚.

---

## ğŸ“š Topic 17.3: Classic Evasion (Packet Fragmentation `-f`, `--mtu`)

### 1. ğŸ¯ Topic/Flag:
**Packet Fragmentation - IDS/Firewall Evasion Through Packet Splitting**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Large packets à¤•à¥‹ small fragments à¤®à¥‡à¤‚ split à¤•à¤°à¤¨à¤¾ à¤¤à¤¾à¤•à¤¿ IDS/firewall signatures bypass à¤¹à¥‹ à¤¸à¤•à¥‡à¤‚ à¤œà¥‹ complete packets analyze à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
à¤•à¤ˆ IDS systems fragmented packets à¤•à¥‹ properly reassemble à¤¨à¤¹à¥€à¤‚ à¤•à¤° à¤ªà¤¾à¤¤à¥‡, à¤œà¤¿à¤¸à¤¸à¥‡ malicious payloads detection à¤¸à¥‡ à¤¬à¤š à¤œà¤¾à¤¤à¥‡ à¤¹à¥ˆà¤‚. à¤¯à¤¹ classic evasion technique à¤¹à¥ˆ.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- IDS signature evasion
- Firewall rule bypass
- Deep packet inspection avoidance
- Legacy system exploitation
- Stealth scanning enhancement

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Basic fragmentation (8 bytes)
nmap -f <target>

# Double fragmentation (16 bytes)  
nmap -ff <target>

# Custom MTU (Maximum Transmission Unit)
nmap --mtu 24 <target>  # Must be multiple of 8
```
Packets à¤•à¥‹ specified size à¤•à¥‡ fragments à¤®à¥‡à¤‚ split à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ. IDS à¤•à¥‹ complete packet reconstruct à¤•à¤°à¤¨à¤¾ à¤ªà¤¡à¤¼à¤¤à¤¾ à¤¹à¥ˆ detection à¤•à¥‡ à¤²à¤¿à¤.

### 6. ğŸ‘ Pros (Fayde)
- IDS evasion effective
- Firewall bypass possible
- Simple implementation
- Works with most scan types

### 7. ğŸ‘ Cons (Nuksaan)
- Slower scanning
- May cause packet loss
- Modern IDS detect fragmentation
- Network overhead increases

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -f <target>           # Fragment packets (8 bytes)
nmap -ff <target>          # Double fragment (16 bytes)
nmap --mtu <size> <target> # Custom MTU (multiple of 8)
```

### 9. ğŸ’» Practice Command
```bash
# Basic fragmentation
nmap -f -sS -p 80,443 scanme.nmap.org

# Double fragmentation with stealth
nmap -ff -sS -T2 <target>

# Custom MTU fragmentation
nmap --mtu 24 -sS <target>

# Fragmentation with other evasion techniques
nmap -f -D RND:10 --source-port 53 <target>

# Test different fragment sizes
for mtu in 16 24 32; do nmap --mtu $mtu -sS -p 80 <target>; done
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Fragmentation à¤•à¥‹ other evasion techniques à¤•à¥‡ à¤¸à¤¾à¤¥ combine à¤•à¤°à¥‹: `nmap -f -D RND:5 --source-port 53 -T2 <target>`. à¤›à¥‹à¤Ÿà¥‡ MTU values (16-32) à¤œà¥à¤¯à¤¾à¤¦à¤¾ effective à¤¹à¥ˆà¤‚.

**Common Mistake:** à¤¬à¤¹à¥à¤¤ à¤›à¥‹à¤Ÿà¥‡ fragments (8 bytes) use à¤•à¤°à¤¨à¤¾ à¤œà¥‹ suspicious à¤²à¤—à¤¤à¥‡ à¤¹à¥ˆà¤‚. 24-32 bytes optimal à¤¹à¥ˆà¤‚ - effective evasion with reasonable performance.

---

## ğŸ“š Topic 17.4: Advanced Evasion (`--data-string`, `--scan-delay`, `--badsum`)

### 1. ğŸ¯ Topic/Flag:
**Advanced Evasion Techniques - Custom Data, Delays, and Invalid Checksums**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Sophisticated evasion techniques à¤œà¥‹ custom data payloads, artificial delays, à¤”à¤° invalid checksums use à¤•à¤°à¤•à¥‡ advanced security systems à¤•à¥‹ bypass à¤•à¤°à¤¤à¥€ à¤¹à¥ˆà¤‚.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Modern security systems behavioral analysis à¤”à¤° pattern recognition use à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚. Advanced evasion techniques à¤¸à¥‡ à¤‡à¤¨ systems à¤•à¥‹ fool à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **`--data-string`:** Custom payload injection
- **`--scan-delay`:** Rate limiting evasion  
- **`--badsum`:** Firewall testing
- **`--data-length`:** Packet size manipulation
- **`--ip-options`:** IP header manipulation

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Custom data in packets
nmap --data-string "HTTP/1.1 GET /" <target>

# Artificial delays between probes
nmap --scan-delay 2s <target>

# Invalid TCP checksums (firewall testing)
nmap --badsum <target>

# Custom packet length
nmap --data-length 25 <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Advanced IDS evasion
- Rate limiting bypass
- Firewall configuration testing
- Custom payload delivery
- Behavioral analysis evasion

### 7. ğŸ‘ Cons (Nuksaan)
- Significantly slower scanning
- Complex configuration required
- May cause connection issues
- Limited effectiveness on modern systems

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap --data-string <string> <target>
nmap --scan-delay <time> <target>
nmap --badsum <target>
nmap --data-length <length> <target>
```

### 9. ğŸ’» Practice Command
```bash
# Custom HTTP-like payload
nmap --data-string "GET / HTTP/1.1\r\nHost: target.com\r\n\r\n" -p 80 <target>

# Slow scan with delays (rate limiting evasion)
nmap --scan-delay 5s -T1 <target>

# Invalid checksum testing
nmap --badsum -sS <target>

# Custom packet length (avoid signature detection)
nmap --data-length 50 -sS <target>

# Combined advanced evasion
nmap --data-string "NORMAL_TRAFFIC" --scan-delay 3s --data-length 30 -f -T1 <target>

# Random delays between scans
nmap --scan-delay 1-10s <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** `--data-string` à¤®à¥‡à¤‚ legitimate traffic mimic à¤•à¤°à¥‹: "GET / HTTP/1.1" à¤¯à¤¾ "SSH-2.0-OpenSSH". `--scan-delay` à¤•à¥‹ random intervals à¤•à¥‡ à¤¸à¤¾à¤¥ use à¤•à¤°à¥‹: `1-5s` detection avoid à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤.

**Common Mistake:** à¤¸à¤­à¥€ advanced techniques à¤à¤• à¤¸à¤¾à¤¥ use à¤•à¤°à¤¨à¤¾ à¤œà¥‹ scanning à¤•à¥‹ extremely slow à¤¬à¤¨à¤¾ à¤¦à¥‡à¤¤à¤¾ à¤¹à¥ˆ. Selective evasion use à¤•à¤°à¥‹ based on target environment.

---

## ğŸ“š Topic 17.5: Niche Scan Types (SCTP `-sY`, RPC `-sR`)

### 1. ğŸ¯ Topic/Flag:
**Specialized Scan Types - SCTP and RPC Protocol Scanning**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Specialized protocols à¤•à¥‡ à¤²à¤¿à¤ specific scan types - SCTP (Stream Control Transmission Protocol) à¤”à¤° RPC (Remote Procedure Call) services à¤•à¥‡ à¤²à¤¿à¤.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Telecom networks, VoIP systems, à¤”à¤° enterprise environments à¤®à¥‡à¤‚ SCTP/RPC services common à¤¹à¥ˆà¤‚. Standard TCP/UDP scans à¤‡à¤¨ services à¤•à¥‹ miss à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **SCTP (`-sY`):** VoIP systems, telecom infrastructure
- **RPC (`-sR`):** NFS, NIS, enterprise services
- **Protocol-specific vulnerabilities**
- **Specialized service enumeration**

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# SCTP INIT scan
nmap -sY <target>

# RPC scan (requires root)
nmap -sR <target>

# SCTP with specific ports
nmap -sY -p 2905,3868,4739 <target>
```
SCTP scan INIT chunks à¤­à¥‡à¤œà¤¤à¤¾ à¤¹à¥ˆ, RPC scan portmapper queries à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ registered services à¤•à¥‡ à¤²à¤¿à¤.

### 6. ğŸ‘ Pros (Fayde)
- Protocol-specific detection
- Specialized service enumeration
- Comprehensive network assessment
- Niche vulnerability discovery

### 7. ğŸ‘ Cons (Nuksaan)
- Limited protocol support
- Requires specialized knowledge
- May not work on all systems
- Less common in standard networks

### 8. âŒ¨ï¸ Syntax (Command)
```bash
nmap -sY <target>          # SCTP INIT scan
nmap -sR <target>          # RPC scan
nmap -sY -p <ports> <target> # SCTP specific ports
```

### 9. ğŸ’» Practice Command
```bash
# SCTP scan for VoIP/telecom
nmap -sY -p 2905,3868,4739,9899 <telecom-target>

# RPC service enumeration
sudo nmap -sR <target>

# Combined SCTP and standard scan
nmap -sS -sY <target>

# SCTP with service detection
nmap -sY -sV <target>

# RPC with specific ports
sudo nmap -sR -p 111,2049,4045 <target>
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** SCTP scan telecom/VoIP environments à¤®à¥‡à¤‚ valuable à¤¹à¥ˆ. Common SCTP ports: 2905 (M3UA), 3868 (Diameter), 4739 (IPFIX). RPC scan à¤¸à¥‡ NFS shares à¤”à¤° enterprise services discover à¤¹à¥‹ à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚.

**Common Mistake:** à¤‡à¤¨ specialized scans à¤•à¥‹ ignore à¤•à¤°à¤¨à¤¾. Enterprise à¤”à¤° telecom environments à¤®à¥‡à¤‚ à¤¯à¤¹ critical services reveal à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤œà¥‹ standard scans miss à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚.

---

## ğŸ“š Topic 17.6: The Nmap Suite (Ncat, Ndiff, Nping)

### 1. ğŸ¯ Topic/Flag:
**Nmap Suite Tools - Ncat, Ndiff, Nping Utilities**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap à¤•à¥‡ à¤¸à¤¾à¤¥ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¥‡ additional tools à¤œà¥‹ networking, comparison, à¤”à¤° packet crafting à¤•à¥‡ à¤²à¤¿à¤ use à¤¹à¥‹à¤¤à¥‡ à¤¹à¥ˆà¤‚.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Complete pentesting toolkit à¤•à¥‡ à¤²à¤¿à¤ à¤¯à¤¹ tools essential à¤¹à¥ˆà¤‚ - Ncat (netcat replacement), Ndiff (scan comparison), Nping (packet crafting).

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Ncat:** Reverse shells, port forwarding, file transfer
- **Ndiff:** Scan result comparison, change detection
- **Nping:** Custom packet crafting, network testing

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Ncat - Network connectivity
ncat -l -p 4444                    # Listen mode
ncat target.com 80                 # Connect mode
ncat -l -p 4444 -e /bin/bash      # Reverse shell

# Ndiff - Scan comparison  
ndiff scan1.xml scan2.xml

# Nping - Packet crafting
nping --tcp -p 80 target.com
```

### 6. ğŸ‘ Pros (Fayde)
- **Ncat:** Versatile networking tool
- **Ndiff:** Easy scan comparison
- **Nping:** Advanced packet crafting
- Integrated with Nmap ecosystem

### 7. ğŸ‘ Cons (Nuksaan)
- Learning curve for each tool
- May require separate installation
- Limited compared to specialized tools
- Documentation scattered

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Ncat
ncat [options] [hostname] [port]

# Ndiff  
ndiff [options] <file1> <file2>

# Nping
nping [options] <target>
```

### 9. ğŸ’» Practice Command
```bash
# Ncat Examples
# Reverse shell listener
ncat -l -p 4444 -e /bin/bash

# File transfer server
ncat -l -p 8080 < file.txt

# Port forwarding
ncat -l -p 8080 -c "ncat target.com 80"

# Ndiff Examples  
# Compare two scans
nmap -oX scan1.xml target.com
# ... time passes ...
nmap -oX scan2.xml target.com
ndiff scan1.xml scan2.xml

# Nping Examples
# TCP packet crafting
nping --tcp -p 80,443 --flags syn target.com

# ICMP ping with custom data
nping --icmp --data-string "PENTESTING" target.com

# ARP ping on local network
nping --arp 192.168.1.1
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Ncat à¤•à¥‹ reverse shells à¤•à¥‡ à¤²à¤¿à¤ use à¤•à¤°à¥‹: `ncat -l -p 4444 -e /bin/bash`. Ndiff à¤¸à¥‡ regular scans compare à¤•à¤°à¤•à¥‡ network changes monitor à¤•à¤°à¥‹. Nping à¤¸à¥‡ custom packets craft à¤•à¤°à¤•à¥‡ firewall rules test à¤•à¤°à¥‹.

**Common Mistake:** à¤‡à¤¨ tools à¤•à¥‹ separate entities à¤¸à¤®à¤à¤¨à¤¾. à¤¯à¤¹ Nmap ecosystem à¤•à¤¾ part à¤¹à¥ˆà¤‚ à¤”à¤° integrated workflows à¤®à¥‡à¤‚ powerful à¤¹à¥ˆà¤‚.

---

## ğŸ“š Topic 17.7: Advanced NSE (Lua, `broadcast` category, `ipidseq` script)

### 1. ğŸ¯ Topic/Flag:
**Advanced NSE Scripting - Lua Programming and Specialized Scripts**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Nmap Scripting Engine à¤•à¥€ advanced capabilities - custom Lua scripts writing, broadcast category scripts, à¤”à¤° specialized scripts à¤œà¥ˆà¤¸à¥‡ ipidseq.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Custom requirements à¤•à¥‡ à¤²à¤¿à¤ à¤…à¤ªà¤¨à¥‡ scripts à¤²à¤¿à¤– à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹, broadcast scripts à¤¸à¥‡ network-wide information gather à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹, specialized scripts à¤¸à¥‡ unique vulnerabilities find à¤•à¤° à¤¸à¤•à¤¤à¥‡ à¤¹à¥‹.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Custom Lua scripts:** Specific vulnerability checks
- **Broadcast scripts:** Network-wide enumeration  
- **ipidseq script:** OS fingerprinting, idle scan preparation
- **Advanced enumeration:** Custom protocol analysis

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```lua
-- Custom NSE script example
local nmap = require "nmap"
local shortport = require "shortport"

portrule = shortport.http

action = function(host, port)
    local response = http.get(host, port, "/admin")
    if response.status == 200 then
        return "Admin panel found!"
    end
end
```

```bash
# Broadcast scripts
nmap --script broadcast-dhcp-discover
nmap --script broadcast-dns-service-discovery

# ipidseq script
nmap --script ipidseq <target>
```

### 6. ğŸ‘ Pros (Fayde)
- Complete customization possible
- Network-wide discovery capabilities
- Advanced OS fingerprinting
- Specialized vulnerability detection

### 7. ğŸ‘ Cons (Nuksaan)
- Requires Lua programming knowledge
- Complex script development
- Debugging challenges
- Performance considerations

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Custom script execution
nmap --script /path/to/custom-script.nse <target>

# Broadcast category
nmap --script broadcast

# Specific advanced scripts
nmap --script ipidseq <target>
```

### 9. ğŸ’» Practice Command
```bash
# Broadcast scripts for network discovery
nmap --script broadcast-dhcp-discover -e eth0
nmap --script broadcast-dns-service-discovery
nmap --script broadcast-netbios-master-browser

# ipidseq for OS fingerprinting
nmap --script ipidseq scanme.nmap.org

# Advanced HTTP enumeration
nmap --script http-enum,http-headers,http-methods -p 80,443 <target>

# Custom script development location
ls /usr/share/nmap/scripts/
# Create custom script
nano /usr/share/nmap/scripts/custom-check.nse

# Update script database after adding custom scripts
nmap --script-updatedb
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** Broadcast scripts local network reconnaissance à¤•à¥‡ à¤²à¤¿à¤ powerful à¤¹à¥ˆà¤‚: `--script broadcast` à¤¸à¥‡ DHCP, DNS, NetBIOS à¤¸à¤¬ à¤•à¥à¤› discover à¤¹à¥‹ à¤œà¤¾à¤¤à¤¾ à¤¹à¥ˆ. ipidseq script idle scan à¤•à¥‡ à¤²à¤¿à¤ zombie hosts identify à¤•à¤°à¤¨à¥‡ à¤®à¥‡à¤‚ helpful à¤¹à¥ˆ.

**Common Mistake:** Custom scripts à¤¬à¤¨à¤¾à¤¤à¥‡ à¤¸à¤®à¤¯ error handling ignore à¤•à¤°à¤¨à¤¾. à¤¹à¤®à¥‡à¤¶à¤¾ proper error checking à¤”à¤° timeout handling implement à¤•à¤°à¥‹ Lua scripts à¤®à¥‡à¤‚.

---

## ğŸ“š Topic 17.8: Pro Workflow (Metasploit `db_import`, Debugging, Resume, IPv6)

### 1. ğŸ¯ Topic/Flag:
**Professional Pentesting Workflow - Integration, Debugging, and Advanced Features**

### 2. ğŸ¤” Yeh Kya Hai? (What is it?)
Professional pentesting à¤•à¥‡ à¤²à¤¿à¤ complete workflow à¤œà¥‹ Metasploit integration, debugging capabilities, scan resumption, à¤”à¤° IPv6 support include à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ.

### 3. ğŸ›¡ï¸ Pentester ke liye Kyun Zaroori Hai?
Real-world pentesting à¤®à¥‡à¤‚ comprehensive workflow à¤šà¤¾à¤¹à¤¿à¤ à¤œà¥‹ tools à¤•à¥‹ integrate à¤•à¤°à¥‡, debugging provide à¤•à¤°à¥‡, long scans à¤•à¥‹ resume à¤•à¤°à¥‡, à¤”à¤° modern IPv6 networks à¤•à¥‹ handle à¤•à¤°à¥‡.

### 4. ğŸ¯ Practical Use (Asli Pentesting Mein)
- **Metasploit Integration:** Automated exploitation
- **Debugging:** Troubleshooting à¤”à¤° analysis
- **Resume functionality:** Long scan continuation
- **IPv6 support:** Modern network assessment

### 5. âš™ï¸ Yeh Kaise Kaam Karta Hai? (How it works)
```bash
# Metasploit integration
nmap -sS -sV -oX scan.xml target.com
msfconsole
msf> db_import scan.xml
msf> hosts
msf> services

# Debugging
nmap --reason --packet-trace <target>
nmap --script-trace <target>

# Resume scans
nmap --resume /tmp/nmap_scan_12345

# IPv6 scanning
nmap -6 2001:db8::1
```

### 6. ğŸ‘ Pros (Fayde)
- **Integration:** Seamless tool workflow
- **Debugging:** Detailed analysis capabilities  
- **Resume:** Time-saving for long scans
- **IPv6:** Modern network support

### 7. ğŸ‘ Cons (Nuksaan)
- Complex workflow setup
- Requires multiple tools knowledge
- IPv6 scanning limitations
- Debugging overhead

### 8. âŒ¨ï¸ Syntax (Command)
```bash
# Metasploit workflow
nmap -oX scan.xml <target>
msfconsole -q -x "db_import scan.xml; hosts; services"

# Debugging options
nmap --reason --packet-trace --script-trace <target>

# Resume and IPv6
nmap --resume <file>
nmap -6 <ipv6-target>
```

### 9. ğŸ’» Practice Command
```bash
# Complete professional workflow
# 1. Initial reconnaissance
nmap -sn 192.168.1.0/24 -oA network_discovery

# 2. Comprehensive scanning with XML output
nmap -sS -sV -sC --script vuln -oA full_scan 192.168.1.0/24

# 3. Import to Metasploit
msfconsole -q -x "
workspace -a PENTEST_2024
db_import full_scan.xml
hosts -c address,name,os_name
services -c port,proto,name,state
search type:exploit platform:windows
"

# 4. Debugging problematic scans
nmap --reason --packet-trace -sS -p 445 <target>

# 5. IPv6 network assessment
nmap -6 -sS -sV 2001:db8::/32

# 6. Resume interrupted scan
nmap --resume /tmp/nmap_scan_*

# 7. Advanced debugging with script tracing
nmap --script-trace --script vuln <target>

# 8. Runtime interaction (during scan)
# Press 'd' for debugging info
# Press 'v' for verbose mode
# Press '?' for help
```

### 10. ğŸ’¡ Pro Tip / Galti
**Pro Tip:** à¤¹à¤®à¥‡à¤¶à¤¾ XML output (`-oX`) use à¤•à¤°à¥‹ Metasploit integration à¤•à¥‡ à¤²à¤¿à¤. Long scans à¤•à¥‡ à¤²à¤¿à¤ `--resume` feature life-saver à¤¹à¥ˆ. IPv6 networks à¤®à¥‡à¤‚ `-6` flag à¤•à¥‡ à¤¸à¤¾à¤¥ link-local addresses à¤­à¥€ scan à¤•à¤°à¥‹: `nmap -6 fe80::/64%eth0`

**Common Mistake:** Debugging options à¤•à¥‹ production scans à¤®à¥‡à¤‚ use à¤•à¤°à¤¨à¤¾ à¤œà¥‹ performance impact à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚. Debugging sirf troubleshooting à¤•à¥‡ à¤²à¤¿à¤ use à¤•à¤°à¥‹, regular scans à¤®à¥‡à¤‚ à¤¨à¤¹à¥€à¤‚.

---

**ğŸ“ Module 17 Complete! ğŸ†**

**CONGRATULATIONS! à¤†à¤ªà¤¨à¥‡ NMAP: Zero-to-Pro Pentester Course Complete à¤•à¤° à¤²à¤¿à¤¯à¤¾!**

à¤…à¤¬ à¤†à¤ª à¤œà¤¾à¤¨à¤¤à¥‡ à¤¹à¥‹:
- **Timing Templates:** Speed vs stealth optimization
- **Advanced Host Discovery:** Custom ping techniques  
- **Packet Fragmentation:** Classic IDS evasion
- **Advanced Evasion:** Custom payloads à¤”à¤° delays
- **Specialized Scans:** SCTP à¤”à¤° RPC protocols
- **Nmap Suite:** Ncat, Ndiff, Nping tools
- **Advanced NSE:** Lua scripting à¤”à¤° broadcast discovery
- **Pro Workflow:** Metasploit integration à¤”à¤° debugging

**ğŸš€ MASTER PENTESTER WORKFLOW:**
```bash
# 1. Network Discovery
nmap -sn <network> -oA discovery

# 2. Comprehensive Assessment  
nmap -sS -sV -sC --script vuln -T4 -oA assessment <targets>

# 3. Stealth Operations
nmap -sS -f -D RND:10 --source-port 53 -T1 <high-security-target>

# 4. Metasploit Integration
msfconsole -x "db_import assessment.xml; hosts; services"

# 5. Advanced Techniques
nmap -6 --script broadcast --resume <file> <targets>
```

**à¤†à¤ª à¤…à¤¬ à¤à¤• Professional Ethical Hacker à¤¹à¥ˆà¤‚! ğŸ•µï¸â€â™‚ï¸**

**Keep Learning, Keep Hacking (Ethically)! ğŸ’ª**

=============================================================
